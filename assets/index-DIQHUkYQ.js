const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./raw-in9isEBO.js","./basedecoder-B2c5_Eok.js","./lzw-_aCqfs4w.js","./jpeg-CKYXsxFN.js","./deflate-B9JhHpvg.js","./pako.esm-Cram60i4.js","./packbits-DDWKfGV_.js","./lerc-aPj8nzU2.js","./webimage-DBgUwIbt.js"])))=>i.map(i=>d[i]);
var sn=Object.defineProperty;var rn=(e,t,i)=>t in e?sn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var k=(e,t,i)=>rn(e,typeof t!="symbol"?t+"":t,i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function i(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=i(r);fetch(r.href,n)}})();var nn=1e-6,St=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function on(){var e=new St(9);return St!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function me(e,t,i,s,r,n,o,l,a){var c=new St(9);return c[0]=e,c[1]=t,c[2]=i,c[3]=s,c[4]=r,c[5]=n,c[6]=o,c[7]=l,c[8]=a,c}function Cs(e,t,i){var s=t[0],r=t[1],n=t[2],o=t[3],l=t[4],a=t[5],c=t[6],h=t[7],d=t[8],f=i[0],u=i[1],m=i[2],g=i[3],A=i[4],p=i[5],w=i[6],y=i[7],x=i[8];return e[0]=f*s+u*o+m*c,e[1]=f*r+u*l+m*h,e[2]=f*n+u*a+m*d,e[3]=g*s+A*o+p*c,e[4]=g*r+A*l+p*h,e[5]=g*n+A*a+p*d,e[6]=w*s+y*o+x*c,e[7]=w*r+y*l+x*h,e[8]=w*n+y*a+x*d,e}function nt(){var e=new St(16);return St!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function It(e){var t=new St(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function an(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Qt(e,t,i,s,r,n,o,l,a,c,h,d,f,u,m,g){var A=new St(16);return A[0]=e,A[1]=t,A[2]=i,A[3]=s,A[4]=r,A[5]=n,A[6]=o,A[7]=l,A[8]=a,A[9]=c,A[10]=h,A[11]=d,A[12]=f,A[13]=u,A[14]=m,A[15]=g,A}function gr(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ht(e,t){if(e===t){var i=t[1],s=t[2],r=t[3],n=t[6],o=t[7],l=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=i,e[6]=t[9],e[7]=t[13],e[8]=s,e[9]=n,e[11]=t[14],e[12]=r,e[13]=o,e[14]=l}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function zt(e,t){var i=t[0],s=t[1],r=t[2],n=t[3],o=t[4],l=t[5],a=t[6],c=t[7],h=t[8],d=t[9],f=t[10],u=t[11],m=t[12],g=t[13],A=t[14],p=t[15],w=i*l-s*o,y=i*a-r*o,x=i*c-n*o,b=s*a-r*l,M=s*c-n*l,D=r*c-n*a,v=h*g-d*m,C=h*A-f*m,I=h*p-u*m,S=d*A-f*g,E=d*p-u*g,V=f*p-u*A,T=w*V-y*E+x*S+b*I-M*C+D*v;return T?(T=1/T,e[0]=(l*V-a*E+c*S)*T,e[1]=(r*E-s*V-n*S)*T,e[2]=(g*D-A*M+p*b)*T,e[3]=(f*M-d*D-u*b)*T,e[4]=(a*I-o*V-c*C)*T,e[5]=(i*V-r*I+n*C)*T,e[6]=(A*x-m*D-p*y)*T,e[7]=(h*D-f*x+u*y)*T,e[8]=(o*E-l*I+c*v)*T,e[9]=(s*I-i*E-n*v)*T,e[10]=(m*M-g*x+p*w)*T,e[11]=(d*x-h*M-u*w)*T,e[12]=(l*C-o*S-a*v)*T,e[13]=(i*S-s*C+r*v)*T,e[14]=(g*y-m*b-A*w)*T,e[15]=(h*b-d*y+f*w)*T,e):null}function ce(e,t,i){var s=t[0],r=t[1],n=t[2],o=t[3],l=t[4],a=t[5],c=t[6],h=t[7],d=t[8],f=t[9],u=t[10],m=t[11],g=t[12],A=t[13],p=t[14],w=t[15],y=i[0],x=i[1],b=i[2],M=i[3];return e[0]=y*s+x*l+b*d+M*g,e[1]=y*r+x*a+b*f+M*A,e[2]=y*n+x*c+b*u+M*p,e[3]=y*o+x*h+b*m+M*w,y=i[4],x=i[5],b=i[6],M=i[7],e[4]=y*s+x*l+b*d+M*g,e[5]=y*r+x*a+b*f+M*A,e[6]=y*n+x*c+b*u+M*p,e[7]=y*o+x*h+b*m+M*w,y=i[8],x=i[9],b=i[10],M=i[11],e[8]=y*s+x*l+b*d+M*g,e[9]=y*r+x*a+b*f+M*A,e[10]=y*n+x*c+b*u+M*p,e[11]=y*o+x*h+b*m+M*w,y=i[12],x=i[13],b=i[14],M=i[15],e[12]=y*s+x*l+b*d+M*g,e[13]=y*r+x*a+b*f+M*A,e[14]=y*n+x*c+b*u+M*p,e[15]=y*o+x*h+b*m+M*w,e}function Be(e,t,i){var s=i[0],r=i[1],n=i[2],o,l,a,c,h,d,f,u,m,g,A,p;return t===e?(e[12]=t[0]*s+t[4]*r+t[8]*n+t[12],e[13]=t[1]*s+t[5]*r+t[9]*n+t[13],e[14]=t[2]*s+t[6]*r+t[10]*n+t[14],e[15]=t[3]*s+t[7]*r+t[11]*n+t[15]):(o=t[0],l=t[1],a=t[2],c=t[3],h=t[4],d=t[5],f=t[6],u=t[7],m=t[8],g=t[9],A=t[10],p=t[11],e[0]=o,e[1]=l,e[2]=a,e[3]=c,e[4]=h,e[5]=d,e[6]=f,e[7]=u,e[8]=m,e[9]=g,e[10]=A,e[11]=p,e[12]=o*s+h*r+m*n+t[12],e[13]=l*s+d*r+g*n+t[13],e[14]=a*s+f*r+A*n+t[14],e[15]=c*s+u*r+p*n+t[15]),e}function Ds(e,t,i){var s=i[0],r=i[1],n=i[2];return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function si(e,t,i){var s=Math.sin(i),r=Math.cos(i),n=t[4],o=t[5],l=t[6],a=t[7],c=t[8],h=t[9],d=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=n*r+c*s,e[5]=o*r+h*s,e[6]=l*r+d*s,e[7]=a*r+f*s,e[8]=c*r-n*s,e[9]=h*r-o*s,e[10]=d*r-l*s,e[11]=f*r-a*s,e}function ri(e,t,i){var s=Math.sin(i),r=Math.cos(i),n=t[0],o=t[1],l=t[2],a=t[3],c=t[4],h=t[5],d=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=n*r+c*s,e[1]=o*r+h*s,e[2]=l*r+d*s,e[3]=a*r+f*s,e[4]=c*r-n*s,e[5]=h*r-o*s,e[6]=d*r-l*s,e[7]=f*r-a*s,e}function ln(e,t,i){var s=i[0],r=i[1],n=i[2],o=Math.hypot(s,r,n),l,a,c;return o<nn?null:(o=1/o,s*=o,r*=o,n*=o,l=Math.sin(t),a=Math.cos(t),c=1-a,e[0]=s*s*c+a,e[1]=r*s*c+n*l,e[2]=n*s*c-r*l,e[3]=0,e[4]=s*r*c-n*l,e[5]=r*r*c+a,e[6]=n*r*c+s*l,e[7]=0,e[8]=s*n*c+r*l,e[9]=r*n*c-s*l,e[10]=n*n*c+a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function cn(e,t,i,s,r,n,o){var l=1/(t-i),a=1/(s-r),c=1/(n-o);return e[0]=-2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+i)*l,e[13]=(r+s)*a,e[14]=(o+n)*c,e[15]=1,e}var ni=cn;function hn(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12]*i,e[13]=t[13]*i,e[14]=t[14]*i,e[15]=t[15]*i,e}var Ar=ce;function pt(){var e=new St(3);return St!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function We(e){var t=new St(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function he(e){var t=e[0],i=e[1],s=e[2];return Math.hypot(t,i,s)}function Q(e,t,i){var s=new St(3);return s[0]=e,s[1]=t,s[2]=i,s}function Is(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function xe(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e}function bt(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e}function os(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e}function as(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e}function fn(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function dn(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function Xt(e,t){var i=t[0],s=t[1],r=t[2],n=i*i+s*s+r*r;return n>0&&(n=1/Math.sqrt(n)),e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function un(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Ci(e,t,i){var s=t[0],r=t[1],n=t[2],o=i[0],l=i[1],a=i[2];return e[0]=r*a-n*l,e[1]=n*o-s*a,e[2]=s*l-r*o,e}function mn(e,t,i,s){var r=t[0],n=t[1],o=t[2];return e[0]=r+s*(i[0]-r),e[1]=n+s*(i[1]-n),e[2]=o+s*(i[2]-o),e}function Oi(e,t){var i=e[0],s=e[1],r=e[2],n=t[0],o=t[1],l=t[2],a=Math.sqrt(i*i+s*s+r*r),c=Math.sqrt(n*n+o*o+l*l),h=a*c,d=h&&un(e,t)/h;return Math.acos(Math.min(Math.max(d,-1),1))}var Es=bt,Je=he;(function(){var e=pt();return function(t,i,s,r,n,o){var l,a;for(i||(i=3),s||(s=0),r?a=Math.min(r*i+s,t.length):a=t.length,l=s;l<a;l+=i)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],n(e,e,o),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2];return t}})();function ne(){var e=new St(4);return St!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function re(e){var t=new St(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function xt(e,t,i,s){var r=new St(4);return r[0]=e,r[1]=t,r[2]=i,r[3]=s,r}function Ms(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e}function gn(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e}function An(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e}function Tt(e,t,i){var s=t[0],r=t[1],n=t[2],o=t[3];return e[0]=i[0]*s+i[4]*r+i[8]*n+i[12]*o,e[1]=i[1]*s+i[5]*r+i[9]*n+i[13]*o,e[2]=i[2]*s+i[6]*r+i[10]*n+i[14]*o,e[3]=i[3]*s+i[7]*r+i[11]*n+i[15]*o,e}var pn=gn;(function(){var e=ne();return function(t,i,s,r,n,o){var l,a;for(i||(i=4),s||(s=0),r?a=Math.min(r*i+s,t.length):a=t.length,l=s;l<a;l+=i)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],e[3]=t[l+3],n(e,e,o),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2],t[l+3]=e[3];return t}})();function xn(){var e=new St(2);return St!=Float32Array&&(e[0]=0,e[1]=0),e}function Ss(e,t){var i=new St(2);return i[0]=e,i[1]=t,i}function vn(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e}function Ts(e){var t=e[0],i=e[1];return Math.hypot(t,i)}function wn(e,t){var i=t[0],s=t[1],r=i*i+s*s;return r>0&&(r=1/Math.sqrt(r)),e[0]=t[0]*r,e[1]=t[1]*r,e}(function(){var e=xn();return function(t,i,s,r,n,o){var l,a;for(i||(i=2),s||(s=0),r?a=Math.min(r*i+s,t.length):a=t.length,l=s;l<a;l+=i)e[0]=t[l],e[1]=t[l+1],n(e,e,o),t[l]=e[0],t[l+1]=e[1];return t}})();var pe=256,Di=[],oi;for(;pe--;)Di[pe]=(pe+256).toString(16).substring(1);function es(){var e=0,t,i="";if(!oi||pe+16>256){for(oi=Array(e=256);e--;)oi[e]=256*Math.random()|0;e=pe=0}for(;e<16;e++)t=oi[pe+e],e==6?i+=Di[t&15|64]:e==8?i+=Di[t&63|128]:i+=Di[t],e&1&&e>1&&e<11&&(i+="-");return pe++,i}function ls(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ki,Fs;function yn(){return Fs||(Fs=1,ki=function(t,i){var s=t.length;if(t===i)return!0;if(s!==i.length)return!1;for(var r=0;r<s;r++)if(t[r]!==i[r])return!1;return!0}),ki}var bn=yn();const Cn=ls(bn),pr=-1,Ui=0,Xe=1,Vi=2,cs=3,hs=4,fs=5,ds=6,xr=7,vr=8,Vs=typeof self=="object"?self:globalThis,Dn=(e,t)=>{const i=(r,n)=>(e.set(n,r),r),s=r=>{if(e.has(r))return e.get(r);const[n,o]=t[r];switch(n){case Ui:case pr:return i(o,r);case Xe:{const l=i([],r);for(const a of o)l.push(s(a));return l}case Vi:{const l=i({},r);for(const[a,c]of o)l[s(a)]=s(c);return l}case cs:return i(new Date(o),r);case hs:{const{source:l,flags:a}=o;return i(new RegExp(l,a),r)}case fs:{const l=i(new Map,r);for(const[a,c]of o)l.set(s(a),s(c));return l}case ds:{const l=i(new Set,r);for(const a of o)l.add(s(a));return l}case xr:{const{name:l,message:a}=o;return i(new Vs[l](a),r)}case vr:return i(BigInt(o),r);case"BigInt":return i(Object(BigInt(o)),r);case"ArrayBuffer":return i(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:l}=new Uint8Array(o);return i(new DataView(l),o)}}return i(new Vs[n](o),r)};return s},In=e=>Dn(new Map,e)(0),Ie="",{toString:En}={},{keys:Mn}=Object,Ge=e=>{const t=typeof e;if(t!=="object"||!e)return[Ui,t];const i=En.call(e).slice(8,-1);switch(i){case"Array":return[Xe,Ie];case"Object":return[Vi,Ie];case"Date":return[cs,Ie];case"RegExp":return[hs,Ie];case"Map":return[fs,Ie];case"Set":return[ds,Ie];case"DataView":return[Xe,i]}return i.includes("Array")?[Xe,i]:i.includes("Error")?[xr,i]:[Vi,i]},ai=([e,t])=>e===Ui&&(t==="function"||t==="symbol"),Sn=(e,t,i,s)=>{const r=(o,l)=>{const a=s.push(o)-1;return i.set(l,a),a},n=o=>{if(i.has(o))return i.get(o);let[l,a]=Ge(o);switch(l){case Ui:{let h=o;switch(a){case"bigint":l=vr,h=o.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+a);h=null;break;case"undefined":return r([pr],o)}return r([l,h],o)}case Xe:{if(a){let f=o;return a==="DataView"?f=new Uint8Array(o.buffer):a==="ArrayBuffer"&&(f=new Uint8Array(o)),r([a,[...f]],o)}const h=[],d=r([l,h],o);for(const f of o)h.push(n(f));return d}case Vi:{if(a)switch(a){case"BigInt":return r([a,o.toString()],o);case"Boolean":case"Number":case"String":return r([a,o.valueOf()],o)}if(t&&"toJSON"in o)return n(o.toJSON());const h=[],d=r([l,h],o);for(const f of Mn(o))(e||!ai(Ge(o[f])))&&h.push([n(f),n(o[f])]);return d}case cs:return r([l,o.toISOString()],o);case hs:{const{source:h,flags:d}=o;return r([l,{source:h,flags:d}],o)}case fs:{const h=[],d=r([l,h],o);for(const[f,u]of o)(e||!(ai(Ge(f))||ai(Ge(u))))&&h.push([n(f),n(u)]);return d}case ds:{const h=[],d=r([l,h],o);for(const f of o)(e||!ai(Ge(f)))&&h.push(n(f));return d}}const{message:c}=o;return r([l,{name:a,message:c}],o)};return n},Tn=(e,{json:t,lossy:i}={})=>{const s=[];return Sn(!(t||i),!!t,new Map,s)(e),s};var Mt=Uint8Array,Pe=Uint16Array,Fn=Int32Array,wr=new Mt([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),yr=new Mt([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Vn=new Mt([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),br=function(e,t){for(var i=new Pe(31),s=0;s<31;++s)i[s]=t+=1<<e[s-1];for(var r=new Fn(i[30]),s=1;s<30;++s)for(var n=i[s];n<i[s+1];++n)r[n]=n-i[s]<<5|s;return{b:i,r}},Cr=br(wr,2),Dr=Cr.b,Bn=Cr.r;Dr[28]=258,Bn[258]=28;var Un=br(yr,0),Rn=Un.b,is=new Pe(32768);for(var vt=0;vt<32768;++vt){var oe=(vt&43690)>>1|(vt&21845)<<1;oe=(oe&52428)>>2|(oe&13107)<<2,oe=(oe&61680)>>4|(oe&3855)<<4,is[vt]=((oe&65280)>>8|(oe&255)<<8)>>1}var je=function(e,t,i){for(var s=e.length,r=0,n=new Pe(t);r<s;++r)e[r]&&++n[e[r]-1];var o=new Pe(t);for(r=1;r<t;++r)o[r]=o[r-1]+n[r-1]<<1;var l;if(i){l=new Pe(1<<t);var a=15-t;for(r=0;r<s;++r)if(e[r])for(var c=r<<4|e[r],h=t-e[r],d=o[e[r]-1]++<<h,f=d|(1<<h)-1;d<=f;++d)l[is[d]>>a]=c}else for(l=new Pe(s),r=0;r<s;++r)e[r]&&(l[r]=is[o[e[r]-1]++]>>15-e[r]);return l},$e=new Mt(288);for(var vt=0;vt<144;++vt)$e[vt]=8;for(var vt=144;vt<256;++vt)$e[vt]=9;for(var vt=256;vt<280;++vt)$e[vt]=7;for(var vt=280;vt<288;++vt)$e[vt]=8;var Ir=new Mt(32);for(var vt=0;vt<32;++vt)Ir[vt]=5;var Nn=je($e,9,1),Pn=je(Ir,5,1),Gi=function(e){for(var t=e[0],i=1;i<e.length;++i)e[i]>t&&(t=e[i]);return t},Zt=function(e,t,i){var s=t/8|0;return(e[s]|e[s+1]<<8)>>(t&7)&i},Yi=function(e,t){var i=t/8|0;return(e[i]|e[i+1]<<8|e[i+2]<<16)>>(t&7)},Er=function(e){return(e+7)/8|0},Ii=function(e,t,i){return(t==null||t<0)&&(t=0),(i==null||i>e.length)&&(i=e.length),new Mt(e.subarray(t,i))},Ln=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Pt=function(e,t,i){var s=new Error(t||Ln[e]);if(s.code=e,Error.captureStackTrace&&Error.captureStackTrace(s,Pt),!i)throw s;return s},Ri=function(e,t,i,s){var r=e.length,n=0;if(!r||t.f&&!t.l)return i||new Mt(0);var o=!i,l=o||t.i!=2,a=t.i;o&&(i=new Mt(r*3));var c=function(ft){var ut=i.length;if(ft>ut){var At=new Mt(Math.max(ut*2,ft));At.set(i),i=At}},h=t.f||0,d=t.p||0,f=t.b||0,u=t.l,m=t.d,g=t.m,A=t.n,p=r*8;do{if(!u){h=Zt(e,d,1);var w=Zt(e,d+1,3);if(d+=3,w)if(w==1)u=Nn,m=Pn,g=9,A=5;else if(w==2){var M=Zt(e,d,31)+257,D=Zt(e,d+10,15)+4,v=M+Zt(e,d+5,31)+1;d+=14;for(var C=new Mt(v),I=new Mt(19),S=0;S<D;++S)I[Vn[S]]=Zt(e,d+S*3,7);d+=D*3;for(var E=Gi(I),V=(1<<E)-1,T=je(I,E,1),S=0;S<v;){var R=T[Zt(e,d,V)];d+=R&15;var y=R>>4;if(y<16)C[S++]=y;else{var N=0,O=0;for(y==16?(O=3+Zt(e,d,3),d+=2,N=C[S-1]):y==17?(O=3+Zt(e,d,7),d+=3):y==18&&(O=11+Zt(e,d,127),d+=7);O--;)C[S++]=N}}var G=C.subarray(0,M),z=C.subarray(M);g=Gi(G),A=Gi(z),u=je(G,g,1),m=je(z,A,1)}else Pt(1);else{var y=Er(d)+4,x=e[y-4]|e[y-3]<<8,b=y+x;if(b>r){a&&Pt(0);break}l&&c(f+x),i.set(e.subarray(y,b),f),t.b=f+=x,t.p=d=b*8,t.f=h;continue}if(d>p){a&&Pt(0);break}}l&&c(f+131072);for(var q=(1<<g)-1,J=(1<<A)-1,_=d;;_=d){var N=u[Yi(e,d)&q],tt=N>>4;if(d+=N&15,d>p){a&&Pt(0);break}if(N||Pt(2),tt<256)i[f++]=tt;else if(tt==256){_=d,u=null;break}else{var $=tt-254;if(tt>264){var S=tt-257,dt=wr[S];$=Zt(e,d,(1<<dt)-1)+Dr[S],d+=dt}var lt=m[Yi(e,d)&J],rt=lt>>4;lt||Pt(3),d+=lt&15;var z=Rn[rt];if(rt>3){var dt=yr[rt];z+=Yi(e,d)&(1<<dt)-1,d+=dt}if(d>p){a&&Pt(0);break}l&&c(f+131072);var ht=f+$;if(f<z){var Ct=n-z,ct=Math.min(z,ht);for(Ct+f<0&&Pt(3);f<ct;++f)i[f]=s[Ct+f]}for(;f<ht;++f)i[f]=i[f-z]}}t.l=u,t.p=_,t.b=f,t.f=h,u&&(h=1,t.m=g,t.d=m,t.n=A)}while(!h);return f!=i.length&&o?Ii(i,0,f):i.subarray(0,f)},On=new Mt(0),Mr=function(e){(e[0]!=31||e[1]!=139||e[2]!=8)&&Pt(6,"invalid gzip data");var t=e[3],i=10;t&4&&(i+=(e[10]|e[11]<<8)+2);for(var s=(t>>3&1)+(t>>4&1);s>0;s-=!e[i++]);return i+(t&2)},kn=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},Gn=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Pt(6,"invalid zlib data"),(e[1]>>5&1)==1&&Pt(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2},zi=function(){function e(t,i){typeof t=="function"&&(i=t,t={}),this.ondata=i;var s=t&&t.dictionary&&t.dictionary.subarray(-32768);this.s={i:0,b:s?s.length:0},this.o=new Mt(32768),this.p=new Mt(0),s&&this.o.set(s)}return e.prototype.e=function(t){if(this.ondata||Pt(5),this.d&&Pt(4),!this.p.length)this.p=t;else if(t.length){var i=new Mt(this.p.length+t.length);i.set(this.p),i.set(t,this.p.length),this.p=i}},e.prototype.c=function(t){this.s.i=+(this.d=t||!1);var i=this.s.b,s=Ri(this.p,this.s,this.o);this.ondata(Ii(s,i,this.s.b),this.d),this.o=Ii(s,this.s.b-32768),this.s.b=this.o.length,this.p=Ii(this.p,this.s.p/8|0),this.s.p&=7},e.prototype.push=function(t,i){this.e(t),this.c(i)},e}();function Yn(e,t){return Ri(e,{i:2},t,t)}var zn=function(){function e(t,i){this.v=1,this.r=0,zi.call(this,t,i)}return e.prototype.push=function(t,i){if(zi.prototype.e.call(this,t),this.r+=t.length,this.v){var s=this.p.subarray(this.v-1),r=s.length>3?Mr(s):4;if(r>s.length){if(!i)return}else this.v>1&&this.onmember&&this.onmember(this.r-s.length);this.p=s.subarray(r),this.v=0}zi.prototype.c.call(this,i),this.s.f&&!this.s.l&&!i&&(this.v=Er(this.s.p)+9,this.s={i:0},this.o=new Mt(0),this.push(new Mt(0),i))},e}();function Kn(e,t){var i=Mr(e);return i+8>e.length&&Pt(6,"invalid gzip data"),Ri(e.subarray(i,-8),{i:2},new Mt(kn(e)),t)}function qn(e,t){return Ri(e.subarray(Gn(e),-4),{i:2},t,t)}function Qn(e,t){return e[0]==31&&e[1]==139&&e[2]==8?Kn(e,t):(e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31?Yn(e,t):qn(e,t)}var Hn=typeof TextDecoder<"u"&&new TextDecoder,Wn=0;try{Hn.decode(On,{stream:!0}),Wn=1}catch{}class Sr{constructor(t,i,s,r){k(this,"esize");k(this,"ecode");k(this,"edata");k(this,"littleEndian");if(t%16!=0)throw new Error("This does not appear to be a NIFTI extension");this.esize=t,this.ecode=i,this.edata=s,this.littleEndian=r}toArrayBuffer(){let t=new Uint8Array(this.esize),i=new Uint8Array(this.edata);t.set(i,8);let s=new DataView(t.buffer);return s.setInt32(0,this.esize,this.littleEndian),s.setInt32(4,this.ecode,this.littleEndian),t.buffer}}const Nt=class Nt{static getStringAt(t,i,s){var r="",n,o;for(n=i;n<s;n+=1)o=t.getUint8(n),o!==0&&(r+=String.fromCharCode(o));return r}static getIntAt(t,i,s){return t.getInt32(i,s)}static getFloatAt(t,i,s){return t.getFloat32(i,s)}static getDoubleAt(t,i,s){return t.getFloat64(i,s)}static getInt64At(t,i,s){const r=t.getUint32(i,s),n=t.getInt32(i+4,s);let o;return s?o=n*2**32+r:o=r*2**32+n,n<0&&(o+=-1*2**32*2**32),o}static getUint64At(t,i,s){const r=t.getUint32(i+(s?0:4),s),n=t.getUint32(i+(s?4:0),s);return s?n*2**32+r:r*2**32+n}static getExtensionsAt(t,i,s,r){let n=[],o=i;for(;o<r;){let l=s,a=Nt.getIntAt(t,o,s);if(!a)break;if(a+o>r&&(l=!l,a=Nt.getIntAt(t,o,l),a+o>r))throw new Error("This does not appear to be a valid NIFTI extension");if(a%16!=0)throw new Error("This does not appear to be a NIFTI extension");let c=Nt.getIntAt(t,o+4,l),h=t.buffer.slice(o+8,o+a),d=new Sr(a,c,h,l);n.push(d),o+=a}return n}static toArrayBuffer(t){var i,s,r;for(i=new ArrayBuffer(t.length),s=new Uint8Array(i),r=0;r<t.length;r+=1)s[r]=t[r];return i}static isString(t){return typeof t=="string"||t instanceof String}static formatNumber(t,i=void 0){let s;return Nt.isString(t)?s=Number(t):s=t,i?s=s.toPrecision(5):s=s.toPrecision(7),parseFloat(s)}static makeCRCTable(){let t,i=[];for(var s=0;s<256;s++){t=s;for(var r=0;r<8;r++)t=t&1?3988292384^t>>>1:t>>>1;i[s]=t}return i}static crc32(t){Nt.crcTable||(Nt.crcTable=Nt.makeCRCTable());const i=Nt.crcTable;let s=-1;for(var r=0;r<t.byteLength;r++)s=s>>>8^i[(s^t.getUint8(r))&255];return(s^-1)>>>0}};k(Nt,"crcTable",null),k(Nt,"GUNZIP_MAGIC_COOKIE1",31),k(Nt,"GUNZIP_MAGIC_COOKIE2",139),k(Nt,"getByteAt",function(t,i){return t.getUint8(i)}),k(Nt,"getShortAt",function(t,i,s){return t.getInt16(i,s)});let K=Nt;const H=class H{constructor(){k(this,"littleEndian",!1);k(this,"dim_info",0);k(this,"dims",[]);k(this,"intent_p1",0);k(this,"intent_p2",0);k(this,"intent_p3",0);k(this,"intent_code",0);k(this,"datatypeCode",0);k(this,"numBitsPerVoxel",0);k(this,"slice_start",0);k(this,"slice_end",0);k(this,"slice_code",0);k(this,"pixDims",[]);k(this,"vox_offset",0);k(this,"scl_slope",1);k(this,"scl_inter",0);k(this,"xyzt_units",0);k(this,"cal_max",0);k(this,"cal_min",0);k(this,"slice_duration",0);k(this,"toffset",0);k(this,"description","");k(this,"aux_file","");k(this,"intent_name","");k(this,"qform_code",0);k(this,"sform_code",0);k(this,"quatern_a",0);k(this,"quatern_b",0);k(this,"quatern_c",0);k(this,"quatern_d",0);k(this,"qoffset_x",0);k(this,"qoffset_y",0);k(this,"qoffset_z",0);k(this,"affine",[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]);k(this,"qfac",1);k(this,"quatern_R");k(this,"magic","0");k(this,"isHDR",!1);k(this,"extensionFlag",[0,0,0,0]);k(this,"extensionSize",0);k(this,"extensionCode",0);k(this,"extensions",[]);k(this,"getDatatypeCodeString",function(t){return t===H.TYPE_UINT8?"1-Byte Unsigned Integer":t===H.TYPE_INT16?"2-Byte Signed Integer":t===H.TYPE_INT32?"4-Byte Signed Integer":t===H.TYPE_FLOAT32?"4-Byte Float":t===H.TYPE_FLOAT64?"8-Byte Float":t===H.TYPE_RGB24?"RGB":t===H.TYPE_INT8?"1-Byte Signed Integer":t===H.TYPE_UINT16?"2-Byte Unsigned Integer":t===H.TYPE_UINT32?"4-Byte Unsigned Integer":t===H.TYPE_INT64?"8-Byte Signed Integer":t===H.TYPE_UINT64?"8-Byte Unsigned Integer":"Unknown"});k(this,"getTransformCodeString",function(t){return t===H.XFORM_SCANNER_ANAT?"Scanner":t===H.XFORM_ALIGNED_ANAT?"Aligned":t===H.XFORM_TALAIRACH?"Talairach":t===H.XFORM_MNI_152?"MNI":"Unknown"});k(this,"getUnitsCodeString",function(t){return t===H.UNITS_METER?"Meters":t===H.UNITS_MM?"Millimeters":t===H.UNITS_MICRON?"Microns":t===H.UNITS_SEC?"Seconds":t===H.UNITS_MSEC?"Milliseconds":t===H.UNITS_USEC?"Microseconds":t===H.UNITS_HZ?"Hz":t===H.UNITS_PPM?"PPM":t===H.UNITS_RADS?"Rads":"Unknown"});k(this,"nifti_mat33_mul",function(t,i){var s=[[0,0,0],[0,0,0],[0,0,0]],r,n;for(r=0;r<3;r+=1)for(n=0;n<3;n+=1)s[r][n]=t[r][0]*i[0][n]+t[r][1]*i[1][n]+t[r][2]*i[2][n];return s});k(this,"nifti_mat33_determ",function(t){var i,s,r,n,o,l,a,c,h;return i=t[0][0],s=t[0][1],r=t[0][2],n=t[1][0],o=t[1][1],l=t[1][2],a=t[2][0],c=t[2][1],h=t[2][2],i*o*h-i*c*l-n*s*h+n*c*r+a*s*l-a*o*r})}readHeader(t){var i=new DataView(t),s=K.getIntAt(i,0,this.littleEndian),r,n,o,l;if(s!==H.MAGIC_COOKIE&&(this.littleEndian=!0,s=K.getIntAt(i,0,this.littleEndian)),s!==H.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.dim_info=K.getByteAt(i,39),r=0;r<8;r+=1)l=40+r*2,this.dims[r]=K.getShortAt(i,l,this.littleEndian);for(this.intent_p1=K.getFloatAt(i,56,this.littleEndian),this.intent_p2=K.getFloatAt(i,60,this.littleEndian),this.intent_p3=K.getFloatAt(i,64,this.littleEndian),this.intent_code=K.getShortAt(i,68,this.littleEndian),this.datatypeCode=K.getShortAt(i,70,this.littleEndian),this.numBitsPerVoxel=K.getShortAt(i,72,this.littleEndian),this.slice_start=K.getShortAt(i,74,this.littleEndian),r=0;r<8;r+=1)l=76+r*4,this.pixDims[r]=K.getFloatAt(i,l,this.littleEndian);if(this.vox_offset=K.getFloatAt(i,108,this.littleEndian),this.scl_slope=K.getFloatAt(i,112,this.littleEndian),this.scl_inter=K.getFloatAt(i,116,this.littleEndian),this.slice_end=K.getShortAt(i,120,this.littleEndian),this.slice_code=K.getByteAt(i,122),this.xyzt_units=K.getByteAt(i,123),this.cal_max=K.getFloatAt(i,124,this.littleEndian),this.cal_min=K.getFloatAt(i,128,this.littleEndian),this.slice_duration=K.getFloatAt(i,132,this.littleEndian),this.toffset=K.getFloatAt(i,136,this.littleEndian),this.description=K.getStringAt(i,148,228),this.aux_file=K.getStringAt(i,228,252),this.qform_code=K.getShortAt(i,252,this.littleEndian),this.sform_code=K.getShortAt(i,254,this.littleEndian),this.quatern_b=K.getFloatAt(i,256,this.littleEndian),this.quatern_c=K.getFloatAt(i,260,this.littleEndian),this.quatern_d=K.getFloatAt(i,264,this.littleEndian),this.quatern_a=Math.sqrt(1-(Math.pow(this.quatern_b,2)+Math.pow(this.quatern_c,2)+Math.pow(this.quatern_d,2))),this.qoffset_x=K.getFloatAt(i,268,this.littleEndian),this.qoffset_y=K.getFloatAt(i,272,this.littleEndian),this.qoffset_z=K.getFloatAt(i,276,this.littleEndian),this.qform_code<1&&this.sform_code<1&&(this.affine[0][0]=this.pixDims[1],this.affine[1][1]=this.pixDims[2],this.affine[2][2]=this.pixDims[3]),this.qform_code>0&&this.sform_code<this.qform_code){const a=this.quatern_a,c=this.quatern_b,h=this.quatern_c,d=this.quatern_d;for(this.qfac=this.pixDims[0]===0?1:this.pixDims[0],this.quatern_R=[[a*a+c*c-h*h-d*d,2*c*h-2*a*d,2*c*d+2*a*h],[2*c*h+2*a*d,a*a+h*h-c*c-d*d,2*h*d-2*a*c],[2*c*d-2*a*h,2*h*d+2*a*c,a*a+d*d-h*h-c*c]],n=0;n<3;n+=1)for(o=0;o<3;o+=1)this.affine[n][o]=this.quatern_R[n][o]*this.pixDims[o+1],o===2&&(this.affine[n][o]*=this.qfac);this.affine[0][3]=this.qoffset_x,this.affine[1][3]=this.qoffset_y,this.affine[2][3]=this.qoffset_z}else if(this.sform_code>0)for(n=0;n<3;n+=1)for(o=0;o<4;o+=1)l=280+(n*4+o)*4,this.affine[n][o]=K.getFloatAt(i,l,this.littleEndian);if(this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.intent_name=K.getStringAt(i,328,344),this.magic=K.getStringAt(i,344,348),this.isHDR=this.magic===String.fromCharCode.apply(null,H.MAGIC_NUMBER2),i.byteLength>H.MAGIC_COOKIE){this.extensionFlag[0]=K.getByteAt(i,348),this.extensionFlag[1]=K.getByteAt(i,349),this.extensionFlag[2]=K.getByteAt(i,350),this.extensionFlag[3]=K.getByteAt(i,351);let a=!0;!this.isHDR&&this.vox_offset<=352&&(a=!1),i.byteLength<=368&&(a=!1),a&&this.extensionFlag[0]&&(this.extensions=K.getExtensionsAt(i,this.getExtensionLocation(),this.littleEndian,this.vox_offset),this.extensionSize=this.extensions[0].esize,this.extensionCode=this.extensions[0].ecode)}}toFormattedString(){var t=K.formatNumber,i="";return i+="Dim Info = "+this.dim_info+`
`,i+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+`
`,i+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+`
`,i+="Intent Code = "+this.intent_code+`
`,i+="Datatype = "+this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+`)
`,i+="Bits Per Voxel = "+this.numBitsPerVoxel+`
`,i+="Slice Start = "+this.slice_start+`
`,i+="Voxel Dimensions (1-8): "+t(this.pixDims[0])+", "+t(this.pixDims[1])+", "+t(this.pixDims[2])+", "+t(this.pixDims[3])+", "+t(this.pixDims[4])+", "+t(this.pixDims[5])+", "+t(this.pixDims[6])+", "+t(this.pixDims[7])+`
`,i+="Image Offset = "+this.vox_offset+`
`,i+="Data Scale:  Slope = "+t(this.scl_slope)+"  Intercept = "+t(this.scl_inter)+`
`,i+="Slice End = "+this.slice_end+`
`,i+="Slice Code = "+this.slice_code+`
`,i+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(H.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(H.TEMPORAL_UNITS_MASK&this.xyzt_units)+`)
`,i+="Display Range:  Max = "+t(this.cal_max)+"  Min = "+t(this.cal_min)+`
`,i+="Slice Duration = "+this.slice_duration+`
`,i+="Time Axis Shift = "+this.toffset+`
`,i+='Description: "'+this.description+`"
`,i+='Auxiliary File: "'+this.aux_file+`"
`,i+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+`)
`,i+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+`)
`,i+="Quaternion Parameters:  b = "+t(this.quatern_b)+"  c = "+t(this.quatern_c)+"  d = "+t(this.quatern_d)+`
`,i+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+`
`,i+="S-Form Parameters X: "+t(this.affine[0][0])+", "+t(this.affine[0][1])+", "+t(this.affine[0][2])+", "+t(this.affine[0][3])+`
`,i+="S-Form Parameters Y: "+t(this.affine[1][0])+", "+t(this.affine[1][1])+", "+t(this.affine[1][2])+", "+t(this.affine[1][3])+`
`,i+="S-Form Parameters Z: "+t(this.affine[2][0])+", "+t(this.affine[2][1])+", "+t(this.affine[2][2])+", "+t(this.affine[2][3])+`
`,i+='Intent Name: "'+this.intent_name+`"
`,this.extensionFlag[0]&&(i+="Extension: Size = "+this.extensionSize+"  Code = "+this.extensionCode+`
`),i}getQformMat(){return this.convertNiftiQFormToNiftiSForm(this.quatern_b,this.quatern_c,this.quatern_d,this.qoffset_x,this.qoffset_y,this.qoffset_z,this.pixDims[1],this.pixDims[2],this.pixDims[3],this.pixDims[0])}convertNiftiQFormToNiftiSForm(t,i,s,r,n,o,l,a,c,h){var d=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],f,u=t,m=i,g=s,A,p,w;return d[3][0]=d[3][1]=d[3][2]=0,d[3][3]=1,f=1-(u*u+m*m+g*g),f<1e-7?(f=1/Math.sqrt(u*u+m*m+g*g),u*=f,m*=f,g*=f,f=0):f=Math.sqrt(f),A=l>0?l:1,p=a>0?a:1,w=c>0?c:1,h<0&&(w=-w),d[0][0]=(f*f+u*u-m*m-g*g)*A,d[0][1]=2*(u*m-f*g)*p,d[0][2]=2*(u*g+f*m)*w,d[1][0]=2*(u*m+f*g)*A,d[1][1]=(f*f+m*m-u*u-g*g)*p,d[1][2]=2*(m*g-f*u)*w,d[2][0]=2*(u*g-f*m)*A,d[2][1]=2*(m*g+f*u)*p,d[2][2]=(f*f+g*g-m*m-u*u)*w,d[0][3]=r,d[1][3]=n,d[2][3]=o,d}convertNiftiSFormToNEMA(t){var i,s,r,n,o,l,a,c,h,d,f,u,m,g,A,p,w,y,x,b,M,D,v,C,I,S,E,V,T,R,N,O,G,z;if(A=0,E=[[0,0,0],[0,0,0],[0,0,0]],V=[[0,0,0],[0,0,0],[0,0,0]],i=t[0][0],s=t[0][1],r=t[0][2],n=t[1][0],o=t[1][1],l=t[1][2],a=t[2][0],c=t[2][1],h=t[2][2],d=Math.sqrt(i*i+n*n+a*a),d===0||(i/=d,n/=d,a/=d,d=Math.sqrt(s*s+o*o+c*c),d===0))return null;if(s/=d,o/=d,c/=d,d=i*s+n*o+a*c,Math.abs(d)>1e-4){if(s-=d*i,o-=d*n,c-=d*a,d=Math.sqrt(s*s+o*o+c*c),d===0)return null;s/=d,o/=d,c/=d}if(d=Math.sqrt(r*r+l*l+h*h),d===0?(r=n*c-a*o,l=a*s-c*i,h=i*o-n*s):(r/=d,l/=d,h/=d),d=i*r+n*l+a*h,Math.abs(d)>1e-4){if(r-=d*i,l-=d*n,h-=d*a,d=Math.sqrt(r*r+l*l+h*h),d===0)return null;r/=d,l/=d,h/=d}if(d=s*r+o*l+c*h,Math.abs(d)>1e-4){if(r-=d*s,l-=d*o,h-=d*c,d=Math.sqrt(r*r+l*l+h*h),d===0)return null;r/=d,l/=d,h/=d}if(E[0][0]=i,E[0][1]=s,E[0][2]=r,E[1][0]=n,E[1][1]=o,E[1][2]=l,E[2][0]=a,E[2][1]=c,E[2][2]=h,f=this.nifti_mat33_determ(E),f===0)return null;for(S=-666,x=D=v=C=1,b=2,M=3,m=1;m<=3;m+=1)for(g=1;g<=3;g+=1)if(m!==g){for(A=1;A<=3;A+=1)if(!(m===A||g===A))for(V[0][0]=V[0][1]=V[0][2]=V[1][0]=V[1][1]=V[1][2]=V[2][0]=V[2][1]=V[2][2]=0,p=-1;p<=1;p+=2)for(w=-1;w<=1;w+=2)for(y=-1;y<=1;y+=2)V[0][m-1]=p,V[1][g-1]=w,V[2][A-1]=y,u=this.nifti_mat33_determ(V),u*f>0&&(I=this.nifti_mat33_mul(V,E),d=I[0][0]+I[1][1]+I[2][2],d>S&&(S=d,x=m,b=g,M=A,D=p,v=w,C=y))}switch(T=R=N=O=G=z="",x*D){case 1:T="X",O="+";break;case-1:T="X",O="-";break;case 2:T="Y",O="+";break;case-2:T="Y",O="-";break;case 3:T="Z",O="+";break;case-3:T="Z",O="-";break}switch(b*v){case 1:R="X",G="+";break;case-1:R="X",G="-";break;case 2:R="Y",G="+";break;case-2:R="Y",G="-";break;case 3:R="Z",G="+";break;case-3:R="Z",G="-";break}switch(M*C){case 1:N="X",z="+";break;case-1:N="X",z="-";break;case 2:N="Y",z="+";break;case-2:N="Y",z="-";break;case 3:N="Z",z="+";break;case-3:N="Z",z="-";break}return T+R+N+O+G+z}getExtensionLocation(){return H.MAGIC_COOKIE+4}getExtensionSize(t){return K.getIntAt(t,this.getExtensionLocation(),this.littleEndian)}getExtensionCode(t){return K.getIntAt(t,this.getExtensionLocation()+4,this.littleEndian)}addExtension(t,i=-1){i==-1?this.extensions.push(t):this.extensions.splice(i,0,t),this.vox_offset+=t.esize}removeExtension(t){let i=this.extensions[t];i&&(this.vox_offset-=i.esize),this.extensions.splice(t,1)}toArrayBuffer(t=!1){let r=352;if(t)for(let a of this.extensions)r+=a.esize;let n=new Uint8Array(r),o=new DataView(n.buffer);o.setInt32(0,348,this.littleEndian),o.setUint8(39,this.dim_info);for(let a=0;a<8;a++)o.setUint16(40+2*a,this.dims[a],this.littleEndian);o.setFloat32(56,this.intent_p1,this.littleEndian),o.setFloat32(60,this.intent_p2,this.littleEndian),o.setFloat32(64,this.intent_p3,this.littleEndian),o.setInt16(68,this.intent_code,this.littleEndian),o.setInt16(70,this.datatypeCode,this.littleEndian),o.setInt16(72,this.numBitsPerVoxel,this.littleEndian),o.setInt16(74,this.slice_start,this.littleEndian);for(let a=0;a<8;a++)o.setFloat32(76+4*a,this.pixDims[a],this.littleEndian);o.setFloat32(108,this.vox_offset,this.littleEndian),o.setFloat32(112,this.scl_slope,this.littleEndian),o.setFloat32(116,this.scl_inter,this.littleEndian),o.setInt16(120,this.slice_end,this.littleEndian),o.setUint8(122,this.slice_code),o.setUint8(123,this.xyzt_units),o.setFloat32(124,this.cal_max,this.littleEndian),o.setFloat32(128,this.cal_min,this.littleEndian),o.setFloat32(132,this.slice_duration,this.littleEndian),o.setFloat32(136,this.toffset,this.littleEndian),n.set(new TextEncoder().encode(this.description),148),n.set(new TextEncoder().encode(this.aux_file),228),o.setInt16(252,this.qform_code,this.littleEndian),o.setInt16(254,this.sform_code,this.littleEndian),o.setFloat32(256,this.quatern_b,this.littleEndian),o.setFloat32(260,this.quatern_c,this.littleEndian),o.setFloat32(264,this.quatern_d,this.littleEndian),o.setFloat32(268,this.qoffset_x,this.littleEndian),o.setFloat32(272,this.qoffset_y,this.littleEndian),o.setFloat32(276,this.qoffset_z,this.littleEndian);const l=this.affine.flat();for(let a=0;a<12;a++)o.setFloat32(280+4*a,l[a],this.littleEndian);if(n.set(new TextEncoder().encode(this.intent_name),328),n.set(new TextEncoder().encode(this.magic),344),t){n.set(Uint8Array.from([1,0,0,0]),348);let a=this.getExtensionLocation();for(const c of this.extensions)o.setInt32(a,c.esize,c.littleEndian),o.setInt32(a+4,c.ecode,c.littleEndian),n.set(new Uint8Array(c.edata),a+8),a+=c.esize}else n.set(new Uint8Array(4).fill(0),348);return n.buffer}};k(H,"TYPE_NONE",0),k(H,"TYPE_BINARY",1),k(H,"TYPE_UINT8",2),k(H,"TYPE_INT16",4),k(H,"TYPE_INT32",8),k(H,"TYPE_FLOAT32",16),k(H,"TYPE_COMPLEX64",32),k(H,"TYPE_FLOAT64",64),k(H,"TYPE_RGB24",128),k(H,"TYPE_INT8",256),k(H,"TYPE_UINT16",512),k(H,"TYPE_UINT32",768),k(H,"TYPE_INT64",1024),k(H,"TYPE_UINT64",1280),k(H,"TYPE_FLOAT128",1536),k(H,"TYPE_COMPLEX128",1792),k(H,"TYPE_COMPLEX256",2048),k(H,"XFORM_UNKNOWN",0),k(H,"XFORM_SCANNER_ANAT",1),k(H,"XFORM_ALIGNED_ANAT",2),k(H,"XFORM_TALAIRACH",3),k(H,"XFORM_MNI_152",4),k(H,"SPATIAL_UNITS_MASK",7),k(H,"TEMPORAL_UNITS_MASK",56),k(H,"UNITS_UNKNOWN",0),k(H,"UNITS_METER",1),k(H,"UNITS_MM",2),k(H,"UNITS_MICRON",3),k(H,"UNITS_SEC",8),k(H,"UNITS_MSEC",16),k(H,"UNITS_USEC",24),k(H,"UNITS_HZ",32),k(H,"UNITS_PPM",40),k(H,"UNITS_RADS",48),k(H,"MAGIC_COOKIE",348),k(H,"STANDARD_HEADER_SIZE",348),k(H,"MAGIC_NUMBER_LOCATION",344),k(H,"MAGIC_NUMBER",[110,43,49]),k(H,"MAGIC_NUMBER2",[110,105,49]),k(H,"EXTENSION_HEADER_SIZE",8);let et=H;const ie=class ie{constructor(){k(this,"littleEndian",!1);k(this,"dim_info",0);k(this,"dims",[]);k(this,"intent_p1",0);k(this,"intent_p2",0);k(this,"intent_p3",0);k(this,"intent_code",0);k(this,"datatypeCode",0);k(this,"numBitsPerVoxel",0);k(this,"slice_start",0);k(this,"slice_end",0);k(this,"slice_code",0);k(this,"pixDims",[]);k(this,"vox_offset",0);k(this,"scl_slope",1);k(this,"scl_inter",0);k(this,"xyzt_units",0);k(this,"cal_max",0);k(this,"cal_min",0);k(this,"slice_duration",0);k(this,"toffset",0);k(this,"description","");k(this,"aux_file","");k(this,"intent_name","");k(this,"qform_code",0);k(this,"sform_code",0);k(this,"quatern_b",0);k(this,"quatern_c",0);k(this,"quatern_d",0);k(this,"qoffset_x",0);k(this,"qoffset_y",0);k(this,"qoffset_z",0);k(this,"affine",[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]);k(this,"magic","0");k(this,"extensionFlag",[0,0,0,0]);k(this,"extensions",[]);k(this,"extensionSize",0);k(this,"extensionCode",0);k(this,"getExtensionLocation",function(){return ie.MAGIC_COOKIE+4});k(this,"getExtensionSize",et.prototype.getExtensionSize);k(this,"getExtensionCode",et.prototype.getExtensionCode);k(this,"addExtension",et.prototype.addExtension);k(this,"removeExtension",et.prototype.removeExtension);k(this,"getDatatypeCodeString",et.prototype.getDatatypeCodeString);k(this,"getTransformCodeString",et.prototype.getTransformCodeString);k(this,"getUnitsCodeString",et.prototype.getUnitsCodeString);k(this,"getQformMat",et.prototype.getQformMat);k(this,"convertNiftiQFormToNiftiSForm",et.prototype.convertNiftiQFormToNiftiSForm);k(this,"convertNiftiSFormToNEMA",et.prototype.convertNiftiSFormToNEMA);k(this,"nifti_mat33_mul",et.prototype.nifti_mat33_mul);k(this,"nifti_mat33_determ",et.prototype.nifti_mat33_determ)}readHeader(t){var i=new DataView(t),s=K.getIntAt(i,0,this.littleEndian),r,n,o,l;if(s!==ie.MAGIC_COOKIE&&(this.littleEndian=!0,s=K.getIntAt(i,0,this.littleEndian)),s!==ie.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.magic=K.getStringAt(i,4,12),this.datatypeCode=K.getShortAt(i,12,this.littleEndian),this.numBitsPerVoxel=K.getShortAt(i,14,this.littleEndian),r=0;r<8;r+=1)l=16+r*8,this.dims[r]=K.getInt64At(i,l,this.littleEndian);for(this.intent_p1=K.getDoubleAt(i,80,this.littleEndian),this.intent_p2=K.getDoubleAt(i,88,this.littleEndian),this.intent_p3=K.getDoubleAt(i,96,this.littleEndian),r=0;r<8;r+=1)l=104+r*8,this.pixDims[r]=K.getDoubleAt(i,l,this.littleEndian);for(this.vox_offset=K.getInt64At(i,168,this.littleEndian),this.scl_slope=K.getDoubleAt(i,176,this.littleEndian),this.scl_inter=K.getDoubleAt(i,184,this.littleEndian),this.cal_max=K.getDoubleAt(i,192,this.littleEndian),this.cal_min=K.getDoubleAt(i,200,this.littleEndian),this.slice_duration=K.getDoubleAt(i,208,this.littleEndian),this.toffset=K.getDoubleAt(i,216,this.littleEndian),this.slice_start=K.getInt64At(i,224,this.littleEndian),this.slice_end=K.getInt64At(i,232,this.littleEndian),this.description=K.getStringAt(i,240,320),this.aux_file=K.getStringAt(i,320,344),this.qform_code=K.getIntAt(i,344,this.littleEndian),this.sform_code=K.getIntAt(i,348,this.littleEndian),this.quatern_b=K.getDoubleAt(i,352,this.littleEndian),this.quatern_c=K.getDoubleAt(i,360,this.littleEndian),this.quatern_d=K.getDoubleAt(i,368,this.littleEndian),this.qoffset_x=K.getDoubleAt(i,376,this.littleEndian),this.qoffset_y=K.getDoubleAt(i,384,this.littleEndian),this.qoffset_z=K.getDoubleAt(i,392,this.littleEndian),n=0;n<3;n+=1)for(o=0;o<4;o+=1)l=400+(n*4+o)*8,this.affine[n][o]=K.getDoubleAt(i,l,this.littleEndian);this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.slice_code=K.getIntAt(i,496,this.littleEndian),this.xyzt_units=K.getIntAt(i,500,this.littleEndian),this.intent_code=K.getIntAt(i,504,this.littleEndian),this.intent_name=K.getStringAt(i,508,524),this.dim_info=K.getByteAt(i,524),i.byteLength>ie.MAGIC_COOKIE&&(this.extensionFlag[0]=K.getByteAt(i,540),this.extensionFlag[1]=K.getByteAt(i,541),this.extensionFlag[2]=K.getByteAt(i,542),this.extensionFlag[3]=K.getByteAt(i,543),this.extensionFlag[0]&&(this.extensions=K.getExtensionsAt(i,this.getExtensionLocation(),this.littleEndian,this.vox_offset),this.extensionSize=this.extensions[0].esize,this.extensionCode=this.extensions[0].ecode))}toFormattedString(){var t=K.formatNumber,i="";return i+="Datatype = "+ +this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+`)
`,i+="Bits Per Voxel =  = "+this.numBitsPerVoxel+`
`,i+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+`
`,i+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+`
`,i+="Voxel Dimensions (1-8): "+t(this.pixDims[0])+", "+t(this.pixDims[1])+", "+t(this.pixDims[2])+", "+t(this.pixDims[3])+", "+t(this.pixDims[4])+", "+t(this.pixDims[5])+", "+t(this.pixDims[6])+", "+t(this.pixDims[7])+`
`,i+="Image Offset = "+this.vox_offset+`
`,i+="Data Scale:  Slope = "+t(this.scl_slope)+"  Intercept = "+t(this.scl_inter)+`
`,i+="Display Range:  Max = "+t(this.cal_max)+"  Min = "+t(this.cal_min)+`
`,i+="Slice Duration = "+this.slice_duration+`
`,i+="Time Axis Shift = "+this.toffset+`
`,i+="Slice Start = "+this.slice_start+`
`,i+="Slice End = "+this.slice_end+`
`,i+='Description: "'+this.description+`"
`,i+='Auxiliary File: "'+this.aux_file+`"
`,i+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+`)
`,i+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+`)
`,i+="Quaternion Parameters:  b = "+t(this.quatern_b)+"  c = "+t(this.quatern_c)+"  d = "+t(this.quatern_d)+`
`,i+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+`
`,i+="S-Form Parameters X: "+t(this.affine[0][0])+", "+t(this.affine[0][1])+", "+t(this.affine[0][2])+", "+t(this.affine[0][3])+`
`,i+="S-Form Parameters Y: "+t(this.affine[1][0])+", "+t(this.affine[1][1])+", "+t(this.affine[1][2])+", "+t(this.affine[1][3])+`
`,i+="S-Form Parameters Z: "+t(this.affine[2][0])+", "+t(this.affine[2][1])+", "+t(this.affine[2][2])+", "+t(this.affine[2][3])+`
`,i+="Slice Code = "+this.slice_code+`
`,i+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(et.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(et.TEMPORAL_UNITS_MASK&this.xyzt_units)+`)
`,i+="Intent Code = "+this.intent_code+`
`,i+='Intent Name: "'+this.intent_name+`"
`,i+="Dim Info = "+this.dim_info+`
`,i}toArrayBuffer(t=!1){let r=544;if(t)for(let a of this.extensions)r+=a.esize;let n=new Uint8Array(r),o=new DataView(n.buffer);o.setInt32(0,540,this.littleEndian),n.set(new TextEncoder().encode(this.magic),4),o.setInt16(12,this.datatypeCode,this.littleEndian),o.setInt16(14,this.numBitsPerVoxel,this.littleEndian);for(let a=0;a<8;a++)o.setBigInt64(16+8*a,BigInt(this.dims[a]),this.littleEndian);o.setFloat64(80,this.intent_p1,this.littleEndian),o.setFloat64(88,this.intent_p2,this.littleEndian),o.setFloat64(96,this.intent_p3,this.littleEndian);for(let a=0;a<8;a++)o.setFloat64(104+8*a,this.pixDims[a],this.littleEndian);o.setBigInt64(168,BigInt(this.vox_offset),this.littleEndian),o.setFloat64(176,this.scl_slope,this.littleEndian),o.setFloat64(184,this.scl_inter,this.littleEndian),o.setFloat64(192,this.cal_max,this.littleEndian),o.setFloat64(200,this.cal_min,this.littleEndian),o.setFloat64(208,this.slice_duration,this.littleEndian),o.setFloat64(216,this.toffset,this.littleEndian),o.setBigInt64(224,BigInt(this.slice_start),this.littleEndian),o.setBigInt64(232,BigInt(this.slice_end),this.littleEndian),n.set(new TextEncoder().encode(this.description),240),n.set(new TextEncoder().encode(this.aux_file),320),o.setInt32(344,this.qform_code,this.littleEndian),o.setInt32(348,this.sform_code,this.littleEndian),o.setFloat64(352,this.quatern_b,this.littleEndian),o.setFloat64(360,this.quatern_c,this.littleEndian),o.setFloat64(368,this.quatern_d,this.littleEndian),o.setFloat64(376,this.qoffset_x,this.littleEndian),o.setFloat64(384,this.qoffset_y,this.littleEndian),o.setFloat64(392,this.qoffset_z,this.littleEndian);const l=this.affine.flat();for(let a=0;a<12;a++)o.setFloat64(400+8*a,l[a],this.littleEndian);if(o.setInt32(496,this.slice_code,this.littleEndian),o.setInt32(500,this.xyzt_units,this.littleEndian),o.setInt32(504,this.intent_code,this.littleEndian),n.set(new TextEncoder().encode(this.intent_name),508),o.setUint8(524,this.dim_info),t){n.set(Uint8Array.from([1,0,0,0]),540);let a=this.getExtensionLocation();for(const c of this.extensions)o.setInt32(a,c.esize,c.littleEndian),o.setInt32(a+4,c.ecode,c.littleEndian),n.set(new Uint8Array(c.edata),a+8),a+=c.esize}else n.set(new Uint8Array(4).fill(0),540);return n.buffer}};k(ie,"MAGIC_COOKIE",540),k(ie,"MAGIC_NUMBER_LOCATION",4),k(ie,"MAGIC_NUMBER",[110,43,50,0,13,10,26,10]),k(ie,"MAGIC_NUMBER2",[110,105,50,0,13,10,26,10]);let Yt=ie;function Xn(e,t=!1){var i,s,r,n;return e.byteLength<et.STANDARD_HEADER_SIZE?!1:(i=new DataView(e),i&&(s=i.getUint8(et.MAGIC_NUMBER_LOCATION)),r=i.getUint8(et.MAGIC_NUMBER_LOCATION+1),n=i.getUint8(et.MAGIC_NUMBER_LOCATION+2),t&&s===et.MAGIC_NUMBER2[0]&&r===et.MAGIC_NUMBER2[1]&&n===et.MAGIC_NUMBER2[2]?!0:s===et.MAGIC_NUMBER[0]&&r===et.MAGIC_NUMBER[1]&&n===et.MAGIC_NUMBER[2])}function jn(e,t=!1){var i,s,r,n;return e.byteLength<et.STANDARD_HEADER_SIZE?!1:(i=new DataView(e),s=i.getUint8(Yt.MAGIC_NUMBER_LOCATION),r=i.getUint8(Yt.MAGIC_NUMBER_LOCATION+1),n=i.getUint8(Yt.MAGIC_NUMBER_LOCATION+2),t&&s===Yt.MAGIC_NUMBER2[0]&&r===Yt.MAGIC_NUMBER2[1]&&n===Yt.MAGIC_NUMBER2[2]?!0:s===Yt.MAGIC_NUMBER[0]&&r===Yt.MAGIC_NUMBER[1]&&n===Yt.MAGIC_NUMBER[2])}function Bi(e){var t,i,s;return!!(e&&(t=new DataView(e),i=t.getUint8(0),s=t.getUint8(1),i===K.GUNZIP_MAGIC_COOKIE1||s===K.GUNZIP_MAGIC_COOKIE2))}function Zn(e){return Qn(new Uint8Array(e)).buffer}async function Bs(e){const t=new Uint8Array(e),i=t[0]===31&&t[1]===139&&t[2]===8?"gzip":t[0]===120&&(t[1]===1||t[1]===94||t[1]===156||t[1]===218)?"deflate":"deflate-raw",s=new DecompressionStream(i),r=s.writable.getWriter();r.write(t).catch(console.error);const n=r.close().catch(console.error),l=await new Response(s.readable).arrayBuffer();return await n,l}async function Us(e,t=1/0){const i=u=>u[0]===31&&u[1]===139&&u[2]===8?"gzip":u[0]===120&&[1,94,156,218].includes(u[1])?"deflate":"deflate-raw",s=new Uint8Array(e),r=i(s),n=new DecompressionStream(r),o=new TransformStream({transform(u,m){m.enqueue(u)},flush(u){u.terminate()}}),{readable:l,writable:a}=n,c=a.getWriter(),h=l.pipeThrough(o).getReader();c.write(s).catch(u=>{u instanceof Error&&u.name==="AbortError"||console.error("Error during write:",u)});const d=[];let f=0;try{for(;f<t;){const{done:u,value:m}=await h.read();if(u)break;const g=t-f,A=m.subarray(0,Math.min(m.length,g));if(d.push(A),f+=A.length,f>=t){await Promise.all([h.cancel().catch(()=>{}),c.abort().catch(()=>{})]);break}}}catch(u){u instanceof Error&&u.name==="AbortError"||console.error("Error during decompression:",u)}finally{await Promise.allSettled([h.cancel().catch(()=>{}),c.close().catch(()=>{})])}return d.length===1?d[0].buffer:d.reduce((u,m)=>{const g=new Uint8Array(u.byteLength+m.byteLength);return g.set(new Uint8Array(u),0),g.set(m,u.byteLength),g.buffer},new ArrayBuffer(0))}function Jn(e,t=!1){let i=null;if(Bi(e)&&(e=Zn(e)),Xn(e,t)?i=new et:jn(e,t)&&(i=new Yt),i)i.readHeader(e);else throw new Error("That file does not appear to be NIFTI!");return i}async function Ye(e,t=!1){if(!Bi(e))return Jn(e,t);let i=null,s=await Us(e,540),r=!0,n=!0;var o=new DataView(s);const l=o.getInt32(0,!0),a=o.getInt32(0,!1);if(l!==348)if(a===348)r=!1;else if(l===540)n=!1;else if(a===540)n=!1,r=!1;else throw new Error("That file does not appear to be NIFTI!");let c=Math.round(o.getFloat32(108,r));return Yt&&(c=K.getUint64At(o,168,r)),c>s.byteLength&&(s=await Us(e,c)),n?i=new et:i=new Yt,i.readHeader(s),i}function Rs(e,t){var i=e.vox_offset,s=1,r=1;e.dims[4]&&(s=e.dims[4]),e.dims[5]&&(r=e.dims[5]);var n=e.dims[1]*e.dims[2]*e.dims[3]*s*r*(e.numBitsPerVoxel/8);return t.slice(i,i+n)}var Tr=Object.defineProperty,Fr=e=>{throw TypeError(e)},_n=(e,t,i)=>t in e?Tr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,$n=(e,t)=>{for(var i in t)Tr(e,i,{get:t[i],enumerable:!0})},F=(e,t,i)=>_n(e,typeof t!="symbol"?t+"":t,i),Vr=(e,t,i)=>t.has(e)||Fr("Cannot "+i),j=(e,t,i)=>(Vr(e,t,"read from private field"),i?i.call(e):t.get(e)),ze=(e,t,i)=>t.has(e)?Fr("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,i),Ee=(e,t,i,s)=>(Vr(e,t,"write to private field"),t.set(e,i),i),Ns="0.52.0",Br=class Jt{constructor({name:t="niivue",level:i="info"}={}){F(this,"level"),F(this,"name"),this.name=`${t}`,this.level=i}debug(...t){Jt.levels[this.level]>Jt.levels.debug||console.debug(`${this.name}-debug`,...t)}info(...t){Jt.levels[this.level]>Jt.levels.info||console.info(`${this.name}-info`,...t)}warn(...t){Jt.levels[this.level]>Jt.levels.warn||console.warn(`${this.name}-warn`,...t)}error(...t){Jt.levels[this.level]>Jt.levels.error||console.error(`${this.name}-error`,...t)}fatal(...t){Jt.levels[this.level]>Jt.levels.fatal||console.error(`${this.name}-fatal`,...t)}setLogLevel(t){this.level=t}setName(t){this.name=t}};F(Br,"levels",{debug:0,info:1,warn:2,error:3,fatal:4,silent:1/0});var to=Br,P=new to({name:"niivue",level:"info"}),eo=function(e,t,i){const s=e.createShader(e.VERTEX_SHADER);e.shaderSource(s,t),e.compileShader(s);const r=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(r,i),e.compileShader(r);const n=e.createProgram();if(e.attachShader(n,s),e.attachShader(n,r),e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(n)),e.getShaderParameter(s,e.COMPILE_STATUS)||console.log("Vertex shader compilation error:",e.getShaderInfoLog(s)),e.getShaderParameter(r,e.COMPILE_STATUS)||console.log("Fragment shader compilation error:",e.getShaderInfoLog(r)),P.error(e.getProgramInfoLog(n)),new Error("Shader failed to link, see console for log");return n},ot=class{constructor(e,t,i){F(this,"program"),F(this,"uniforms",{}),F(this,"isMatcap"),this.program=eo(e,t,i);const s=/uniform[^;]+[ ](\w+);/g,r=/uniform[^;]+[ ](\w+);/,n=t.match(s),o=i.match(s);n&&n.forEach(l=>{const a=l.match(r);this.uniforms[a[1]]=-1}),o&&o.forEach(l=>{const a=l.match(r);this.uniforms[a[1]]=-1});for(const l in this.uniforms)this.uniforms[l]=e.getUniformLocation(this.program,l)}use(e){e.useProgram(this.program)}},Ke=`#version 300 es
#line 4
layout(location=0) in vec3 pos;
layout(location=1) in vec3 texCoords;
uniform mat4 mvpMtx;
out vec3 vColor;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
	vColor = texCoords;
}`,Ur=`
	vec4 drawColor(float scalar, float drawOpacity) {
		float nlayer = float(textureSize(colormap, 0).y);
		float layer = (nlayer - 0.5) / nlayer;
		vec4 dcolor = texture(colormap, vec2((scalar * 255.0)/256.0 + 0.5/256.0, layer)).rgba;
		dcolor.a *= drawOpacity;
		return dcolor;
}`,ti=`vec3 GetBackPosition(vec3 startPositionTex) {
	vec3 startPosition = startPositionTex * volScale;
	vec3 invR = 1.0 / rayDir;
	vec3 tbot = invR * (vec3(0.0)-startPosition);
	vec3 ttop = invR * (volScale-startPosition);
	vec3 tmax = max(ttop, tbot);
	vec2 t = min(tmax.xx, tmax.yz);
	vec3 endPosition = startPosition + (rayDir * min(t.x, t.y));
	//convert world position back to texture position:
	endPosition = endPosition / volScale;
	return endPosition;
}

vec4 applyClip (vec3 dir, inout vec4 samplePos, inout float len, inout bool isClip) {
	float cdot = dot(dir,clipPlane.xyz);
	isClip = false;
	if  ((clipPlane.a > 1.0) || (cdot == 0.0)) return samplePos;
	bool frontface = (cdot > 0.0);
	float dis = (-clipPlane.a - dot(clipPlane.xyz, samplePos.xyz-0.5)) / cdot;
	float thick = clipThick;
	if (thick <= 0.0) thick = 2.0;
	float  disBackFace = (-(clipPlane.a-thick) - dot(clipPlane.xyz, samplePos.xyz-0.5)) / cdot;
	if (((frontface) && (dis >= len)) || ((!frontface) && (dis <= 0.0))) {
		samplePos.a = len + 1.0;
		return samplePos;
	}
	if (frontface) {
		dis = max(0.0, dis);
		samplePos = vec4(samplePos.xyz+dir * dis, dis);
		if (dis > 0.0) isClip = true;
		len = min(disBackFace, len);
	}
	if (!frontface) {
		len = min(dis, len);
		disBackFace = max(0.0, disBackFace);
		if (len == dis) isClip = true;
		samplePos = vec4(samplePos.xyz+dir * disBackFace, disBackFace);
	}
	return samplePos;
}

void clipVolume(inout vec3 startPos, inout vec3 backPos, int dim, float frac, bool isLo) {
	vec3 dir = backPos - startPos;
	float len = length(dir);
	dir = normalize(dir);
	// Discard if both startPos and backPos are outside the clipping plane
	if (isLo && startPos[dim] < frac && backPos[dim] < frac) {
		discard;
	}
	if (!isLo && startPos[dim] > frac && backPos[dim] > frac) {
		discard;
	}
	vec4 plane = vec4(0.0, 0.0, 0.0, 0.5 - frac);
	plane[dim] = 1.0;
	float cdot = dot(dir, plane.xyz);
	float dis = (-plane.w - dot(plane.xyz, startPos - vec3(0.5))) / cdot;
	// Adjust startPos or backPos based on the intersection with the plane
	bool isFrontFace = (cdot > 0.0);
	if (!isLo)
		isFrontFace = !isFrontFace;
	if (dis > 0.0) {
		if (isFrontFace) {
				if (dis <= len) {
					startPos = startPos + dir * dis;
				}
		} else {
			if (dis < len) {
				backPos = startPos + dir * dis;
			}
		}
	}
}

void clipVolumeStart (inout vec3 startPos, inout vec3 backPos) {
	// vec3 clipLo = vec3(0.1, 0.2, 0.4);
	// vec3 clipHi = vec3(0.8, 0.7, 0.7);
	for (int i = 0; i < 3; i++) {
		if (clipLo[i] > 0.0)
			clipVolume(startPos, backPos, i, clipLo[i], true);
	}
	for (int i = 0; i < 3; i++) {
		if (clipHi[i] < 1.0)
			clipVolume(startPos, backPos, i, clipHi[i], false);
	}
}

float frac2ndc(vec3 frac) {
//https://stackoverflow.com/questions/7777913/how-to-render-depth-linearly-in-modern-opengl-with-gl-fragcoord-z-in-fragment-sh
	vec4 pos = vec4(frac.xyz, 1.0); //fraction
	vec4 dim = vec4(vec3(textureSize(volume, 0)), 1.0);
	pos = pos * dim;
	vec4 shim = vec4(-0.5, -0.5, -0.5, 0.0);
	pos += shim;
	vec4 mm = transpose(matRAS) * pos;
	float z_ndc = (mvpMtx * vec4(mm.xyz, 1.0)).z;
	return (z_ndc + 1.0) / 2.0;
}`+Ur,us=`void main() {
	if (fColor.x > 2.0) {
		fColor = vec4(1.0, 0.0, 0.0, 0.5);
		return;
	}
	fColor = vec4(0.0,0.0,0.0,0.0);
	vec4 clipPlaneColorX = clipPlaneColor;
	//if (clipPlaneColor.a < 0.0)
	//	clipPlaneColorX.a = - 1.0;
	bool isColorPlaneInVolume = false;
	if (clipPlaneColorX.a < 0.0) {
		isColorPlaneInVolume = true;
		clipPlaneColorX.a = 0.0;
	}
	//fColor = vec4(vColor.rgb, 1.0); return;
	vec3 start = vColor;
	gl_FragDepth = 0.0;
	vec3 backPosition = GetBackPosition(start);
	// fColor = vec4(backPosition, 1.0); return;
	vec3 dir = normalize(backPosition - start);
	clipVolumeStart(start, backPosition);
	dir = normalize(dir);
	float len = length(backPosition - start);
	float lenVox = length((texVox * start) - (texVox * backPosition));
	if ((lenVox < 0.5) || (len > 3.0)) { //length limit for parallel rays
		return;
	}
	float sliceSize = len / lenVox; //e.g. if ray length is 1.0 and traverses 50 voxels, each voxel is 0.02 in unit cube
	float stepSize = sliceSize; //quality: larger step is faster traversal, but fewer samples
	float opacityCorrection = stepSize/sliceSize;
	vec4 deltaDir = vec4(dir.xyz * stepSize, stepSize);
	vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	float lenNoClip = len;
	bool isClip = false;
	vec4 clipPos = applyClip(dir, samplePos, len, isClip);
	//if ((clipPos.a != samplePos.a) && (len < 3.0)) {
	//start: OPTIONAL fast pass: rapid traversal until first hit
	float stepSizeFast = sliceSize * 1.9;
	vec4 deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	while (samplePos.a <= len) {
		float val = texture(volume, samplePos.xyz).a;
		if (val > 0.01)
			break;
		samplePos += deltaDirFast; //advance ray position
	}
	float drawOpacityA = renderDrawAmbientOcclusionXY.y;
	if ((samplePos.a >= len) && (((overlays < 1.0) && (drawOpacityA <= 0.0) ) || (backgroundMasksOverlays > 0)))  {
		if (isClip)
			fColor += clipPlaneColorX;
		return;
	}
	fColor = vec4(1.0, 1.0, 1.0, 1.0);
	//gl_FragDepth = frac2ndc(samplePos.xyz); //crude due to fast pass resolution
	samplePos -= deltaDirFast;
	if (samplePos.a < 0.0)
		vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	//end: fast pass
	vec4 colAcc = vec4(0.0,0.0,0.0,0.0);
	vec4 firstHit = vec4(0.0,0.0,0.0,2.0 * lenNoClip);
	const float earlyTermination = 0.95;
	float backNearest = len; //assume no hit
	float ran = fract(sin(gl_FragCoord.x * 12.9898 + gl_FragCoord.y * 78.233) * 43758.5453);
	samplePos += deltaDir * ran; //jitter ray
`,Ni=`
	if (firstHit.a < len)
		gl_FragDepth = frac2ndc(firstHit.xyz);
	colAcc.a = (colAcc.a / earlyTermination) * backOpacity;
	fColor = colAcc;
	//if (isClip) //CR
	if ((isColorPlaneInVolume) && (clipPos.a != samplePos.a) && (abs(firstHit.a - clipPos.a) < deltaDir.a))
		fColor.rgb = mix(fColor.rgb, clipPlaneColorX.rgb, abs(clipPlaneColor.a));
		//fColor.rgb = mix(fColor.rgb, clipPlaneColorX.rgb, clipPlaneColorX.a * 0.65);
	float renderDrawAmbientOcclusionX = renderDrawAmbientOcclusionXY.x;
	float drawOpacity = renderDrawAmbientOcclusionXY.y;
	if ((overlays < 1.0) && (drawOpacity <= 0.0))
		return;
	//overlay pass
	len = lenNoClip;
	samplePos = vec4(start.xyz, 0.0); //ray position
	//start: OPTIONAL fast pass: rapid traversal until first hit
	stepSizeFast = sliceSize * 1.0;
	deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	while (samplePos.a <= len) {
		float val = texture(overlay, samplePos.xyz).a;
		if (drawOpacity > 0.0)
			val = max(val, texture(drawing, samplePos.xyz).r);
		if (val > 0.001)
			break;
		samplePos += deltaDirFast; //advance ray position
	}
	if (samplePos.a >= len) {
		if (isClip && (fColor.a == 0.0))
				fColor += clipPlaneColorX;
			return;
	}
	samplePos -= deltaDirFast;
	if (samplePos.a < 0.0)
		vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	//end: fast pass
	float overFarthest = len;
	colAcc = vec4(0.0, 0.0, 0.0, 0.0);

	samplePos += deltaDir * ran; //jitter ray
	vec4 overFirstHit = vec4(0.0,0.0,0.0,2.0 * len);
	if (backgroundMasksOverlays > 0)
		samplePos = firstHit;
	bool firstDraw = true;
	while (samplePos.a <= len) {
		vec4 colorSample = texture(overlay, samplePos.xyz);
		if ((colorSample.a < 0.01) && (drawOpacity > 0.0)) {
			float val = texture(drawing, samplePos.xyz).r;
			vec4 draw = drawColor(val, drawOpacity);
			if ((draw.a > 0.0) && (firstDraw)) {
				firstDraw = false;
				float sum = 0.0;
				const float mn = 1.0 / 256.0;
				const float sampleRadius = 1.1;
				float dx = sliceSize * sampleRadius;
				vec3 center = samplePos.xyz;
				//six neighbors that share a face
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,0.0,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,0.0,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,+dx,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,-dx,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,0.0,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,0.0,0.0), dir)).r, mn);
				//float proportion = (sum / mn) / 6.0;
				
				//12 neighbors that share an edge
				dx = sliceSize * sampleRadius * sqrt(2.0) * 0.5;
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,+dx,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,0.0,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,+dx,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,-dx,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,0.0,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,-dx,0.0), dir)).r, mn);

				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,+dx,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,0.0,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,-dx,0.0), dir)).r, mn);
				
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,-dx,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,0.0,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,+dx,0.0), dir)).r, mn);
				float proportion = (sum / mn) / 18.0; //proportion of six neighbors is non-zero
				
				//a high proportion of hits means crevice
				//since the AO term adds shadows that darken most voxels, it will result in dark surfaces
				//the term brighten adds a little illumination to balance this
				// without brighten, only the most extreme ridges will not be darker
				const float brighten = 1.2;
				vec3 ao = draw.rgb * (1.0 - proportion) * brighten;
				draw.rgb = mix (draw.rgb, ao , renderDrawAmbientOcclusionX);
			}
			colorSample = draw;
		}
		samplePos += deltaDir; //advance ray position
		if (colorSample.a >= 0.01) {
			if (overFirstHit.a > len)
				overFirstHit = samplePos;
			colorSample.a *= renderOverlayBlend;
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			overFarthest = samplePos.a;
			if ( colAcc.a > earlyTermination )
				break;
		}
	}
	//if (samplePos.a >= len) {
	if (colAcc.a <= 0.0) {
		if (isClip && (fColor.a == 0.0))
			fColor += clipPlaneColorX;
		return;
	}
	if (overFirstHit.a < firstHit.a)
		gl_FragDepth = frac2ndc(overFirstHit.xyz);
	float overMix = colAcc.a;
	float overlayDepth = 0.3;
	if (fColor.a <= 0.0)
		overMix = 1.0;
	else if (((overFarthest) > backNearest)) {
		float dx = (overFarthest - backNearest)/1.73;
		dx = fColor.a * pow(dx, overlayDepth);
		overMix *= 1.0 - dx;
	}
	fColor.rgb = mix(fColor.rgb, colAcc.rgb, overMix);
	fColor.a = max(fColor.a, colAcc.a);
}`,io=`#version 300 es
#line 215
precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 texVox;
uniform int backgroundMasksOverlays;
uniform vec3 volScale;
uniform vec4 clipPlane;
uniform highp sampler3D volume, overlay;
uniform float overlays;
uniform float clipThick;
uniform vec3 clipLo;
uniform vec3 clipHi;
uniform float backOpacity;
uniform mat4 mvpMtx;
uniform mat4 matRAS;
uniform vec4 clipPlaneColor;
uniform float renderOverlayBlend;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
uniform vec2 renderDrawAmbientOcclusionXY;
in vec3 vColor;
out vec4 fColor;
`+ti+`
	void main() {
	vec3 start = vColor;
	gl_FragDepth = 0.0;
	vec3 backPosition = GetBackPosition(start);
	vec3 dir = normalize(backPosition - start);
	clipVolumeStart(start, backPosition);
	float len = length(backPosition - start);
	float lenVox = length((texVox * start) - (texVox * backPosition));
	if ((lenVox < 0.5) || (len > 3.0)) { //length limit for parallel rays
		fColor = vec4(0.0,0.0,0.0,0.0);
		return;
	}
	float sliceSize = len / lenVox; //e.g. if ray length is 1.0 and traverses 50 voxels, each voxel is 0.02 in unit cube
	float stepSize = sliceSize; //quality: larger step is faster traversal, but fewer samples
	float opacityCorrection = stepSize/sliceSize;
	vec4 deltaDir = vec4(dir.xyz * stepSize, stepSize);
	vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	vec4 colAcc = vec4(0.0,0.0,0.0,0.0);
	vec4 firstHit = vec4(0.0,0.0,0.0,2.0 * len);
	const float earlyTermination = 0.95;
	float backNearest = len; //assume no hit
	float dis = len;
	//check if axial plane is closest
	vec4 aClip = vec4(0.0, 0.0, 1.0, (1.0- clipPlane.z) - 0.5);
	float adis = (-aClip.a - dot(aClip.xyz, samplePos.xyz-0.5)) / dot(dir,aClip.xyz);
	if (adis > 0.0)
		dis = min(adis, dis);
	//check of coronal plane is closest
	vec4 cClip = vec4(0.0, 1.0, 0.0, (1.0- clipPlane.y) - 0.5);
	float cdis = (-cClip.a - dot(cClip.xyz, samplePos.xyz-0.5)) / dot(dir,cClip.xyz);
	if (cdis > 0.0)
		dis = min(cdis, dis);
	//check if coronal slice is closest
	vec4 sClip = vec4(1.0, 0.0, 0.0, (1.0- clipPlane.x) - 0.5);
	float sdis = (-sClip.a - dot(sClip.xyz, samplePos.xyz-0.5)) / dot(dir,sClip.xyz);
	if (sdis > 0.0)
		dis = min(sdis, dis);
	if ((dis > 0.0) && (dis < len)) {
		samplePos = vec4(samplePos.xyz+dir * dis, dis);
		colAcc = texture(volume, samplePos.xyz);
		colAcc.a = earlyTermination;
		firstHit = samplePos;
		backNearest = min(backNearest, samplePos.a);
	}
	//the following are only used by overlays
	vec4 clipPlaneColorX = clipPlaneColor;
	bool isColorPlaneInVolume = false;
	float lenNoClip = len;
	bool isClip = false;
	vec4 clipPos = applyClip(dir, samplePos, len, isClip);
	float stepSizeFast = sliceSize * 1.9;
	vec4 deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	if (samplePos.a < 0.0)
		vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	float ran = fract(sin(gl_FragCoord.x * 12.9898 + gl_FragCoord.y * 78.233) * 43758.5453);
	samplePos += deltaDir * ran; //jitter ray
`+Ni,so=`#version 300 es
#line 215
precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 texVox;
uniform int backgroundMasksOverlays;
uniform vec3 volScale;
uniform vec4 clipPlane;
uniform highp sampler3D volume, overlay;
uniform float overlays;
uniform float clipThick;
uniform vec3 clipLo;
uniform vec3 clipHi;
uniform float backOpacity;
uniform mat4 mvpMtx;
uniform mat4 matRAS;
uniform vec4 clipPlaneColor;
uniform float renderOverlayBlend;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
uniform vec2 renderDrawAmbientOcclusionXY;
in vec3 vColor;
out vec4 fColor;
`+ti+us+`while (samplePos.a <= len) {
		vec4 colorSample = texture(volume, samplePos.xyz);
		samplePos += deltaDir; //advance ray position
		if (colorSample.a >= 0.01) {
			if (firstHit.a > lenNoClip)
				firstHit = samplePos;
			backNearest = min(backNearest, samplePos.a);
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			if ( colAcc.a > earlyTermination )
				break;
		}
	}
`+Ni,Rr=`#version 300 es
#line 215
precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 texVox;
uniform int backgroundMasksOverlays;
uniform vec3 volScale;
uniform vec4 clipPlane;
uniform highp sampler3D volume, overlay;
uniform float overlays;
uniform float clipThick;
uniform vec3 clipLo;
uniform vec3 clipHi;
uniform float backOpacity;
uniform mat4 mvpMtx;
uniform mat4 normMtx;
uniform mat4 matRAS;
uniform vec4 clipPlaneColor;
uniform float renderOverlayBlend;
uniform highp sampler3D drawing, gradient;
uniform highp sampler2D colormap;
uniform highp sampler2D matCap;
uniform vec2 renderDrawAmbientOcclusionXY;
uniform float gradientAmount;
uniform float gradientOpacity[256];
in vec3 vColor;
out vec4 fColor;
`,ro=Rr+ti+us+`
	float startPos = samplePos.a;
	float clipClose = clipPos.a + 3.0 * deltaDir.a; //do not apply gradients near clip plane
	float brighten = 2.0; //modulating makes average intensity darker 0.5 * 0.5 = 0.25
	//vec4 prevGrad = vec4(0.0);
	while (samplePos.a <= len) {
		vec4 colorSample = texture(volume, samplePos.xyz);
		if (colorSample.a >= 0.0) {
			vec4 grad = texture(gradient, samplePos.xyz);
			grad.rgb = normalize(grad.rgb*2.0 - 1.0);
			//if (grad.a < prevGrad.a)
			//	grad.rgb = prevGrad.rgb;
			//prevGrad = grad;
			vec3 n = mat3(normMtx) * grad.rgb;
			n.y = - n.y;
			vec4 mc = vec4(texture(matCap, n.xy * 0.5 + 0.5).rgb, 1.0) * brighten;
			mc = mix(vec4(1.0), mc, gradientAmount);
			if (samplePos.a > clipClose)
				colorSample.rgb *= mc.rgb;
			if (firstHit.a > lenNoClip)
				firstHit = samplePos;
			backNearest = min(backNearest, samplePos.a);
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			int gradIdx = int(grad.a * 255.0);
			colorSample.a *= gradientOpacity[gradIdx];
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			if ( colAcc.a > earlyTermination )
				break;
		}
		samplePos += deltaDir; //advance ray position
	}
`+Ni,no=Rr+ti+us+`
	float startPos = samplePos.a;
	float clipClose = clipPos.a + 3.0 * deltaDir.a; //do not apply gradients near clip plane
	float brighten = 2.0; //modulating makes average intensity darker 0.5 * 0.5 = 0.25
	//vec4 prevGrad = vec4(0.0);
	while (samplePos.a <= len) {
		vec4 colorSample = texture(volume, samplePos.xyz);
		if (colorSample.a >= 0.0) {
			vec4 grad = texture(gradient, samplePos.xyz);
			colorSample.rgb = abs(normalize(grad.rgb*2.0 - 1.0));
			if (firstHit.a > lenNoClip)
				firstHit = samplePos;
			backNearest = min(backNearest, samplePos.a);
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			if ( colAcc.a > earlyTermination )
				break;
		}
		samplePos += deltaDir; //advance ray position
	}
`+Ni,Ps=`#version 300 es
#line 392
layout(location=0) in vec3 pos;
uniform int axCorSag;
uniform mat4 mvpMtx;
uniform mat4 frac2mm;
uniform float slice;
out vec3 texPos;
void main(void) {
	texPos = vec3(pos.x, pos.y, slice);
	if (axCorSag > 1)
		texPos = vec3(slice, pos.x, pos.y);
	else if (axCorSag > 0)
		texPos = vec3(pos.x, slice, pos.y);
	vec4 mm = frac2mm * vec4(texPos, 1.0);
	gl_Position = mvpMtx * mm;
}`,Nr=`#version 300 es
#line 411
precision highp int;
precision highp float;
uniform highp sampler3D volume, overlay;
uniform int backgroundMasksOverlays;
uniform float overlayOutlineWidth;
uniform float overlayAlphaShader;
uniform int axCorSag;
uniform float overlays;
uniform float opacity;
uniform float drawOpacity;
uniform bool isAlphaClipDark;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
in vec3 texPos;
out vec4 color;`+Ur+`void main() {
	//color = vec4(1.0, 0.0, 1.0, 1.0);return;
	vec4 background = texture(volume, texPos);
	color = vec4(background.rgb, opacity);
	if ((isAlphaClipDark) && (background.a == 0.0)) color.a = 0.0; //FSLeyes clipping range
	vec4 ocolor = vec4(0.0);
	float overlayAlpha = overlayAlphaShader;
	if (overlays > 0.0) {
		ocolor = texture(overlay, texPos);
		//dFdx for "boxing" issue 435 has aliasing on some implementations (coarse vs fine)
		//however, this only identifies 50% of the edges due to aliasing effects
		// http://www.aclockworkberry.com/shader-derivative-functions/
		// https://bgolus.medium.com/distinctive-derivative-differences-cce38d36797b
		//if ((ocolor.a >= 1.0) && ((dFdx(ocolor.a) != 0.0) || (dFdy(ocolor.a) != 0.0)  ))
		//	ocolor.rbg = vec3(0.0, 0.0, 0.0);
		bool isOutlineBelowNotAboveThreshold = true;
		if (isOutlineBelowNotAboveThreshold) {
			if ((overlayOutlineWidth > 0.0) && (ocolor.a < 1.0)) { //check voxel neighbors for edge
				vec3 vx = (overlayOutlineWidth ) / vec3(textureSize(overlay, 0));
				//6 voxel neighbors that share a face
				vec3 vxR = vec3(texPos.x+vx.x, texPos.y, texPos.z);
				vec3 vxL = vec3(texPos.x-vx.x, texPos.y, texPos.z);
				vec3 vxA = vec3(texPos.x, texPos.y+vx.y, texPos.z);
				vec3 vxP = vec3(texPos.x, texPos.y-vx.y, texPos.z);
				vec3 vxS = vec3(texPos.x, texPos.y, texPos.z+vx.z);
				vec3 vxI = vec3(texPos.x, texPos.y, texPos.z-vx.z);
				float a = 0.0;
				if (axCorSag != 2) {
					a = max(a, texture(overlay, vxR).a);
					a = max(a, texture(overlay, vxL).a);
				}
				if (axCorSag != 1) {
					a = max(a, texture(overlay, vxA).a);
					a = max(a, texture(overlay, vxP).a);
				}
				if (axCorSag != 0) {
					a = max(a, texture(overlay, vxS).a);
					a = max(a, texture(overlay, vxI).a);
				}
				bool isCheckCorners = true;
				if (isCheckCorners) {
					//12 voxel neighbors that share an edge
					vec3 vxRA = vec3(texPos.x+vx.x, texPos.y+vx.y, texPos.z);
					vec3 vxLA = vec3(texPos.x-vx.x, texPos.y+vx.y, texPos.z);
					vec3 vxRP = vec3(texPos.x+vx.x, texPos.y-vx.y, texPos.z);
					vec3 vxLP = vec3(texPos.x-vx.x, texPos.y-vx.y, texPos.z);
					vec3 vxRS = vec3(texPos.x+vx.x, texPos.y, texPos.z+vx.z);
					vec3 vxLS = vec3(texPos.x-vx.x, texPos.y, texPos.z+vx.z);
					vec3 vxRI = vec3(texPos.x+vx.x, texPos.y, texPos.z-vx.z);
					vec3 vxLI = vec3(texPos.x-vx.x, texPos.y, texPos.z-vx.z);
					vec3 vxAS = vec3(texPos.x, texPos.y+vx.y, texPos.z+vx.z);
					vec3 vxPS = vec3(texPos.x, texPos.y-vx.y, texPos.z+vx.z);
					vec3 vxAI = vec3(texPos.x, texPos.y+vx.y, texPos.z-vx.z);
					vec3 vxPI = vec3(texPos.x, texPos.y-vx.y, texPos.z-vx.z);

					if (axCorSag == 0) { //axial corners
						a = max(a, texture(overlay, vxRA).a);
						a = max(a, texture(overlay, vxLA).a);
						a = max(a, texture(overlay, vxRP).a);
						a = max(a, texture(overlay, vxLP).a);
					}
					if (axCorSag == 1) { //coronal corners
						a = max(a, texture(overlay, vxRS).a);
						a = max(a, texture(overlay, vxLS).a);
						a = max(a, texture(overlay, vxRI).a);
						a = max(a, texture(overlay, vxLI).a);
					}
					if (axCorSag == 2) { //sagittal corners
						a = max(a, texture(overlay, vxAS).a);
						a = max(a, texture(overlay, vxPS).a);
						a = max(a, texture(overlay, vxAI).a);
						a = max(a, texture(overlay, vxPI).a);
					}
				}
				if (a >= 1.0) {
					ocolor = vec4(0.0, 0.0, 0.0, 1.0);
					overlayAlpha = 1.0;
				}
			}

		} else {
			if ((overlayOutlineWidth > 0.0) && (ocolor.a >= 1.0)) { //check voxel neighbors for edge
				vec3 vx = (overlayOutlineWidth ) / vec3(textureSize(overlay, 0));
				vec3 vxR = vec3(texPos.x+vx.x, texPos.y, texPos.z);
				vec3 vxL = vec3(texPos.x-vx.x, texPos.y, texPos.z);
				vec3 vxA = vec3(texPos.x, texPos.y+vx.y, texPos.z);
				vec3 vxP = vec3(texPos.x, texPos.y-vx.y, texPos.z);
				vec3 vxS = vec3(texPos.x, texPos.y, texPos.z+vx.z);
				vec3 vxI = vec3(texPos.x, texPos.y, texPos.z-vx.z);
				float a = 1.0;
				if (axCorSag != 2) {
					a = min(a, texture(overlay, vxR).a);
					a = min(a, texture(overlay, vxL).a);
				}
				if (axCorSag != 1) {
					a = min(a, texture(overlay, vxA).a);
					a = min(a, texture(overlay, vxP).a);
				}
				if (axCorSag != 0) {
					a = min(a, texture(overlay, vxS).a);
					a = min(a, texture(overlay, vxI).a);
				}
				if (a < 1.0) {
					ocolor = vec4(0.0, 0.0, 0.0, 1.0);
					overlayAlpha = 1.0;
				}
			}
		} //outline above threshold
	}

`,Pr=`	ocolor.a *= overlayAlpha;
	vec4 dcolor = drawColor(texture(drawing, texPos).r, drawOpacity);
	if (dcolor.a > 0.0) {
		color.rgb = mix(color.rgb, dcolor.rgb, dcolor.a);
		color.a = max(drawOpacity, color.a);
	}
	if ((backgroundMasksOverlays > 0) && (background.a == 0.0))
		return;
	float a = color.a + ocolor.a * (1.0 - color.a); // premultiplied alpha
	if (a == 0.0) return;
	color.rgb = mix(color.rgb, ocolor.rgb, ocolor.a / a);
	color.a = a;
}`,oo=Nr+Pr,ao=Nr+`	if (ocolor.a > 0.0) {
		//https://gamedev.stackexchange.com/questions/102889/is-it-possible-to-convert-vec4-to-int-in-glsl-using-opengl-es
		uint alpha = uint(ocolor.a * 255.0);
		vec3 xyzFlip = vec3(float((uint(1) & alpha) > uint(0)), float((uint(2) & alpha) > uint(0)), float((uint(4) & alpha) > uint(0)));
		//convert from 0 and 1 to -1 and 1
		xyzFlip = (xyzFlip * 2.0) - 1.0;
		//https://math.stackexchange.com/questions/1905533/find-perpendicular-distance-from-point-to-line-in-3d
		//v1 principle direction of tensor for this voxel
		vec3 v1 = ocolor.rgb;
		//flips encode polarity to convert from 0..1 to -1..1 (27 bits vs 24 bit precision)
		v1 = normalize( v1 * xyzFlip);
		vec3 vxl = fract(texPos * vec3(textureSize(volume, 0))) - 0.5;
		//vxl coordinates now -0.5..+0.5 so 0,0,0 is origin
		vxl.x = -vxl.x;
		float t = dot(vxl,v1);
		vec3 P = t * v1;
		float dx = length(P-vxl);
		ocolor.a = 1.0 - smoothstep(0.2,0.25, dx);
		//if modulation was applied, use that to scale alpha not color:
		ocolor.a *= length(ocolor.rgb);
		ocolor.rgb = normalize(ocolor.rgb);
		//compute distance one half voxel closer to viewer:
		float pan = 0.5;
		if (axCorSag == 0)
			vxl.z -= pan;
		if (axCorSag == 1)
			vxl.y -= pan;
		if (axCorSag == 2)
			vxl.x += pan;
		t = dot(vxl,v1);
		P = t * v1;
		float dx2 = length(P-vxl);
		ocolor.rgb += (dx2-dx-(0.5 * pan)) * 1.0;
	}
`+Pr,Ki=`#version 300 es
#line 480
precision highp int;
precision highp float;
uniform vec4 lineColor;
out vec4 color;
void main() {
	color = lineColor;
}`,lo=`#version 300 es
#line 723
precision highp int;
precision highp float;

uniform vec4 lineColor;
uniform vec4 leftTopWidthHeight;
uniform float thickness; // line thickness in pixels
uniform vec2 canvasWidthHeight;

out vec4 color;

void main() {
    // fragment position in screen coordinates
    vec2 fragCoord = gl_FragCoord.xy;

    // canvas height
    float canvasHeight = canvasWidthHeight.y;

    // 'top' and 'bottom' to match gl_FragCoord.y coordinate system
    float top = canvasHeight - leftTopWidthHeight.y;
    float bottom = top - leftTopWidthHeight.w;

    // left and right edges
    float left = leftTopWidthHeight.x;
    float right = left + leftTopWidthHeight.z;

    bool withinLeft = fragCoord.x >= left && fragCoord.x <= left + thickness;
    bool withinRight = fragCoord.x <= right && fragCoord.x >= right - thickness;
    bool withinTop = fragCoord.y <= top && fragCoord.y >= top - thickness;
    bool withinBottom = fragCoord.y >= bottom && fragCoord.y <= bottom + thickness;

    bool isOutline = withinLeft || withinRight || withinTop || withinBottom;

    if (isOutline) {
        color = lineColor;
    } else {
        discard; 
    }
}`,co=`#version 300 es
#line 490
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
out vec2 vColor;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vColor = pos.xy;
}`,ho=`#version 300 es
#line 506
precision highp int;
precision highp float;
uniform highp sampler2D colormap;
uniform float layer;
in vec2 vColor;
out vec4 color;
void main() {
	float nlayer = float(textureSize(colormap, 0).y);
	float fmap = (0.5 + layer) / nlayer;
	color = vec4(texture(colormap, vec2(vColor.x, fmap)).rgb, 1.0);
}`,Ls=`#version 300 es
#line 520
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
}`,fo=`#version 300 es
#line 534
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform float thickness;
uniform vec4 startXYendXY;
void main(void) {
	vec2 posXY = mix(startXYendXY.xy, startXYendXY.zw, pos.x);
	vec2 dir = normalize(startXYendXY.xy - startXYendXY.zw);
	posXY += vec2(-dir.y, dir.x) * thickness * (pos.y - 0.5);
	posXY.x = (posXY.x) / canvasWidthHeight.x; //0..1
	posXY.y = 1.0 - (posXY.y / canvasWidthHeight.y); //1..0
	gl_Position = vec4((posXY * 2.0) - 1.0, 0.0, 1.0);
}`,uo=`#version 300 es
#line 534
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform float thickness;
uniform vec2 startXY;
uniform vec3 endXYZ; // transformed XYZ point
void main(void) {	
	vec2 posXY = mix(startXY.xy, endXYZ.xy, pos.x);
	vec2 startDiff = endXYZ.xy - startXY.xy;
	float startDistance = length(startDiff);
	vec2 diff = endXYZ.xy - posXY;
	float currentDistance = length(diff);
	vec2 dir = normalize(startXY.xy - endXYZ.xy);
	posXY += vec2(-dir.y, dir.x) * thickness * (pos.y - 0.5);
	posXY.x = (posXY.x) / canvasWidthHeight.x; //0..1
	posXY.y = 1.0 - (posXY.y / canvasWidthHeight.y); //1..0	
	float z = endXYZ.z * ( 1.0 - abs(currentDistance/startDistance)); 
	gl_Position = vec4((posXY * 2.0) - 1.0, z, 1.0);
}`,mo=`#version 300 es
#line 549
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
out vec2 vUV;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vUV = vec2(pos.x, 1.0 - pos.y);
}`,go=`#version 300 es
#line 565
precision highp int;
precision highp float;
uniform highp sampler2D bmpTexture;
in vec2 vUV;
out vec4 color;
void main() {
	color = texture(bmpTexture, vUV);
}`,Ao=`#version 300 es
#line 576
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
uniform vec4 uvLeftTopWidthHeight;
out vec2 vUV;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vUV = vec2(uvLeftTopWidthHeight.x + (pos.x * uvLeftTopWidthHeight.z), uvLeftTopWidthHeight.y  + ((1.0 - pos.y) * uvLeftTopWidthHeight.w) );
}`,po=`#version 300 es
#line 593
precision highp int;
precision highp float;
uniform highp sampler2D fontTexture;
uniform vec4 fontColor;
uniform float screenPxRange;
in vec2 vUV;
out vec4 color;
float median(float r, float g, float b) {
	return max(min(r, g), min(max(r, g), b));
}
void main() {
	vec3 msd = texture(fontTexture, vUV).rgb;
	float sd = median(msd.r, msd.g, msd.b);
	float screenPxDistance = screenPxRange*(sd - 0.5);
	float opacity = clamp(screenPxDistance + 0.5, 0.0, 1.0);
	color = vec4(fontColor.rgb , fontColor.a * opacity);
}`,xo=`#version 300 es
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
uniform vec4 uvLeftTopWidthHeight;
out vec2 vUV;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vUV = pos.xy;
}`,vo=`#version 300 es
precision highp int;
precision highp float;
uniform vec4 circleColor;
uniform float fillPercent;
in vec2 vUV;
out vec4 color;
void main() {
	/* Check if the pixel is inside the circle
		 and color it with a gradient. Otherwise, color it 
		 transparent   */
	float distance = length(vUV-vec2(0.5,0.5));
	if ( distance < 0.5 && distance >= (1.0 - fillPercent) / 2.0){
			color = vec4(circleColor.r,circleColor.g,circleColor.b,circleColor.a) ;			
	}else{
			color = vec4(0.0,0.0,0.0,0.0);
	}
}
`,Me=`#version 300 es
#line 613
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
	TexCoord = vPos.xy;
	gl_Position = vec4( (vPos.xy-vec2(0.5,0.5)) * 2.0, 0.0, 1.0);
}`,qi=`#version 300 es
uniform highp usampler3D intensityVol;
`,Os=`#version 300 es
uniform highp isampler3D intensityVol;
`,wo=`#version 300 es
uniform highp sampler3D intensityVol;
`,ks=`#line 636
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float layer;
uniform highp sampler2D colormap;
uniform lowp sampler3D blend3D;
uniform float opacity;
uniform vec4 xyzaFrac;
uniform mat4 mtx;
void main(void) {
	vec4 vx = vec4(TexCoord.x, TexCoord.y, coordZ, 1.0) * mtx;
	uint idx = uint(texture(intensityVol, vx.xyz).r);
	FragColor = vec4(0.0, 0.0, 0.0, 0.0);
	if (idx == uint(0))
		return;
	//idx = ((idx - uint(1)) % uint(100))+uint(1);
	float textureWidth = float(textureSize(colormap, 0).x);
	float fx = (float(idx)+0.5) / textureWidth;
	float nlayer = float(textureSize(colormap, 0).y);
	float y = ((2.0 * layer) + 1.5)/nlayer;
	FragColor = texture(colormap, vec2(fx, y)).rgba;
	float alpha = FragColor.a;
	FragColor.a *= opacity;
	if (xyzaFrac.a > 0.0) { //outline
		vx = vec4(TexCoord.x+xyzaFrac.x, TexCoord.y, coordZ, 1.0) * mtx;
		uint R = uint(texture(intensityVol, vx.xyz).r);
		vx = vec4(TexCoord.x-xyzaFrac.x, TexCoord.y, coordZ, 1.0) * mtx;
		uint L = uint(texture(intensityVol, vx.xyz).r);
		vx = vec4(TexCoord.x, TexCoord.y+xyzaFrac.y, coordZ, 1.0) * mtx;
		uint A = uint(texture(intensityVol, vx.xyz).r);
		vx = vec4(TexCoord.x, TexCoord.y-xyzaFrac.y, coordZ, 1.0) * mtx;
		uint P = uint(texture(intensityVol, vx.xyz).r);
		vx = vec4(TexCoord.x, TexCoord.y, coordZ+xyzaFrac.z, 1.0) * mtx;
		uint S = uint(texture(intensityVol, vx.xyz).r);
		vx = vec4(TexCoord.x, TexCoord.y, coordZ-xyzaFrac.z, 1.0) * mtx;
		uint I = uint(texture(intensityVol, vx.xyz).r);
		if ((idx != R) || (idx != L) || (idx != A) || (idx != P) || (idx != S) || (idx != I))
			FragColor.a = alpha * xyzaFrac.a;
	}
}`,Qi=`#line 691
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float layer;
uniform float scl_slope;
uniform float scl_inter;
uniform float cal_max;
uniform float cal_min;
uniform float cal_maxNeg;
uniform float cal_minNeg;
uniform bool isAlphaThreshold;
uniform bool isColorbarFromZero;
uniform bool isAdditiveBlend;
uniform highp sampler2D colormap;
uniform lowp sampler3D blend3D;
uniform int modulation;
uniform highp sampler3D modulationVol;
uniform float opacity;
uniform mat4 mtx;
void main(void) {
	vec4 vx = vec4(TexCoord.xy, coordZ, 1.0) * mtx;
	if ((vx.x < 0.0) || (vx.x > 1.0) || (vx.y < 0.0) || (vx.y > 1.0) || (vx.z < 0.0) || (vx.z > 1.0)) {
		//set transparent if out of range
		//https://webglfundamentals.org/webgl/webgl-3d-textures-repeat-clamp.html
		FragColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
		return;
	}
	float f = (scl_slope * float(texture(intensityVol, vx.xyz).r)) + scl_inter;
	float mn = cal_min;
	float mx = cal_max;
	if ((isAlphaThreshold) || (isColorbarFromZero))
		mn = 0.0;
	float r = max(0.00001, abs(mx - mn));
	mn = min(mn, mx);
	float txl = mix(0.0, 1.0, (f - mn) / r);
	if (f > mn) { //issue1139: survives threshold, so round up to opaque voxel
		txl = max(txl, 2.0/256.0);
	}
	//https://stackoverflow.com/questions/5879403/opengl-texture-coordinates-in-pixel-space
	float nlayer = float(textureSize(colormap, 0).y);
	//each volume has two color maps:
	// (layer*2) = negative and (layer * 2) + 1 = postive
	float y = ((2.0 * layer) + 1.5)/nlayer;
	FragColor = texture(colormap, vec2(txl, y)).rgba;
	//negative colors
	mn = cal_minNeg;
	mx = cal_maxNeg;
	if ((isAlphaThreshold) || (isColorbarFromZero))
		mx = 0.0;
	//if ((!isnan(cal_minNeg)) && ( f < mx)) {
	if ((cal_minNeg < cal_maxNeg) && ( f < mx)) {
		r = max(0.00001, abs(mx - mn));
		mn = min(mn, mx);
		txl = 1.0 - mix(0.0, 1.0, (f - mn) / r);
		//issue1139: survives threshold, so round up to opaque voxel
		txl = max(txl, 2.0/256.0);
		y = ((2.0 * layer) + 0.5)/nlayer;
		FragColor = texture(colormap, vec2(txl, y));
	}
	if (layer > 0.7)
		FragColor.a = step(0.00001, FragColor.a);
	//if (modulation > 10)
	//	FragColor.a *= texture(modulationVol, vx.xyz).r;
	//	FragColor.rgb *= texture(modulationVol, vx.xyz).r;
	if (isAlphaThreshold) {
		if ((cal_minNeg != cal_maxNeg) && ( f < 0.0) && (f > cal_maxNeg))
			FragColor.a = pow(-f / -cal_maxNeg, 2.0);
		else if ((f > 0.0) && (cal_min > 0.0))
			FragColor.a *= pow(f / cal_min, 2.0); //issue435:  A = (V/X)**2
		//FragColor.g = 0.0;
	} else if (isColorbarFromZero) {
		if ((cal_minNeg != cal_maxNeg) && ( f < 0.0) && (f > cal_maxNeg))
			FragColor.a = 0.0;
		else if ((f > 0.0) && (cal_min > 0.0) && (f < cal_min))
			FragColor.a *= 0.0;

	}
	if (modulation == 1) {
		FragColor.rgb *= texture(modulationVol, vx.xyz).r;
	} else if (modulation == 2) {
		FragColor.a = texture(modulationVol, vx.xyz).r;
	}
	FragColor.a *= opacity;
	if (layer < 1.0) return;
	vec4 prevColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
	// https://en.wikipedia.org/wiki/Alpha_compositing
	float aout = FragColor.a + (1.0 - FragColor.a) * prevColor.a;
	if (aout <= 0.0) return;
	if (isAdditiveBlend)
		FragColor.rgb = ((FragColor.rgb * FragColor.a) + (prevColor.rgb * prevColor.a)) / aout;
	else
		FragColor.rgb = ((FragColor.rgb * FragColor.a) + (prevColor.rgb * prevColor.a * (1.0 - FragColor.a))) / aout;
	FragColor.a = aout;
}`,yo=`#line 773
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float layer;
uniform float scl_slope;
uniform float scl_inter;
uniform float cal_max;
uniform float cal_min;
uniform highp sampler2D colormap;
uniform lowp sampler3D blend3D;
uniform float opacity;
uniform mat4 mtx;
uniform bool hasAlpha;
uniform int modulation;
uniform highp sampler3D modulationVol;
void main(void) {
	vec4 vx = vec4(TexCoord.xy, coordZ, 1.0) * mtx;
	uvec4 aColor = texture(intensityVol, vx.xyz);
	FragColor = vec4(float(aColor.r) / 255.0, float(aColor.g) / 255.0, float(aColor.b) / 255.0, float(aColor.a) / 255.0);
	if (modulation == 1)
		FragColor.rgb *= texture(modulationVol, vx.xyz).r;
	if (!hasAlpha) {
		FragColor.a = (FragColor.r * 0.21 + FragColor.g * 0.72 + FragColor.b * 0.07);
		//next line: we could binarize alpha, but see rendering of visible human
		//FragColor.a = step(0.01, FragColor.a);
	}
	if (modulation == 2)
		FragColor.a = texture(modulationVol, vx.xyz).r;
	FragColor.a *= opacity;
}`,bo=`#version 300 es
#line 808
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
	TexCoord = vPos.xy;
	gl_Position = vec4((vPos.x - 0.5) * 2.0, (vPos.y - 0.5) * 2.0, 0.0, 1.0);
}`,Co=`#version 300 es
#line 829
	precision highp float;
	precision highp int;
	precision highp isampler3D;
	layout(location = 0) out int label;
	layout(location = 1) out int strength;
	in vec2 TexCoord;
	uniform int finalPass;
	uniform float coordZ;
	uniform lowp sampler3D in3D;
	uniform highp isampler3D backTex; // background
	uniform highp isampler3D labelTex; // label
	uniform highp isampler3D strengthTex; // strength
void main(void) {
	vec3 interpolatedTextureCoordinate = vec3(TexCoord.xy, coordZ);
	ivec3 size = textureSize(backTex, 0);
	ivec3 texelIndex = ivec3(floor(interpolatedTextureCoordinate * vec3(size)));
	int background = texelFetch(backTex, texelIndex, 0).r;
	label = texelFetch(labelTex, texelIndex, 0).r;
	strength = texelFetch(strengthTex, texelIndex, 0).r;
	for (int k = -1; k <= 1; k++) {
		for (int j = -1; j <= 1; j++) {
			for (int i = -1; i <= 1; i++) {
				if (i != 0 && j != 0 && k != 0) {
					ivec3 neighborIndex = texelIndex + ivec3(i,j,k);
					int neighborBackground = texelFetch(backTex, neighborIndex, 0).r;
					int neighborStrength = texelFetch(strengthTex, neighborIndex, 0).r;
					int strengthCost = abs(neighborBackground - background);
					int takeoverStrength = neighborStrength - strengthCost;
					if (takeoverStrength > strength) {
						strength = takeoverStrength;
						label = texelFetch(labelTex, neighborIndex, 0).r;
					}
				}
			}
		}
	}
	if (finalPass < 1)
		return;
	int ok = 1;
	ivec4 labelCount = ivec4(0,0,0,0);
	for (int k = -1; k <= 1; k++)
		for (int j = -1; j <= 1; j++)
			for (int i = -1; i <= 1; i++) {
				ivec3 neighborIndex = texelIndex + ivec3(i,j,k);
				int ilabel = texelFetch(labelTex, neighborIndex, 0).r;
				if ((ilabel < 0) || (ilabel > 3))
					ok = 0;
				else
					labelCount[ilabel]++;
			}
	if (ok != 1) {
		return;
	}
	int maxIdx = 0;
	for (int i = 1; i < 4; i++) {
		if (labelCount[i] > labelCount[maxIdx])
			maxIdx = i;
	}
	label = maxIdx;
}`,Do=`#version 300 es
layout(location=0) in vec3 pos;
uniform mat4 mvpMtx;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
}`,Io=`#version 300 es
precision highp int;
precision highp float;
uniform vec4 surfaceColor;
out vec4 color;
void main() {
	color = surfaceColor;
}`,Eo=`#version 300 es
layout(location=0) in vec3 pos;
layout(location=1) in vec4 clr;
out vec4 vClr;
uniform mat4 mvpMtx;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
	vClr = clr;
}`,Mo=`#version 300 es
precision highp int;
precision highp float;
in vec4 vClr;
out vec4 color;
uniform float opacity;
void main() {
	color = vec4(vClr.rgb, opacity);
}`,Hi=`#version 300 es
layout(location=0) in vec3 pos;
layout(location=1) in vec4 norm;
layout(location=2) in vec4 clr;
uniform mat4 mvpMtx;
//uniform mat4 modelMtx;
uniform mat4 normMtx;
out vec4 vClr;
out vec3 vN;
out vec4 vP;
out vec4 vPc;
void main(void) {
	vec3 lightPosition = vec3(0.0, 0.0, -10.0);
	vP = vec4(pos, 1.0);
	vPc = mvpMtx * vec4(pos, 1.0);
	gl_Position = vPc;
	vN = normalize((normMtx * vec4(norm.xyz,1.0)).xyz);
	//vV = -vec3(modelMtx*vec4(pos,1.0));
	vClr = clr;
}`,So=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
out vec4 color;
vec4 packFloatToVec4i(const float value) {
	const vec4 bitSh = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);
	const vec4 bitMsk = vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);
	vec4 res = fract(value * bitSh);
	res -= res.xxyz * bitMsk;
	return res;
}
void main() {
	color = packFloatToVec4i(gl_FragCoord.z);
}`,To=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
float stepmix(float edge0, float edge1, float E, float x){
	float T = clamp(0.5 * (x - edge0 + E) / E, 0.0, 1.0);
	return mix(edge0, edge1, T);
}
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0);
	float ambient = 0.3;
	float diffuse = 0.6;
	float specular = 0.5;
	float shininess = 50.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float df = max(0.0, dot(n, l));
	float sf = pow(max(dot(reflect(l, n), r), 0.0), shininess);
	const float A = 0.1;
	const float B = 0.3;
	const float C = 0.6;
	const float D = 1.0;
	float E = fwidth(df);
	if (df > A - E && df < A + E) df = stepmix(A, B, E, df);
	else if (df > B - E && df < B + E) df = stepmix(B, C, E, df);
	else if (df > C - E && df < C + E) df = stepmix(C, D, E, df);
	else if (df < A) df = 0.0;
	else if (df < B) df = B;
	else if (df < C) df = C;
	else df = D;
	E = fwidth(sf);
	if (sf > 0.5 - E && sf < 0.5 + E)
		sf = smoothstep(0.5 - E, 0.5 + E, sf);
	else
		sf = step(0.5, sf);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(df, 0.0) * vClr.rgb * diffuse;
	color.rgb = a + d + (specular * sf);
	color.a = opacity;
}`,Fo=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.3;
	float diffuse = 0.6;
	float specular = 0.25;
	float shininess = 10.0;
	float PenWidth = 0.6;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	float view = abs(dot(n,r)); //with respect to viewer
	if (PenWidth < view) discard;
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color.rgb = a + d + s;
	color.a = opacity;
}`,Vo=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float diffuse = 1.0;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 0.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = max(dot(n, l), 0.0);
	vec3 d = lightNormDot * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(d + s, opacity);
}`,Bo=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	float diffuse = 1.4;
	vec3 l = vec3(0.0, 0.0, -1.0);
	float lightNormDot = max(dot(normalize(vN), l), 0.0);
	color = vec4(lightNormDot * vClr.rgb * diffuse, opacity);
}`,Uo=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	float specularRGB = 0.7;
	float specularWhite = 0.3;
	float shininess = 10.0;
	float diffuse = 1.0;
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	vec3 n = normalize(vN);
	vec3 l = vec3(0.0, 0.0, -1.0);
	float lightNormDot = max(dot(n, l), 0.0);
	vec3 d3 = lightNormDot * vClr.rgb * diffuse;
	float s = pow(max(dot(reflect(l, n), r), 0.0), shininess);
	vec3 s3 = specularRGB * s * vClr.rgb;
	s *= specularWhite;
	color = vec4(d3 + s3 + s, opacity);
}`,Ro=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
in vec4 vPc;
out vec4 color;
void main() {
	vec3 n = normalize(vN);
	// Compute curvature
	vec3 dx = dFdx(n);
	vec3 dy = dFdy(n);
	vec3 xneg = n - dx;
	vec3 xpos = n + dx;
	vec3 yneg = n - dy;
	vec3 ypos = n + dy;
	float depth = length(vPc.xyz);
	float curv = (cross(xneg, xpos).y - cross(yneg, ypos).x) / depth;
	//at this stage 0.5 for flat, with valleys dark and ridges bright
	curv = 1.0 - (curv + 0.5);
	//clamp
	curv =  min(max(curv, 0.0), 1.0);
	// easing function
	curv = pow(curv, 0.5);
	//modulate ambient and diffuse with curvature
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.6;
	float diffuse = 0.6;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 lightPosition = vec3(0.0, 10.0, -2.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient * curv;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,No=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.35;
	float diffuse = 0.5;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,Po=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
uniform sampler2D matCap;
out vec4 color;
void main() {
	vec3 n = normalize(vN);
	vec2 uv = n.xy * 0.5 + 0.5;
	uv.y = 1.0 - uv.y;
	vec3 clr = texture(matCap,uv.xy).rgb * vClr.rgb;
	color = vec4(clr, opacity);
}`,Lo=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	float ambient = 0.35;
	float diffuse = 0.6;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	color = vec4(a + d, opacity);
}`,Oo=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.35;
	float diffuse = 0.5;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 up = vec3(0.0, 1.0, 0.0);
	float ax = dot(n, up) * 0.5 + 0.5;  //Shreiner et al. (2013) OpenGL Programming Guide, 8th Ed., p 388. ISBN-10: 0321773039
	vec3 upClr = vec3(1.0, 1.0, 0.95);
	vec3 downClr = vec3(0.4, 0.4, 0.6);
	vec3 a = vClr.rgb * ambient;
	a *= mix(downClr, upClr, ax);
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,ko=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
//Spherical harmonics constants
const float C1 = 0.429043;
const float C2 = 0.511664;
const float C3 = 0.743125;
const float C4 = 0.886227;
const float C5 = 0.247708;
//Spherical harmonics coefficients
// Ramamoorthi, R., and P. Hanrahan. 2001b. "An Efficient Representation for Irradiance Environment Maps." In Proceedings of SIGGRAPH 2001, pp. 497500.
// https://github.com/eskimoblood/processingSketches/blob/master/data/shader/shinyvert.glsl
// https://github.com/eskimoblood/processingSketches/blob/master/data/shader/shinyvert.glsl
// Constants for Eucalyptus Grove lighting
const vec3 L00  = vec3( 0.3783264,  0.4260425,  0.4504587);
const vec3 L1m1 = vec3( 0.2887813,  0.3586803,  0.4147053);
const vec3 L10  = vec3( 0.0379030,  0.0295216,  0.0098567);
const vec3 L11  = vec3(-0.1033028, -0.1031690, -0.0884924);
const vec3 L2m2 = vec3(-0.0621750, -0.0554432, -0.0396779);
const vec3 L2m1 = vec3( 0.0077820, -0.0148312, -0.0471301);
const vec3 L20  = vec3(-0.0935561, -0.1254260, -0.1525629);
const vec3 L21  = vec3(-0.0572703, -0.0502192, -0.0363410);
const vec3 L22  = vec3( 0.0203348, -0.0044201, -0.0452180);
vec3 SH(vec3 vNormal) {
	vNormal = vec3(vNormal.x,vNormal.z,vNormal.y);
	vec3 diffuseColor = C1 * L22 * (vNormal.x * vNormal.x - vNormal.y * vNormal.y) +
	C3 * L20 * vNormal.z * vNormal.z +
	C4 * L00 -
	C5 * L20 +
	2.0 * C1 * L2m2 * vNormal.x * vNormal.y +
	2.0 * C1 * L21  * vNormal.x * vNormal.z +
	2.0 * C1 * L2m1 * vNormal.y * vNormal.z +
	2.0 * C2 * L11  * vNormal.x +
	2.0 * C2 * L1m1 * vNormal.y +
	2.0 * C2 * L10  * vNormal.z;
	return diffuseColor;
}
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.3;
	float diffuse = 0.6;
	float specular = 0.1;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	vec3 a = vClr.rgb * ambient;
	vec3 d = vClr.rgb * diffuse * SH(-reflect(n, vec3(l.x, l.y, -l.z)) );
	color = vec4(a + d + s, opacity);
}`,Go=`#version 300 es
layout(location=0) in vec3 pos;
layout(location=1) in vec4 norm;
layout(location=2) in vec4 clr;
uniform mat4 mvpMtx;
//uniform mat4 modelMtx;
uniform mat4 normMtx;
out vec4 vClr;
flat out vec3 vN;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
	vN = normalize((normMtx * vec4(norm.xyz,1.0)).xyz);
	//vV = -vec3(modelMtx*vec4(pos,1.0));
	vClr = clr;
}`,Gs=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
flat in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.35;
	float diffuse = 0.5;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,Yo=`#version 300 es
#line 1260
//precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 volScale;
uniform vec3 texVox;
uniform vec4 clipPlane;
uniform highp sampler3D volume, overlay;
uniform float overlays;
uniform float clipThick;
uniform vec3 clipLo;
uniform vec3 clipHi;
uniform mat4 matRAS;
uniform mat4 mvpMtx;
uniform float drawOpacity, renderOverlayBlend;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
uniform int backgroundMasksOverlays;
in vec3 vColor;
out vec4 fColor;
`+ti+`
void main() {
	int id = 254;
	vec3 start = vColor;
	gl_FragDepth = 0.0;
	fColor = vec4(0.0, 0.0, 0.0, 0.0); //assume no hit: ID = 0
	float fid = float(id & 255)/ 255.0;
	vec3 backPosition = GetBackPosition(start);
	vec3 dir = normalize(backPosition - start);
	clipVolumeStart(start, backPosition);
	float len = length(backPosition - start);
	float lenVox = length((texVox * start) - (texVox * backPosition));
	if ((lenVox < 0.5) || (len > 3.0)) return;//discard; //length limit for parallel rays
	float sliceSize = len / lenVox; //e.g. if ray length is 1.0 and traverses 50 voxels, each voxel is 0.02 in unit cube
	float stepSize = sliceSize; //quality: larger step is faster traversal, but fewer samples
	float opacityCorrection = stepSize/sliceSize;
	dir = normalize(dir);
	vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	float lenNoClip = len;
	bool isClip = false;
	vec4 clipPos = applyClip(dir, samplePos, len, isClip);
	if (isClip) fColor = vec4(samplePos.xyz, 253.0 / 255.0); //assume no hit: ID = 0
	//start: OPTIONAL fast pass: rapid traversal until first hit
	float stepSizeFast = sliceSize * 1.9;
	vec4 deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	while (samplePos.a <= len) {
		float val = texture(volume, samplePos.xyz).a;
		if (val > 0.01) {
			fColor = vec4(samplePos.rgb, fid);
			gl_FragDepth = frac2ndc(samplePos.xyz);
			break;
		}
		samplePos += deltaDirFast; //advance ray position
	}
	//end: fast pass
	if ((overlays < 1.0) || (backgroundMasksOverlays > 0)) {
		return; //background hit, no overlays
	}
	//overlay pass
	len = min(lenNoClip, samplePos.a); //only find overlay closer than background
	samplePos = vec4(start.xyz, 0.0); //ray position
	while (samplePos.a <= len) {
		float val = texture(overlay, samplePos.xyz).a;
		if (val > 0.01) {
			fColor = vec4(samplePos.rgb, fid);
			gl_FragDepth = frac2ndc(samplePos.xyz);
			return;
		}
		samplePos += deltaDirFast; //advance ray position
	}
	//if (fColor.a == 0.0) discard; //no hit in either background or overlays
	//you only get here if there is a hit with the background that is closer than any overlay
}`,zo=`#version 300 es
// an attribute is an input (in) to a vertex shader.
// It will receive data from a buffer
layout(location=0)  in vec3 a_position;
layout(location=1)  in vec3 a_color;
// A matrix to transform the positions by
uniform mat4 u_matrix;
out vec3 vColor;
// all shaders have a main function
void main() {
	// Multiply the position by the matrix.
	vec4 pos = vec4(a_position, 1.0);
	gl_Position = u_matrix * vec4(pos);
	vColor = a_color;
}
`,Ko=`#version 300 es
precision highp float;
uniform vec4 u_color;
in vec3 vColor;
out vec4 outColor;
void main() {
	outColor = vec4(vColor, 1.0);
}`,qo=`#version 300 es
#line 1359
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
	TexCoord = vPos.xy;
	vec2 viewCoord = (vPos.xy - 0.5) * 2.0;
	gl_Position = vec4((vPos.xy - 0.5) * 2.0, 0.0, 1.0);
}`,Qo=`#version 300 es
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform lowp sampler3D in3D;
void main(void) {
 FragColor = texture(in3D, vec3(TexCoord.xy, coordZ));
}`,li=`#version 300 es
#line 286
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
    TexCoord = vPos.xy;
    gl_Position = vec4( (vPos.xy-vec2(0.5,0.5))* 2.0, 0.0, 1.0);
}`,Ho=`#version 300 es
#line 298
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform highp sampler3D intensityVol;
void main(void) {
 vec3 vx = vec3(TexCoord.xy, coordZ);
 vec4 samp = texture(intensityVol,vx+vec3(+dX,+dY,+dZ));
 samp += texture(intensityVol,vx+vec3(+dX,+dY,-dZ));
 samp += texture(intensityVol,vx+vec3(+dX,-dY,+dZ));
 samp += texture(intensityVol,vx+vec3(+dX,-dY,-dZ));
 samp += texture(intensityVol,vx+vec3(-dX,+dY,+dZ));
 samp += texture(intensityVol,vx+vec3(-dX,+dY,-dZ));
 samp += texture(intensityVol,vx+vec3(-dX,-dY,+dZ));
 samp += texture(intensityVol,vx+vec3(-dX,-dY,-dZ));
 FragColor = samp*0.125;
}`,Wo=`#version 300 es
#line 298
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform highp sampler3D intensityVol;
void main(void) {
 vec3 vx = vec3(TexCoord.xy, coordZ);
 vec4 XYZ = texture(intensityVol,vx+vec3(+dX,+dY,+dZ));
 vec4 OYZ = texture(intensityVol,vx+vec3(0.0,+dY,+dZ));
 vec4 xYZ = texture(intensityVol,vx+vec3(-dX,+dY,+dZ));
 vec4 XOZ = texture(intensityVol,vx+vec3(+dX,0.0,+dZ));
 vec4 OOZ = texture(intensityVol,vx+vec3(0.0,0.0,+dZ));
 vec4 xOZ = texture(intensityVol,vx+vec3(-dX,0.0,+dZ));
 vec4 XyZ = texture(intensityVol,vx+vec3(+dX,-dY,+dZ));
 vec4 OyZ = texture(intensityVol,vx+vec3(0.0,-dY,+dZ));
 vec4 xyZ = texture(intensityVol,vx+vec3(-dX,-dY,+dZ));

 vec4 XYO = texture(intensityVol,vx+vec3(+dX,+dY,0.0));
 vec4 OYO = texture(intensityVol,vx+vec3(0.0,+dY,0.0));
 vec4 xYO = texture(intensityVol,vx+vec3(-dX,+dY,0.0));
 vec4 XOO = texture(intensityVol,vx+vec3(+dX,0.0,0.0));
 vec4 OOO = texture(intensityVol,vx+vec3(0.0,0.0,0.0));
 vec4 xOO = texture(intensityVol,vx+vec3(-dX,0.0,0.0));
 vec4 XyO = texture(intensityVol,vx+vec3(+dX,-dY,0.0));
 vec4 OyO = texture(intensityVol,vx+vec3(0.0,-dY,0.0));
 vec4 xyO = texture(intensityVol,vx+vec3(-dX,-dY,0.0));

 vec4 XYz = texture(intensityVol,vx+vec3(+dX,+dY,-dZ));
 vec4 OYz = texture(intensityVol,vx+vec3(0.0,+dY,-dZ));
 vec4 xYz = texture(intensityVol,vx+vec3(-dX,+dY,-dZ));
 vec4 XOz = texture(intensityVol,vx+vec3(+dX,0.0,-dZ));
 vec4 OOz = texture(intensityVol,vx+vec3(0.0,0.0,-dZ));
 vec4 xOz = texture(intensityVol,vx+vec3(-dX,0.0,-dZ));
 vec4 Xyz = texture(intensityVol,vx+vec3(+dX,-dY,-dZ));
 vec4 Oyz = texture(intensityVol,vx+vec3(0.0,-dY,-dZ));
 vec4 xyz = texture(intensityVol,vx+vec3(-dX,-dY,-dZ));

 vec4 blurred = vec4 (0.0, 0.0, 0.0, 0.0);
 blurred.r = 2.0*(xOz.r +xOZ.r +xyO.r +xYO.r +xOO.r +XOz.r +XOZ.r +XyO.r +XYO.r +XOO.r) +xyz.r +xyZ.r +xYz.r +xYZ.r +Xyz.r +XyZ.r +XYz.r +XYZ.r;
 blurred.g = 2.0*(Oyz.r +OyZ.r +xyO.r +XyO.r +OyO.r +OYz.r +OYZ.r +xYO.r +XYO.r +OYO.r) +xyz.r +Xyz.r +xyZ.r +XyZ.r +xYz.r +XYz.r +xYZ.r +XYZ.r;
 blurred.b = 2.0*(Oyz.r +OYz.r +xOz.r +XOz.r +OOz.r +OyZ.r +OYZ.r +xOZ.r +XOZ.r +OOZ.r) +xyz.r +Xyz.r +xYz.r +XYz.r +xyZ.r +XyZ.r +XyZ.r +XYZ.r;
 blurred.a = 0.32*(abs(blurred.r)+abs(blurred.g)+abs(blurred.b));
 // 0.0357 = 1/28 to account for weights, rescale to 2**16,
 FragColor = 0.0357*blurred;
}`,Lr=`
  gradientSample.a = log2(gradientSample.r*gradientSample.r + gradientSample.g*gradientSample.g + gradientSample.b*gradientSample.b + 1.922337562475971e-06) + 18.988706873717717;
`,Xo=`#version 300 es
#line 323
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform highp sampler3D intensityVol;
void main(void) {
  vec3 vx = vec3(TexCoord.xy, coordZ);
  //Neighboring voxels 'T'op/'B'ottom, 'A'nterior/'P'osterior, 'R'ight/'L'eft
  float TAR = texture(intensityVol,vx+vec3(+dX,+dY,+dZ)).r;
  float TAL = texture(intensityVol,vx+vec3(+dX,+dY,-dZ)).r;
  float TPR = texture(intensityVol,vx+vec3(+dX,-dY,+dZ)).r;
  float TPL = texture(intensityVol,vx+vec3(+dX,-dY,-dZ)).r;
  float BAR = texture(intensityVol,vx+vec3(-dX,+dY,+dZ)).r;
  float BAL = texture(intensityVol,vx+vec3(-dX,+dY,-dZ)).r;
  float BPR = texture(intensityVol,vx+vec3(-dX,-dY,+dZ)).r;
  float BPL = texture(intensityVol,vx+vec3(-dX,-dY,-dZ)).r;
  vec4 gradientSample = vec4 (0.0, 0.0, 0.0, 0.0);
  gradientSample.r = BAR+BAL+BPR+BPL -TAR-TAL-TPR-TPL;
  gradientSample.g = TPR+TPL+BPR+BPL -TAR-TAL-BAR-BAL;
  gradientSample.b = TAL+TPL+BAL+BPL -TAR-TPR-BAR-BPR;
${Lr}
	// 0.04242020977371934 = 1/(log2(3*8) - log2(1/(255**2*8))) // 3*8 -> max for 1st order gradient
	gradientSample.a *= 0.04242020977371934;
  gradientSample.rgb = normalize(gradientSample.rgb);
  gradientSample.rgb = (gradientSample.rgb * 0.5)+0.5;
  FragColor = gradientSample;
}`,jo=`#version 300 es
#line 323
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform float dX2;
uniform float dY2;
uniform float dZ2;
uniform highp sampler3D intensityVol;
void main(void) {
  vec3 vx = vec3(TexCoord.xy, coordZ);
  //Neighboring voxels 'T'op/'B'ottom, 'A'nterior/'P'osterior, 'R'ight/'L'eft
  vec4 TAR = texture(intensityVol,vx+vec3(+dX,+dY,+dZ));
  vec4 TAL = texture(intensityVol,vx+vec3(+dX,+dY,-dZ));
  vec4 TPR = texture(intensityVol,vx+vec3(+dX,-dY,+dZ));
  vec4 TPL = texture(intensityVol,vx+vec3(+dX,-dY,-dZ));
  vec4 BAR = texture(intensityVol,vx+vec3(-dX,+dY,+dZ));
  vec4 BAL = texture(intensityVol,vx+vec3(-dX,+dY,-dZ));
  vec4 BPR = texture(intensityVol,vx+vec3(-dX,-dY,+dZ));
  vec4 BPL = texture(intensityVol,vx+vec3(-dX,-dY,-dZ));
  vec4 T = texture(intensityVol,vx+vec3(+dX2,0.0,0.0));
  vec4 A = texture(intensityVol,vx+vec3(0.0,+dY2,0.0));
  vec4 R = texture(intensityVol,vx+vec3(0.0,0.0,+dZ2));
  vec4 B = texture(intensityVol,vx+vec3(-dX2,0.0,0.0));
  vec4 P = texture(intensityVol,vx+vec3(0.0,-dY2,0.0));
  vec4 L = texture(intensityVol,vx+vec3(0.0,0.0,-dZ2));
  vec4 gradientSample = vec4 (0.0, 0.0, 0.0, 0.0);
  gradientSample.r = -4.0*B.r +8.0*(BAR.r+BAL.r+BPR.r+BPL.r) -8.0*(TAR.r+TAL.r+TPR.r+TPL.r) +4.0*T.r;
  gradientSample.g = -4.0*P.g +8.0*(TPR.g+TPL.g+BPR.g+BPL.g) -8.0*(TAR.g+TAL.g+BAR.g+BAL.g) +4.0*A.g;
  gradientSample.b = -4.0*L.b +8.0*(TAL.b+TPL.b+BAL.b+BPL.b) -8.0*(TAR.b+TPR.b+BAR.b+BPR.b) +4.0*R.b;
${Lr}
	gradientSample.a *= 0.0325;
  gradientSample.rgb = normalize(gradientSample.rgb);
  gradientSample.rgb =  (gradientSample.rgb * 0.5)+0.5;
  FragColor = gradientSample;
}`,Zo=new Float32Array([-1,-1,-1,.28,.28,.28,-1,-1,-1,.28,.28,.28,-1,1,-1,.28,.28,.28,1,-1,-1,.28,.28,.28,1,1,-1,.28,.28,.28,1,1,-1,.28,.28,.28,-1,-1,1,.8,.8,.8,-1,-1,1,.8,.8,.8,1,-1,1,.8,.8,.8,-1,1,1,.8,.8,.8,1,1,1,.8,.8,.8,1,1,1,.8,.8,.8,-1,1,-1,0,0,.74,-1,1,-1,0,0,.74,-1,1,1,0,0,.74,1,1,-1,0,0,.74,1,1,1,0,0,.74,1,1,1,0,0,.74,-1,-1,-1,.42,0,.42,-1,-1,-1,.42,0,.42,1,-1,-1,.42,0,.42,-1,-1,1,.42,0,.42,1,-1,1,.42,0,.42,1,-1,1,.42,0,.42,-1,-1,-1,.64,0,0,-1,-1,-1,.64,0,0,-1,-1,1,.64,0,0,-1,1,-1,.64,0,0,-1,1,1,.64,0,0,-1,1,1,.64,0,0,1,-1,-1,0,.5,0,1,-1,-1,0,.5,0,1,1,-1,0,.5,0,1,-1,1,0,.5,0,1,1,1,0,.5,0,1,1,1,0,.5,0,-.45,1,-.8,0,0,0,-.45,1,-.8,0,0,0,-.45,1,.8,0,0,0,-.25,1,-.8,0,0,0,-.25,1,.8,0,0,0,-.25,1,.8,0,0,0,-.25,1,.6,0,0,0,-.25,1,.6,0,0,0,-.25,1,.8,0,0,0,.45,1,.6,0,0,0,.25,1,.8,0,0,0,.25,1,.8,0,0,0,.25,1,.1,0,0,0,.25,1,.1,0,0,0,.25,1,.6,0,0,0,.45,1,.1,0,0,0,.45,1,.6,0,0,0,.45,1,.6,0,0,0,-.25,1,-.1,0,0,0,-.25,1,-.1,0,0,0,-.25,1,.1,0,0,0,.25,1,-.1,0,0,0,.45,1,.1,0,0,0,.45,1,.1,0,0,0,.45,-1,-.8,0,0,0,.45,-1,-.8,0,0,0,.05,-1,.8,0,0,0,.25,-1,-.8,0,0,0,-.15,-1,.8,0,0,0,-.15,-1,.8,0,0,0,-.25,-1,-.8,0,0,0,-.25,-1,-.8,0,0,0,.05,-1,.8,0,0,0,-.45,-1,-.8,0,0,0,-.15,-1,.8,0,0,0,-.15,-1,.8,0,0,0,.13,-1,-.3,0,0,0,.13,-1,-.3,0,0,0,.07,-1,-.1,0,0,0,-.33,-1,-.3,0,0,0,-.27,-1,-.1,0,0,0,-.27,-1,-.1,0,0,0,-.45,.6,1,0,0,0,-.45,.6,1,0,0,0,-.45,.4,1,0,0,0,-.25,.8,1,0,0,0,-.25,.4,1,0,0,0,-.25,.4,1,0,0,0,-.25,.8,1,0,0,0,-.25,.8,1,0,0,0,-.25,.6,1,0,0,0,.25,.8,1,0,0,0,.45,.6,1,0,0,0,.45,.6,1,0,0,0,.25,.8,1,0,0,0,.25,.8,1,0,0,0,.25,-.1,1,0,0,0,.45,.6,1,0,0,0,.45,.1,1,0,0,0,.45,.1,1,0,0,0,-.25,.1,1,0,0,0,-.25,.1,1,0,0,0,-.45,-.1,1,0,0,0,.25,.1,1,0,0,0,.25,-.1,1,0,0,0,.25,-.1,1,0,0,0,-.45,-.1,1,0,0,0,-.45,-.1,1,0,0,0,-.45,-.6,1,0,0,0,-.25,-.1,1,0,0,0,-.25,-.8,1,0,0,0,-.25,-.8,1,0,0,0,-.25,-.6,1,0,0,0,-.25,-.6,1,0,0,0,-.25,-.8,1,0,0,0,.45,-.6,1,0,0,0,.25,-.8,1,0,0,0,.25,-.8,1,0,0,0,.25,-.4,1,0,0,0,.25,-.4,1,0,0,0,.25,-.6,1,0,0,0,.45,-.4,1,0,0,0,.45,-.6,1,0,0,0,.45,-.6,1,0,0,0,-.1,-.8,-1,0,0,0,-.1,-.8,-1,0,0,0,-.1,.8,-1,0,0,0,.1,-.8,-1,0,0,0,.1,.8,-1,0,0,0,.1,.8,-1,0,0,0,-1,-.45,-.8,0,0,0,-1,-.45,-.8,0,0,0,-1,-.45,.8,0,0,0,-1,-.25,-.8,0,0,0,-1,-.25,.8,0,0,0,-1,-.25,.8,0,0,0,-1,-.25,-.8,0,0,0,-1,-.25,-.8,0,0,0,-1,-.25,-.6,0,0,0,-1,.45,-.8,0,0,0,-1,.45,-.6,0,0,0,-1,.45,-.6,0,0,0,1,.45,-.8,0,0,0,1,.45,-.8,0,0,0,1,.45,.8,0,0,0,1,.25,-.8,0,0,0,1,.25,.8,0,0,0,1,.25,.8,0,0,0,1,.25,.6,0,0,0,1,.25,.6,0,0,0,1,.25,.8,0,0,0,1,-.45,.6,0,0,0,1,-.25,.8,0,0,0,1,-.25,.8,0,0,0,1,-.25,.1,0,0,0,1,-.25,.1,0,0,0,1,-.25,.6,0,0,0,1,-.45,.1,0,0,0,1,-.45,.6,0,0,0,1,-.45,.6,0,0,0,1,.25,-.1,0,0,0,1,.25,-.1,0,0,0,1,.25,.1,0,0,0,1,-.25,-.1,0,0,0,1,-.45,.1,0,0,0,1,-.45,.1,0,0,0,1,-.25,-.8,0,0,0,1,-.25,-.8,0,0,0,1,-.05,-.1,0,0,0,1,-.45,-.8,0,0,0,1,-.25,-.1,0,0,0,1,-.25,-.1,0,0,0]),at=class{constructor(t,i,s,r,n=null,o=null){F(this,"sphereIdx",[]),F(this,"sphereVtx",[]),F(this,"renderShaders",[]),F(this,"isVisible",!0),F(this,"isPickable",!0),F(this,"vertexBuffer"),F(this,"indexCount"),F(this,"indexBuffer"),F(this,"vao"),F(this,"mode"),F(this,"glFlags",0),F(this,"id"),F(this,"colorId"),F(this,"modelMatrix",nt()),F(this,"scale",[1,1,1]),F(this,"position",[0,0,0]),F(this,"rotation",[0,0,0]),F(this,"rotationRadians",0),F(this,"extentsMin",[]),F(this,"extentsMax",[]),F(this,"furthestVertexFromOrigin"),F(this,"originNegate"),F(this,"fieldOfViewDeObliqueMM"),F(this,"mm"),this.vertexBuffer=i,this.indexCount=r,this.indexBuffer=n,this.vao=o,this.mode=s,this.id=t,this.colorId=[(t>>0&255)/255,(t>>8&255)/255,(t>>16&255)/255,(t>>24&255)/255]}};F(at,"BLEND",1);F(at,"CULL_FACE",2);F(at,"CULL_FRONT",4);F(at,"CULL_BACK",8);F(at,"ENABLE_DEPTH_TEST",16);F(at,"generateCrosshairs",function(e,t,i,s,r,n,o=20,l=0){const a=at.generateCrosshairsGeometry(e,i,s,r,n,o,l);return new at(t,a.vertexBuffer,e.TRIANGLES,a.indexCount,a.indexBuffer,a.vao)});F(at,"generateCrosshairsGeometry",function(e,t,i,s,r,n=20,o=0){const l=[],a=[],c=r*o;if(c<=0){let u=Q(i[0],t[1],t[2]),m=Q(s[0],t[1],t[2]);at.makeCylinder(l,a,u,m,r,n),u=Q(t[0],i[1],t[2]),m=Q(t[0],s[1],t[2]),at.makeCylinder(l,a,u,m,r,n),u=Q(t[0],t[1],i[2]),m=Q(t[0],t[1],s[2]),at.makeCylinder(l,a,u,m,r,n)}else{let u=Q(i[0],t[1],t[2]),m=Q(t[0]-c,t[1],t[2]);at.makeCylinder(l,a,u,m,r,n,!1),u=Q(t[0]+c,t[1],t[2]),m=Q(s[0],t[1],t[2]),at.makeCylinder(l,a,u,m,r,n,!1),u=Q(t[0],i[1],t[2]),m=Q(t[0],t[1]-c,t[2]),at.makeCylinder(l,a,u,m,r,n,!1),u=Q(t[0],t[1]+c,t[2]),m=Q(t[0],s[1],t[2]),at.makeCylinder(l,a,u,m,r,n,!1),u=Q(t[0],t[1],i[2]),m=Q(t[0],t[1],t[2]-c),at.makeCylinder(l,a,u,m,r,n,!1),u=Q(t[0],t[1],t[2]+c),m=Q(t[0],t[1],s[2]),at.makeCylinder(l,a,u,m,r,n,!1)}const h=e.createBuffer();if(h===null)throw new Error("could not instantiate vertex buffer");e.bindBuffer(e.ARRAY_BUFFER,h),e.bufferData(e.ARRAY_BUFFER,new Float32Array(l),e.STATIC_DRAW);const d=e.createBuffer();if(d===null)throw new Error("could not instantiate index buffer");e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,d),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint32Array(a),e.STATIC_DRAW);const f=e.createVertexArray();return e.bindVertexArray(f),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,d),e.bindBuffer(e.ARRAY_BUFFER,h),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,3,e.FLOAT,!1,0,0),e.bindVertexArray(null),{vertexBuffer:h,indexBuffer:d,indexCount:a.length,vao:f}});F(at,"getFirstPerpVector",function(e){const t=Q(0,0,0);return e[0]===0?t[0]=1:e[1]===0?t[1]=1:e[2]===0?t[2]=1:(t[0]=e[2],t[1]=e[2],t[2]=-(e[0]+e[1]),Xt(t,t)),t});F(at,"subdivide",function(e,t){let i=e.length/3,s=t.length/3;const r=s,n=pt(),o=pt();for(let l=0;l<r;l++){const a=t[l*3+0],c=t[l*3+1],h=t[l*3+2],d=Q(e[a*3+0],e[a*3+1],e[a*3+2]),f=Q(e[c*3+0],e[c*3+1],e[c*3+2]),u=Q(e[h*3+0],e[h*3+1],e[h*3+2]);xe(n,d,f),Xt(o,n),e.push(...o),xe(n,f,u),Xt(o,n),e.push(...o),xe(n,d,u),Xt(o,n),e.push(...o);let m=[i,i+1,i+2];t.push(...m),m=[a,i,i+2],t.push(...m),m=[i,c,i+1],t.push(...m),t[l*3+0]=i+2,t[l*3+1]=i+1,t[l*3+2]=h,s=s+3,i=i+3}});F(at,"weldVertices",function(e,t){const i=e.length/3;let s=0;const r=new Int32Array(i);for(let l=0;l<i-1;l++){if(r[l]!==0)continue;r[l]=s;let a=l*3;const c=e[a],h=e[a+1],d=e[a+2];for(let f=l+1;f<i;f++)a+=3,c===e[a]&&h===e[a+1]&&d===e[a+2]&&(r[f]=s);s++}if(s===i)return e;const n=t.length;for(let l=0;l<n;l++)t[l]=r[t[l]];const o=e.slice(0,s*3-1);for(let l=0;l<i-1;l++){const a=l*3,c=r[l]*3;o[c]=e[a],o[c+1]=e[a+1],o[c+2]=e[a+2]}return o});F(at,"makeSphere",function(e,t,i,s=[0,0,0]){let r=[0,0,1,.894,0,.447,.276,.851,.447,-.724,.526,.447,-.724,-.526,.447,.276,-.851,.447,.724,.526,-.447,-.276,.851,-.447,-.894,0,-.447,-.276,-.851,-.447,.724,-.526,-.447,0,0,-1];const n=[0,1,2,0,2,3,0,3,4,0,4,5,0,5,1,7,6,11,8,7,11,9,8,11,10,9,11,6,10,11,6,2,1,7,3,2,8,4,3,9,5,4,10,1,5,6,7,2,7,8,3,8,9,4,9,10,5,10,6,1];at.subdivide(r,n),at.subdivide(r,n),r=at.weldVertices(r,n);for(let c=0;c<r.length;c++)r[c]=r[c]*i;const o=r.length/3;let l=0;for(let c=0;c<o;c++)r[l]=r[l]+s[0],l++,r[l]=r[l]+s[1],l++,r[l]=r[l]+s[2],l++;const a=Math.floor(e.length/3);for(let c=0;c<n.length;c++)n[c]=n[c]+a;t.push(...n),e.push(...r)});F(at,"makeCylinder",function(e,t,i,s,r,n=20,o=!0){n<3&&(n=3);const l=pt();bt(l,s,i),Xt(l,l);const a=at.getFirstPerpVector(l),c=pt();Ci(c,l,a),Xt(c,c);let h=2*n,d=2*n;o&&(d+=2*n,h+=2);const f=Math.floor(e.length/3),u=new Uint32Array(d*3),m=new Float32Array(h*3);function g(b,M){m[b*3+0]=M[0],m[b*3+1]=M[1],m[b*3+2]=M[2]}function A(b,M,D,v){u[b*3+0]=M+f,u[b*3+1]=D+f,u[b*3+2]=v+f}const p=2*n,w=p+1;o&&(g(p,i),g(w,s));const y=pt(),x=pt();for(let b=0;b<n;b++){const M=Math.cos(b/n*2*Math.PI),D=Math.sin(b/n*2*Math.PI);y[0]=r*(M*a[0]+D*c[0]),y[1]=r*(M*a[1]+D*c[1]),y[2]=r*(M*a[2]+D*c[2]),xe(x,i,y),g(b,x),xe(x,s,y),g(b+n,x);let v=0;b<n-1&&(v=b+1),A(b*2,b,v,b+n),A(b*2+1,v,v+n,b+n),o&&(A(n*2+b,b,p,v),A(n*2+b+n,w,b+n,v+n))}t.push(...u),e.push(...m)});F(at,"makeColoredCylinder",function(e,t,i,s,r,n,o=[192,0,0,255],l=20,a=!1){let c=e.length/3;at.makeCylinder(e,t,s,r,n,l,a),c=e.length/3-c;const h=[];for(let d=0;d<c*4-1;d+=4)h[d]=o[0],h[d+1]=o[1],h[d+2]=o[2],h[d+3]=o[3];i.push(...h)});F(at,"makeColoredSphere",function(e,t,i,s,r=[0,0,0],n=[0,0,192,255]){let o=e.length/3;at.makeSphere(e,t,s,r),o=e.length/3-o;const l=[];for(let a=0;a<o*4-1;a+=4)l[a]=n[0],l[a+1]=n[1],l[a+2]=n[2],l[a+3]=n[3];i.push(...l)});var ve=at,Ei={};$n(Ei,{$itksnap:()=>Jo,$slicer3d:()=>_o,actc:()=>$o,afni_blues_inv:()=>dl,afni_reds_inv:()=>ul,batlow:()=>ta,bcgwhw:()=>ia,bcgwhw_dark:()=>ea,blue:()=>aa,blue2cyan:()=>na,blue2magenta:()=>ra,blue2red:()=>sa,bluegrn:()=>oa,bone:()=>la,bronze:()=>ca,cet_l17:()=>ha,cividis:()=>fa,cool:()=>da,copper:()=>ma,copper2:()=>ua,ct_airways:()=>ga,ct_artery:()=>Aa,ct_bones:()=>pa,ct_brain:()=>va,ct_brain_gray:()=>xa,ct_cardiac:()=>wa,ct_head:()=>ya,ct_kidneys:()=>ba,ct_liver:()=>Ca,ct_muscles:()=>Da,ct_scalp:()=>Ia,ct_skull:()=>Ea,ct_soft:()=>Ma,ct_soft_tissue:()=>Sa,ct_surface:()=>Ta,ct_vessels:()=>Fa,ct_w_contrast:()=>Va,cubehelix:()=>Ba,electric_blue:()=>Ua,freesurfer:()=>Ra,ge_color:()=>Na,gold:()=>Pa,gray:()=>La,green:()=>Oa,green2cyan:()=>ka,green2orange:()=>Ga,hot:()=>za,hotiron:()=>Ya,hsv:()=>Ka,inferno:()=>qa,jet:()=>Qa,kry:()=>Ha,linspecer:()=>Wa,lipari:()=>Xa,magma:()=>ja,mako:()=>Za,navia:()=>Ja,nih:()=>_a,plasma:()=>$a,random:()=>tl,red:()=>el,redyell:()=>il,rocket:()=>sl,roi_i256:()=>ml,surface:()=>rl,thermal:()=>nl,turbo:()=>ol,violet:()=>al,viridis:()=>ll,warm:()=>cl,winter:()=>hl,x_rain:()=>fl});var Jo={R:[0,255,0,0,255,0,255,255,0,205,210,102,0,0,46,255,106,221,233,165,255,147,218,75,255,60,255,255,218,0,188,255,255,222,127,139,124,255,70,0,238,238,240,245,184,32,255,25,112,34,248,245,255,144,173,65,255,250,128,50,244,255,123,255,173,255,127,255,143,220,253,255,0,0,128,255,250,148,178,255,135,100,240,250,255,107,135,0,139,245,186,255,255,0,210,255,47,72,175,128,176,255,139,240,255,216,119,219,72,255,199,154,189,240,230,0,85,64,153,205,250,95,0,255,224,176,138,30,240,152,160],G:[0,0,255,0,255,255,0,239,0,133,180,205,0,139,139,228,90,160,150,42,250,112,112,0,182,179,235,228,165,128,143,105,218,184,255,69,252,255,130,100,130,232,255,222,134,178,20,25,128,139,248,255,160,238,255,105,99,240,0,205,164,255,104,165,216,192,255,140,188,20,245,250,206,255,0,250,128,0,34,127,206,149,230,235,245,142,206,0,0,245,85,228,222,191,105,248,79,61,238,128,224,240,0,255,215,191,136,112,209,0,21,205,183,248,230,250,107,224,50,92,250,158,128,69,255,196,43,144,128,251,82],B:[0,0,0,255,0,255,255,213,205,63,140,170,128,139,87,225,205,221,122,42,250,219,214,130,193,113,205,196,32,128,143,180,185,135,0,19,0,224,180,0,238,170,240,179,11,170,147,112,144,34,255,250,122,144,47,225,71,230,0,50,96,240,238,0,230,203,212,0,143,60,230,240,209,127,128,205,114,211,34,80,235,237,140,215,238,35,250,139,139,220,211,181,173,255,30,220,79,139,238,0,230,245,0,255,0,216,153,147,204,255,133,50,107,255,250,154,47,208,204,92,210,160,0,0,255,222,226,255,128,152,45],A:[0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130]},_o={labels:["background","tissue","bone","skin","connective tissue","blood","organ","mass","muscle","foreign object","waste","teeth","fat","gray matter","white matter","nerve","vein","artery","capillary","ligament","tendon","cartilage","meniscus","lymph node","lymphatic vessel","cerebro-spinal fluid","bile","urine","feces","gas","fluid","edema","bleeding","necrosis","clot","embolism","head","central nervous system","brain","gray matter of brain","telencephalon","cerebral cortex","right frontal lobe","left frontal lobe","right temporal lobe","left temporal lobe","right parietal lobe","left parietal lobe","right occipital lobe","left occipital lobe","right insular lobe","left insular lobe","right limbic lobe","left limbic lobe","right striatum","left striatum","right caudate nucleus","left caudate nucleus","right putamen","left putamen","right pallidum","left pallidum","right amygdaloid complex","left amygdaloid complex","diencephalon","thalamus","right thalamus","left thalamus","pineal gland","midbrain","substantia nigra","right substantia nigra","left substantia nigra","cerebral white matter","right superior longitudinal fasciculus","left superior longitudinal fasciculus","right inferior longitudinal fasciculus","left inferior longitudinal fasciculus","right arcuate fasciculus","left arcuate fasciculus","right uncinate fasciculus","left uncinate fasciculus","right cingulum bundle","left cingulum bundle","projection fibers","right corticospinal tract","left corticospinal tract","right optic radiation","left optic radiation","right medial lemniscus","left medial lemniscus","right superior cerebellar peduncle","left superior cerebellar peduncle","right middle cerebellar peduncle","left middle cerebellar peduncle","right inferior cerebellar peduncle","left inferior cerebellar peduncle","optic chiasm","right optic tract","left optic tract","right fornix","left fornix","commissural fibers","corpus callosum","posterior commissure","cerebellar white matter","CSF space","ventricles of brain","right lateral ventricle","left lateral ventricle","right third ventricle","left third ventricle","cerebral aqueduct","fourth ventricle","subarachnoid space","spinal cord","gray matter of spinal cord","white matter of spinal cord","endocrine system of brain","pituitary gland","adenohypophysis","neurohypophysis","meninges","dura mater","arachnoid","pia mater","muscles of head","salivary glands","lips","nose","tongue","soft palate","right inner ear","left inner ear","right external ear","left external ear","right middle ear","left middle ear","right eyeball","left eyeball","skull","right frontal bone","left frontal bone","right parietal bone","left parietal bone","right temporal bone","left temporal bone","right sphenoid bone","left sphenoid bone","right ethmoid bone","left ethmoid bone","occipital bone","maxilla","right zygomatic bone","right lacrimal bone","vomer bone","right palatine bone","left palatine bone","mandible","neck","muscles of neck","pharynx","larynx","thyroid gland","right parathyroid glands","left parathyroid glands","skeleton of neck","hyoid bone","cervical vertebral column","thorax","trachea","bronchi","right lung","left lung","superior lobe of right lung","superior lobe of left lung","middle lobe of right lung","inferior lobe of right lung","inferior lobe of left lung","pleura","heart","right atrium","left atrium","atrial septum","ventricular septum","right ventricle of heart","left ventricle of heart","mitral valve","tricuspid valve","aortic valve","pulmonary valve","aorta","pericardium","pericardial cavity","esophagus","thymus","mediastinum","skin of thoracic wall","muscles of thoracic wall","skeleton of thorax","thoracic vertebral column","ribs","sternum","right clavicle","left clavicle","abdominal cavity","abdomen","peritoneum","omentum","peritoneal cavity","retroperitoneal space","stomach","duodenum","small bowel","colon","anus","liver","biliary tree","gallbladder","pancreas","spleen","urinary system","right kidney","left kidney","right ureter","left ureter","urinary bladder","urethra","right adrenal gland","left adrenal gland","female internal genitalia","uterus","right fallopian tube","left fallopian tube","right ovary","left ovary","vagina","male internal genitalia","prostate","right seminal vesicle","left seminal vesicle","right deferent duct","left deferent duct","skin of abdominal wall","muscles of abdominal wall","skeleton of abdomen","lumbar vertebral column","female external genitalia","male external genitalia","skeleton of upper limb","muscles of upper limb","right upper limb","left upper limb","right shoulder","left shoulder","right arm"],R:[0,128,241,177,111,216,221,144,192,220,78,255,230,200,250,244,0,216,183,183,152,111,178,68,111,85,0,214,78,218,170,140,188,216,145,150,177,244,250,200,68,128,83,83,162,162,141,141,182,182,188,188,154,154,177,177,30,30,210,210,48,48,98,98,69,166,122,122,253,145,46,0,0,250,127,127,159,159,125,125,106,106,154,154,126,201,201,78,78,174,174,139,139,148,148,186,186,99,156,156,64,64,138,97,126,194,85,88,88,88,88,88,88,88,88,244,200,250,82,57,60,92,255,255,255,255,201,70,188,177,166,182,229,229,174,174,201,201,194,194,241,203,203,229,229,255,255,209,209,248,248,255,196,255,255,255,242,242,222,177,213,184,150,62,62,62,242,250,255,177,182,175,197,197,172,172,202,224,224,255,206,210,203,233,195,181,152,159,166,218,225,224,255,184,211,47,255,173,188,255,226,253,244,205,205,186,177,255,234,204,180,216,255,205,204,255,221,0,139,249,157,203,185,185,247,247,222,124,249,249,244,255,255,227,213,213,193,216,230,245,245,241,241,177,171,217,212,185,185,198,194,177,177,177,177,177],G:[0,174,214,122,184,101,130,238,104,245,63,250,220,200,250,214,151,101,156,214,189,184,212,172,197,188,145,230,63,255,250,224,65,191,60,98,122,214,250,200,131,174,146,146,115,115,93,93,166,166,135,135,150,150,140,140,111,111,157,157,129,129,153,153,110,113,101,101,135,92,101,108,108,250,150,150,116,116,102,102,174,174,146,146,126,160,160,152,152,140,140,126,126,120,120,135,135,106,171,171,123,123,95,113,161,195,188,106,106,106,106,106,106,106,106,214,200,250,174,157,143,162,244,244,244,244,121,163,91,122,84,105,147,147,122,122,112,112,142,142,213,179,179,204,204,243,243,185,185,223,223,230,172,255,250,237,217,217,198,122,124,105,208,162,162,162,206,210,255,122,228,216,165,165,138,138,164,186,186,245,110,115,108,138,100,85,55,63,70,123,130,97,244,122,171,150,244,121,95,239,202,232,217,179,179,124,122,255,234,142,119,132,253,167,168,224,130,145,150,180,108,136,102,102,182,182,154,186,186,186,170,181,190,153,141,141,123,146,158,172,172,172,172,124,85,198,188,135,135,175,98,122,122,122,122,122],B:[0,128,145,101,210,79,101,144,88,20,0,220,70,235,210,49,206,79,220,211,207,210,242,100,131,255,30,130,0,255,250,228,28,216,66,83,101,49,225,215,98,128,164,164,105,105,137,137,110,110,166,166,201,201,190,190,85,85,166,166,126,126,112,112,53,137,38,38,192,109,131,112,112,225,88,88,163,163,154,154,155,155,83,83,55,133,133,141,141,103,103,177,177,72,72,135,135,24,108,108,147,147,74,158,197,164,255,215,215,215,215,215,215,215,215,49,215,225,128,110,83,109,209,209,209,209,77,117,95,101,94,107,118,118,90,90,73,73,0,0,144,77,77,109,109,152,152,85,85,131,131,138,68,167,160,145,123,123,101,101,109,108,243,114,114,114,142,139,207,101,255,244,145,145,115,115,140,162,162,217,84,89,81,112,73,57,13,27,38,97,104,76,209,154,143,103,209,88,76,172,134,158,154,108,108,161,101,220,194,178,153,105,229,142,143,199,101,30,98,111,162,116,83,83,164,164,132,223,150,150,147,158,165,130,113,113,103,127,140,147,147,151,151,92,68,131,102,134,134,125,79,101,101,101,101,101],A:[0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},$o={R:[0,0,24,248,255],G:[0,0,177,254,0],B:[0,136,0,0,0],A:[0,32,64,78,128],I:[0,64,128,156,255]},ta={R:[1,10,15,17,21,27,36,49,65,82,99,118,140,161,183,203,222,238,248,253,253,253,252,250],G:[25,42,56,68,79,88,97,105,111,116,122,127,133,138,142,146,150,155,162,170,178,186,195,204],B:[89,92,95,96,98,98,96,91,83,74,64,55,46,43,49,62,79,100,126,151,175,199,223,250],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,11,22,33,44,55,66,77,88,99,110,121,133,144,155,166,177,188,199,210,221,232,243,255]},ea={R:[0,248,242,235,229,222,212,202,193,183,173,145,117,78,39,0,0,0,0,0,0,64,128,191,255,255,255,255,255,238,221,204,214,224,235,245,255,249,242,236,229,223,217,210,204,197,191,184,176,169,161,154,146,139,132,124,117,109,102,0],G:[0,251,247,243,239,235,235,235,235,235,235,216,197,174,150,127,153,178,204,229,255,255,255,255,255,220,185,150,115,77,38,0,31,61,92,122,153,138,122,107,92,77,61,46,31,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B:[0,254,253,252,251,250,251,252,253,254,255,226,198,132,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40,80,120,160,200,199,198,197,196,196,195,194,193,192,191,184,176,169,161,154,146,139,132,124,117,109,102,0],A:[256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256],I:[0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160,164,168,172,176,180,184,188,192,196,200,204,208,212,216,220,224,228,232,236,240,244,248,255]},ia={R:[255,248,242,235,229,222,212,202,193,183,173,145,117,78,39,0,0,0,0,0,0,64,128,191,255,255,255,255,255,238,221,204,214,224,235,245,255,249,242,236,229,223,217,210,204,197,191,184,176,169,161,154,146,139,132,124,117,109,102,0],G:[255,251,247,243,239,235,235,235,235,235,235,216,197,174,150,127,153,178,204,229,255,255,255,255,255,220,185,150,115,77,38,0,31,61,92,122,153,138,122,107,92,77,61,46,31,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B:[255,254,253,252,251,250,251,252,253,254,255,226,198,132,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40,80,120,160,200,199,198,197,196,196,195,194,193,192,191,184,176,169,161,154,146,139,132,124,117,109,102,0],A:[256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256],I:[0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160,164,168,172,176,180,184,188,192,196,200,204,208,212,216,220,224,228,232,236,240,244,248,255]},sa={R:[0,0,0,0,196,255],G:[0,32,128,128,128,32],B:[0,255,196,0,0,0],A:[0,128,64,64,64,128],I:[0,1,64,128,192,255]},ra={R:[0,255],G:[0,0],B:[255,255],A:[0,128],I:[0,255]},na={R:[0,0],G:[0,255],B:[255,255],A:[0,128],I:[0,255]},oa={R:[0,0,0,0],G:[0,1,128,255],B:[0,222,127,32],A:[0,0,64,128],I:[0,1,128,255]},aa={R:[0,0,0],G:[0,0,0],B:[0,128,255],A:[0,64,128],I:[0,128,255]},la={R:[0,103,255],G:[0,126,255],B:[0,165,255],A:[0,76,128],I:[0,153,255]},ca={R:[0,43,103,199,216,255],G:[0,0,37,155,213,255],B:[0,0,20,97,201,255],A:[0,44,48,54,56,56],I:[0,64,128,196,240,255]},ha={R:[0,9,24,33,40,46,52,57,62,66,70,74,78,81,85,88,91,94,98,101,103,106,109,112,114,117,119,121,124,126,128,130,133,135,137,139,141,143,145,147,149,151,153,155,157,159,161,163,164,166,168,169,171,172,174,175,177,178,180,181,183,184,186,187,189,190,191,193,194,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,222,223,224,224,225,226,226,227,228,228,229,229,230,231,231,232,233,233,234,234,235,235,236,236,236,237,237,237,238,238,238,239,239,239,240,240,240,241,241,241,242,242,242,243,243,243,243,243,243,243,243,244,244,244,244,244,244,244,244,244,244,244,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,244,244,244,244,244,244,244,244,244,244,244,244,244,244,244,243,243,243,243,243,243,243,243,243,243,243,243,242,242,242,242,242,242,242,242,241,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,243,243,244,244,245,246,246,247,247,248,249,249,250,250,251,251,252,252,253,253,254,254,254],G:[42,41,41,41,40,40,40,39,39,39,38,38,37,37,36,36,35,35,34,34,33,32,32,31,30,30,30,30,29,29,29,29,28,28,28,27,27,27,26,26,26,25,25,25,24,24,24,24,24,25,25,26,27,27,28,28,29,30,30,31,31,32,33,33,34,34,35,36,36,37,38,39,40,42,43,44,45,47,48,49,50,51,53,54,55,56,57,58,59,60,62,63,64,65,66,68,69,71,72,73,75,76,77,79,80,81,83,84,85,87,88,89,90,92,93,94,95,97,98,100,101,102,104,105,107,108,109,111,112,113,115,116,117,119,120,121,122,124,125,126,128,129,130,132,133,134,136,137,138,140,141,142,144,145,146,147,149,150,151,153,154,155,156,158,159,160,161,163,164,165,167,168,169,170,172,173,174,175,176,178,179,180,181,183,184,185,186,187,189,190,191,192,193,194,196,197,198,199,200,201,203,204,205,206,207,208,209,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,228,229,230,231,232,233,234,235,236,237,238,238,239,240,241,241,242,243,244,244,245,246,247,248,248,249,250,251,251,252,253,254,255],B:[167,167,166,166,166,165,165,165,164,164,164,163,163,162,162,162,161,161,161,160,160,160,159,159,158,158,157,157,156,155,155,154,154,153,153,152,151,151,150,150,149,149,148,147,147,146,146,145,144,144,143,143,142,141,141,140,139,139,138,137,137,136,135,135,134,133,133,132,131,131,130,130,129,128,128,127,127,126,125,125,124,124,123,123,122,121,121,120,119,119,118,118,117,116,116,116,115,115,114,114,113,113,113,112,112,111,111,110,110,109,109,109,108,108,107,107,106,106,106,106,106,105,105,105,105,105,105,105,104,104,104,104,104,103,103,103,103,103,102,102,102,103,103,103,103,104,104,104,104,104,105,105,105,105,106,106,106,106,106,107,107,107,107,108,108,109,110,111,111,112,113,113,114,115,115,116,117,117,118,119,120,120,121,122,122,123,124,125,126,128,129,130,131,132,134,135,136,137,138,140,141,142,143,144,146,147,148,149,150,152,153,155,157,158,160,162,163,165,167,168,170,172,173,175,177,178,180,182,183,185,187,188,190,193,196,199,201,204,207,210,212,215,218,221,224,226,229,232,235,238,240,243,246,249,252,255],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},fa={R:[0,86,166,255],G:[32,92,156,233],B:[76,108,117,69],A:[0,56,80,88],I:[0,64,192,255]},da={R:[0,0,0],G:[127,196,254],B:[255,255,255],A:[0,64,128],I:[0,128,255]},ua={R:[0,61,122,183,244,255],G:[0,41,81,122,163,255],B:[0,25,51,76,102,255],A:[0,25,51,71,102,128],I:[0,51,102,153,204,255]},ma={R:[0,61,122,183,244,255],G:[0,41,81,122,163,203],B:[0,25,51,76,102,127],A:[0,25,51,71,102,128],I:[0,51,102,153,204,255]},ga={min:-643,max:-235,R:[0,0,0],G:[154,154,154],B:[179,179,101],A:[0,32,0],I:[0,163,255]},Aa={min:114,max:800,R:[0,255,255,255],G:[0,0,129,255],B:[0,0,0,255],A:[0,64,88,228],I:[0,80,160,255]},pa={min:180,max:600,R:[0,0,113,255],G:[0,0,109,250],B:[0,0,101,245],A:[0,0,100,160],I:[0,1,128,255]},xa={min:-10,max:110,R:[0,127,255],G:[0,127,255],B:[0,127,255],A:[0,48,128],I:[0,124,255]},va={min:-10,max:110,R:[0,199,255],G:[0,127,255],B:[0,127,255],A:[0,48,128],I:[0,124,255]},wa={min:-80,max:1e3,R:[0,189,150,150,150,150,255],G:[0,169,54,54,54,54,240],B:[0,153,52,52,52,52,242],A:[0,32,64,0,0,64,64],I:[0,1,82,92,234,242,255]},ya={min:-590,max:600,R:[0,241,241,248,248,178,178,232,255,255,255],G:[0,156,156,222,222,36,36,51,255,255,255],B:[0,130,130,169,169,24,24,37,255,255,255],A:[0,8,0,0,0,64,64,0,0,222,222],I:[0,2,3,64,122,142,172,182,252,253,255]},ba={min:114,max:302,R:[0,255,255],G:[0,129,255],B:[0,0,255],A:[0,88,228],I:[0,103,255]},Ca={min:-23,max:246,R:[0,44,255,255,255],G:[0,128,90,255,255],B:[0,0,70,0,255],A:[0,0,82,184,228],I:[0,64,131,196,255]},Da={min:-100,max:246,R:[0,128,159,255,255,255,255],G:[0,0,56,90,0,255,255],B:[0,0,41,70,0,0,255],A:[0,63,105,135,167,184,228],I:[0,100,128,155,180,209,255]},Ia={min:-590,max:600,R:[0,241,241,248,248,178,232,255,255],G:[0,156,156,222,222,36,51,255,255],B:[0,130,130,169,169,24,37,255,255],A:[0,63,105,135,167,184,228,228,228],I:[0,1,52,127,137,162,172,252,255]},Ea={min:140,max:1024,R:[0,2,113,255],G:[0,1,109,250],B:[0,1,101,245],A:[0,1,96,168],I:[0,1,128,255]},Ma={min:-923,max:679,R:[0,0,0,0,0,255,255,255],G:[154,154,154,154,0,0,254,255],B:[179,179,179,179,0,0,0,255],A:[0,3,8,0,0,10,15,20],I:[0,30,62,88,170,200,232,255]},Sa={min:-10,max:110,R:[0,199,255],G:[0,127,255],B:[0,127,255],A:[0,48,128],I:[0,124,255]},Ta={min:-600,max:100,R:[0,134,255],G:[0,109,250],B:[0,101,245],A:[0,60,148],I:[0,128,255]},Fa={min:114,max:246,R:[0,255,255],G:[0,128,255],B:[0,128,255],A:[0,64,96],I:[0,87,255]},Va={min:50,max:1e3,R:[98,210,169,128,255],G:[94,26,77,128,255],B:[45,21,74,128,255],A:[0,25,0,4,168],I:[0,41,87,154,255]},Ba={R:[0,13,21,26,27,25,22,21,22,28,39,54,75,98,124,148,171,189,202,210,213,211,206,200,195,193,195,201,211,225,240,255],G:[0,5,11,20,31,44,58,72,86,99,109,116,120,122,122,122,121,121,124,129,137,147,161,175,190,205,218,229,238,245,251,255],B:[0,14,30,46,61,71,77,78,75,68,60,52,48,47,53,65,83,105,131,157,183,205,222,235,241,243,242,240,239,240,245,255],A:[0,4,8,12,17,21,25,29,33,37,41,45,50,54,58,62,66,70,74,78,83,87,91,95,99,103,107,111,116,120,124,128],I:[0,8,16,25,33,41,49,58,66,74,82,90,99,107,115,123,132,140,148,156,165,173,181,189,197,206,214,222,230,239,247,255]},Ua={R:[0,10,136,255],G:[0,39,220,255],B:[0,223,253,255],A:[0,48,64,70],I:[0,92,192,255]},Ra={R:[0,245,205,120,196,220,230,0,122,236,12,204,42,119,220,103,60,255,165,160,0,245,205,120,196,220,230,0,122,236,13,220,103,255,165,160,0,120,200,255,255,164,164,164,234,0,0,0,0,0],G:[0,245,62,18,58,248,148,118,186,13,48,182,204,159,216,255,60,165,42,32,200,245,62,18,58,248,148,118,186,13,48,216,255,165,42,32,200,190,70,148,148,108,108,108,169,0,0,0,0,0],B:[0,245,78,134,250,164,34,14,220,176,255,142,164,176,20,255,60,0,42,240,200,245,78,134,250,164,34,14,220,176,255,20,255,0,42,240,221,150,255,10,10,226,226,226,30,64,112,160,208,255],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,2,3,4,5,7,8,10,11,12,13,14,15,16,17,18,24,26,28,30,31,41,42,43,44,46,47,49,50,51,52,53,54,58,60,62,63,72,77,78,79,80,81,82,85,251,252,253,254,255]},Na={R:[0,0,128,255,255],G:[0,128,0,128,255],B:[0,125,255,0,255],A:[0,32,64,96,128],I:[0,63,128,192,255]},Pa={R:[0,142,227,255],G:[0,85,170,255],B:[0,14,76,255],A:[0,42,84,128],I:[0,85,170,255]},La={R:[0,255],G:[0,255],B:[0,255],A:[0,128],I:[0,255]},Oa={R:[0,0,0],G:[0,128,255],B:[0,0,0],A:[0,64,128],I:[0,128,255]},ka={R:[0,0,0],G:[72,72,255],B:[0,255,255],A:[0,64,128],I:[0,88,255]},Ga={R:[0,255,255],G:[72,88,255],B:[0,0,0],A:[0,64,128],I:[0,88,255]},Ya={R:[0,255,255,255],G:[0,0,126,255],B:[0,0,0,255],A:[0,64,96,128],I:[0,128,191,255]},za={R:[3,255,255,255],G:[0,0,255,255],B:[0,0,0,255],A:[0,48,96,128],I:[0,95,191,255]},Ka={R:[255,255,0,0,0,255,255],G:[0,255,255,255,0,0,0],B:[0,0,0,255,255,255,0],A:[0,14,28,43,57,71,85],I:[0,43,85,128,170,213,255]},qa={R:[0,120,237,240],G:[0,28,105,249],B:[4,109,37,33],A:[0,56,80,88],I:[0,64,192,255]},Qa={R:[0,0,127,255,127],G:[0,127,255,127,0],B:[127,255,127,0,0],A:[0,32,64,96,128],I:[0,63,128,192,255]},Ha={R:[0,255,255],G:[0,0,255],B:[0,0,0],A:[0,64,64],I:[0,86,255]},Wa={R:[94,50,90,152,215,238,249,254,252,241,209,158],G:[79,131,186,214,240,244,237,210,157,100,57,1],B:[162,189,167,164,155,169,168,123,86,68,79,66],A:[0,12,23,35,47,58,70,81,93,105,116,128],I:[0,23,46,70,93,116,139,162,185,209,232,255]},Xa={R:[3,7,13,25,45,67,84,98,110,124,138,154,173,191,210,225,233,233,231,229,230,235,243,253],G:[19,33,48,63,77,87,92,94,95,96,96,97,99,101,106,118,133,149,163,177,192,208,225,245],B:[38,58,79,99,114,122,122,120,117,113,110,105,101,97,94,96,103,112,122,134,149,169,192,218],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,11,22,33,44,55,66,77,88,99,110,121,133,144,155,166,177,188,199,210,221,232,243,255]},ja={R:[0,148,183,223,247,252],G:[0,44,55,74,112,253],B:[4,128,121,104,92,191],A:[0,44,53,64,75,107],I:[0,107,128,154,179,255]},Za={R:[11,59,55,222],G:[4,45,165,245],B:[5,91,172,229],A:[0,23,70,107],I:[0,56,167,255]},Ja={R:[3,5,6,8,12,19,28,36,42,48,54,61,68,76,86,96,110,129,154,181,205,224,239,252],G:[19,32,44,58,72,86,98,108,116,122,128,134,141,149,157,167,178,191,204,216,225,232,239,244],B:[39,60,82,104,123,137,144,145,142,138,134,130,126,121,116,110,105,104,112,131,155,178,198,217],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,11,22,33,44,55,66,77,88,99,110,121,133,144,155,166,177,188,199,210,221,232,243,255]},_a={R:[0,85,0,0,0,0,0,0,85,255,255,255,172],G:[0,0,0,0,85,170,255,255,255,255,85,0,0],B:[0,170,85,255,255,170,170,0,85,0,0,0,0],A:[0,5,10,21,26,32,37,42,48,53,64,72,85],I:[0,15,31,63,79,95,111,127,143,159,191,217,255]},$a={R:[13,156,237,240],G:[8,23,121,249],B:[135,158,83,33],A:[0,56,80,88],I:[0,64,192,255]},tl={R:[208,71,33,192,32,195,208,173,233,202,25,210,145,89,87,245,246,38,3,25,57,167,245,86,227,208,81,64,90,199,140,48,212,180,70,120,9,192,245,177,65,157,9,193,100,181,125,145,62,8,108,36,140,237,242,248,161,189,41,114,65,121,97,50,238,149,44,214,124,167,40,167,127,178,231,30,173,244,193,203,204,238,139,135,71,234,234,217,66,14,129,19,97,165,112,244,35,73,192,12,149,71,33,192,32,195,208,173,233,202,25,210,145,89,87,245,246,38,3,25,57,167,245,86,227,208,81,64,90,199,140,48,212,180,70,120,9,192,245,177,65,157,9,193,100,181,125,145,62,8,108,36,140,237,242,248,161,189,41,114,65,121,97,50,238,149,44,214,124,167,40,167,127,178,231,30,173,244,193,203,204,238,139,135,71,234,234,217,66,14,129,19,97,165,112,244,35,73,192,12,149,71,33,192,32,195,208,173,233,202,25,210,145,89,87,245,246,38,3,25,57,167,245,86,227,208,81,64,90,199,140,48,212,180,70,120,9,192,245,177,65,157,9,193,100,181,125,145,62,8,108,36,140,237,242,248],G:[182,46,78,199,79,89,41,208,135,20,154,35,21,43,230,113,191,147,208,37,28,27,86,203,25,209,148,187,139,111,48,102,76,110,106,130,37,160,34,222,90,165,245,222,102,47,19,130,4,232,137,211,240,11,140,21,42,22,241,61,99,115,199,166,114,190,204,60,233,66,115,230,125,103,203,125,13,176,94,131,39,198,167,124,67,175,254,1,15,198,62,237,159,31,218,58,244,47,61,67,94,46,78,199,79,89,41,208,135,20,154,35,21,43,230,113,191,147,208,37,28,27,86,203,25,209,148,187,139,111,48,102,76,110,106,130,37,160,34,222,90,165,245,222,102,47,19,130,4,232,137,211,240,11,140,21,42,22,241,61,99,115,199,166,114,190,204,60,233,66,115,230,125,103,203,125,13,176,94,131,39,198,167,124,67,175,254,1,15,198,62,237,159,31,218,58,244,47,61,67,94,46,78,199,79,89,41,208,135,20,154,35,21,43,230,113,191,147,208,37,28,27,86,203,25,209,148,187,139,111,48,102,76,110,106,130,37,160,34,222,90,165,245,222,102,47,19,130,4,232,137,211,240,11,140,21],B:[191,154,43,10,207,204,164,231,136,58,239,30,147,230,101,111,150,35,128,57,252,79,173,120,25,126,81,85,8,7,122,237,190,152,246,182,130,219,67,76,167,178,235,250,28,61,186,250,199,67,58,50,86,182,108,77,89,112,59,125,226,50,205,227,125,128,104,27,59,66,53,133,159,203,97,125,139,159,158,7,215,47,140,226,223,231,44,110,184,61,233,47,67,148,22,120,173,156,117,181,94,154,43,10,207,204,164,231,136,58,239,30,147,230,101,111,150,35,128,57,252,79,173,120,25,126,81,85,8,7,122,237,190,152,246,182,130,219,67,76,167,178,235,250,28,61,186,250,199,67,58,50,86,182,108,77,89,112,59,125,226,50,205,227,125,128,104,27,59,66,53,133,159,203,97,125,139,159,158,7,215,47,140,226,223,231,44,110,184,61,233,47,67,148,22,120,173,156,117,181,94,154,43,10,207,204,164,231,136,58,239,30,147,230,101,111,150,35,128,57,252,79,173,120,25,126,81,85,8,7,122,237,190,152,246,182,130,219,67,76,167,178,235,250,28,61,186,250,199,67,58,50,86,182,108,77],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},el={R:[0,128,255],G:[0,0,0],B:[0,0,0],A:[0,64,128],I:[0,128,255]},il={R:[192,224,255],G:[1,128,255],B:[0,0,0],A:[0,64,128],I:[0,128,255]},sl={R:[3,112,144,188,236,246,255],G:[5,31,29,22,76,158,250],B:[26,87,91,86,62,117,235],A:[0,30,38,49,67,85,107],I:[0,73,92,118,160,205,255]},rl={R:[1,240,255],G:[1,128,255],B:[1,128,255],A:[0,76,128],I:[0,153,255]},nl={R:[0,5,18,34,53,72,90,107,126,144,161,178,194,209,222,233,242,248,251,251,249,244,241,252],G:[0,4,10,11,9,11,17,23,30,36,43,50,59,70,83,98,117,136,157,177,199,220,240,254],B:[3,24,50,76,96,106,109,110,108,104,97,89,79,67,55,42,26,12,6,22,47,79,121,164],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,11,22,33,44,55,66,77,88,99,110,121,133,144,155,166,177,188,199,210,221,232,243,255]},ol={R:[48,48,64,70,65,25,132,195,244,254,218,122],G:[18,18,64,107,150,226,255,241,199,158,57,4],B:[59,59,162,227,255,187,81,52,58,47,7,3],A:[0,22,26,30,34,43,52,57,63,67,77,86],I:[0,1,16,32,49,83,118,140,164,181,219,255]},al={R:[0,128,255],G:[0,0,0],B:[0,128,255],A:[0,64,128],I:[0,128,255]},ll={R:[68,49,53,253],G:[1,104,183,231],B:[84,142,121,37],A:[0,56,80,88],I:[0,64,192,255]},cl={R:[255,255,255],G:[127,196,254],B:[0,0,0],A:[0,64,128],I:[0,128,255]},hl={R:[0,0,0],G:[0,128,255],B:[255,196,128],A:[0,64,128],I:[0,128,255]},fl={R:[3,64,0,0,255,255,255],G:[0,0,0,255,255,192,3],B:[0,32,48,56,64,96,128],A:[0,8,16,24,32,52,80],I:[0,32,64,96,160,192,255]},dl={min:0,max:0,R:[0,37],G:[242,0],B:[255,255],A:[0,64],I:[0,255]},ul={R:[255,255],G:[255,11],B:[0,0],A:[0,64],I:[0,255]},ml={min:0,max:0,R:[65,10,223,120,216,207,251,93,252,217,21,253,131,165,173,143,144,217,86,89,63,254,172,1,142,107,42,78,221,8,222,71,127,126,167,33,104,2,208,216,0,251,7,105,2,101,248,190,253,62,255,224,166,37,110,138,45,34,6,37,69,201,43,122,199,37,173,194,103,211,75,159,96,4,239,98,110,193,253,166,40,255,48,130,140,243,101,9,177,220,133,32,4,81,48,48,210,109,60,132,1,119,1,159,247,33,212,187,253,144,196,254,168,79,64,196,39,97,73,173,104,216,217,43,101,119,254,5,237,103,203,122,57,87,251,164,19,75,200,2,252,150,66,0,255,157,23,254,55,16,240,161,69,253,207,195,5,60,255,251,200,217,134,123,253,180,27,246,130,136,250,232,4,125,140,22,253,255,13,180,123,61,254,111,10,185,76,192,255,223,186,61,198,5,172,13,83,172,171,6,23,73,134,133,109,61,213,55,57,132,36,209,2,144,1,253,68,155,3,160,2,77,121,70,67,176,223,131,4,162,232,255,150,94,235,191,207,10,246,0,225,4,209,116,57,112,172,253,1,6,92,227,73,62,135,223],G:[162,50,112,245,4,124,176,243,56,125,183,139,182,68,189,4,225,10,20,223,7,46,31,193,225,250,219,41,2,100,83,181,34,150,72,223,168,248,80,253,7,117,214,2,248,10,3,59,179,160,90,244,146,4,207,4,125,255,96,100,1,208,130,51,116,181,236,53,244,5,165,28,181,86,96,42,254,1,134,194,214,92,41,204,137,86,207,3,143,3,100,239,164,94,65,251,131,244,173,57,143,107,217,53,210,0,148,250,45,198,81,40,61,218,252,88,171,0,248,24,248,4,41,100,187,46,208,145,43,168,121,46,175,250,125,107,233,112,207,231,174,215,53,9,43,153,52,124,128,65,210,147,255,147,63,200,148,254,0,179,241,42,239,2,230,8,82,135,87,16,3,87,86,151,254,8,255,86,53,19,7,192,171,201,253,247,197,103,251,126,0,149,54,183,61,126,79,113,10,103,184,75,11,195,222,136,149,131,8,99,240,177,252,255,198,16,7,68,178,66,191,150,73,26,211,109,78,209,240,254,1,166,247,131,2,0,167,127,133,10,43,99,235,3,214,142,176,82,132,38,10,249,255,215,44,81],B:[176,182,248,37,117,35,96,69,32,152,108,20,237,250,2,89,141,216,111,251,211,149,10,44,214,103,31,251,3,32,252,246,97,1,219,167,197,4,36,116,206,118,106,43,205,204,114,69,127,205,87,80,41,251,145,204,253,161,247,1,149,9,43,253,97,72,136,161,171,181,26,255,108,80,218,214,231,255,84,31,109,4,218,3,217,36,68,85,241,39,221,2,240,2,173,42,206,5,110,46,103,27,212,184,2,207,246,45,116,72,110,253,38,105,248,159,243,81,192,93,141,145,24,157,234,131,57,178,62,75,65,176,148,40,253,66,76,240,51,154,17,251,139,253,207,9,114,49,200,254,96,73,138,118,204,102,137,89,145,161,4,112,66,234,147,178,212,205,185,11,203,131,2,250,118,169,1,185,154,53,171,197,61,175,249,96,15,254,95,5,222,75,246,194,2,61,180,25,133,165,15,233,59,35,221,140,109,7,114,255,198,0,115,168,252,23,242,80,75,142,137,255,12,182,68,201,4,111,37,228,83,248,24,192,249,5,54,223,160,122,160,114,145,119,252,31,253,250,10,214,8,47,0,142,222,70],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},gl=class{constructor(){F(this,"gamma",1),F(this,"version",.1),F(this,"cluts",{});const t=Object.keys(Ei).filter(i=>!i.startsWith("$")).sort(new Intl.Collator("en").compare);for(const i of t)this.cluts[i]=Ei[i]}addColormap(e,t){this.cluts[e]=t}colormaps(){return Object.keys(this.cluts)}colorMaps(){return this.colormaps()}colormapFromKey(e){let t=this.cluts[e];return t!==void 0||(t=this.cluts[e.toLowerCase()],t!==void 0)?t:(e.length>0&&P.warn("No color map named "+e),{min:0,max:0,R:[0,255],G:[0,255],B:[0,255],A:[0,255],I:[0,255]})}colormap(e="",t=!1){const i=this.colormapFromKey(e);return this.makeLut(i.R,i.G,i.B,i.A,i.I,t)}makeLabelLut(e,t=255){if(e.R===void 0||e.G===void 0||e.B===void 0)throw new Error(`Invalid colormap table: ${e}`);const i=e.R.length,s=e.I??[...Array(i).keys()];if(i!==e.G.length||i!==e.B.length||i!==s.length)throw new Error(`colormap does not make sense: ${e} Rs ${e.R.length} Gs ${e.G.length} Bs ${e.B.length} Is ${s.length}`);let r=new Uint8ClampedArray(i).fill(t);r[0]=0,e.A!==void 0&&(r=Uint8ClampedArray.from(e.A));const n=Math.min(...s),o=Math.max(...s),l=o-n+1,a=new Uint8ClampedArray(l*4).fill(0);for(let h=0;h<i;h++){let d=(s[h]-n)*4;a[d++]=e.R[h],a[d++]=e.G[h],a[d++]=e.B[h],a[d++]=r[h]}const c={lut:a,min:n,max:o};if(e.labels){const h=e.labels.length;if(h===l)c.labels=e.labels;else if(h===i){c.labels=Array(l).fill("?");for(let d=0;d<i;d++){const f=s[d];c.labels[f]=e.labels[d]}}}return c}async makeLabelLutFromUrl(e){const i=await(await fetch(e)).json();return this.makeLabelLut(i)}makeDrawLut(e){let t=typeof e=="object"?e:Ei[e];t===void 0&&(t={min:0,max:0,R:[0,255,0,0,255,0,255],G:[0,0,255,0,255,255,0],B:[0,0,0,255,0,255,255],A:[0,255,255,255,255,255,255],I:[0,255]});const i=this.makeLabelLut(t,255);if(i.labels===void 0&&(i.labels=[]),i.labels.length<256){const o=i.labels.length;for(let l=o;l<256;l++)i.labels.push(l.toString())}const s=new Uint8ClampedArray(256*4);let r=0;for(let o=0;o<256;o++)s[r++]=255,s[r++]=0,s[r++]=0,s[r++]=255;s[3]=0;const n=Math.min(i.lut.length,256*4);if(n>0)for(let o=0;o<n;o++)s[o]=i.lut[o];return{lut:s,labels:i.labels}}makeLut(e,t,i,s,r,n){const o=e.length,l=[...e],a=[...t],c=[...i];if(!r){r=new Array(o);for(let u=0;u<o;u++)r[u]=u/(o-1)*255}s||(s=new Array(o).fill(64),s[0]=0);let h=Uint8ClampedArray.from(s),d=Uint8ClampedArray.from(r);if(n)for(let u=0;u<o;u++)l[u]=e[o-1-u],a[u]=t[o-1-u],c[u]=i[o-1-u],h[u]=255-s[o-1-u],d[u]=255-r[o-1-u];const f=new Uint8ClampedArray(256*4);if(typeof d>"u"){d=new Uint8ClampedArray(o).fill(0);for(let u=0;u<o;u++)d[u]=Math.round(u*255/(o-1))}typeof h>"u"&&(h=new Uint8ClampedArray(o).fill(64),h[0]=0);for(let u=0;u<o-1;u++){const m=d[u];let g=d[u+1];u===0&&m!==0&&P.warn("colormap issue: indices expected to start with 0 not ",m),u===d.length-2&&g!==255&&(P.warn("padding colormap: indices expected end with 255 not ",g),g=255);const A=g-m;let p=m*4;for(let w=m;w<=g;w++){const y=(w-m)/A;f[p++]=l[u]+y*(l[u+1]-l[u]),f[p++]=a[u]+y*(a[u+1]-a[u]),f[p++]=c[u]+y*(c[u+1]-c[u]),f[p++]=h[u]+y*(h[u+1]-h[u])}}if(this.gamma===1)return f;for(let u=0;u<255*4;u++)u%4!==3&&(f[u]=Math.pow(f[u]/255,1/this.gamma)*255);return f}},mt=new gl,Ae=class{static getClusterBoundaryU8(e,t){const i=new Array(e.length).fill(!1),s=new Array(e.length).fill(!1);for(let o=0;o<e.length;o++)e[o]>0&&(s[o]=!0);const r=t.length/3;let n=0;for(let o=0;o<r;o++){const l=t[n],a=t[n+1],c=t[n+2];n+=3,!(s[l]===s[a]&&s[l]===s[c]&&s[a]===s[c])&&(i[l]=!0,i[a]=!0,i[c]=!0)}return i}static async gzip(e){const t=new CompressionStream("gzip"),i=t.writable.getWriter();i.write(e).catch(console.error);const s=i.close().catch(console.error),r=new Response(t.readable),n=new Uint8Array(await r.arrayBuffer());return await s,n}static createMZ3(e,t,i=!1,s=null){const n=s instanceof Uint8Array&&s.length===e.length/3*4,o=n?7:3,l=t.length/3,a=e.length/3,c=0,h=16,d=l*3*4,f=a*3*4,u=h+d+f,m=new ArrayBuffer(u),g=new DataView(m);g.setUint16(0,23117,!0),g.setUint16(2,o,!0),g.setUint32(4,l,!0),g.setUint32(8,a,!0),g.setUint32(12,c,!0);let A=h;if(new Uint32Array(m,A,t.length).set(t),A+=d,new Float32Array(m,A,e.length).set(e),n&&(A+=f,new Uint8Array(m,A,s.length).set(s)),i)throw new Error("Call async createMZ3Async() for compression");return m}static async createMZ3Async(e,t,i=!1,s=null){const r=this.createMZ3(e,t,i,s);return i?await this.gzip(new Uint8Array(r)):r}static createOBJ(e,t){let i="";for(let n=0;n<e.length;n+=3)i+=`v ${e[n]} ${e[n+1]} ${e[n+2]}
`;for(let n=0;n<t.length;n+=3)i+=`f ${t[n]+1} ${t[n+1]+1} ${t[n+2]+1}
`;return new TextEncoder().encode(i).buffer}static createSTL(e,t){const i=t.length/3,s=84+i*50,r=new ArrayBuffer(s),n=new DataView(r);for(let l=0;l<80;l++)n.setUint8(l,0);n.setUint32(80,i,!0);let o=84;for(let l=0;l<t.length;l+=3){const a=t[l]*3,c=t[l+1]*3,h=t[l+2]*3;n.setFloat32(o,0,!0),n.setFloat32(o+4,0,!0),n.setFloat32(o+8,0,!0),o+=12,n.setFloat32(o,e[a],!0),n.setFloat32(o+4,e[a+1],!0),n.setFloat32(o+8,e[a+2],!0),o+=12,n.setFloat32(o,e[c],!0),n.setFloat32(o+4,e[c+1],!0),n.setFloat32(o+8,e[c+2],!0),o+=12,n.setFloat32(o,e[h],!0),n.setFloat32(o+4,e[h+1],!0),n.setFloat32(o+8,e[h+2],!0),o+=12,n.setUint16(o,0,!0),o+=2}return r}static downloadArrayBuffer(e,t){const i=new Blob([e],{type:"application/octet-stream"}),s=URL.createObjectURL(i),r=document.createElement("a");r.href=s,r.download=t,document.body.appendChild(r),r.style.display="none",r.click(),setTimeout(()=>{document.body.removeChild(r),URL.revokeObjectURL(s)},0)}static async saveMesh(e,t,i=".mz3",s=!1){let r=new ArrayBuffer(0);return/\.obj$/i.test(i)?r=this.createOBJ(e,t):/\.stl$/i.test(i)?r=this.createSTL(e,t):(/\.mz3$/i.test(i)||(i+=".mz3"),r=await this.createMZ3Async(e,t,s)),i.length>4&&this.downloadArrayBuffer(r,i),r}static getClusterBoundary(e,t){const i=new Uint32Array(e.buffer),s=new Array(i.length).fill(!1),r=t.length/3;let n=0;for(let o=0;o<r;o++){const l=t[n],a=t[n+1],c=t[n+2];n+=3,!(i[l]===i[a]&&i[l]===i[c]&&i[a]===i[c])&&(s[l]=!0,s[a]=!0,s[c]=!0)}return s}static getExtents(e){if(!ArrayBuffer.isView(e)&&!Array.isArray(e)||e.length<3)return{mxDx:0,extentsMin:0,extentsMax:0};let t=0;const i=Q(e[0],e[1],e[2]),s=Q(e[0],e[1],e[2]);for(let o=0;o<e.length;o+=3){const l=Q(e[o],e[o+1],e[o+2]);t=Math.max(t,Je(l)),os(i,i,l),as(s,s,l)}const r=[i[0],i[1],i[2]],n=[s[0],s[1],s[2]];return{mxDx:t,extentsMin:r,extentsMax:n}}static generateNormals(e,t){const i=[];let s;const r=e.length;let n,o,l,a,c,h,d,f,u;const m=new Float32Array(r),g=t.length;for(s=0;s<g;s+=3){d=t[s]*3,f=t[s+1]*3,u=t[s+2]*3;const A=[e[d],e[d+1],e[d+2]],p=[e[f],e[f+1],e[f+2]],w=[e[u],e[u+1],e[u+2]];n=p[0]-A[0],o=p[1]-A[1],l=p[2]-A[2],a=w[0]-A[0],c=w[1]-A[1],h=w[2]-A[2],i[0]=c*l-h*o,i[1]=h*n-a*l,i[2]=a*o-c*n,m[d]+=i[0],m[d+1]+=i[1],m[d+2]+=i[2],m[f]+=i[0],m[f+1]+=i[1],m[f+2]+=i[2],m[u]+=i[0],m[u+1]+=i[1],m[u+2]+=i[2]}for(s=0;s<r;s+=3){i[0]=-1*m[s],i[1]=-1*m[s+1],i[2]=-1*m[s+2];let A=i[0]*i[0]+i[1]*i[1]+i[2]*i[2];A>0&&(A=1/Math.sqrt(A),i[0]*=A,i[1]*=A,i[2]*=A),m[s]=i[0],m[s+1]=i[1],m[s+2]=i[2]}return m}},Z,Gt,Mi,ss,He,Al=class{constructor(e){ze(this,Z),ze(this,Gt,0),ze(this,Mi,[]),ze(this,ss,[]),ze(this,He),Ee(this,Z,new DataView(e)),this.read()}async extract(e){const t=new Uint8Array(j(this,Z).buffer.slice(e.startsAt,e.startsAt+e.compressedSize));if(e.compressionMethod===0)return t;if(e.compressionMethod===8){const i=new DecompressionStream("deflate-raw"),s=i.writable.getWriter();s.write(t).catch(console.error);const r=s.close().catch(console.error),n=new Response(i.readable),o=new Uint8Array(await n.arrayBuffer());return await r,o}throw new Error(`Unsupported compression method: ${e.compressionMethod}`)}read(){for(;!j(this,He)&&j(this,Gt)<j(this,Z).byteLength;){const e=j(this,Z).getUint32(j(this,Gt),!0);if(e===67324752){const t=this.readLocalFile(j(this,Gt));t.extract=this.extract.bind(this,t),j(this,Mi).push(t);const i=(t.generalPurpose&8)!==0;if(t.startsAt=j(this,Gt)+30+t.fileNameLength+t.extraLength,t.compressedSize===0&&i){let s=t.startsAt;for(;s+20<=j(this,Z).byteLength;){if(j(this,Z).getUint32(s,!0)===134695760&&j(this,Z).getUint16(s+16,!0)===19280){s+=4;break}s++}t.crc=j(this,Z).getUint32(s,!0),t.compressedSize=j(this,Z).getUint32(s+4,!0),t.uncompressedSize=j(this,Z).getUint32(s+8,!0),Ee(this,Gt,s+12)}else Ee(this,Gt,t.startsAt+t.compressedSize)}else if(e===33639248){const t=this.readCentralDirectory(j(this,Gt));j(this,ss).push(t),Ee(this,Gt,j(this,Gt)+(46+t.fileNameLength+t.extraLength+t.fileCommentLength))}else if(e===101010256){Ee(this,He,this.readEndCentralDirectory(j(this,Gt)));break}else if(e===101075792){Ee(this,He,this.readEndCentralDirectory64(j(this,Gt)));break}else{console.error(`Unexpected ZIP signature 0x${e.toString(16).padStart(8,"0")} at index ${j(this,Gt)}`);break}}}readLocalFile(e){let t=j(this,Z).getUint32(e+18,!0),i=j(this,Z).getUint32(e+22,!0);const s=j(this,Z).getUint16(e+26,!0),r=j(this,Z).getUint16(e+28,!0),n=e+30+s;if(this.readString(n,r),t===4294967295&&i===4294967295){let o=n,l=!1;for(;o<n+r-4;){const a=j(this,Z).getUint16(o,!0),c=j(this,Z).getUint16(o+2,!0);if(o+=4,a===1)if(c>=16){i=Number(j(this,Z).getBigUint64(o,!0)),o+=8,t=Number(j(this,Z).getBigUint64(o,!0)),l=!0;break}else throw new Error(`ZIP64 extra field found but is too small (expected at least 16 bytes, got ${c}).`);o+=c}if(!l)throw new Error("ZIP64 format missing extra field with signature 0x0001.")}return{signature:this.readString(e,4),version:j(this,Z).getUint16(e+4,!0),generalPurpose:j(this,Z).getUint16(e+6,!0),compressionMethod:j(this,Z).getUint16(e+8,!0),lastModifiedTime:j(this,Z).getUint16(e+10,!0),lastModifiedDate:j(this,Z).getUint16(e+12,!0),crc:j(this,Z).getUint32(e+14,!0),compressedSize:t,uncompressedSize:i,fileNameLength:s,extraLength:r,fileName:this.readString(e+30,s),extra:this.readString(e+30+s,r)}}readCentralDirectory(e){return{versionCreated:j(this,Z).getUint16(e+4,!0),versionNeeded:j(this,Z).getUint16(e+6,!0),fileNameLength:j(this,Z).getUint16(e+28,!0),extraLength:j(this,Z).getUint16(e+30,!0),fileCommentLength:j(this,Z).getUint16(e+32,!0),diskNumber:j(this,Z).getUint16(e+34,!0),internalAttributes:j(this,Z).getUint16(e+36,!0),externalAttributes:j(this,Z).getUint32(e+38,!0),offset:j(this,Z).getUint32(e+42,!0),comments:this.readString(e+46,j(this,Z).getUint16(e+32,!0))}}readEndCentralDirectory(e){const t=j(this,Z).getUint16(e+20,!0);return{numberOfDisks:j(this,Z).getUint16(e+4,!0),centralDirectoryStartDisk:j(this,Z).getUint16(e+6,!0),numberCentralDirectoryRecordsOnThisDisk:j(this,Z).getUint16(e+8,!0),numberCentralDirectoryRecords:j(this,Z).getUint16(e+10,!0),centralDirectorySize:j(this,Z).getUint32(e+12,!0),centralDirectoryOffset:j(this,Z).getUint32(e+16,!0),commentLength:t,comment:this.readString(e+22,t)}}readEndCentralDirectory64(e){const t=Number(j(this,Z).getBigUint64(e+0,!0));return{numberOfDisks:j(this,Z).getUint32(e+16,!0),centralDirectoryStartDisk:j(this,Z).getUint32(e+20,!0),numberCentralDirectoryRecordsOnThisDisk:Number(j(this,Z).getBigUint64(e+24,!0)),numberCentralDirectoryRecords:Number(j(this,Z).getBigUint64(e+32,!0)),centralDirectorySize:Number(j(this,Z).getBigUint64(e+40,!0)),centralDirectoryOffset:Number(j(this,Z).getBigUint64(e+48,!0)),commentLength:t,comment:""}}readString(e,t){return Array.from({length:t},(i,s)=>String.fromCharCode(j(this,Z).getUint8(e+s))).join("")}get entries(){return j(this,Mi)}};Z=new WeakMap;Gt=new WeakMap;Mi=new WeakMap;ss=new WeakMap;He=new WeakMap;var X=class Ue{static arrayBufferToBase64(t){const i=new Uint8Array(t);return Ue.uint8tob64(i)}static async decompress(t){const i=t[0]===31&&t[1]===139&&t[2]===8?"gzip":t[0]===120&&(t[1]===1||t[1]===94||t[1]===156||t[1]===218)?"deflate":"deflate-raw",s=new DecompressionStream(i),r=s.writable.getWriter();r.write(t).catch(console.error);const n=r.close().catch(console.error),o=new Response(s.readable),l=new Uint8Array(await o.arrayBuffer());return await n,l}static async decompressToBuffer(t){const i=await Ue.decompress(t);return i.buffer.slice(i.byteOffset,i.byteOffset+i.byteLength)}static async readMatV4(t){let i=t.byteLength;if(i<40)throw new Error("File too small to be MAT v4: bytes = "+t.byteLength);let s=new DataView(t),r=s.getUint16(0,!0),n=t;if(r===35615||r===8075){const u=await this.decompress(new Uint8Array(t));s=new DataView(u.buffer),r=s.getUint16(0,!0),n=u.buffer,i=n.byteLength}const o=new TextDecoder("utf-8"),l=new Uint8Array(n);let a=0;const c={};function h(u){return Math.floor(u/10)%10}function d(u,m,g){const A=new Uint8Array(l.subarray(m,g));return u===1?new Float32Array(A.buffer):u===2?new Int32Array(A.buffer):u===3?new Int16Array(A.buffer):u===4?new Uint16Array(A.buffer):u===5?new Uint8Array(A.buffer):new Float64Array(A.buffer)}function f(){const u=s.getUint32(a,!0),m=s.getUint32(a+4,!0),g=s.getUint32(a+8,!0),A=s.getUint32(a+12,!0),p=s.getUint32(a+16,!0);if(a+=20,A!==0)throw new Error("Matlab V4 reader does not support imaginary numbers");const w=m*g;if(w<1)throw new Error("mrows * ncols must be greater than one");const y=new Uint8Array(l.subarray(a,a+p)),x=o.decode(y).trim().replaceAll("\0",""),b=h(u);let M=8;if(b>=1&&b<=2)M=4;else if(b>=3&&b<=4)M=2;else if(b===5)M=1;else if(b!==0)throw new Error("impossible Matlab v4 datatype");if(a+=p,u>50)throw new Error("Does not appear to be little-endian V4 Matlab file");const D=a+w*M;c[x]=d(b,a,D),a=D}for(;a+20<i;)f();return c}static b64toUint8(t){const i=atob(t),s=i.length,r=new Uint8Array(s);for(let n=0;n<s;n++)r[n]=i.charCodeAt(n);return r}static uint8tob64(t){let i="";const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=t.byteLength,n=r%3,o=r-n;let l,a,c,h,d;for(let f=0;f<o;f=f+3)d=t[f]<<16|t[f+1]<<8|t[f+2],l=(d&16515072)>>18,a=(d&258048)>>12,c=(d&4032)>>6,h=d&63,i+=s[l]+s[a]+s[c]+s[h];return n===1?(d=t[o],l=(d&252)>>2,a=(d&3)<<4,i+=s[l]+s[a]+"=="):n===2&&(d=t[o]<<8|t[o+1],l=(d&64512)>>10,a=(d&1008)>>4,c=(d&15)<<2,i+=s[l]+s[a]+s[c]+"="),i}static download(t,i,s){const r=document.createElement("a"),n=Array.isArray(t)?t:[t],o=new Blob(n,{type:s});r.href=URL.createObjectURL(o),r.download=i,r.click()}static readFileAsync(t){return new Promise((i,s)=>{const r=new FileReader;r.onload=()=>{i(r.result)},r.onerror=s,r.readAsArrayBuffer(t)})}static blobToBase64(t){return new Promise(i=>{const s=new FileReader;s.onloadend=()=>i(s.result),s.readAsDataURL(t)})}static async decompressBase64String(t){const i=atob(t),s=new ArrayBuffer(i.length),r=new Uint8Array(s);for(let n=0;n<i.length;n++)r[n]=i.charCodeAt(n);return Ue.decompressArrayBuffer(r)}static async compressToBase64String(t){const i=await Ue.compressStringToArrayBuffer(t);return Ue.uint8tob64(new Uint8Array(i))}static strToU8(t,i){if(i){const a=new Uint8Array(t.length);for(let c=0;c<t.length;++c)a[c]=t.charCodeAt(c);return a}const s=t.length,r=(a,c,h)=>((h==null||h>a.length)&&(h=a.length),new Uint8Array(a.subarray(c,h)));let n=new Uint8Array(t.length+(t.length>>1)),o=0;const l=a=>{n[o++]=a};for(let a=0;a<s;++a){if(o+5>n.length){const h=new Uint8Array(o+8+(s-a<<1));h.set(n),n=h}let c=t.charCodeAt(a);c<128||i?l(c):c<2048?(l(192|c>>6),l(128|c&63)):(c>55295&&c<57344,c=65536+(c&1047552)|t.charCodeAt(++a)&1023,l(240|c>>18),l(128|c>>12&63),l(128|c>>6&63),l(128|c&63))}return r(n,0,o)}static async compress(t,i="gzip"){const s=new CompressionStream(i),r=s.writable.getWriter();r.write(t).catch(console.error);const n=r.close().catch(console.error),l=await new Response(s.readable).arrayBuffer();return await n,l}static async compressStringToArrayBuffer(t){const i=this.strToU8(t);return await this.compress(i)}static isArrayBufferCompressed(t){if(t&&t.byteLength){const i=new Uint8Array(t);return(i[0]<<8|i[1])===8075}else return!1}static strFromU8(t,i){if(i){let s="";for(let r=0;r<t.length;r+=16384)s+=String.fromCharCode.apply(null,t.subarray(r,r+16384));return s}else{const s=(l,a,c)=>((a==null||a<0)&&(a=0),(c==null||c>l.length)&&(c=l.length),new Uint8Array(l.subarray(a,c))),r=l=>{for(let a="",c=0;;){let h=l[c++];const d=(h>127)+(h>223)+(h>239);if(c+d>l.length)return{s:a,r:s(l,c-1)};d?d===3?(h=((h&15)<<18|(l[c++]&63)<<12|(l[c++]&63)<<6|l[c++]&63)-65536,a+=String.fromCharCode(55296|h>>10,56320|h&1023)):d&1?a+=String.fromCharCode((h&31)<<6|l[c++]&63):a+=String.fromCharCode((h&15)<<12|(l[c++]&63)<<6|l[c++]&63):a+=String.fromCharCode(h)}},{s:n,r:o}=r(t);if(o.length)throw new Error("Unexpected trailing bytes in UTF-8 decoding");return n}}static async decompressArrayBuffer(t){const i=await this.decompress(new Uint8Array(t));return this.strFromU8(i)}static arraysAreEqual(t,i){return Cn(t,i)}static range(t,i,s){return Array.from({length:(i-t)/s+1},(r,n)=>t+n*s)}static sph2cartDeg(t,i){const s=-i*(Math.PI/180),r=(t-90)%360*(Math.PI/180),n=[Math.cos(s)*Math.cos(r),Math.cos(s)*Math.sin(r),Math.sin(s)],o=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);return o<=0||(n[0]/=o,n[1]/=o,n[2]/=o),n}static vox2mm(t,i){const s=It(i);Ht(s,s);const r=xt(t[0],t[1],t[2],1);return Tt(r,r,s),Q(r[0],r[1],r[2])}},ci=P,yt=class Et{static readTRACT(t){const i=t.byteLength;if(i<20)throw new Error("File too small to be niml.tract: bytes = "+i);const s=new DataView(t),r=new Uint8Array(t);let n=0;function o(){for(;n<i&&r[n]!==60;)n++;const g=n;for(;n<i&&r[n]!==62;)n++;return n++,n-g<1?"":new TextDecoder().decode(t.slice(g,n-1)).trim()}let l=o();function a(g){const A=l.indexOf(g);if(A<0)return 0;const p=l.indexOf('"',A)+1,w=l.indexOf('"',p),y=l.slice(p,w);return parseInt(y)}const c=a("N_tracts=");(!l.startsWith("<network")||c<1)&&P.warn("This is not a valid niml.tract file "+l);let h=0;const d=[];d.push(h);const f=[],u=[];for(let g=0;g<c;g++){l=o();const A=a("ni_dimen="),p=a("Bundle_Tag="),w=l.includes("binary.lsbfirst");for(let y=0;y<A;y++){n+=4;const x=s.getUint32(n,w)/3;n+=4;for(let b=0;b<x;b++)f.push(s.getFloat32(n,w)),n+=4,f.push(-s.getFloat32(n,w)),n+=4,f.push(s.getFloat32(n,w)),n+=4;h+=x,d.push(h),u.push(p)}l=o()}const m=[];return m.push({id:"tract",vals:Float32Array.from(u)}),{pts:new Float32Array(f),offsetPt0:new Uint32Array(d),dps:m}}static async readTT(t){let i=new Uint32Array(0),s=new Float32Array(0);const r=await X.readMatV4(t);if(!("trans_to_mni"in r))throw new Error("TT format file must have 'trans_to_mni'");if(!("voxel_size"in r))throw new Error("TT format file must have 'voxel_size'");if(!("track"in r))throw new Error("TT format file must have 'track'");let n=nt();const o=r.trans_to_mni;n=Qt(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],o[9],o[10],o[11],o[12],o[13],o[14],o[15]),Ht(n,n);function l(a){const c=new DataView(a.buffer),h=[];let d=0,f=0;for(;f<a.length;){h.push(f);const g=c.getUint32(f,!0);f=f+g+13,d+=g}i=new Uint32Array(h.length+1),s=new Float32Array(d);let u=0;for(let g=0;g<h.length;g++){i[g]=u/3;let A=h[g];const p=c.getUint32(A,!0)/3;let w=c.getInt32(A+4,!0),y=c.getInt32(A+8,!0),x=c.getInt32(A+12,!0);A+=16,s[u++]=w,s[u++]=y,s[u++]=x;for(let b=2;b<=p;b++)w=w+c.getInt8(A++),y=y+c.getInt8(A++),x=x+c.getInt8(A++),s[u++]=w,s[u++]=y,s[u++]=x}for(let g=0;g<u;g++)s[g]=s[g]/32;let m=0;for(let g=0;g<u/3;g++){const A=xt(s[m],s[m+1],s[m+2],1);Tt(A,A,n),s[m++]=A[0],s[m++]=A[1],s[m++]=A[2]}i[h.length]=u/3}return l(r.track),{pts:s,offsetPt0:i}}static async readTRX(t){function i(u){const m=(u&31744)>>10,g=u&1023;return(u>>15?-1:1)*(m?m===31?g?NaN:1/0:Math.pow(2,m-15)*(1+g/1024):6103515625e-14*(g/1024))}let s=0,r=0,n=new Float32Array([]);const o=[],l=[],a=[],c=[];let h=[],d=!1;const f=new Al(t);for(let u=0;u<f.entries.length;u++){const m=f.entries[u];if(m.uncompressedSize===0)continue;const g=m.fileName.split("/"),A=g.slice(-1)[0];if(A.startsWith("."))continue;const p=g.slice(-2)[0],w=A.split(".")[0],y=await m.extract();if(A.includes("header.json")){const M=new TextDecoder().decode(y);h=JSON.parse(M);continue}let x=0,b=[];if(A.endsWith(".uint64")||A.endsWith(".int64")){x=y.length/8,b=new Uint32Array(x);const M=new Uint32Array(y.buffer);let D=0;for(let v=0;v<x;v++)b[v]=M[D],M[D+1]!==0&&(d=!0),D+=2}else if(A.endsWith(".uint32"))b=new Uint32Array(y.buffer);else if(A.endsWith(".uint16"))b=new Uint16Array(y.buffer);else if(A.endsWith(".uint8"))b=new Uint8Array(y.buffer);else if(A.endsWith(".int32"))b=new Int32Array(y.buffer);else if(A.endsWith(".int16"))b=new Int16Array(y.buffer);else if(A.endsWith(".int8"))b=new Int8Array(y.buffer);else if(A.endsWith(".float64"))b=new Float64Array(y.buffer);else if(A.endsWith(".float32"))b=new Float32Array(y.buffer);else if(A.endsWith(".float16")){x=y.length/2,b=new Float32Array(x);const M=new Uint16Array(y.buffer),D=new Float32Array(65536);for(let v=0;v<65536;v++)D[v]=i(v);for(let v=0;v<x;v++)b[v]=D[M[v]]}else continue;if(x=b.length,p.includes("groups")){l.push({id:w,vals:Float32Array.from(b.slice())});continue}if(p.includes("dpv")){c.push({id:w,vals:Float32Array.from(b.slice())});continue}if(p.includes("dps")){a.push({id:w,vals:Float32Array.from(b.slice())});continue}if(A.startsWith("offsets.")){s=x;for(let M=0;M<x;M++)o[M]=b[M]}A.startsWith("positions.3.")&&(r=x,n=new Float32Array(b))}if(s===0||r===0)throw new Error("Failure reading TRX format (no offsets or points).");if(d)throw new Error("Too many vertices: JavaScript does not support 64 bit integers");return o[s]=r/3,{pts:n,offsetPt0:new Uint32Array(o),dpg:l,dps:a,dpv:c,header:h}}static readTSF(t,i=0){const s=new Float32Array(i),r=t.byteLength;if(r<20)throw new Error("File too small to be TSF: bytes = "+r);const n=new Uint8Array(t);let o=0;function l(){for(;o<r&&n[o]===10;)o++;const f=o;for(;o<r&&n[o]!==10;)o++;return o++,o-f<1?"":new TextDecoder().decode(t.slice(f,o-1))}let a=l();if(!a.includes("mrtrix track scalars"))throw new Error("Not a valid TSF file");let c=-1;for(;o<r&&!a.includes("END");)if(a=l(),a.toLowerCase().startsWith("file:")&&(c=parseInt(a.split(" ").pop())),a.toLowerCase().startsWith("datatype:")&&!a.endsWith("Float32LE"))throw new Error("Only supports TSF files with Float32LE");if(c<20)throw new Error("Not a valid TSF file (missing file offset)");o=c;const h=new DataView(t);let d=0;for(;o+4<=r&&d<i;){const f=h.getFloat32(o,!0);if(o+=4,isFinite(f))s[d++]=f;else if(!isNaN(f))break}return s}static readTCK(t){const i=t.byteLength;if(i<20)throw new Error("File too small to be TCK: bytes = "+i);const s=new Uint8Array(t);let r=0;function n(){for(;r<i&&s[r]===10;)r++;const m=r;for(;r<i&&s[r]!==10;)r++;return r++,r-m<1?"":new TextDecoder().decode(t.slice(m,r-1))}let o=n();if(!o.includes("mrtrix tracks"))throw new Error("Not a valid TCK file");let l=-1;for(;r<i&&!o.includes("END");)o=n(),o.toLowerCase().startsWith("file:")&&(l=parseInt(o.split(" ").pop()));if(l<20)throw new Error("Not a valid TCK file (missing file offset)");r=l;const a=new DataView(t);let c=0,h=new Uint32Array(i/(4*4)),d=0,f=0,u=new Float32Array(i/4);for(h[0]=0;r+12<i;){const m=a.getFloat32(r,!0);r+=4;const g=a.getFloat32(r,!0);r+=4;const A=a.getFloat32(r,!0);if(r+=4,isFinite(m))u[f++]=m,u[f++]=g,u[f++]=A,c++;else if(h[d++]=c,!isNaN(m))break}return u=u.slice(0,f),h=h.slice(0,d),{pts:u,offsetPt0:h}}static async readTRK(t){let i=new DataView(t),s=i.getUint32(0,!0);if(s!==1128354388){let S;if(s===4247762216)throw new Error("zstd TRK decompression is not supported");S=await X.decompress(new Uint8Array(t)),t=S.buffer,i=new DataView(t),s=i.getUint32(0,!0)}const r=i.getUint32(992,!0),n=i.getUint32(996,!0);if(r>2||n!==1e3||s!==1128354388)throw new Error("Not a valid TRK file");const o=i.getInt16(36,!0),l=[];for(let S=0;S<o;S++){const E=new Uint8Array(t.slice(38+S*20,58+S*20)),V=new TextDecoder().decode(E).split("\0").shift();l.push({id:V.trim(),vals:[]})}const a=i.getFloat32(12,!0),c=i.getFloat32(16,!0),h=i.getFloat32(20,!0),d=Qt(1/a,0,0,-.5,0,1/c,0,-.5,0,0,1/h,-.5,0,0,0,1),f=i.getInt16(238,!0),u=[];for(let S=0;S<f;S++){const E=new Uint8Array(t.slice(240+S*20,260+S*20)),V=new TextDecoder().decode(E).split("\0").shift();u.push({id:V.trim(),vals:[]})}const m=nt();for(let S=0;S<16;S++)m[S]=i.getFloat32(440+S*4,!0);m[15]===0&&(P.warn("TRK vox_to_ras not set"),gr(m));const g=nt();Ar(g,d,m);let A=null,p=null;A=new Int32Array(t.slice(n)),p=new Float32Array(A.buffer);const w=A.length;if(w<1)throw new Error("Empty TRK file.");let y=0,x=0,b=new Uint32Array(A.length/4),M=0,D=new Float32Array(A.length),v=0;for(;y<w;){const S=A[y];y=y+1,b[M++]=x;for(let E=0;E<S;E++){const V=p[y+0],T=p[y+1],R=p[y+2];if(y+=3,D[v++]=V*g[0]+T*g[1]+R*g[2]+g[3],D[v++]=V*g[4]+T*g[5]+R*g[6]+g[7],D[v++]=V*g[8]+T*g[9]+R*g[10]+g[11],o>0)for(let N=0;N<o;N++)l[N].vals.push(p[y]),y++;x++}if(f>0)for(let E=0;E<f;E++)u[E].vals.push(p[y]),y++}const C=[];for(let S=0;S<u.length;S++)C.push({id:u[S].id,vals:Float32Array.from(u[S].vals)});const I=[];for(let S=0;S<l.length;S++)I.push({id:l[S].id,vals:Float32Array.from(l[S].vals)});return b[M++]=x,D=D.slice(0,v),b=b.slice(0,M),{pts:D,offsetPt0:b,dps:C,dpv:I}}static readTxtVTK(t){const r=new TextDecoder("utf-8").decode(t).split(`
`);if(r.length<7||!r[0].startsWith("# vtk DataFile"))throw new Error("Invalid VTK image");if(!r[2].startsWith("ASCII"))throw new Error("Not ASCII VTK mesh");let o=3;for(;r[o].length<1;)o++;if(!r[o].includes("POLYDATA"))throw new Error("Not ASCII VTK polydata");for(o++;r[o].length<1;)o++;if(!r[o].startsWith("POINTS"))throw new Error("Not VTK POINTS");let l=r[o].trim().split(/\s+/);const a=parseInt(l[1]),c=a*3,h=new Float32Array(a*3);let d=0;for(;d<a*3;){o++;const g=r[o].trim().trim().split(/\s+/);for(let A=0;A<g.length&&!(d>=c);A++)h[d]=parseFloat(g[A]),d++}const f=[];for(o++;r[o].length<1;)o++;if(r[o].startsWith("METADATA")){for(;r[o].length>1;)o++;o++}if(l=r[o].trim().split(/\s+/),o++,l[0].includes("LINES")){const m=parseInt(l[1]);if(m<1)throw new Error("Corrupted VTK ASCII");let g=r[o].trim();const A=[];let p=[];if(g.startsWith("OFFSETS")){o++;let w=0;for(;w<m;){g=r[o].trim(),o++;const y=g.trim().split(/\s+/);for(let x=0;x<y.length&&(A[w]=parseInt(y[x]),w++,!(w>=m));x++);}p=Array.from(h)}else{let w=function(){g=r[o].trim();const M=g.trim().split(/\s+/);x=[];for(let D=0;D<M.length;D++)x.push(parseInt(M[D]));b=0,o++},y=0;A[0]=0;let x=[],b=0;w();for(let M=0;M<m;M++){b>=x.length&&w();const D=x[b++];y+=D,A[M+1]=y;for(let v=0;v<D;v++){b>=x.length&&w();const C=x[b++]*3;p.push(h[C+0]),p.push(h[C+1]),p.push(h[C+2])}}}return{pts:Float32Array.from(p),offsetPt0:Uint32Array.from(A)}}else if(l[0].includes("TRIANGLE_STRIPS")){const m=parseInt(l[1]);for(let g=0;g<m;g++){const A=r[o].trim();o++;const p=A.trim().split(/\s+/),w=parseInt(p[0])-2;let y=1;for(let x=0;x<w;x++)x%2?(f.push(parseInt(p[y+2])),f.push(parseInt(p[y+1])),f.push(parseInt(p[y]))):(f.push(parseInt(p[y])),f.push(parseInt(p[y+1])),f.push(parseInt(p[y+2]))),y+=1}}else if(l[0].includes("POLYGONS")){const m=parseInt(l[1]);for(let g=0;g<m;g++){const A=r[o].trim();o++;const p=A.trim().split(/\s+/),w=parseInt(p[0])-2,y=parseInt(p[1]);let x=parseInt(p[2]);for(let b=0;b<w;b++){const M=parseInt(p[3+b]);f.push(y),f.push(x),f.push(M),x=M}}}else throw new Error("Unsupported ASCII VTK datatype "+l[0]);const u=new Uint32Array(f);return{positions:h,indices:u}}static async readLayer(t="",i,s,r=.5,n="warm",o="winter",l=!1,a=null,c=null,h=0){const d={...vl,colormapInvert:!1,colormapType:0,isTransparentBelowCalMin:!0,isAdditiveBlend:!1,colorbarVisible:!0,colormapLabel:null},f=/(?:\.([^.]+))?$/;let u=f.exec(t)[1];u=u.toUpperCase(),u==="GZ"&&(u=f.exec(t.slice(0,-3))[1],u=u.toUpperCase());const m=s.vertexCount/3;if(s.offsetPt0){if(u!=="TSF")throw new Error("readLayer for streamlines only supports TSF files.");const p=s.pts.length/3,w=t.split("/");let y="Unknown";w.length>1&&w.pop()&&(y=y.split(".").slice(0,-1).join("."));const x=Et.readTSF(i,p);s.dpv||(s.dpv=[]);const b=x.reduce((D,v)=>Math.min(D,v)),M=x.reduce((D,v)=>Math.max(D,v));return s.dpv.push({id:y,vals:Float32Array.from(x.slice()),global_min:b,global_max:M,cal_min:b,cal_max:M}),d}if(m<3){P.error("n_vert < 3 in layer");return}if(u==="MZ3"){const p=await Et.readMZ3(i,m);d.values=p.scalars,"colormapLabel"in p&&(d.colormapLabel=p.colormapLabel)}else if(u==="ANNOT"){const p=Et.readANNOT(i,m,!0);p instanceof Uint32Array?d.values=p:(d.values=p.scalars,d.colormapLabel=p.colormapLabel)}else if(u==="CRV"||u==="CURV"||u==="THICKNESS"||u==="AREA")d.values=Et.readCURV(i,m),d.isTransparentBelowCalMin=!1;else if(u==="GII"){const p=await Et.readGII(i,m);d.values=p.scalars,d.colormapLabel=p.colormapLabel}else if(u==="MGH"||u==="MGZ"){const p=await Et.readMGH(i,m,!0);"scalars"in p?(d.values=p.scalars,d.colormapLabel=p.colormapLabel):d.values=p}else if(u==="NII")d.values=await Et.readNII(i,m,s.anatomicalStructurePrimary);else if(u==="SMP")d.values=await Et.readSMP(i,m);else if(u==="STC")d.values=Et.readSTC(i,m);else if(Et.isCurv(i))d.values=Et.readCURV(i,m),d.isTransparentBelowCalMin=!1;else return P.warn("Unknown layer overlay format "+t),d;if(!d.values){P.error("no values in layer");return}d.nFrame4D=d.values.length/m,d.frame4D=0,d.outlineBorder=h;let g=d.values[0],A=d.values[0];for(let p=0;p<d.values.length;p++)g=Math.min(g,d.values[p]),A=Math.max(A,d.values[p]);return d.global_min=g,d.global_max=A,d.cal_min=a||0,a||(d.cal_min=g),d.cal_max=c||0,c||(d.cal_max=A),d.cal_minNeg=NaN,d.cal_maxNeg=NaN,d.opacity=r,d.colormap=n,d.colormapNegative=o,d.useNegativeCmap=l,d}static async readSMP(t,i){const s=t.byteLength;let r=new DataView(t),n=r.getUint16(0,!0);if(n>5){const d=await X.decompress(new Uint8Array(t));r=new DataView(d.buffer),n=r.getUint16(0,!0),t=d.buffer}n>5&&P.error("Unsupported or invalid BrainVoyager SMP version "+n);const o=r.getUint32(2,!0);o!==i&&P.error("SMP file has "+o+" vertices, background mesh has "+i);const l=r.getUint16(6,!0),a=new Float32Array(o*l);let c=9;function h(){const d=c;for(;c<s&&r.getUint8(c)!==0;)c++;return c++,new TextDecoder().decode(t.slice(d,c-1))}h();for(let d=0;d<l;d++){const f={};f.mapType=r.getUint32(c,!0),c+=4,n>=3&&f.mapType===3&&(f.nLags=r.getUint32(c,!0),c+=4,f.mnLag=r.getUint32(c,!0),c+=4,f.mxLag=r.getUint32(c,!0),c+=4,f.ccOverlay=r.getUint32(c,!0),c+=4),f.clusterSize=r.getUint32(c,!0),c+=4,f.clusterCheck=r.getUint8(c),c+=1,f.critThresh=r.getFloat32(c,!0),c+=4,f.maxThresh=r.getFloat32(c,!0),c+=4,n>=4&&(f.includeValuesGreaterThreshMax=r.getUint32(c,!0),c+=4),f.df1=r.getUint32(c,!0),c+=4,f.df2=r.getUint32(c,!0),c+=4,n>=5?(f.posNegFlag=r.getUint32(c,!0),c+=4):f.posNegFlag=3,f.cortexBonferroni=r.getUint32(c,!0),c+=4,f.posMinRGB=[0,0,0],f.posMaxRGB=[0,0,0],f.negMinRGB=[0,0,0],f.negMaxRGB=[0,0,0],n>=2&&(f.posMinRGB[0]=r.getUint8(c),c++,f.posMinRGB[1]=r.getUint8(c),c++,f.posMinRGB[2]=r.getUint8(c),c++,f.posMaxRGB[0]=r.getUint8(c),c++,f.posMaxRGB[1]=r.getUint8(c),c++,f.posMaxRGB[2]=r.getUint8(c),c++,n>=4&&(f.negMinRGB[0]=r.getUint8(c),c++,f.negMinRGB[1]=r.getUint8(c),c++,f.negMinRGB[2]=r.getUint8(c),c++,f.negMaxRGB[0]=r.getUint8(c),c++,f.negMaxRGB[1]=r.getUint8(c),c++,f.negMaxRGB[2]=r.getUint8(c),c++),f.enableSMPColor=r.getUint8(c),c++,n>=4&&(f.lut=h()),f.colorAlpha=r.getFloat32(c,!0),c+=4),f.name=h();const u=new Float32Array(t,c,o);a.set(u,d*o),c+=o*4}return a}static readSTC(t,i){const s=new DataView(t),r=s.getInt32(8,!1);if(r!==i)throw new Error("Overlay has "+r+" vertices, expected "+i);let n=12+r*4;const o=s.getUint32(n,!1);n+=4;const l=new Float32Array(o*r);for(let a=0;a<o*r;a++)l[a]=s.getFloat32(n,!1),n+=4;return l}static isCurv(t){const i=new DataView(t),s=i.getUint8(0),r=i.getUint8(1),n=i.getUint8(2);return s!==255||r!==255||n!==255?(ci.debug("Unable to recognize file type: does not appear to be FreeSurfer format."),!1):!0}static readCURV(t,i){const s=new DataView(t),r=s.getUint8(0),n=s.getUint8(1),o=s.getUint8(2),l=s.getUint32(3,!1),a=s.getUint32(11,!1);if((r!==255||n!==255||o!==255)&&ci.debug("Unable to recognize file type: does not appear to be FreeSurfer format."),i!==l)throw new Error("CURV file has different number of vertices ( "+l+")than mesh ("+i+")");if(t.byteLength<15+4*l*a)throw new Error("CURV file smaller than specified");const c=new Float32Array(a*l);let h=15;for(let m=0;m<a*l;m++)c[m]=s.getFloat32(h,!1),h+=4;let d=c[0],f=c[0];for(let m=0;m<c.length;m++)d=Math.min(d,c[m]),f=Math.max(f,c[m]);const u=1/(f-d);for(let m=0;m<c.length;m++)c[m]=1-(c[m]-d)*u;return c}static readANNOT(t,i,s=!1){const r=new DataView(t),n=r.getUint32(0,!1),o=this.decimateLayerVertices(n,i);if(i!==o)throw new Error("ANNOT file has different number of vertices than mesh");if(t.byteLength<4+8*n)throw new Error("ANNOT file smaller than specified");let l=0;const a=new Uint32Array(n);for(let y=0;y<n;y++){const x=r.getUint32(l+=4,!1);a[x]=r.getUint32(l+=4,!1)}if(!s)return a;let c=0;try{c=r.getInt32(l+=4,!1)}catch{return a}if(c!==1||r.getInt32(l+=4,!1)>0)return a;const f=r.getInt32(l+=4,!1),u=r.getInt32(l+=4,!1);l+=u;const m=r.getInt32(l+=4,!1);if(m<1)return a;const g={R:Array(f).fill(0),G:Array(f).fill(0),B:Array(f).fill(0),A:Array(f).fill(0),I:Array(f).fill(0),labels:Array(f).fill("")};for(let y=0;y<m;y++){const x=r.getInt32(l+=4,!1),b=r.getInt32(l+=4,!1);l+=4;let M="";for(let S=0;S<b;S++){const E=r.getUint8(l++);if(E===0)break;M+=String.fromCharCode(E)}l-=4;const D=r.getInt32(l+=4,!1),v=r.getInt32(l+=4,!1),C=r.getInt32(l+=4,!1),I=r.getInt32(l+=4,!1);if(x<0||x>=f){P.warn("annot entry out of range");continue}g.R[x]=D,g.G[x]=v,g.B[x]=C,g.A[x]=I,g.I[x]=(I<<24)+(C<<16)+(v<<8)+D,g.labels[x]=M}const A=new Float32Array(n);A.fill(-1);let p=0;for(let y=0;y<i;y++){const x=a[y];for(let b=0;b<f;b++)if(g.I[b]===x){A[y]=b;break}A[y]<0&&(p++,A[y]=0)}p>0&&P.error(`annot vertex colors do not match ${p} of ${n} vertices.`);for(let y=0;y<f;y++)g.I[y]=y;const w=mt.makeLabelLut(g);return{scalars:A,colormapLabel:w}}static readNV(t){const i=t.byteLength,s=new Uint8Array(t);let r=0;function n(){for(;r<i&&s[r]===10;)r++;const f=r;for(;r<i&&s[r]!==10;)r++;return r++,r-f<1?"":new TextDecoder().decode(t.slice(f,r-1))}let o=0,l=0,a=0,c=0,h,d;for(;r<i;){const f=n();if(f.startsWith("#"))continue;const u=f.trim().split(/\s+/);if(o<1){o=parseInt(u[0]),h=new Float32Array(o*3);continue}if(a<o*3){h[a]=parseFloat(u[0]),h[a+1]=parseFloat(u[1]),h[a+2]=parseFloat(u[2]),a+=3;continue}if(l<1){l=parseInt(u[0]),d=new Uint32Array(l*3);continue}if(c>=l*3)break;d[c+2]=parseInt(u[0])-1,d[c+1]=parseInt(u[1])-1,d[c+0]=parseInt(u[2])-1,c+=3}return{positions:h,indices:d}}static readASC(t){const i=t.byteLength,s=new Uint8Array(t);let r=0;function n(){for(;r<i&&s[r]===10;)r++;const u=r;for(;r<i&&s[r]!==10;)r++;return r++,r-u<1?"":new TextDecoder().decode(t.slice(u,r-1))}let o=n();o.startsWith("#!ascii")||P.warn("Invalid ASC mesh"),o=n();let l=o.trim().split(/\s+/);const a=parseInt(l[0]),c=parseInt(l[1]),h=new Float32Array(a*3);let d=0;for(let u=0;u<a;u++)o=n(),l=o.trim().split(/\s+/),h[d]=parseFloat(l[0]),h[d+1]=parseFloat(l[1]),h[d+2]=parseFloat(l[2]),d+=3;const f=new Uint32Array(c*3);d=0;for(let u=0;u<c;u++)o=n(),l=o.trim().split(/\s+/),f[d]=parseInt(l[0]),f[d+1]=parseInt(l[1]),f[d+2]=parseInt(l[2]),d+=3;return{positions:h,indices:f}}static readVTK(t){const i=t.byteLength;if(i<20)throw new Error("File too small to be VTK: bytes = "+t.byteLength);const s=new Uint8Array(t);let r=0;function n(g=!0){if(g)for(;r<i&&s[r]===10;)r++;const A=r;for(;r<i&&s[r]!==10;)r++;return r++,r-A<1?"":new TextDecoder().decode(t.slice(A,r-1))}let o=n();if(!o.startsWith("# vtk DataFile"))throw new Error("Invalid VTK mesh");if(o=n(!1),o=n(),o.startsWith("ASCII"))return Et.readTxtVTK(t);if(!o.startsWith("BINARY"))throw new Error("Invalid VTK image, expected ASCII or BINARY "+o);if(o=n(),!o.includes("POLYDATA"))throw new Error("Only able to read VTK POLYDATA "+o);o=n(),(!o.includes("POINTS")||!o.includes("double")&&!o.includes("float"))&&P.warn("Only able to read VTK float or double POINTS"+o);const l=o.includes("double");let a=o.trim().split(/\s+/);const h=parseInt(a[1])*3,d=new Float32Array(h),f=new DataView(t);if(l)for(let g=0;g<h;g++)d[g]=f.getFloat64(r,!1),r+=8;else for(let g=0;g<h;g++)d[g]=f.getFloat32(r,!1),r+=4;o=n(),a=o.trim().split(/\s+/);const u=[];if(a[0].includes("LINES")){const g=parseInt(a[1]),A=r;if(o=n(),o.startsWith("OFFSETS")){let x=!1;o.includes("int64")&&(x=!0);const b=new Uint32Array(g);if(x){let D=!1;for(let v=0;v<g;v++){let C=f.getInt32(r,!1);C!==0&&(D=!0),r+=4,C=f.getInt32(r,!1),r+=4,b[v]=C}D&&P.warn("int32 overflow: JavaScript does not support int64")}else for(let D=0;D<g;D++){const v=f.getInt32(r,!1);r+=4,b[D]=v}return{pts:d,offsetPt0:b}}r=A;let p=0;const w=[],y=[];w.push(p);for(let x=0;x<g;x++){const b=f.getInt32(r,!1);r+=4,p+=b,w.push(p);for(let M=0;M<b;M++){const D=f.getInt32(r,!1)*3;r+=4,y.push(d[D+0]),y.push(d[D+1]),y.push(d[D+2])}}return{pts:Float32Array.from(y),offsetPt0:Uint32Array.from(w)}}else if(a[0].includes("TRIANGLE_STRIPS")){const g=parseInt(a[1]);for(let A=0;A<g;A++){const p=f.getInt32(r,!1)-2;r+=4;for(let w=0;w<p;w++)w%2?(u.push(f.getInt32(r+8,!1)),u.push(f.getInt32(r+4,!1)),u.push(f.getInt32(r,!1))):(u.push(f.getInt32(r,!1)),u.push(f.getInt32(r+4,!1)),u.push(f.getInt32(r+8,!1))),r+=4;r+=8}}else if(a[0].includes("POLYGONS")){const g=parseInt(a[1]);for(let A=0;A<g;A++){const p=f.getInt32(r,!1)-2;if(A===0&&p>65535)throw new Error("Invalid VTK binary polygons using little-endian data (MRtrix)");r+=4;const w=f.getInt32(r,!1);r+=4;let y=f.getInt32(r,!1);r+=4;for(let x=0;x<p;x++){const b=f.getInt32(r,!1);r+=4,u.push(w),u.push(y),u.push(b),y=b}}}else throw new Error("Unsupported binary VTK datatype "+a[0]);const m=new Uint32Array(u);return{positions:d,indices:m}}static readWRL(t){const i=new TextDecoder("utf-8").decode(t),s=/coord\s+Coordinate\s*\{\s*point\s*\[([\s\S]*?)\]/,r=/coordIndex\s*\[([\s\S]*?)\]/,n=/color\s+Color\s*\{\s*color\s*\[([\s\S]*?)\]/,o=s.exec(i),l=r.exec(i),a=n.exec(i);if(!o||!l)throw new Error("Invalid WRL file: Could not find vertices or indices.");const c=new Float32Array(o[1].trim().split(/[\s,]+/).map(Number));let h=null;if(a){h=new Float32Array(a[1].trim().split(/[\s,]+/).map(Number));const f=c.length/3;h.length!==f*3&&(console.warn(`Unexpected color count: expected ${f*3}, got ${h.length}`),h=null)}const d=new Uint32Array(l[1].trim().split(/[\s,]+/).map(Number).filter(f=>f!==-1));return{positions:c,indices:d,colors:h}}static readDFS(t){const i=new DataView(t),s=i.getUint32(0,!0),r=i.getUint16(4,!0);(s!==1599292996||r!==17740)&&P.warn("Not a little-endian brainsuite DFS mesh");const n=i.getUint32(12,!0),o=i.getUint32(24,!0),l=i.getUint32(28,!0),a=i.getUint32(48,!0);let c=n;const h=new Uint32Array(t,c,o*3);c+=o*3*4;const d=new Float32Array(t,c,l*3);for(let u=0;u<l*3;u+=3){const m=d[u];d[u]=d[u+1],d[u+1]=m}let f;return a>=0&&(f=new Float32Array(t,a,l*3)),{positions:d,indices:h,colors:f}}static async readMZ3(t,i=0){if(t.byteLength<20)throw new Error("File too small to be mz3: bytes = "+t.byteLength);let s=new DataView(t),r=s.getUint16(0,!0),n=t;if(r===35615||r===8075){const M=await X.decompress(new Uint8Array(t));s=new DataView(M.buffer),r=s.getUint16(0,!0),n=M.buffer}const o=s.getUint16(2,!0),l=s.getUint32(4,!0);let a=s.getUint32(8,!0);const c=s.getUint32(12,!0);if(ci.debug("MZ3 magic %d attr %d face %d vert %d skip %d",r,o,l,a,c),r!==23117)throw new Error("Invalid MZ3 file");const h=(o&1)!==0,d=(o&2)!==0,f=(o&4)!==0;let u=(o&8)!==0;const m=(o&16)!==0;if(o>63)throw new Error("Unsupported future version of MZ3 file");let g=4;m&&(g=8);let A=0;if(i>0&&!h&&l<1&&!f&&(u=!0),u){let M=i;i===0&&(M=a);const D=16+c+(h?1:0)*l*12+(d?1:0)*M*12+(f?1:0)*M*4,v=Math.floor((n.byteLength-D)/g);a!==i&&v%i===0&&(P.warn("Issue 729: mz3 mismatch scalar NVERT does not match mesh NVERT"),a=i),A=Math.floor(v/a),A<1&&(P.warn("Corrupt MZ3: file reports NSCALAR but not enough bytes"),u=!1)}if(a<3&&i<3)throw new Error("Not a mesh MZ3 file (maybe scalar)");i>0&&i!==a&&P.warn("Layer has "+a+"vertices, but background mesh has "+i);let p=16+c,w=null;h&&(w=new Uint32Array(n,p,l*3),p+=l*3*4);let y=null;d&&(y=new Float32Array(n,p,a*3),p+=a*3*4);let x=null;if(f){x=new Float32Array(a*3);const M=new Uint8Array(n,p,a*4);p+=a*4;let D=0,v=0;for(let C=0;C<a;C++){for(let I=0;I<3;I++)x[D]=M[v]/255,D++,v++;v++}}let b=new Float32Array;if((!f||i>0)&&u&&A>0){if(m){const M=new Float64Array(n,p,A*a);b=Float32Array.from(M)}else b=new Float32Array(n,p,A*a);p+=g*A*a}if(i>0&&f&&u){let M=b[0];for(let C=0;C<a;C++)M=Math.max(M,b[C]);const D={R:[],G:[],B:[],A:[],I:[],labels:[]};for(let C=0;C<=M;C++)for(let I=0;I<a;I++)if(C===b[I]){const S=I*3;D.I.push(C),D.R.push(x[S]*255),D.G.push(x[S+1]*255),D.B.push(x[S+2]*255),D.A.push(255),D.labels.push(`${C}`);break}const v=mt.makeLabelLut(D);return{scalars:b,colormapLabel:v}}return i>0?{scalars:b}:{positions:y,indices:w,scalars:b,colors:x}}static readPLY(t){const i=t.byteLength,s=new Uint8Array(t);let r=0;function n(){for(;r<i&&s[r]===10;)r++;const v=r;for(;r<i&&s[r]!==10;)r++;return r++,r-v<1?"":new TextDecoder().decode(t.slice(v,r-1))}let o=n();if(!o.startsWith("ply"))throw new Error("Not a valid PLY file");o=n();const l=o.includes("ascii");function a(v){if(v==="char"||v==="uchar"||v==="int8"||v==="uint8")return 1;if(v==="short"||v==="ushort"||v==="int16"||v==="uint16")return 2;if(v==="int"||v==="uint"||v==="int32"||v==="uint32"||v==="float"||v==="float32")return 4;if(v==="double")return 8;throw new Error("Unknown data type: "+v)}const c=o.includes("binary_little_endian");let h=0,d=!1,f=0,u=0,m=0,g=0,A=0,p=0,w=0;for(;r<i&&!o.startsWith("end_header");){if(o=n(),o.startsWith("comment"))continue;let v=o.split(/\s/);if(o.startsWith("element vertex"))for(h=parseInt(v[v.length-1]),o=n(),v=o.split(/\s/);o.startsWith("property");){const C=v[1];v[2]==="x"&&C.startsWith("double")?d=!0:v[2]==="x"&&!C.startsWith("float")&&P.error("Error: expect ply xyz to be float or double: "+o),f+=a(C),o=n(),v=o.split(/\s/)}if(o.startsWith("element face"))for(w=parseInt(v[v.length-1]),o=n(),v=o.split(/\s/);o.startsWith("property");){if(v[1]==="list")m=a(v[2]),g=a(v[3]),u+=m+3*g;else{const C=a(v[1]);u+=C,g===0&&(A+=C,p++)}o=n(),v=o.split(/\s/)}}if(l){w<1&&P.error(`Malformed ply format: faces ${w} `);const v=new Float32Array(h*3);let C=0;for(let E=0;E<h;E++){o=n();const V=o.split(/\s/);v[C]=parseFloat(V[0]),v[C+1]=parseFloat(V[1]),v[C+2]=parseFloat(V[2]),C+=3}let I=new Uint32Array(w*3),S=0;for(let E=0;E<w;E++){o=n();const V=o.split(/\s/),T=parseInt(V[p])-2;if(T<1)break;if(S+T*3>I.length){const O=new Uint32Array(I.length+I.length);O.set(I),I=O.slice()}const R=parseInt(V[p+1]);let N=parseInt(V[p+2]);for(let O=0;O<T;O++){const G=parseInt(V[p+3+O]);I[S+0]=R,I[S+1]=N,I[S+2]=G,N=G,S+=3}}return I.length!==S&&(I=I.slice(0,S)),{positions:v,indices:I}}(f<12||m<1||g<1||w<1)&&P.warn(`Malformed ply format: stride ${f} count ${m} iBytes ${g} iStrideBytes ${u} iPadBytes ${A} faces ${w}`);const y=new DataView(t);let x;if(r%4===0&&f===12&&c)x=new Float32Array(t,r,h*3),r+=h*f;else{x=new Float32Array(h*3);let v=0;for(let C=0;C<h;C++)d?(x[v]=y.getFloat64(r,c),x[v+1]=y.getFloat64(r+8,c),x[v+2]=y.getFloat64(r+16,c)):(x[v]=y.getFloat32(r,c),x[v+1]=y.getFloat32(r+4,c),x[v+2]=y.getFloat32(r+8,c)),v+=3,r+=f}const b=new Uint32Array(w*3);let M=!0,D=0;if(m===1&&g===4&&u===13)for(let v=0;v<w;v++){const C=y.getUint8(r);r+=m,C!==3&&(M=!1),b[D]=y.getUint32(r,c),r+=4,b[D+1]=y.getUint32(r,c),r+=4,b[D+2]=y.getUint32(r,c),r+=4,D+=3}else{let v=r;for(let C=0;C<w;C++){r=v+A;let I=0;m===1?I=y.getUint8(r):m===2?I=y.getUint16(r,c):m===4&&(I=y.getUint32(r,c)),r+=m,I!==3&&(M=!1);for(let S=0;S<3;S++)g===1?b[D]=y.getUint8(r):g===2?b[D]=y.getUint16(r,c):g===4&&(b[D]=y.getUint32(r,c)),D++,r+=g;v+=u}}return M||P.warn("Only able to read PLY meshes limited to triangles."),{positions:x,indices:b}}static readICO(t){const r=new TextDecoder("utf-8").decode(t).split(`
`);let n=r[0].trim().split(/\s+/);n.length>1&&P.warn("This is not a valid FreeSurfer ICO/TRI mesh.");const o=parseInt(n[0]),l=new Float32Array(o*3);let a=1;for(let d=0;d<o;d++){const f=r[a].trim().split(/\s+/);a++;let u=parseInt(f[0])-1;const m=parseFloat(f[1]),g=parseFloat(f[2]),A=parseFloat(f[3]);if(u<0||u>=o){P.error("ICO vertices corrupted");break}u*=3,l[u]=m,l[u+1]=g,l[u+2]=A}n=r[a].trim().split(/\s+/),a++;const c=parseInt(n[0]),h=new Uint32Array(c*3);for(let d=0;d<c;d++){const f=r[a].trim().split(/\s+/);a++;let u=parseInt(f[0])-1;const m=parseInt(f[1])-1,g=parseInt(f[2])-1,A=parseInt(f[3])-1;if(u<0||u>=c){P.error("ICO indices corrupted");break}u*=3,h[u]=m,h[u+1]=g,h[u+2]=A}for(let d=0;d<h.length;d+=3){const f=h[d];h[d]=h[d+1],h[d+1]=f}return{positions:l,indices:h}}static readGEO(t,i=!1){const n=new TextDecoder("utf-8").decode(t).split(`
`),o=n[0].trim().split(/\s+/),l=parseInt(o[0]);let a=parseInt(o[1]),c=parseInt(o[2]);const h=parseInt(o[3]);(l>1||h!==c*3)&&P.warn("Multi-part BYU/GEO header or not a triangular mesh.");const d=[];a*=3;let f=0,u=2;for(;f<a;){const w=n[u].trim().split(/\s+/);u++;for(let y=0;y<w.length&&(d.push(parseFloat(w[y])),f++,!(f>=a));y++);}const m=[];c*=3;let g=0;for(;g<c;){const w=n[u].trim().split(/\s+/);u++;for(let y=0;y<w.length&&(m.push(Math.abs(parseInt(w[y]))-1),g++,!(g>=c));y++);}if(i)for(let w=0;w<m.length;w+=3){const y=m[w];m[w]=m[w+1],m[w+1]=y}const A=new Float32Array(d),p=new Uint32Array(m);return{positions:A,indices:p}}static readOFF(t){const r=new TextDecoder("utf-8").decode(t).split(`
`),n=[],o=[];let l=0;r[l].includes("OFF")?l++:P.warn("File does not start with OFF");let a=r[l].trim().split(/\s+/);const c=parseInt(a[0]),h=parseInt(a[1]);l++;for(let u=0;u<c;u++)a=r[l].trim().split(/\s+/),n.push(parseFloat(a[0])),n.push(parseFloat(a[1])),n.push(parseFloat(a[2])),l++;for(let u=0;u<h;u++)a=r[l].trim().split(/\s+/),parseInt(a[0])!==3&&P.warn("Only able to read OFF files with triangular meshes"),o.push(parseInt(a[1])),o.push(parseInt(a[2])),o.push(parseInt(a[3])),l++;const d=new Float32Array(n),f=new Uint32Array(o);return{positions:d,indices:f}}static readOBJMNI(t){const r=new TextDecoder("utf-8").decode(t).trim().split(/\s*,\s*|\s+/);(r.length<1||r[0]!=="P")&&P.warn("This is not a valid MNI OBJ mesh.");let n=6;const o=parseInt(r[n++]),l=o*3,a=new Float32Array(l);for(let m=0;m<l;m++)a[m]=parseFloat(r[n++]);n+=l;const c=parseInt(r[n++]),h=parseInt(r[n++]);(c<1||h<0||h>2)&&P.warn("This is not a valid MNI OBJ mesh.");let d=1;h===1?d=c:h===1&&(d=o),n+=d*4,n+=c;const f=c*3,u=new Uint32Array(f);for(let m=0;m<f;m++)u[m]=parseInt(r[n++]);return{positions:a,indices:u}}static async readOBJ(t){const i=new Uint8Array(t,0,2);i[0]===31&&i[1]===139&&(t=await X.decompressToBuffer(new Uint8Array(t)));const r=new TextDecoder("utf-8").decode(t);if(r[0]==="P")return this.readOBJMNI(t);const n=r.split(`
`),o=n.length,l=[],a=[];for(let u=0;u<o;u++){const m=n[u];if(m[0]==="v"&&m[1]===" "){const g=m.trim().split(/\s+/);l.push(parseFloat(g[1])),l.push(parseFloat(g[2])),l.push(parseFloat(g[3]))}if(m[0]==="f"){const g=m.trim().split(/\s+/),A=g.length-3;if(A<1)break;let p=g[1].split("/");const w=parseInt(p[0])-1;p=g[2].split("/");let y=parseInt(p[0])-1;for(let x=0;x<A;x++){p=g[3+x].split("/");const b=parseInt(p[0])-1;a.push(w),a.push(y),a.push(b),y=b}}}const c=new Float32Array(l),h=new Uint32Array(a);let d=h[0],f=h[0];for(let u=1;u<h.length;u++)h[u]<d&&(d=h[u]),h[u]>f&&(f=h[u]);if(f-d+1>c.length/3)throw new Error("Not a valid OBJ file");for(let u=0;u<h.length;u++)h[u]-=d;return{positions:c,indices:h}}static readFreeSurfer(t){const i=new Uint8Array(t);if(i[0]===35&&i[1]===33&&i[2]===97)return Et.readASC(t);const s=new DataView(t),r=s.getUint32(0,!1),n=s.getUint32(4,!1);(r!==4294966883||n!==1919246708)&&ci.debug("Unable to recognize file type: does not appear to be FreeSurfer format.");let o=0;for(;s.getUint8(o)!==10;)o++;o+=2;let l=s.getUint32(o,!1);o+=4;let a=s.getUint32(o,!1);o+=4,l*=3;const c=new Float32Array(l);for(let u=0;u<l;u++)c[u]=s.getFloat32(o,!1),o+=4;a*=3;const h=new Uint32Array(a);for(let u=0;u<a;u++)h[u]=s.getUint32(o,!1),o+=4;const d=s.getUint32(o,!1);o+=4;let f=d===20;if(!f){const u=s.getUint32(o,!1);o+=4;const m=s.getUint32(o,!1);o+=4,f=d===2&&u===0&&m===20}if(!f)P.warn("Unknown FreeSurfer Mesh extension code.");else{const m=new TextDecoder().decode(t.slice(o)).trim().split(`
`);for(let g=0;g<m.length;g++){if(!m[g].startsWith("cras"))continue;const p=m[g].split("=")[1].trim().split(" ").map(Number),w=Math.floor(c.length/3);let y=0;for(let x=0;x<w;x++)c[y]+=p[0],y++,c[y]+=p[1],y++,c[y]+=p[2],y++}}return{positions:c,indices:h}}static async readSRF(t){const i=new Uint8Array(t);if(i[0]===35&&i[1]===33&&i[2]===97)return Et.readASC(t);i[0]===31&&i[1]===139&&(t=(await X.decompress(new Uint8Array(t))).buffer);const s=new DataView(t),r=s.getFloat32(0,!0),n=s.getUint32(8,!0),o=s.getUint32(12,!0),l=s.getFloat32(16,!0),a=s.getFloat32(20,!0),c=s.getFloat32(24,!0),h=new Float32Array(n*3);let d=28,f=1;for(let M=0;M<n;M++)h[f]=-s.getFloat32(d,!0)+l,f+=3,d+=4;f=2;for(let M=0;M<n;M++)h[f]=-s.getFloat32(d,!0)+a,f+=3,d+=4;f=0;for(let M=0;M<n;M++)h[f]=-s.getFloat32(d,!0)+c,f+=3,d+=4;d=28+4*6*n;const u=s.getFloat32(d,!0),m=s.getFloat32(d+4,!0),g=s.getFloat32(d+8,!0),A=s.getFloat32(d+16,!0),p=s.getFloat32(d+20,!0),w=s.getFloat32(d+24,!0);d+=8*4;const y=new Float32Array(n*3),x=new Uint32Array(t,d,n);f=0;for(let M=0;M<n;M++){const D=x[M];D>1056964608&&(y[f+0]=(D>>16&255)/255,y[f+1]=(D>>8&255)/255,y[f+2]=(D&255)/255),D===0&&(y[f+0]=u,y[f+1]=m,y[f+2]=g),D===1&&(y[f+0]=A,y[f+1]=p,y[f+2]=w),f+=3}d+=n*4;for(let M=0;M<n;M++){const D=s.getUint32(d,!0);d+=4+4*D}const b=new Uint32Array(o*3);for(let M=0;M<o*3;M++)b[M]=s.getInt32(d,!0),d+=4;return r!==4&&P.warn("Not valid SRF"),{positions:h,indices:b,colors:y}}static readTxtSTL(t){const r=new TextDecoder("utf-8").decode(t).split(`
`);if(!r[0].startsWith("solid"))throw new Error("Not a valid STL file");const n=[];for(let c=1;c<r.length;c++){if(!r[c].includes("vertex"))continue;const h=r[c].trim().split(/\s+/);for(let d=1;d<h.length;d++)n.push(parseFloat(h[d]))}const o=Math.floor(n.length/3);if(o*3!==n.length)throw new Error("Unable to parse ASCII STL file.");const l=new Float32Array(n),a=new Uint32Array(o);for(let c=0;c<o;c++)a[c]=c;return{positions:l,indices:a}}static readSTL(t){if(t.byteLength<134)throw new Error("File too small to be STL: bytes = "+t.byteLength);const i=new DataView(t);if(i.getUint32(0,!0)===1768714099)return Et.readTxtSTL(t);const r=i.getUint32(80,!0),n=3*r;if(t.byteLength<84+r*50)throw new Error("STL file too small to store triangles = "+r);const o=new Uint32Array(n),l=new Float32Array(n*3);let a=96,c=0;for(let h=0;h<r;h++){for(let d=0;d<9;d++)l[c]=i.getFloat32(a,!0),c+=1,a+=4;a+=14}for(let h=0;h<n;h++)o[h]=h;return{positions:l,indices:o}}static decimateLayerVertices(t,i){if(t%i===0)return t;const s=12,r=Math.round(Math.log((t-2)/(s-2))/Math.log(4)),n=Math.round(Math.log((i-2)/(s-2))/Math.log(4)),o=Math.pow(4,r)*(s-2)+2,l=Math.pow(4,n)*(s-2)+2;return o!==t||l!==i?t:i}static async readNII2(t,i=0,s=""){let r=new Float32Array;const n=t.byteLength;let o=!0;const l=new DataView(t);let a=l.getUint16(0,o);if(a===469893120&&(o=!1,a=l.getUint16(0,o)),a!==540)throw new Error("Not a valid NIfTI-2 dataset");const c=Number(l.getBigInt64(168,o)),h=l.getFloat64(176,o),d=l.getFloat64(184,o);(h!==1||d!==0)&&P.warn("ignoring scale slope and intercept");const f=l.getUint32(504,o),u=l.getUint16(12,o);if(u!==2&&u!==4&&u!==8&&u!==16)throw new Error("Unsupported NIfTI datatype "+u);let m=1;const g=[1,1,1,1,1,1,1,1];for(let A=1;A<8;A++)g[A]=Math.max(Number(l.getBigInt64(16+A*8,o)),1),m*=g[A];if(f>=3e3&&f<=3099&&c>580){let A=function(){for(;C<n&&v[C]===10;)C++;const N=C;for(;C<n&&v[C]!==10;)C++;return C++,C-N<1?"":new TextDecoder().decode(t.slice(N,C-1)).trim()},p=function(){let N=A();if(!N.startsWith("<")||N.endsWith(">"))return N;for(;C<n&&!N.endsWith(">");)N+=A();return N},w=function(N,O=!1){const G=I.indexOf(N);if(G<0)return 1;const z=I.indexOf('"',G)+1,q=I.indexOf('"',z),J=I.slice(z,q);return O?J:parseInt(J)},y=0,x=0,b=0,M="",D=new Uint32Array;const v=new Uint8Array(t);let C=552,I;const S=g[5],E=new Float32Array(i*S);for(;C<n&&(I=p(),!I.includes("</CIFTI>"));)if(I.includes("<BrainModel")){const N=w("SurfaceNumberOfVertices="),O=w("BrainStructure=",!0).toUpperCase();if(N%i!==0)continue;let G=!1;if(s.includes("CORTEX")&&O.includes("CORTEX")&&(G=!0),!G||(G=!1,s.includes("LEFT")&&O.includes("LEFT")&&(G=!0),s.includes("RIGHT")&&O.includes("RIGHT")&&(G=!0),!G))continue;if(b=N,y=w("IndexOffset="),x=w("IndexCount="),M=O,I.includes("<VertexIndices>")||(I=p()),!I.startsWith("<VertexIndices>")||!I.endsWith("</VertexIndices>"))return P.warn("Unable to find CIfTI <VertexIndices>"),E;I=I.slice(15,-16);const z=I.trim().split(/\s+/);z.length<x&&P.error("Error parsing VertexIndices"),D=new Uint32Array(x);for(let q=0;q<x;q++)D[q]=parseInt(z[q])}if(b===0||D.length===0)return P.warn("Unable to find CIfTI structure that matches the mesh."),E;if(u!==16)return P.warn("Only able to read float32 CIfTI (only known datatype)."),E;const V=new Float32Array(x*S),T=c+S*y*4;for(let N=0;N<x*S;N++)V[N]=l.getFloat32(T+N*4,o);let R=0;for(let N=0;N<x;N++)for(let O=0;O<S;O++)E[D[N]+O*i]=V[R],R++;return P.debug("CIfTI diagnostics",b,M,y,x,y,s),E}if(m=this.decimateLayerVertices(m,i),m%i!==0)throw new Error("Vertices in layer ("+m+") is not a multiple of number of vertices ("+i+")");if(o)u===16?r=new Float32Array(t,c,m):u===8?r=new Int32Array(t,c,m):u===4&&(r=new Int16Array(t,c,m));else if(u===16){r=new Float32Array(m);for(let A=0;A<m;A++)r[A]=l.getFloat32(c+A*4,o)}else if(u===8){r=new Int32Array(m);for(let A=0;A<m;A++)r[A]=l.getInt32(c+A*4,o)}else if(u===4){r=new Int16Array(m);for(let A=0;A<m;A++)r[A]=l.getInt16(c+A*2,o)}return u===2&&(r=new Uint8Array(t,c,m)),r}static async readNII(t,i=0,s=""){let r=new Float32Array,n=!0,o=new DataView(t),l=o.getUint16(0,n);if(l===540||l===469893120)return Et.readNII2(t,i,s);if(l===23553&&(n=!1,l=o.getUint16(0,n)),l!==348){const u=await X.decompress(new Uint8Array(t));if(o=new DataView(u.buffer),t=u.buffer,l=o.getUint16(0,n),l===540||l===469893120)return Et.readNII2(t,i,s);l===23553&&(n=!1,l=o.getUint16(0,n))}l!==348&&P.error("Not a valid NIfTI image.");const a=o.getFloat32(108,n),c=o.getFloat32(112,n),h=o.getFloat32(116,n);(c!==1||h!==0)&&P.warn("ignoring scale slope and intercept");const d=o.getUint16(70,n);if(d!==2&&d!==4&&d!==8&&d!==16)throw new Error("Unsupported NIfTI datatype "+d);let f=1;for(let u=1;u<8;u++){const m=o.getUint16(40+u*2,n);f*=Math.max(m,1)}if(f=this.decimateLayerVertices(f,i),f%i!==0)throw new Error("Vertices in layer ("+f+") is not a multiple of number of vertices ("+i+")");if(n)d===16?r=new Float32Array(t,a,f):d===8?r=new Int32Array(t,a,f):d===4&&(r=new Int16Array(t,a,f));else if(d===16){r=new Float32Array(f);for(let u=0;u<f;u++)r[u]=o.getFloat32(a+u*4,n)}else if(d===8){r=new Int32Array(f);for(let u=0;u<f;u++)r[u]=o.getInt32(a+u*4,n)}else if(d===4){r=new Int16Array(f);for(let u=0;u<f;u++)r[u]=o.getInt16(a+u*2,n)}return d===2&&(r=new Uint8Array(t,a,f)),r}static async readMGH(t,i=0,s=!1){let r=new DataView(t),n=t;if(r.getUint8(0)===31&&r.getUint8(1)===139){const D=await X.decompress(new Uint8Array(t));n=new ArrayBuffer(D.byteLength),new Uint8Array(n).set(new Uint8Array(D)),r=new DataView(D.buffer)}const o=r.getInt32(0,!1),l=Math.max(1,r.getInt32(4,!1)),a=Math.max(1,r.getInt32(8,!1)),c=Math.max(1,r.getInt32(12,!1)),h=Math.max(1,r.getInt32(16,!1)),d=r.getInt32(20,!1);let f=284;const u=!1;(o!==1||d<0||d>4)&&P.warn("Not a valid MGH file");let m=l*a*c*h,g=[];if(m=this.decimateLayerVertices(m,i),m%i!==0)return P.warn("Vertices in layer ("+m+") is not a multiple of number of vertices ("+i+")"),g;if(d===3){g=new Float32Array(m);for(let D=0;D<m;D++)g[D]=r.getFloat32(f+D*4,u)}else if(d===1){g=new Int32Array(m);for(let D=0;D<m;D++)g[D]=r.getInt32(f+D*4,u)}else if(d===4){g=new Int16Array(m);for(let D=0;D<m;D++)g[D]=r.getInt16(f+D*2,u)}else d===0&&(g=new Uint8Array(t,f,m));if(!s)return g;let A=4;d===4&&(A=2),d===0&&(A=1),f+=A*m,f+=4*4;const p=1,w=2,y=20,x=30,b=n.byteLength;let M;for(;f<b-8;){const D=r.getInt32(f+=4,u);let v=0;switch(D){case x:v=r.getInt32(f+=4,u)-1;break;case y:case w:v=0;break;case p:v=0;{let C=r.getInt32(f+=4,u);if(C>0)return P.warn("unsupported CTABreadFromBinaryV1"),g;if(C=-C,C!==2)return P.warn("CTABreadFromBinary: unknown version"),g;const I=r.getInt32(f+=4,u);if(I<0)return P.warn("CTABreadFromBinaryV2: nentries was ",I),g;const S=r.getInt32(f+=4,u);f+=S;const E=r.getInt32(f+=4,u);if(E<0)return g;const V={R:[],G:[],B:[],A:[],I:[],labels:[]};for(let T=0;T<E;T++){const R=r.getInt32(f+=4,u),N=r.getInt32(f+=4,u);let O=f+4,G="";for(let tt=0;tt<N;tt++){const $=r.getUint8(O++);if($===0)break;G+=String.fromCharCode($)}f+=N;const z=r.getInt32(f+=4,u),q=r.getInt32(f+=4,u),J=r.getInt32(f+=4,u),_=255-r.getInt32(f+=4,u);V.I.push(R),V.R.push(z),V.G.push(q),V.B.push(J),V.A.push(_),V.labels.push(G)}M=mt.makeLabelLut(V)}break;default:v=r.getInt32(f+=8,u)}f+=v}return{scalars:g,colormapLabel:M}}static readX3D(t){const i=t.byteLength;if(i<20)throw new Error("File too small to be X3D: bytes = "+i);const s=new Uint8Array(t);let r=0;function n(){for(;r<i&&s[r]!==60;)r++;const y=r;for(;r<i&&s[r]!==62;)r++;const x=r;return new TextDecoder().decode(t.slice(y,x+1)).trim()}let o=n();function l(y){const x=o.indexOf(y+"=");if(x<0)return"";const b=o[x+y.length+1],M=o.indexOf(b,x)+1,D=o.indexOf(b,M);return o.slice(M,D)}function a(y){const x=o.indexOf(y+"=");if(x<0)return 1;const b=o[x+y.length+1],M=o.indexOf(b,x)+1,D=o.indexOf(b,M);let v=o.slice(M,D).trim();v=v.replace(/,\s*$/,"");const C=v.trim().split(/\s*,\s*|\s+/);if(C.length<2)return parseFloat(v);let I=new Array(C.length),S=0;for(let E=0;E<C.length;E++){const V=parseFloat(C[E]);isFinite(V)&&(I[S]=V,S++)}return I=I.slice(0,S),I}o.includes("xml version")||P.warn("Not a X3D image");let c=[],h=[],d=[],f=[],u=[0,0,0,0],m=[0,0,0,0],g=[255,255,255,255],A=[255,255,255,255];const p={};function w(){if(!o.endsWith("/>"))if(o.startsWith("<Appearance>"))for(;r<i&&!o.endsWith("</Appearance>");)o+=n();else for(;r<i&&!o.endsWith("/>");)o+=n();const y=l("USE");if(y.length>1){y in p?g=p[y]:P.warn("Unable to find DEF for "+y);return}const x=a("diffuseColor");if(x.length<3)return;g[0]=Math.round(x[0]*255),g[1]=Math.round(x[1]*255),g[2]=Math.round(x[2]*255);const b=l("DEF");b.length<1||(p[b]=g)}for(;r<i;)if(o=n(),g=A.slice(),o.startsWith("<Transform")&&(u=a("translation"),m=a("rotation")),o.startsWith("<Appearance")&&(w(),A=g.slice()),o.startsWith("<Shape")){let y=1,x=1,b=[],M=[];for(;r<i&&(o=n(),o.startsWith("<Appearance")&&w(),!o.startsWith("</Shape"));){if(o.startsWith("<Sphere")&&(y=a("radius"),x=-1),o.startsWith("<Cylinder")&&(y=a("radius"),x=a("height")),o.startsWith("<IndexedFaceSet")&&(x=-2,b=a("coordIndex")),o.startsWith("<IndexedTriangleSet")&&(x=-7,b=a("index")),o.startsWith("<IndexedTriangleStripSet")&&(x=-3,b=a("index")),o.startsWith("<Coordinate")){M=a("point");const D=M.length%3;D!==0&&(M=M.slice(0,-D))}o.startsWith("<Color")&&(f=a("color")),o.startsWith("<Box")&&(x=-4,P.warn("Unsupported x3d shape: Box")),o.startsWith("<Cone")&&(x=-5,P.warn("Unsupported x3d shape: Cone")),o.startsWith("<ElevationGrid")&&(x=-6,P.warn("Unsupported x3d shape: ElevationGrid"))}if(!(x<-3&&x!==-7))if(x<-1){if(b.length<1||M.length<3||M.length===void 0){P.warn("Indexed mesh must specify indices and points");break}const D=Math.floor(c.length/3);let v=2;if(x===-7)h=[...h,...b];else if(x===-2){let S=0;for(;v<b.length;)b[v]>=0?(h.push(b[S]+D),h.push(b[v-1]+D),h.push(b[v-0]+D),v+=1):(v+=3,S=v-2)}else for(;v<b.length;)b[v]>=0?(h.push(b[v-2]+D),h.push(b[v-1]+D),h.push(b[v-0]+D),v+=1):v+=3;c=[...c,...M];const C=Math.floor(M.length/3),I=Array(C).fill(g).flat();if(f.length===C*3){let S=0,E=0;for(let V=0;V<C;V++){for(let T=0;T<3;T++)I[E]=Math.round(f[S]*255),S++,E++;E++}}d=[...d,...I]}else if(x<0)ve.makeColoredSphere(c,h,d,y,u,g);else{const D=nt();ln(D,m[3],[m[0],m[1],m[2]]);const v=xt(0,-x*.5,0,1),C=xt(0,+x*.5,0,1);Tt(v,v,D),Tt(C,C,D),Ms(v,v,u),Ms(C,C,u);const I=Q(v[0],v[1],v[2]),S=Q(C[0],C[1],C[2]);ve.makeColoredCylinder(c,h,d,I,S,y,g)}}return{positions:Float32Array.from(c),indices:Uint32Array.from(h),rgba255:Uint8Array.from(d)}}static async readGII(t,i=0){let s=t.byteLength;if(s<20)throw new Error("File too small to be GII: bytes = "+s);let r=new TextDecoder("ascii").decode(t);if(r[0].charCodeAt(0)===31){const E=await X.decompress(new Uint8Array(t));t=E.buffer,r=new TextDecoder("ascii").decode(E.buffer)}let n=0;function o(){let E=!0,V=n;for(;E;){for(;n<s&&r[n]!=="<";)n++;for(V=n;n<s&&r[n]!==">";)n++;if(E=r[n-1]==="/",V+1<s&&r[V+1]==="/"&&(n+=1,E=!0),n>=s)break}const T=new TextDecoder().decode(t.slice(V+1,n)).trim(),R=T.split(" ")[0].trim(),N=n;let O=n,G=n;if(r[V+1]!=="?"&&r[V+1]!=="!"){const z="</"+R+">";O=r.indexOf(z,N),G=O+z.length-1}return{name:T,startPos:V,contentStartPos:N,contentEndPos:O,endPos:G}}let l=o();if(!l.name.startsWith("?xml"))throw new Error("readGII: Invalid XML file");for(;!l.name.startsWith("GIFTI")&&l.endPos<s;)l=o();if(!l.name.startsWith("GIFTI")||l.contentStartPos===l.contentEndPos)throw new Error("readGII: XML file does not include GIFTI tag");s=l.contentEndPos;let a=new Float32Array,c=new Uint32Array,h=new Float32Array,d="",f=!1,u=!1,m=!1,g=!1,A=[1,1,1];const p=[0,0,0];let w=0,y=!1,x=!1,b=0,M=!1;l.endPos=l.contentStartPos;let D="";function v(E,V=!1){const T=D.indexOf(E);if(T<0)return 1;const R=D.indexOf('"',T)+1,N=D.indexOf('"',R),O=D.slice(R,N);return V?parseFloat(O):parseInt(O)}function C(E){const V=D.indexOf(E);if(V<0)return"";const T=V+E.length,R=D.indexOf("]",T);return D.slice(T,R)}const I={R:[],G:[],B:[],A:[],I:[],labels:[]};for(;l.endPos<s&&l.name.length>1;){if(l=o(),l.name.startsWith("Label Key")&&(D=l.name,I.I.push(v("Key=")),I.R.push(Math.round(255*v("Red=",!0))),I.G.push(Math.round(255*v("Green=",!0))),I.B.push(Math.round(255*v("Blue=",!0))),I.A.push(Math.round(255*v("Alpha",!0))),D=new TextDecoder().decode(t.slice(l.contentStartPos+1,l.contentEndPos)).trim(),I.labels.push(C("<![CDATA["))),l.name.trim()==="Data"){if(m)continue;D=new TextDecoder().decode(t.slice(l.contentStartPos+1,l.contentEndPos)).trim();let E;if(x){const V=A[0]*A[1]*A[2],T=D.split(/\s+/);if(V!==T.length)throw new Error("Unable to parse ASCII GIfTI");if(w===2&&(w=8),w===32&&(w=16),w===8){E=new Int32Array(V);for(let R=0;R<V;R++)E[R]=parseInt(T[R])}if(w===16){E=new Float32Array(V);for(let R=0;R<V;R++)E[R]=parseFloat(T[R])}}else if(typeof Buffer>"u"){let V=function(T){const R=atob(T),N=R.length,O=new Uint8Array(N);for(let G=0;G<N;G++)O[G]=R.charCodeAt(G);return O};if(y){const T=V(D.slice());E=await X.decompress(new Uint8Array(T))}else E=V(D.slice())}else if(y){const V=Buffer.from(D.slice(),"base64");E=await X.decompress(new Uint8Array(V))}else E=Buffer.from(D.slice(),"base64");if(u){if(w!==16&&P.warn("expect positions as FLOAT32"),a=new Float32Array(E.buffer),g){const V=a.slice(),T=V.length/3;let R=0;for(let N=0;N<T;N++)for(let O=0;O<3;O++)a[R]=V[O*T+N],R++}}else if(f){if(w!==8&&P.warn("expect indices as INT32"),c=new Uint32Array(E.buffer),g){const V=c.slice(),T=V.length/3;let R=0;for(let N=0;N<T;N++)for(let O=0;O<3;O++)c[R]=V[O*T+N],R++}}else{let V=function(R,N){const O=R.length,G=new Float32Array(O+N.length);return G.set(R),G.set(N,O),G};b=A[0]*A[1]*A[2],i!==0&&b%i!==0&&P.warn("Number of vertices in scalar overlay ("+b+") does not match mesh ("+i+")");let T;if(w===2){const R=new Uint8Array(E.buffer);T=Float32Array.from(R)}else if(w===8){const R=new Int32Array(E.buffer);T=Float32Array.from(R)}else if(w===16)T=new Float32Array(E.buffer);else if(w===32){const R=new Float64Array(E.buffer);T=Float32Array.from(R)}else throw new Error(`Invalid dataType: ${w}`);h=V(h,T)}continue}if(l.name.trim()==="DataSpace"&&(D=new TextDecoder().decode(t.slice(l.contentStartPos+1,l.contentEndPos)).trim(),D.includes("NIFTI_XFORM_SCANNER_ANAT")&&(M=!0)),l.name.trim()==="MD"&&(D=new TextDecoder().decode(t.slice(l.contentStartPos+1,l.contentEndPos)).trim(),D.includes("AnatomicalStructurePrimary")&&D.includes("CDATA[")&&(d=C("<Value><![CDATA[").toUpperCase()),D.includes("VolGeom")&&D.includes("CDATA["))){let E=-1;if(D.includes("VolGeomC_R")&&(E=0),D.includes("VolGeomC_A")&&(E=1),D.includes("VolGeomC_S")&&(E=2),E<0)continue;p[E]=parseFloat(C("<Value><![CDATA["))}l.name.startsWith("DataArray")&&(D=l.name,A=[1,1,1],y=D.includes('Encoding="GZipBase64Binary"'),x=D.includes('Encoding="ASCII"'),f=D.includes('Intent="NIFTI_INTENT_TRIANGLE"'),u=D.includes('Intent="NIFTI_INTENT_POINTSET"'),m=D.includes('Intent="NIFTI_INTENT_VECTOR"'),g=D.includes('ArrayIndexingOrder="ColumnMajorOrder"'),D.includes('DataType="NIFTI_TYPE_UINT8"')&&(w=2),D.includes('DataType="NIFTI_TYPE_INT32"')&&(w=8),D.includes('DataType="NIFTI_TYPE_FLOAT32"')&&(w=16),D.includes('DataType="NIFTI_TYPE_FLOAT64"')&&(w=32),A[0]=v("Dim0="),A[1]=v("Dim1="),A[2]=v("Dim2="))}let S;if(I.I.length>1&&(S=mt.makeLabelLut(I)),i>0)return{scalars:h,colormapLabel:S,anatomicalStructurePrimary:d};if(a.length>2&&!M&&(p[0]!==0||p[1]!==0||p[2]!==0)){b=Math.floor(a.length/3);let E=0;for(let V=0;V<b;V++)a[E]+=p[0],E++,a[E]+=p[1],E++,a[E]+=p[2],E++}return{positions:a,indices:c,scalars:h,colormapLabel:S,anatomicalStructurePrimary:d}}},pl=()=>{const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),new Int16Array(e)[0]===256},Or=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.NII=1]="NII",e[e.DCM=2]="DCM",e[e.DCM_MANIFEST=3]="DCM_MANIFEST",e[e.MIH=4]="MIH",e[e.MIF=5]="MIF",e[e.NHDR=6]="NHDR",e[e.NRRD=7]="NRRD",e[e.MHD=8]="MHD",e[e.MHA=9]="MHA",e[e.MGH=10]="MGH",e[e.MGZ=11]="MGZ",e[e.V=12]="V",e[e.V16=13]="V16",e[e.VMR=14]="VMR",e[e.HEAD=15]="HEAD",e[e.DCM_FOLDER=16]="DCM_FOLDER",e[e.SRC=17]="SRC",e[e.FIB=18]="FIB",e[e.BMP=19]="BMP",e))(Or||{}),st=Object.freeze({...Or,parse:e=>{let t=0;switch(e.toUpperCase()){case"":case"DCM":t=2;break;case"TXT":t=3;break;case"FIB":t=18;break;case"NII":t=1;break;case"MIH":t=4;break;case"MIF":t=5;break;case"NHDR":t=6;break;case"NRRD":t=7;break;case"MHD":t=8;break;case"MHA":t=9;break;case"MGH":t=10;break;case"MGZ":t=11;break;case"SRC":t=17;break;case"V":t=12;break;case"V16":t=13;break;case"VMR":t=14;break;case"HEAD":t=15;break;case"PNG":case"BMP":case"GIF":case"JPG":case"JPEG":t=19;break}return t}}),Si=(e,t="",i="",s="gray",r=1,n=NaN,o=NaN,l=!0,a=.02,c=!1,h=!1,d="",f=0,u=st.UNKNOWN,m=NaN,g=NaN,A=!0,p=!1,w=null)=>({url:e,urlImageData:t,name:i,colormap:s,colorMap:s,opacity:r,cal_min:n,cal_max:o,trustCalMinMax:l,percentileFrac:a,ignoreZeroVoxels:c,useQFormNotSForm:h,colormapNegative:d,imageType:u,cal_minNeg:m,cal_maxNeg:g,colorbarVisible:A,frame4D:f,alphaThreshold:p,colormapLabel:w});function Ys(e,t=80){e=e.replace(/[`$]/g,"");const i=[],s=Math.min(t,e.length);for(let r=0;r<s;r++){const n=e.charCodeAt(r);i.push(n&255)}return i}function hi(e,t=!1,i=!1){let n=!0;i&&(n=e.littleEndian);const o=new Uint8Array(348),l=new DataView(o.buffer);l.setInt32(0,348,n),l.setUint8(38,114),l.setUint8(39,e.dim_info);for(let c=0;c<8;c++)l.setUint16(40+2*c,e.dims[c],n);l.setFloat32(56,e.intent_p1,n),l.setFloat32(60,e.intent_p2,n),l.setFloat32(64,e.intent_p3,n),l.setInt16(68,e.intent_code,n),t?(l.setInt16(70,2,n),l.setInt16(72,8,n)):(l.setInt16(70,e.datatypeCode,n),l.setInt16(72,e.numBitsPerVoxel,n)),l.setInt16(74,e.slice_start,n);for(let c=0;c<8;c++)l.setFloat32(76+4*c,e.pixDims[c],n);t?(l.setFloat32(108,352,n),l.setFloat32(112,1,n),l.setFloat32(116,0,n)):(l.setFloat32(108,352,n),l.setFloat32(112,e.scl_slope,n),l.setFloat32(116,e.scl_inter,n)),l.setInt16(120,e.slice_end,n),l.setUint8(122,e.slice_code),e.xyzt_units===0?l.setUint8(123,10):l.setUint8(123,e.xyzt_units),t?(l.setFloat32(124,0,n),l.setFloat32(128,0,n)):(l.setFloat32(124,e.cal_max,n),l.setFloat32(128,e.cal_min,n)),l.setFloat32(132,e.slice_duration,n),l.setFloat32(136,e.toffset,n),o.set(Ys(e.description),148),o.set(Ys(e.aux_file),228),l.setInt16(252,e.qform_code,n),e.sform_code<1||e.sform_code<1?l.setInt16(254,1,n):l.setInt16(254,e.sform_code,n),l.setFloat32(256,e.quatern_b,n),l.setFloat32(260,e.quatern_c,n),l.setFloat32(264,e.quatern_d,n),l.setFloat32(268,e.qoffset_x,n),l.setFloat32(272,e.qoffset_y,n),l.setFloat32(276,e.qoffset_z,n);const a=e.affine.flat();for(let c=0;c<12;c++)l.setFloat32(280+4*c,a[c],n);return l.setInt32(344,3222382,!0),o}function xl(e,t=!0){const i=Math.round(e.length/3),s=Q(0,0,0),r=pt(),n=pt();let o=0,l=1;t&&(l=2);for(let d=0;d<l;d++){o=0;for(let u=0;u<i;u++){const m=Q(e[u*3],e[u*3+1],e[u*3+2]);u===0&&(Is(r,m),Is(n,m)),os(r,r,m),as(n,n,m),bt(m,m,s);const g=Je(m);o=Math.max(o,g)}if(d+1>=l)break;let f=!0;for(let u=0;u<3;++u)r[u]>s[u]&&(f=!1),n[u]<s[u]&&(f=!1);if(f)break;mn(s,r,n,.5),P.debug("origin moved inside volume: ",s)}const a=[r[0],r[1],r[2]],c=[n[0],n[1],n[2]];return{min:a,max:c,furthestVertexFromOrigin:o,origin:s}}function zs(e){const t=[!1,!1,!1,!1],i=[!1,!1,!1,!1];for(let s=0;s<4;s++)for(let r=0;r<4;r++)if(isNaN(e[s][r]))return!1;for(let s=0;s<3;s++)for(let r=0;r<3;r++)e[s][r]!==0&&(t[s]=!0,i[r]=!0);for(let s=0;s<3;s++)if(!t[s]||!i[s])return!1;return!0}async function Wi(e){const t=e.getReader(),{done:i,value:s}=await t.read();if(i)return t.releaseLock(),new ReadableStream({start(o){o.close()}});if(!s||s.length<2)return t.releaseLock(),new ReadableStream({start(o){s&&o.enqueue(s),o.close()}});const r=s[0]===31&&s[1]===139,n=new ReadableStream({async start(o){try{for(o.enqueue(s);;){const{done:l,value:a}=await t.read();if(l){o.close(),t.releaseLock();break}o.enqueue(a)}}catch(l){o.error(l),t.releaseLock()}}});return r?n.pipeThrough(new DecompressionStream("gzip")):n}var Rt=class Ti{constructor(t=null,i="",s="gray",r=1,n=null,o=NaN,l=NaN,a=!0,c=.02,h=!1,d=!1,f="",u=0,m=st.UNKNOWN,g=NaN,A=NaN,p=!0,w=null,y=0){F(this,"name"),F(this,"id"),F(this,"url"),F(this,"headers"),F(this,"_colormap"),F(this,"_opacity"),F(this,"percentileFrac"),F(this,"ignoreZeroVoxels"),F(this,"trustCalMinMax"),F(this,"colormapNegative"),F(this,"colormapLabel"),F(this,"colormapInvert"),F(this,"nFrame4D"),F(this,"frame4D"),F(this,"nTotalFrame4D"),F(this,"cal_minNeg"),F(this,"cal_maxNeg"),F(this,"colorbarVisible",!0),F(this,"modulationImage",null),F(this,"modulateAlpha",0),F(this,"series",[]),F(this,"nVox3D"),F(this,"oblique_angle"),F(this,"maxShearDeg"),F(this,"useQFormNotSForm"),F(this,"colormapType"),F(this,"pixDims"),F(this,"matRAS"),F(this,"pixDimsRAS"),F(this,"obliqueRAS"),F(this,"dimsRAS"),F(this,"permRAS"),F(this,"img2RASstep"),F(this,"img2RASstart"),F(this,"toRAS"),F(this,"toRASvox"),F(this,"frac2mm"),F(this,"frac2mmOrtho"),F(this,"extentsMinOrtho"),F(this,"extentsMaxOrtho"),F(this,"mm2ortho"),F(this,"hdr",null),F(this,"imageType"),F(this,"img"),F(this,"imaginary"),F(this,"v1"),F(this,"fileObject"),F(this,"dims"),F(this,"onColormapChange",()=>{}),F(this,"onOpacityChange",()=>{}),F(this,"mm000"),F(this,"mm100"),F(this,"mm010"),F(this,"mm001"),F(this,"cal_min"),F(this,"cal_max"),F(this,"robust_min"),F(this,"robust_max"),F(this,"global_min"),F(this,"global_max"),F(this,"urlImgData"),F(this,"isManifest"),F(this,"limitFrames4D"),this.init(t,i,s,r,n,o,l,a,c,h,d,f,u,m,g,A,p,w,y)}init(t=null,i="",s="gray",r=1,n=null,o=NaN,l=NaN,a=!0,c=.02,h=!1,d=!1,f="",u=0,m=st.UNKNOWN,g=NaN,A=NaN,p=!0,w=null,y=0,x=null){if(this.name=i,this.imageType=m,this.id=es(),this._colormap=s,this._opacity=r>1?1:r,this.percentileFrac=c,this.ignoreZeroVoxels=h,this.trustCalMinMax=a,this.colormapNegative=f,this.colormapLabel=w,this.frame4D=u,this.cal_minNeg=g,this.cal_maxNeg=A,this.colorbarVisible=p,this.colormapType=y,this.useQFormNotSForm=d,!t)return;if(this.hdr&&typeof this.hdr.magic=="number"&&(this.hdr.magic="n+1"),this.nFrame4D=1,this.hdr)for(let v=4;v<7;v++)this.hdr.dims[v]>1&&(this.nFrame4D*=this.hdr.dims[v]);if(this.frame4D=Math.min(this.frame4D,this.nFrame4D-1),this.nTotalFrame4D=this.nFrame4D,!this.hdr||!x)return;this.nVox3D=this.hdr.dims[1]*this.hdr.dims[2]*this.hdr.dims[3];const b=this.nVox3D*(this.hdr.numBitsPerVoxel/8),M=x.byteLength/b;M!==this.nFrame4D&&(M>0&&M*b===x.byteLength?P.debug("Loading the first "+M+" of "+this.nFrame4D+" volumes"):P.warn("This header does not match voxel data",this.hdr,x.byteLength),this.nFrame4D=M),(this.hdr.intent_code===1007||this.hdr.intent_code===2003)&&this.nFrame4D===3&&this.hdr.datatypeCode===16&&(x=this.float32V1asRGBA(new Float32Array(x))),(this.hdr.pixDims[1]===0||this.hdr.pixDims[2]===0||this.hdr.pixDims[3]===0)&&P.error("pixDims not plausible",this.hdr),(isNaN(this.hdr.scl_slope)||this.hdr.scl_slope===0)&&(this.hdr.scl_slope=1),isNaN(this.hdr.scl_inter)&&(this.hdr.scl_inter=0);let D=zs(this.hdr.affine);if(d||!D||this.hdr.qform_code>this.hdr.sform_code){P.debug("spatial transform based on QForm");const v=this.hdr.quatern_b,C=this.hdr.quatern_c,I=this.hdr.quatern_d,S=Math.sqrt(1-(Math.pow(v,2)+Math.pow(C,2)+Math.pow(I,2))),E=this.hdr.pixDims[0]===0?1:this.hdr.pixDims[0],V=[[S*S+v*v-C*C-I*I,2*v*C-2*S*I,2*v*I+2*S*C],[2*v*C+2*S*I,S*S+C*C-v*v-I*I,2*C*I-2*S*v],[2*v*I-2*S*C,2*C*I+2*S*v,S*S+I*I-C*C-v*v]],T=this.hdr.affine;for(let R=0;R<3;R+=1)for(let N=0;N<3;N+=1)T[R][N]=V[R][N]*this.hdr.pixDims[N+1],N===2&&(T[R][N]*=E);T[0][3]=this.hdr.qoffset_x,T[1][3]=this.hdr.qoffset_y,T[2][3]=this.hdr.qoffset_z,this.hdr.affine=T}if(D=zs(this.hdr.affine),!D){P.debug("Defective NIfTI: spatial transform does not make sense");let v=this.hdr.pixDims[1],C=this.hdr.pixDims[2],I=this.hdr.pixDims[3];(isNaN(v)||v===0)&&(v=1),(isNaN(C)||C===0)&&(C=1),(isNaN(I)||I===0)&&(I=1),this.hdr.pixDims[1]=v,this.hdr.pixDims[2]=C,this.hdr.pixDims[3]=I;const S=[[v,0,0,0],[0,C,0,0],[0,0,I,0],[0,0,0,1]];this.hdr.affine=S}if(this.hdr.datatypeCode!==128&&this.hdr.datatypeCode!==2304&&this.hdr.littleEndian!==pl()&&this.hdr.numBitsPerVoxel>8){if(this.hdr.numBitsPerVoxel===16){const v=new Uint16Array(x);for(let C=0;C<v.length;C++){const I=v[C];v[C]=((I&255)<<8|I>>8&255)<<16>>16}}else if(this.hdr.numBitsPerVoxel===32){const v=new Uint32Array(x);for(let C=0;C<v.length;C++){const I=v[C];v[C]=(I&255)<<24|(I&65280)<<8|I>>8&65280|I>>24&255}}else if(this.hdr.numBitsPerVoxel===64){const v=this.hdr.numBitsPerVoxel/8,C=new Uint8Array(x);for(let I=0;I<C.length;I+=v){let S=v-1;for(let E=0;E<S;E++){const V=C[I+E];C[I+E]=C[I+S],C[I+S]=V,S--}}}}switch(this.hdr.datatypeCode){case 2:this.img=new Uint8Array(x);break;case 4:this.img=new Int16Array(x);break;case 16:this.img=new Float32Array(x);break;case 64:this.img=new Float64Array(x);break;case 128:this.img=new Uint8Array(x);break;case 512:this.img=new Uint16Array(x);break;case 2304:this.img=new Uint8Array(x);break;case 256:{const v=new Int8Array(x),C=v.length;this.img=new Int16Array(C);for(let I=0;I<C;I++)this.img[I]=v[I];this.hdr.datatypeCode=4,this.hdr.numBitsPerVoxel=16;break}case 1:{const v=this.hdr.dims[1]*this.hdr.dims[2]*Math.max(1,this.hdr.dims[3])*Math.max(1,this.hdr.dims[4]),C=new Uint8Array(x);this.img=new Uint8Array(v);const I=new Uint8Array(8);for(let E=0;E<8;E++)I[E]=Math.pow(2,E);let S=-1;for(let E=0;E<v;E++){const V=E%8;V===0&&S++,(C[S]&I[V])!==0&&(this.img[E]=1)}this.hdr.datatypeCode=2,this.hdr.numBitsPerVoxel=8;break}case 768:{const v=new Uint32Array(x),C=v.length;this.img=new Float64Array(C);for(let I=0;I<C-1;I++)this.img[I]=v[I];this.hdr.datatypeCode=64;break}case 8:{const v=new Int32Array(x),C=v.length;this.img=new Float64Array(C);for(let I=0;I<C-1;I++)this.img[I]=v[I];this.hdr.datatypeCode=64;break}case 1024:{const v=new BigInt64Array(x),C=v.length;this.img=new Float64Array(C);for(let I=0;I<C-1;I++)this.img[I]=Number(v[I]);this.hdr.datatypeCode=64;break}case 32:{const v=new Float32Array(x),C=Math.floor(v.length/2);this.imaginary=new Float32Array(C),this.img=new Float32Array(C);let I=0;for(let S=0;S<C-1;S++)this.img[S]=v[I],this.imaginary[S]=v[I+1],I+=2;this.hdr.datatypeCode=16;break}default:throw new Error("datatype "+this.hdr.datatypeCode+" not supported")}this.calculateRAS(),isNaN(o)||(this.hdr.cal_min=o),isNaN(l)||(this.hdr.cal_max=l),this.calMinMax()}static async new(t=null,i="",s="gray",r=1,n=null,o=NaN,l=NaN,a=!0,c=.02,h=!1,d=!1,f="",u=0,m=st.UNKNOWN,g=NaN,A=NaN,p=!0,w=null,y=0){const x=new Ti,b=/(?:\.([^.]+))?$/;let M=b.exec(i)[1]||"";M=M.toUpperCase(),M==="GZ"&&(M=b.exec(i.slice(0,-3))[1],M=M.toUpperCase());let D=null;if(m===st.UNKNOWN&&(m=st.parse(M)),t instanceof ArrayBuffer&&t.byteLength>=2&&m===st.DCM){const v=new Uint8Array(t);(v[0]===92&&v[1]===1||v[1]===92&&v[0]===1)&&(m=st.NII)}switch(x.imageType=m,m){case st.DCM_FOLDER:case st.DCM_MANIFEST:case st.DCM:return;case st.FIB:[D,x.v1]=await x.readFIB(t);break;case st.MIH:case st.MIF:D=await x.readMIF(t,n);break;case st.NHDR:case st.NRRD:D=await x.readNRRD(t,n);break;case st.MHD:case st.MHA:D=await x.readMHA(t,n);break;case st.MGH:case st.MGZ:D=await x.readMGH(t);break;case st.SRC:D=await x.readSRC(t);break;case st.V:D=x.readECAT(t);break;case st.V16:D=x.readV16(t);break;case st.VMR:D=x.readVMR(t);break;case st.HEAD:D=await x.readHEAD(t,n);break;case st.BMP:D=await x.readBMP(t);break;case st.NII:Bi(t)&&(t=await Bs(t)),x.hdr=await Ye(t),x.hdr!==null&&(x.hdr.cal_min===0&&x.hdr.cal_max===255&&(x.hdr.cal_max=0),Bi(t)?D=Rs(x.hdr,await Bs(t)):D=Rs(x.hdr,t));break;default:throw new Error("Image type not supported")}return x.init(t,i,s,r,n,o,l,a,c,h,d,f,u,m,g,A,p,w,y,D),x}computeObliqueAngle(t){const i=It(t);Ht(i,t);const s=Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]),r=Math.max(Math.max(Math.abs(i[0]),Math.abs(i[1])),Math.abs(i[2]))/s,n=Math.sqrt(i[4]*i[4]+i[5]*i[5]+i[6]*i[6]),o=Math.max(Math.max(Math.abs(i[4]),Math.abs(i[5])),Math.abs(i[6]))/n,l=Math.sqrt(i[8]*i[8]+i[9]*i[9]+i[10]*i[10]),a=Math.max(Math.max(Math.abs(i[8]),Math.abs(i[9])),Math.abs(i[10]))/l,c=Math.min(Math.min(r,o),a);let h=Math.abs(Math.acos(c)*180/3.141592653);return h>.01?P.warn("Warning voxels not aligned with world space: "+h+` degrees from plumb.
`):h=0,h}float32V1asRGBA(t){t.length!==this.nVox3D*3&&P.warn("float32V1asRGBA() expects "+this.nVox3D*3+"voxels, got ",+t.length);const i=t.slice();this.hdr.datatypeCode=2304,this.nFrame4D=1;for(let a=4;a<7;a++)this.hdr.dims[a]=1;this.hdr.dims[0]=3;const s=new Uint8Array(this.nVox3D*4);let r=1;for(let a=0;a<this.nVox3D*3;a++)isNaN(i[a])||(r=Math.max(r,Math.abs(i[a])));const n=255/r,o=this.nVox3D*2;let l=0;for(let a=0;a<this.nVox3D;a++){const c=i[a],h=i[a+this.nVox3D],d=i[a+o];s[l]=Math.abs(c*n),s[l+1]=Math.abs(h*n),s[l+2]=Math.abs(d*n);const f=+(c>0)*1,u=+(h>0)*2,m=+(d>0)*4;let g=248+f+u+m;Math.abs(c)+Math.abs(h)+Math.abs(d)<.1&&(g=0),s[l+3]=g,l+=4}return s}loadImgV1(t=!1,i=!1,s=!1){let r=this.v1;if(!r&&this.nFrame4D===3&&this.img.constructor===Float32Array&&(r=this.img.slice()),!r)return P.warn("Image does not have V1 data"),!1;if(t)for(let n=0;n<this.nVox3D;n++)r[n]=-r[n];if(i)for(let n=this.nVox3D;n<2*this.nVox3D;n++)r[n]=-r[n];if(s)for(let n=2*this.nVox3D;n<3*this.nVox3D;n++)r[n]=-r[n];return this.img=this.float32V1asRGBA(r),!0}calculateOblique(){if(!this.matRAS)throw new Error("matRAS not defined");if(this.pixDimsRAS===void 0)throw new Error("pixDimsRAS not defined");if(!this.dimsRAS)throw new Error("dimsRAS not defined");this.oblique_angle=this.computeObliqueAngle(this.matRAS);const t=this.vox2mm([0,0,0],this.matRAS),i=this.vox2mm([1/this.pixDimsRAS[1],0,0],this.matRAS),s=this.vox2mm([0,1/this.pixDimsRAS[2],0],this.matRAS),r=this.vox2mm([0,0,1/this.pixDimsRAS[3]],this.matRAS);bt(i,i,t),bt(s,s,t),bt(r,r,t);const n=Qt(i[0],i[1],i[2],0,s[0],s[1],s[2],0,r[0],r[1],r[2],0,0,0,0,1);this.obliqueRAS=It(n);const o=Math.abs(90-Oi(i,s)*(180/Math.PI)),l=Math.abs(90-Oi(i,r)*(180/Math.PI)),a=Math.abs(90-Oi(s,r)*(180/Math.PI));this.maxShearDeg=Math.max(Math.max(o,l),a),this.maxShearDeg>.1&&P.warn("Warning: voxels are rhomboidal, maximum shear is %f degrees.",this.maxShearDeg);const c=xt(this.dimsRAS[1],this.dimsRAS[2],this.dimsRAS[3],1),h=It(this.matRAS);Ht(h,h);const d=xt(-.5,-.5,-.5,0);Be(h,h,Q(d[0],d[1],d[2])),h[0]*=c[0],h[1]*=c[0],h[2]*=c[0],h[4]*=c[1],h[5]*=c[1],h[6]*=c[1],h[8]*=c[2],h[9]*=c[2],h[10]*=c[2],this.frac2mm=It(h);const f=this.pixDimsRAS[1],u=this.pixDimsRAS[2],m=this.pixDimsRAS[3],g=It(h);g[0]=f*c[0],g[1]=0,g[2]=0,g[4]=0,g[5]=u*c[1],g[6]=0,g[8]=0,g[9]=0,g[10]=m*c[2];const A=this.mm2vox([0,0,0],!0);g[12]=(-A[0]-.5)*f,g[13]=(-A[1]-.5)*u,g[14]=(-A[2]-.5)*m,this.frac2mmOrtho=It(g),this.extentsMinOrtho=[g[12],g[13],g[14]],this.extentsMaxOrtho=[g[0]+g[12],g[5]+g[13],g[10]+g[14]],this.mm2ortho=nt(),zt(this.mm2ortho,n)}THD_daxes_to_NIFTI(t,i,s){const r=this.hdr;if(r===null)throw new Error("HDR is not set");r.sform_code=2;const n="xxyyzzg";let o=-1,l=-1,a=-1;const c=["x","y","z"];c[0]=n[s[0]],c[1]=n[s[1]],c[2]=n[s[2]];const h=t.slice(0,3),d=i.slice(0,3);for(let f=0;f<3;f++)c[f]==="x"?o=f:c[f]==="y"?l=f:a=f;o<0||l<0||a<0||o===l||o===a||l===a||(r.pixDims[1]=Math.abs(h[0]),r.pixDims[2]=Math.abs(h[1]),r.pixDims[3]=Math.abs(h[2]),r.affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],r.affine[0][o]=-h[o],r.affine[1][l]=-h[l],r.affine[2][a]=h[a],r.affine[0][3]=-d[o],r.affine[1][3]=-d[l],r.affine[2][3]=d[a])}SetPixDimFromSForm(){if(!this.hdr)throw new Error("hdr not defined");const t=this.hdr.affine,i=Qt(t[0][0],t[0][1],t[0][2],t[0][3],t[1][0],t[1][1],t[1][2],t[1][3],t[2][0],t[2][1],t[2][2],t[2][3],t[3][0],t[3][1],t[3][2],t[3][3]),s=this.vox2mm([0,0,0],i),r=this.vox2mm([1,0,0],i);bt(r,r,s);const n=this.vox2mm([0,1,0],i);bt(n,n,s);const o=this.vox2mm([0,0,1],i);bt(o,o,s),this.hdr.pixDims[1]=he(r),this.hdr.pixDims[2]=he(n),this.hdr.pixDims[3]=he(o)}readECAT(t){this.hdr=new et;const i=this.hdr;i.dims=[3,1,1,1,0,0,0,0],i.pixDims=[1,1,1,1,1,0,0,0];const s=new DataView(t),r=s.getInt32(0,!1),n=s.getInt16(50,!1);if(r!==1296127058||n<1||n>14)throw new Error("Not a valid ECAT file");let o=512,l=0;const a=[];let c=new Float32Array;for(;;){const h=s.getInt32(o,!1),d=s.getInt32(o+12,!1);if(h+d!==31)break;let f=o+20,u=0,m=0;for(;u<31&&(m=s.getInt32(f,!1),f+=16,m!==0);){u++;let g=m*512;const A=g-512,p=s.getUint16(A,!1);i.dims[1]=s.getUint16(A+4,!1),i.dims[2]=s.getUint16(A+6,!1),i.dims[3]=s.getUint16(A+8,!1);const w=s.getFloat32(A+26,!1);i.pixDims[1]=s.getFloat32(A+34,!1)*10,i.pixDims[2]=s.getFloat32(A+38,!1)*10,i.pixDims[3]=s.getFloat32(A+42,!1)*10,i.pixDims[4]=s.getUint32(A+46,!1)/1e3,a.push(i.pixDims[4]);const y=i.dims[1]*i.dims[2]*i.dims[3],x=new Float32Array(y);if(p===1)for(let M=0;M<y;M++)x[M]=s.getUint8(g)*w,g++;else if(p===6)for(let M=0;M<y;M++)x[M]=s.getUint16(g,!1)*w,g+=2;else if(p===7)for(let M=0;M<y;M++)x[M]=s.getUint32(g,!1)*w,g+=4;else P.warn("Unknown ECAT data type "+p);const b=c.slice(0);c=new Float32Array(b.length+x.length),c.set(b),c.set(x,b.length),l++}if(m===0)break;o+=512}if(i.dims[4]=l,i.pixDims[4]=a[0],l>1){i.dims[0]=4;let h=!1;for(let d=0;d<l;d++)a[d]!==a[0]&&(h=!0);h&&P.warn("Frame durations vary")}return i.sform_code=1,i.affine=[[-i.pixDims[1],0,0,(i.dims[1]-2)*.5*i.pixDims[1]],[0,-i.pixDims[2],0,(i.dims[2]-2)*.5*i.pixDims[2]],[0,0,-i.pixDims[3],(i.dims[3]-2)*.5*i.pixDims[3]],[0,0,0,1]],i.numBitsPerVoxel=32,i.datatypeCode=16,c}readV16(t){this.hdr=new et;const i=this.hdr;i.dims=[3,1,1,1,0,0,0,0],i.pixDims=[1,1,1,1,1,0,0,0];const s=new DataView(t);return i.dims[1]=s.getUint16(0,!0),i.dims[2]=s.getUint16(2,!0),i.dims[3]=s.getUint16(4,!0),2*i.dims[1]*i.dims[2]*i.dims[3]+6!==t.byteLength&&P.warn("This does not look like a valid BrainVoyager V16 file"),i.numBitsPerVoxel=16,i.datatypeCode=512,P.warn("Warning: V16 files have no spatial transforms"),i.affine=[[0,0,-i.pixDims[1],(i.dims[1]-2)*.5*i.pixDims[1]],[-i.pixDims[2],0,0,(i.dims[2]-2)*.5*i.pixDims[2]],[0,-i.pixDims[3],0,(i.dims[3]-2)*.5*i.pixDims[3]],[0,0,0,1]],i.littleEndian=!0,t.slice(6)}async imageDataFromArrayBuffer(t){return new Promise((i,s)=>{const r=new Blob([t]),n=URL.createObjectURL(r),o=new Image;o.crossOrigin="Anonymous",o.src=n,o.onload=()=>{URL.revokeObjectURL(n);const l=document.createElement("canvas");l.width=o.width,l.height=o.height;const a=l.getContext("2d");if(!a){s(new Error("Failed to get 2D context"));return}a.drawImage(o,0,0),i(a.getImageData(0,0,o.width,o.height))},o.onerror=l=>{URL.revokeObjectURL(n),s(l)}})}async readBMP(t){const i=await this.imageDataFromArrayBuffer(t),{width:s,height:r,data:n}=i;this.hdr=new et;const o=this.hdr;return o.dims=[3,s,r,1,0,0,0,0],o.pixDims=[1,1,1,1,1,0,0,0],o.affine=[[o.pixDims[1],0,0,-(o.dims[1]-2)*.5*o.pixDims[1]],[0,-o.pixDims[2],0,(o.dims[2]-2)*.5*o.pixDims[2]],[0,0,-o.pixDims[3],(o.dims[3]-2)*.5*o.pixDims[3]],[0,0,0,1]],o.numBitsPerVoxel=8,o.datatypeCode=2304,n.buffer}readVMR(t){this.hdr=new et;const i=this.hdr;i.dims=[3,1,1,1,0,0,0,0],i.pixDims=[1,1,1,1,1,0,0,0];const s=new DataView(t),r=s.getUint16(0,!0);r!==4&&P.warn("Not a valid version 4 VMR image"),i.dims[1]=s.getUint16(2,!0),i.dims[2]=s.getUint16(4,!0),i.dims[3]=s.getUint16(6,!0);const n=i.dims[1]*i.dims[2]*i.dims[3];if(r>=4){let o=8+n;const l=s.getUint32(o+88,!0);if(o=o+92,l>0){const a=t.byteLength;for(let c=0;c<l;c++){for(;o<a&&s.getUint8(o)!==0;)o++;for(o++,o+=4;o<a&&s.getUint8(o)!==0;)o++;o++;const h=s.getUint32(o,!0);o+=4;for(let d=0;d<h;d++)o+=4}}i.pixDims[1]=s.getFloat32(o+2,!0),i.pixDims[2]=s.getFloat32(o+6,!0),i.pixDims[3]=s.getFloat32(o+10,!0)}return P.warn("Warning: VMR spatial transform not implemented"),i.affine=[[0,0,-i.pixDims[1],(i.dims[1]-2)*.5*i.pixDims[1]],[-i.pixDims[2],0,0,(i.dims[2]-2)*.5*i.pixDims[2]],[0,-i.pixDims[3],0,(i.dims[3]-2)*.5*i.pixDims[3]],[0,0,0,1]],P.debug(i),i.numBitsPerVoxel=8,i.datatypeCode=2,t.slice(8,8+n)}async readMGH(t){this.hdr=new et;const i=this.hdr;i.littleEndian=!1,i.dims=[3,1,1,1,0,0,0,0],i.pixDims=[1,1,1,1,1,0,0,0];let s=t,r=new DataView(s);r.getUint8(0)===31&&r.getUint8(1)===139&&(s=await X.decompressToBuffer(new Uint8Array(t)),r=new DataView(s));const n=r.getInt32(0,!1),o=r.getInt32(4,!1),l=r.getInt32(8,!1),a=r.getInt32(12,!1),c=r.getInt32(16,!1),h=r.getInt32(20,!1),d=r.getFloat32(30,!1),f=r.getFloat32(34,!1),u=r.getFloat32(38,!1),m=r.getFloat32(42,!1),g=r.getFloat32(46,!1),A=r.getFloat32(50,!1),p=r.getFloat32(54,!1),w=r.getFloat32(58,!1),y=r.getFloat32(62,!1),x=r.getFloat32(66,!1),b=r.getFloat32(70,!1),M=r.getFloat32(74,!1),D=r.getFloat32(78,!1),v=r.getFloat32(82,!1),C=r.getFloat32(86,!1);(n!==1||h<0||h>4)&&P.warn("Not a valid MGH file"),h===0?(i.numBitsPerVoxel=8,i.datatypeCode=2):h===4?(i.numBitsPerVoxel=16,i.datatypeCode=4):h===1?(i.numBitsPerVoxel=32,i.datatypeCode=8):h===3&&(i.numBitsPerVoxel=32,i.datatypeCode=16),i.dims[1]=o,i.dims[2]=l,i.dims[3]=a,i.dims[4]=c,c>1&&(i.dims[0]=4),i.pixDims[1]=d,i.pixDims[2]=f,i.pixDims[3]=u,i.vox_offset=284,i.sform_code=1;const I=Qt(m*i.pixDims[1],p*i.pixDims[2],x*i.pixDims[3],0,g*i.pixDims[1],w*i.pixDims[2],b*i.pixDims[3],0,A*i.pixDims[1],y*i.pixDims[2],M*i.pixDims[3],0,0,0,0,1),S=[i.dims[1]/2,i.dims[2]/2,i.dims[3]/2,1],E=[0,0,0,0];for(let T=0;T<3;T++){E[T]=0;for(let R=0;R<3;R++)E[T]=E[T]+I[R+T*4]*S[R]}i.affine=[[I[0],I[1],I[2],D-E[0]],[I[4],I[5],I[6],v-E[1]],[I[8],I[9],I[10],C-E[2]],[0,0,0,1]];const V=i.dims[1]*i.dims[2]*i.dims[3]*i.dims[4]*(i.numBitsPerVoxel/8);return s.slice(i.vox_offset,i.vox_offset+V)}async readFIB(t){this.hdr=new et;const i=this.hdr;i.littleEndian=!1,i.dims=[3,1,1,1,0,0,0,0],i.pixDims=[1,1,1,1,1,0,0,0];const s=await X.readMatV4(t);if(!("dimension"in s)||!("dti_fa"in s))throw new Error("Not a valid DSIstudio FIB file");const r="index0"in s&&"index1"in s&&"index2"in s;i.numBitsPerVoxel=32,i.datatypeCode=16,i.dims[1]=s.dimension[0],i.dims[2]=s.dimension[1],i.dims[3]=s.dimension[2],i.dims[4]=1,i.pixDims[1]=s.voxel_size[0],i.pixDims[2]=s.voxel_size[1],i.pixDims[3]=s.voxel_size[2],i.sform_code=1;const n=(i.dims[1]-1)*.5*i.pixDims[1],o=(i.dims[2]-1)*.5*i.pixDims[2],l=(i.dims[3]-1)*.5*i.pixDims[3];i.affine=[[i.pixDims[1],0,0,-n],[0,-i.pixDims[2],0,o],[0,0,i.pixDims[2],-l],[0,0,0,1]],i.littleEndian=!0;const a=i.dims[1]*i.dims[2]*i.dims[3],c=a*Math.ceil(i.numBitsPerVoxel/8),h=c*i.dims[4],d=new Uint8Array(new ArrayBuffer(a*4*3));if(r){const g=i.dims[1]*i.dims[2]*i.dims[3],A=new Float32Array(g),p=new Float32Array(g),w=new Float32Array(g),y=s.index0,x=s.odf_vertices;for(let b=0;b<g;b++){const M=y[b]*3;A[b]=x[M+0],p[b]=x[M+1],w[b]=-x[M+2]}d.set(new Uint8Array(A.buffer,A.byteOffset,A.byteLength),0*c),d.set(new Uint8Array(p.buffer,p.byteOffset,p.byteLength),1*c),d.set(new Uint8Array(w.buffer,w.byteOffset,w.byteLength),2*c)}const f=new Uint8Array(new ArrayBuffer(h)),u=Float32Array.from(s.dti_fa),m=new Uint8Array(u.buffer,u.byteOffset,u.byteLength);return f.set(m,0),"report"in s&&(i.description=new TextDecoder().decode(s.report.subarray(0,Math.min(79,s.report.byteLength)))),[f.buffer,new Float32Array(d.buffer)]}async readSRC(t){this.hdr=new et;const i=this.hdr;i.littleEndian=!1,i.dims=[3,1,1,1,0,0,0,0],i.pixDims=[1,1,1,1,1,0,0,0];const s=await X.readMatV4(t);if(!("dimension"in s)||!("image0"in s))throw new Error("Not a valid DSIstudio SRC file");let r=0,n=0;for(const[u,m]of Object.entries(s))if(u.startsWith("image")){if(r===0?n=m.length:n!==m.length&&(n=-1),m.constructor!==Uint16Array)throw new Error("DSIstudio SRC files always use Uint16 datatype");r++}if(n<1||r<1)throw new Error("SRC file not valid DSI Studio data. The image(s) should have the same length");i.numBitsPerVoxel=16,i.datatypeCode=512,i.dims[1]=s.dimension[0],i.dims[2]=s.dimension[1],i.dims[3]=s.dimension[2],i.dims[4]=r,i.dims[4]>1&&(i.dims[0]=4),i.pixDims[1]=s.voxel_size[0],i.pixDims[2]=s.voxel_size[1],i.pixDims[3]=s.voxel_size[2],i.sform_code=1;const o=(i.dims[1]-1)*.5*i.pixDims[1],l=(i.dims[2]-1)*.5*i.pixDims[2],a=(i.dims[3]-1)*.5*i.pixDims[3];i.affine=[[i.pixDims[1],0,0,-o],[0,-i.pixDims[2],0,l],[0,0,i.pixDims[2],-a],[0,0,0,1]],i.littleEndian=!0;const c=i.dims[1]*i.dims[2]*i.dims[3]*(i.numBitsPerVoxel/8),h=c*i.dims[4],d=new Uint8Array(new ArrayBuffer(h));let f=0;for(let u=0;u<r;u++){const m=s[`image${u}`],g=new Uint8Array(m.buffer,m.byteOffset,m.byteLength);d.set(g,f),f+=c}return"report"in s&&(i.description=new TextDecoder().decode(s.report.subarray(0,Math.min(79,s.report.byteLength)))),d.buffer}async readHEAD(t,i){this.hdr=new et;const s=this.hdr;s.dims[0]=3,s.pixDims=[1,1,1,1,1,0,0,0];let r=[0,0,0],n=[0,0,0],o=[1,1,1];const a=new TextDecoder().decode(t).split(/\r?\n/),c=(t.byteLength+8)%16,h=t.byteLength+(16-c);P.debug(t.byteLength,"len",h);const d=new Uint8Array(h);d.fill(0),d.set(new Uint8Array(t));const f=new Sr(h+8,42,d,!0);s.addExtension(f),s.extensionCode=42,s.extensionFlag[0]=1,s.extensionSize=h+8;const u=a.length;let m=0,g=!1;for(;m<u;){let p=a[m];if(m++,!p.startsWith("type"))continue;const w=p.includes("integer-attribute"),y=p.includes("float-attribute");if(p=a[m],m++,!p.startsWith("name"))continue;let x=p.split("= ");const b=x[1];p=a[m],m++,x=p.split("= ");let M=parseInt(x[1]);if(!(M<1)){if(p=a[m],m++,x=p.trim().split(/\s+/),y||w){for(;x.length<M;){p=a[m],m++;const D=p.trim().split(/\s+/);x.push(...D)}for(let D=0;D<M;D++)x[D]=parseFloat(x[D])}switch(b){case"BYTEORDER_STRING":x[0].includes("LSB_FIRST")?s.littleEndian=!0:x[0].includes("MSB_FIRST")&&(s.littleEndian=!1);break;case"BRICK_TYPES":{s.dims[4]=M;const D=parseInt(x[0]);D===0?(s.numBitsPerVoxel=8,s.datatypeCode=2):D===1?(s.numBitsPerVoxel=16,s.datatypeCode=4):D===3?(s.numBitsPerVoxel=32,s.datatypeCode=16):P.warn("Unknown BRICK_TYPES ",D)}break;case"IJK_TO_DICOM_REAL":if(M<12)break;g=!0,s.sform_code=2,s.affine=[[-x[0],-x[1],-x[2],-x[3]],[-x[4],-x[5],-x[6],-x[7]],[x[8],x[9],x[10],x[11]],[0,0,0,1]];break;case"DATASET_DIMENSIONS":M=Math.max(M,3);for(let D=0;D<M;D++)s.dims[D+1]=x[D];break;case"ORIENT_SPECIFIC":r=x;break;case"ORIGIN":n=x;break;case"DELTA":o=x;break;case"TAXIS_FLOATS":s.pixDims[4]=x[0];break;default:P.warn("Unknown:",b)}}}g?this.SetPixDimFromSForm():this.THD_daxes_to_NIFTI(o,n,r);const A=s.numBitsPerVoxel/8*s.dims[1]*s.dims[2]*s.dims[3]*s.dims[4];if(!i)throw new Error("pairedImgData not set");return i.byteLength<A?await X.decompressToBuffer(new Uint8Array(i)):i.slice(0)}async readMHA(t,i){const s=t.byteLength;if(s<20)throw new Error("File too small to be VTK: bytes = "+t.byteLength);const r=new Uint8Array(t);let n=0;function o(g){return g===10||g===13}function l(){for(;n<s&&o(r[n]);)n++;const g=n;for(;n<s&&!o(r[n]);)n++;return n-g<2?"":new TextDecoder().decode(t.slice(g,n))}let a=l();this.hdr=new et;const c=this.hdr;c.pixDims=[1,1,1,1,1,0,0,0],c.dims=[1,1,1,1,1,1,1,1],c.littleEndian=!0;let h=!1,d=!1;const f=me(NaN,0,0,0,1,0,0,0,1),u=Q(0,0,0);for(;a!=="";){let g=a.split(" ");if(g.length>2&&(g=g.slice(2)),a.startsWith("BinaryDataByteOrderMSB")&&g[0].includes("False")&&(c.littleEndian=!0),a.startsWith("BinaryDataByteOrderMSB")&&g[0].includes("True")&&(c.littleEndian=!1),a.startsWith("CompressedData")&&g[0].includes("True")&&(h=!0),a.startsWith("TransformMatrix"))for(let A=0;A<9;A++)f[A]=parseFloat(g[A]);if(a.startsWith("Offset"))for(let A=0;A<Math.min(g.length,3);A++)u[A]=parseFloat(g[A]);if(a.startsWith("ElementSpacing"))for(let A=0;A<g.length;A++)c.pixDims[A+1]=parseFloat(g[A]);if(a.startsWith("DimSize")){c.dims[0]=g.length;for(let A=0;A<g.length;A++)c.dims[A+1]=parseInt(g[A])}if(a.startsWith("ElementType"))switch(g[0]){case"MET_UCHAR":c.numBitsPerVoxel=8,c.datatypeCode=2;break;case"MET_CHAR":c.numBitsPerVoxel=8,c.datatypeCode=256;break;case"MET_SHORT":c.numBitsPerVoxel=16,c.datatypeCode=4;break;case"MET_USHORT":c.numBitsPerVoxel=16,c.datatypeCode=512;break;case"MET_INT":c.numBitsPerVoxel=32,c.datatypeCode=8;break;case"MET_UINT":c.numBitsPerVoxel=32,c.datatypeCode=768;break;case"MET_FLOAT":c.numBitsPerVoxel=32,c.datatypeCode=16;break;case"MET_DOUBLE":c.numBitsPerVoxel=64,c.datatypeCode=64;break;default:throw new Error("Unsupported MHA data type: "+g[0])}if(a.startsWith("ObjectType")&&!g[0].includes("Image")&&P.warn("Only able to read ObjectType = Image, not "+a),a.startsWith("ElementDataFile")){g[0]!=="LOCAL"&&(d=!0);break}a=l()}const m=me(c.pixDims[1],0,0,0,c.pixDims[2],0,0,0,c.pixDims[3]);for(Cs(f,f,m),c.affine=[[-f[0],-f[3],-f[6],-u[0]],[-f[1],-f[4],-f[7],-u[1]],[f[2],f[5],f[8],u[2]],[0,0,0,1]];r[n]===10;)n++;return c.vox_offset=n,d&&i?h?await X.decompressToBuffer(new Uint8Array(i.slice(0))):i.slice(0):h?await X.decompressToBuffer(new Uint8Array(t.slice(c.vox_offset))):t.slice(c.vox_offset)}async readMIF(t,i){this.hdr=new et;const s=this.hdr;s.pixDims=[1,1,1,1,1,0,0,0],s.dims=[1,1,1,1,1,1,1,1];let r=t.byteLength;if(r<20)throw new Error("File too small to be MIF: bytes = "+r);const n=new Uint8Array(t);n[0]===31&&n[1]===139&&(P.debug("MIF with GZ decompression"),t=await X.decompressToBuffer(new Uint8Array(t)),r=t.byteLength);let o=0;function l(){for(;o<r&&n[o]===10;)o++;const E=o;for(;o<r&&n[o]!==10;)o++;return o++,o-E<1?"":new TextDecoder().decode(t.slice(E,o-1))}let a=l();if(!a.startsWith("mrtrix image"))throw new Error("Not a valid MIF file");const c=[];let h=!1,d=0,f=0,u=!1;for(a=l();o<r&&!a.startsWith("END");){let E=a.split(":");if(a=l(),E.length<2)break;const V=E[0];E=E[1].split(",");for(let T=0;T<E.length;T++)E[T]=E[T].trim();switch(V){case"dim":s.dims[0]=E.length;for(let T=0;T<E.length;T++)s.dims[T+1]=parseInt(E[T]);break;case"vox":for(let T=0;T<E.length;T++)s.pixDims[T+1]=parseFloat(E[T]),isNaN(s.pixDims[T+1])&&(s.pixDims[T+1]=0);break;case"layout":for(let T=0;T<E.length;T++)c.push(parseInt(E[T]));break;case"datatype":{const T=E[0];T.startsWith("Bit")?(h=!0,s.datatypeCode=2):T.startsWith("Int8")?s.datatypeCode=256:T.startsWith("UInt8")?s.datatypeCode=2:T.startsWith("Int16")?s.datatypeCode=4:T.startsWith("UInt16")?s.datatypeCode=512:T.startsWith("Int32")?s.datatypeCode=8:T.startsWith("UInt32")?s.datatypeCode=768:T.startsWith("Float32")?s.datatypeCode=16:T.startsWith("Float64")?s.datatypeCode=64:P.warn("Unsupported datatype "+T),T.includes("8")?s.numBitsPerVoxel=8:T.includes("16")?s.numBitsPerVoxel=16:T.includes("32")?s.numBitsPerVoxel=32:T.includes("64")&&(s.numBitsPerVoxel=64),s.littleEndian=!0,T.endsWith("LE")&&(s.littleEndian=!0),T.endsWith("BE")&&(s.littleEndian=!1)}break;case"transform":if(d>2||E.length!==4)break;s.affine[d][0]=parseFloat(E[0]),s.affine[d][1]=parseFloat(E[1]),s.affine[d][2]=parseFloat(E[2]),s.affine[d][3]=parseFloat(E[3]),d++;break;case"comments":s.description=E[0].substring(0,Math.min(79,E[0].length));break;case"RepetitionTime":f=parseFloat(E[0]);break;case"file":u=!E[0].startsWith(". "),u||(E=E[0].split(" "),s.vox_offset=parseInt(E[1]));break}}const m=s.dims[0];m>5&&P.warn("reader only designed for a maximum of 5 dimensions (XYZTD)");let g=1;for(let E=0;E<m;E++)g*=Math.max(s.dims[E+1],1);for(let E=0;E<3;E++)for(let V=0;V<3;V++)s.affine[E][V]*=s.pixDims[V+1];P.debug("mif affine:"+s.affine[0]),f>0&&(s.pixDims[4]=f),u&&!i&&P.warn("MIH header provided without paired image data");let A;if(i&&u)A=i.slice(0);else if(h){s.numBitsPerVoxel=8;const E=new Uint8Array(g),V=t.slice(s.vox_offset,s.vox_offset+Math.ceil(g/8)),T=new Uint8Array(V);let R=0;for(let N=0;N<g;N++){const O=N%8;E[N]=T[R]>>7-O&1,O===7&&R++}A=E.buffer}else A=t.slice(s.vox_offset,s.vox_offset+g*(s.numBitsPerVoxel/8));c.length!==s.dims[0]&&P.warn("dims does not match layout");let p=1;const w=[1,1,1,1,1],y=[!1,!1,!1,!1,!1];for(let E=0;E<c.length;E++)for(let V=0;V<c.length;V++)Math.abs(c[V])===E&&(w[V]=p,(c[V]<0||Object.is(c[V],-0))&&(y[V]=!0),p*=s.dims[V+1]);let x=X.range(0,s.dims[1]-1,1);y[0]&&(x=X.range(s.dims[1]-1,0,-1));for(let E=0;E<s.dims[1];E++)x[E]*=w[0];let b=X.range(0,s.dims[2]-1,1);y[1]&&(b=X.range(s.dims[2]-1,0,-1));for(let E=0;E<s.dims[2];E++)b[E]*=w[1];let M=X.range(0,s.dims[3]-1,1);y[2]&&(M=X.range(s.dims[3]-1,0,-1));for(let E=0;E<s.dims[3];E++)M[E]*=w[2];let D=X.range(0,s.dims[4]-1,1);y[3]&&(D=X.range(s.dims[4]-1,0,-1));for(let E=0;E<s.dims[4];E++)D[E]*=w[3];let v=X.range(0,s.dims[5]-1,1);y[4]&&(v=X.range(s.dims[5]-1,0,-1));for(let E=0;E<s.dims[5];E++)v[E]*=w[4];let C=0,I,S;switch(s.datatypeCode){case 256:I=new Int8Array(A),S=new Int8Array(g);break;case 2:I=new Uint8Array(A),S=new Uint8Array(g);break;case 4:I=new Int16Array(A),S=new Int16Array(g);break;case 512:I=new Uint16Array(A),S=new Uint16Array(g);break;case 8:I=new Int32Array(A),S=new Int32Array(g);break;case 768:I=new Uint32Array(A),S=new Uint32Array(g);break;case 16:I=new Float32Array(A),S=new Float32Array(g);break;case 64:I=new Float64Array(A),S=new Float64Array(g);break;default:throw new Error("unknown datatypeCode")}for(let E=0;E<s.dims[5];E++)for(let V=0;V<s.dims[4];V++)for(let T=0;T<s.dims[3];T++)for(let R=0;R<s.dims[2];R++)for(let N=0;N<s.dims[1];N++)S[C]=I[x[N]+b[R]+M[T]+D[V]+v[E]],C++;return S}async readNRRD(t,i){this.hdr=new et;const s=this.hdr;s.pixDims=[1,1,1,1,1,0,0,0];const r=t.byteLength;let n=null;const o=new Uint8Array(t);for(let g=1;g<r;g++)if(o[g-1]===10&&o[g]===10){const A=t.slice(0,g-1);n=new TextDecoder().decode(A),s.vox_offset=g+1;break}if(n===null)throw new Error("could not extract txt");const l=n.split(`
`);l[0].startsWith("NRRD")||alert("Invalid NRRD image");const a=l.length;let c=!1,h=!1,d=!1;const f=me(NaN,0,0,0,1,0,0,0,1),u=Q(0,0,0);let m=on();for(let g=1;g<a;g++){let A=l[g];if(A[0]==="#")continue;A=A.toLowerCase();const p=A.split(":");if(p.length<2)continue;const w=p[0].trim();let y=p[1].trim();switch(y=y.replaceAll(")"," "),y=y.replaceAll("("," "),y=y.trim(),w){case"data file":d=!0;break;case"encoding":y.includes("raw")?c=!1:y.includes("gz")?c=!0:alert("Unsupported NRRD encoding");break;case"type":switch(y){case"uchar":case"unsigned char":case"uint8":case"uint8_t":s.numBitsPerVoxel=8,s.datatypeCode=2;break;case"signed char":case"int8":case"int8_t":s.numBitsPerVoxel=8,s.datatypeCode=256;break;case"short":case"short int":case"signed short":case"signed short int":case"int16":case"int16_t":s.numBitsPerVoxel=16,s.datatypeCode=4;break;case"ushort":case"unsigned short":case"unsigned short int":case"uint16":case"uint16_t":s.numBitsPerVoxel=16,s.datatypeCode=512;break;case"int":case"signed int":case"int32":case"int32_t":s.numBitsPerVoxel=32,s.datatypeCode=8;break;case"uint":case"unsigned int":case"uint32":case"uint32_t":s.numBitsPerVoxel=32,s.datatypeCode=768;break;case"float":s.numBitsPerVoxel=32,s.datatypeCode=16;break;case"double":s.numBitsPerVoxel=64,s.datatypeCode=64;break;default:throw new Error("Unsupported NRRD data type: "+y)}break;case"spacings":{const x=y.split(/[ ,]+/);for(let b=0;b<x.length;b++)s.pixDims[b+1]=parseFloat(x[b])}break;case"sizes":{const x=y.split(/[ ,]+/);s.dims[0]=x.length;for(let b=0;b<x.length;b++)s.dims[b+1]=parseInt(x[b])}break;case"endian":y.includes("little")?s.littleEndian=!0:y.includes("big")&&(s.littleEndian=!1);break;case"space directions":{const x=y.split(/[ ,]+/);if(x.length!==9)break;for(let b=0;b<9;b++)f[b]=parseFloat(x[b])}break;case"space origin":{const x=y.split(/[ ,]+/);if(x.length!==3)break;u[0]=parseFloat(x[0]),u[1]=parseFloat(x[1]),u[2]=parseFloat(x[2])}break;case"space units":y.includes("microns")&&(h=!0);break;case"space":y.includes("right-anterior-superior")||y.includes("ras")?m=me(1,0,0,0,1,0,0,0,1):y.includes("left-anterior-superior")||y.includes("las")?m=me(-1,0,0,0,1,0,0,0,1):y.includes("left-posterior-superior")||y.includes("lps")?m=me(-1,0,0,0,-1,0,0,0,1):P.warn("Unsupported NRRD space value:",y);break;default:P.warn("Unknown:",w)}}if(!isNaN(f[0])){this.hdr.sform_code=2,h&&(hn(f,f,.001),u[0]*=.001,u[1]*=.001,u[2]*=.001),m[0]<0&&(u[0]=-u[0]),m[4]<0&&(u[1]=-u[1]),m[8]<0&&(u[2]=-u[2]),Cs(f,m,f);const g=Qt(f[0],f[3],f[6],u[0],f[1],f[4],f[7],u[1],f[2],f[5],f[8],u[2],0,0,0,1),A=this.vox2mm([0,0,0],g),p=this.vox2mm([1,0,0],g);bt(p,p,A);const w=this.vox2mm([0,1,0],g);bt(w,w,A);const y=this.vox2mm([0,0,1],g);bt(y,y,A),s.pixDims[1]=he(p),s.pixDims[2]=he(w),s.pixDims[3]=he(y),s.affine=[[g[0],g[1],g[2],g[3]],[g[4],g[5],g[6],g[7]],[g[8],g[9],g[10],g[11]],[0,0,0,1]]}return d&&i?i.slice(0):(d&&P.warn("Missing data: NRRD header describes detached data file but only one URL provided"),c?await X.decompressToBuffer(new Uint8Array(t.slice(s.vox_offset))):t.slice(s.vox_offset))}calculateRAS(){if(!this.hdr)throw new Error("hdr not set");const t=this.hdr.affine,i=this.hdr,s=me(Math.abs(t[0][0]),Math.abs(t[0][1]),Math.abs(t[0][2]),Math.abs(t[1][0]),Math.abs(t[1][1]),Math.abs(t[1][2]),Math.abs(t[2][0]),Math.abs(t[2][1]),Math.abs(t[2][2])),r=[1,1,1];s[3]>s[0]&&(r[0]=2),s[6]>s[0]&&s[6]>s[3]&&(r[0]=3),r[1]=1,r[0]===1?s[4]>s[7]?r[1]=2:r[1]=3:r[0]===2?s[1]>s[7]?r[1]=1:r[1]=3:s[1]>s[4]?r[1]=1:r[1]=2,r[2]=6-r[1]-r[0];let n=[1,2,3];n[r[0]-1]=1,n[r[1]-1]=2,n[r[2]-1]=3;let o=Qt(t[0][0],t[0][1],t[0][2],t[0][3],t[1][0],t[1][1],t[1][2],t[1][3],t[2][0],t[2][1],t[2][2],t[2][3],0,0,0,1);this.mm000=this.vox2mm([-.5,-.5,-.5],o),this.mm100=this.vox2mm([i.dims[1]-.5,-.5,-.5],o),this.mm010=this.vox2mm([-.5,i.dims[2]-.5,-.5],o),this.mm001=this.vox2mm([-.5,-.5,i.dims[3]-.5],o);const l=nt();an(l,o);for(let A=0;A<3;A++)for(let p=0;p<3;p++)l[A*4+p]=o[A*4+n[p]-1];const a=[0,0,0];l[0]<0&&(a[0]=1),l[5]<0&&(a[1]=1),l[10]<0&&(a[2]=1),this.dimsRAS=[i.dims[0],i.dims[n[0]],i.dims[n[1]],i.dims[n[2]]],this.pixDimsRAS=[i.pixDims[0],i.pixDims[n[0]],i.pixDims[n[1]],i.pixDims[n[2]]],this.permRAS=n.slice();for(let A=0;A<3;A++)a[A]===1&&(this.permRAS[A]=-this.permRAS[A]);if(this.arrayEquals(n,[1,2,3])&&this.arrayEquals(a,[0,0,0])){this.toRAS=nt(),this.matRAS=It(o),this.calculateOblique(),this.img2RASstep=[1,this.dimsRAS[1],this.dimsRAS[1]*this.dimsRAS[2]],this.img2RASstart=[0,0,0];return}gr(o),o[0+0*4]=1-a[0]*2,o[1+1*4]=1-a[1]*2,o[2+2*4]=1-a[2]*2,o[3+0*4]=(i.dims[n[0]]-1)*a[0],o[3+1*4]=(i.dims[n[1]]-1)*a[1],o[3+2*4]=(i.dims[n[2]]-1)*a[2];const c=nt();zt(c,o),ce(c,c,l),this.matRAS=It(c),o=Qt(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1),o[n[0]-1+0*4]=-a[0]*2+1,o[n[1]-1+1*4]=-a[1]*2+1,o[n[2]-1+2*4]=-a[2]*2+1,o[3+0*4]=a[0],o[3+1*4]=a[1],o[3+2*4]=a[2],this.toRAS=It(o),o[3]=0,o[7]=0,o[11]=0,o[12]=0,(this.permRAS[0]===-1||this.permRAS[1]===-1||this.permRAS[2]===-1)&&(o[12]=i.dims[1]-1),o[13]=0,(this.permRAS[0]===-2||this.permRAS[1]===-2||this.permRAS[2]===-2)&&(o[13]=i.dims[2]-1),o[14]=0,(this.permRAS[0]===-3||this.permRAS[1]===-3||this.permRAS[2]===-3)&&(o[14]=i.dims[3]-1),this.toRASvox=It(o),P.debug(this.hdr.dims),P.debug(this.dimsRAS);const h=this.hdr;n=this.permRAS;const d=[Math.abs(n[0]),Math.abs(n[1]),Math.abs(n[2])],f=[h.dims[d[0]],h.dims[d[1]],h.dims[d[2]]],u=[1,h.dims[1],h.dims[1]*h.dims[2]],m=[u[d[0]-1],u[d[1]-1],u[d[2]-1]],g=[0,0,0];for(let A=0;A<3;A++)n[A]<0&&(g[A]=m[A]*(f[A]-1),m[A]=-m[A]);this.img2RASstep=m,this.img2RASstart=g,this.calculateOblique()}async hdr2RAS(t=1){if(!this.permRAS)throw new Error("permRAS undefined");if(!this.hdr)throw new Error("hdr undefined");const i=hi({...this.hdr},!1),s=await Ye(i.buffer,!0);t===1?(s.dims[0]=3,s.dims[4]=1):t>1&&(s.dims[0]=4,s.dims[4]=t);const r=this.permRAS.slice();if(r[0]===1&&r[1]===2&&r[2]===3)return s;s.qform_code=0;for(let o=1;o<4;o++)s.dims[o]=this.dimsRAS[o];for(let o=0;o<this.pixDimsRAS.length;o++)s.pixDims[o]=this.pixDimsRAS[o];let n=0;for(let o=0;o<4;o++)for(let l=0;l<4;l++)s.affine[o][l]=this.matRAS[n],n++;return s}img2RAS(t=0){if(!this.permRAS)throw new Error("permRAS undefined");if(!this.img)throw new Error("img undefined");if(!this.hdr)throw new Error("hdr undefined");const i=this.permRAS.slice();if(i[0]===1&&i[1]===2&&i[2]===3)return this.img;const s=this.hdr,r=s.dims[1]*s.dims[2]*s.dims[3];let n=t*r;(n+r>this.img.length||n<0)&&(n=0,P.warn(`img2RAS nVolume (${t}) out of bounds (${t}+1)${r} > ${this.img.length}`));const o=this.img.slice(0,r),l=[Math.abs(i[0]),Math.abs(i[1]),Math.abs(i[2])],a=[s.dims[l[0]],s.dims[l[1]],s.dims[l[2]]],c=[1,s.dims[1],s.dims[1]*s.dims[2]],h=[c[l[0]-1],c[l[1]-1],c[l[2]-1]],d=[0,0,0];for(let u=0;u<3;u++)i[u]<0&&(d[u]=h[u]*(a[u]-1),h[u]=-h[u]);let f=0;for(let u=0;u<a[2];u++){const m=d[2]+u*h[2];for(let g=0;g<a[1];g++){const A=d[1]+g*h[1];for(let p=0;p<a[0];p++){const w=d[0]+p*h[0];o[f]=this.img[w+A+m+n],f++}}}return o}vox2mm(t,i){const s=It(i);Ht(s,s);const r=xt(t[0],t[1],t[2],1);return Tt(r,r,s),Q(r[0],r[1],r[2])}mm2vox(t,i=!1){if(!this.matRAS)throw new Error("matRAS undefined");const s=It(this.matRAS),r=It(s);Ht(r,s),zt(r,r);const n=xt(t[0],t[1],t[2],1);Tt(n,n,r);const o=Q(n[0],n[1],n[2]);return i?o:[Math.round(o[0]),Math.round(o[1]),Math.round(o[2])]}arrayEquals(t,i){return Array.isArray(t)&&Array.isArray(i)&&t.length===i.length&&t.every((s,r)=>s===i[r])}setColormap(t){this._colormap=t,this.calMinMax(),this.onColormapChange&&this.onColormapChange(this)}setColormapLabel(t){this.colormapLabel=mt.makeLabelLut(t)}async setColormapLabelFromUrl(t){this.colormapLabel=await mt.makeLabelLutFromUrl(t)}get colormap(){return this._colormap}get colorMap(){return this._colormap}set colormap(t){this.setColormap(t)}set colorMap(t){this.setColormap(t)}get opacity(){return this._opacity}set opacity(t){this._opacity=t,this.onOpacityChange&&this.onOpacityChange(this)}calMinMax(t=Number.POSITIVE_INFINITY,i=!0){if(!this.hdr)throw new Error("hdr undefined");if(!this.img)throw new Error("img undefined");let s=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,n=0,o=0,l=this.hdr.dims[1]*this.hdr.dims[2]*this.hdr.dims[3];const a=Math.floor(this.img.length/l);t>=a&&(t=this.frame4D),t=Math.min(t,a-1);const c=t*l;let h=[];if(i){const V=[Math.floor(.25*this.hdr.dims[1]),Math.floor(.25*this.hdr.dims[2]),Math.floor(.25*this.hdr.dims[3])],T=[this.hdr.dims[1]-2*V[0],this.hdr.dims[2]-2*V[1],this.hdr.dims[3]-2*V[2]],R=[T[0]+V[0],T[1]+V[1],T[2]+V[2]];l=T[0]*T[1]*T[2],h=new this.img.constructor(l);let N=-1,O=0;for(let G=0;G<this.hdr.dims[3];G++)for(let z=0;z<this.hdr.dims[2];z++)for(let q=0;q<this.hdr.dims[1];q++)N++,!(q<V[0]||z<V[1]||G<V[2])&&(q>=R[0]||z>=R[1]||G>=R[2]||(h[O]=this.img[N+c],O++))}else{h=new this.img.constructor(l);for(let E=0;E<l;E++)h[E]=this.img[E+c]}const d=h.constructor!==Float64Array&&h.constructor!==Float32Array&&this.ignoreZeroVoxels;if(d)for(let E=0;E<l;E++)s=Math.min(h[E],s),r=Math.max(h[E],r),h[E]===0&&n++;else for(let E=0;E<l;E++){if(isNaN(h[E])){o++;continue}h[E]===0&&(n++,this.ignoreZeroVoxels)||(s=Math.min(h[E],s),r=Math.max(h[E],r))}this.ignoreZeroVoxels&&s===r&&n>0&&(s=0);const f=this.intensityRaw2Scaled(s),u=this.intensityRaw2Scaled(r),m=mt.colormapFromKey(this._colormap);let g=0,A=0;if(m.min!==void 0&&(g=m.min),m.max!==void 0&&(A=m.max),g===A&&this.trustCalMinMax&&isFinite(this.hdr.cal_min)&&isFinite(this.hdr.cal_max)&&this.hdr.cal_max>this.hdr.cal_min)return this.cal_min=this.hdr.cal_min,this.cal_max=this.hdr.cal_max,this.robust_min=this.cal_min,this.robust_max=this.cal_max,this.global_min=f,this.global_max=u,[this.hdr.cal_min,this.hdr.cal_max,this.hdr.cal_min,this.hdr.cal_max];if(g!==A)return this.cal_min=g,this.cal_max=A,this.robust_min=this.cal_min,this.robust_max=this.cal_max,[g,A,g,A];const p=100*n/(l-0);let w=!1;p>60&&!this.ignoreZeroVoxels&&(P.warn(`${Math.round(p)}% of voxels are zero: ignoring zeros for cal_max`),w=!0,this.ignoreZeroVoxels=!0),this.ignoreZeroVoxels||(n=0),n+=o;const y=Math.round((l-0-n)*this.percentileFrac);if(y<1||s===r)return P.debug("no variability in image intensity?"),this.cal_min=f,this.cal_max=u,this.robust_min=this.cal_min,this.robust_max=this.cal_max,this.global_min=f,this.global_max=u,[f,u,f,u];const x=1001,b=(x-1)/(r-s),M=new Array(x);for(let E=0;E<x;E++)M[E]=0;if(d)for(let E=0;E<l;E++)M[Math.round((h[E]-s)*b)]++;else if(this.ignoreZeroVoxels)for(let E=0;E<l;E++)h[E]!==0&&(isNaN(h[E])||M[Math.round((h[E]-s)*b)]++);else for(let E=0;E<l;E++)isNaN(h[E])||M[Math.round((h[E]-s)*b)]++;let D=0,v=0;for(;D<y;)D+=M[v],v++;v--,D=0;let C=x;for(;D<y;)C--,D+=M[C];if(v===C){let E=-1;for(;E!==0;)v>0&&(v--,M[v]>0&&(E=0)),E!==0&&C<x-1&&(C++,M[C]>0&&(E=0)),v===0&&C===x-1&&(E=0)}let I=this.intensityRaw2Scaled(v/b+s),S=this.intensityRaw2Scaled(C/b+s);return this.hdr.cal_min<this.hdr.cal_max&&this.hdr.cal_min>=f&&this.hdr.cal_max<=u&&(I=this.hdr.cal_min,S=this.hdr.cal_max),w&&(I=Math.min(I,0)),this.cal_min=I,this.cal_max=S,this.robust_min=this.cal_min,this.robust_max=this.cal_max,this.global_min=f,this.global_max=u,[I,S,f,u]}intensityRaw2Scaled(t){if(!this.hdr)throw new Error("hdr undefined");return this.hdr.scl_slope===0&&(this.hdr.scl_slope=1),t*this.hdr.scl_slope+this.hdr.scl_inter}intensityScaled2Raw(t){if(!this.hdr)throw new Error("hdr undefined");return this.hdr.scl_slope===0&&(this.hdr.scl_slope=1),(t-this.hdr.scl_inter)/this.hdr.scl_slope}async saveToUint8Array(t,i=null){if(!this.hdr)throw new Error("hdr undefined");if(!this.img)throw new Error("img undefined");const s=i!==null,r=hi(this.hdr,s),n=new Uint8Array(4);let o=new Uint8Array(this.img.buffer);s&&(o=new Uint8Array(i.buffer));const l=new Uint8Array(r.length+n.length+o.length);l.set(r),l.set(n,r.length),l.set(o,r.length+n.length);let a=null;return t.endsWith(".gz")?a=new Uint8Array(await X.compress(l,"gzip")):a=l,a}async saveToDisk(t="",i=null){const s=await this.saveToUint8Array(t,i);if(t==="")return P.debug("saveToDisk: empty file name, returning data as Uint8Array rather than triggering download"),s;const r=new Blob([s.buffer],{type:"application/octet-stream"}),n=URL.createObjectURL(r),o=document.createElement("a");return o.setAttribute("href",n),o.setAttribute("download",t),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o),s}static async fetchDicomData(t,i={}){if(t==="")throw Error("url must not be empty");let r=/^(?:[a-z+]+:)?\/\//i.test(t)?t:new URL(t,window.location.href);/(?:.([^.]+))?$/.exec(r.pathname)||(r=new URL("niivue-manifest.txt",t));let l=await fetch(r,{headers:i});if(!l.ok)throw Error(l.statusText);const c=(await l.text()).split(`
`),d=/(.*\/).*/.exec(r)[0],f=[];for(const u of c){const m=new URL(u,d);if(l=await fetch(m,{headers:i}),!l.ok)throw Error(l.statusText);const g=await l.arrayBuffer();f.push({name:u,data:g})}return f}static async readFirstDecompressedBytes(t,i){const s=t.getReader(),r=new zn,n=[];let o=0,l=!1,a,c;const h=new Promise((f,u)=>{a=f,c=u});function d(){const f=new Uint8Array(o);let u=0;for(const m of n)f.set(m,u),u+=m.length;a(f)}return r.ondata=f=>{n.push(f),o+=f.length,o>=i&&(l=!0,s.cancel().catch(()=>{}),d())},(async()=>{try{for(;!l;){const{done:f,value:u}=await s.read();if(f){l=!0,r.push(new Uint8Array,!0);return}r.push(u,!1)}}catch(f){c(f)}})().catch(()=>{}),h}static extractFilenameFromUrl(t){const s=new URL(t).searchParams.get("response-content-disposition");if(s){const r=s.match(/filename\*?=(?:UTF-8'')?"?([^";]+)"?/);if(r)return decodeURIComponent(r[1])}return t.split("/").pop().split("?")[0]}static async loadInitialVolumesGz(t="",i={},s=NaN){if(isNaN(s))return null;const r=await fetch(t,{headers:i,cache:"force-cache"});let n=352,o=await this.readFirstDecompressedBytes(r.body,n);const l=new DataView(o.buffer,o.byteOffset,o.byteLength),a=l.getUint16(0,!0),c=a===348;if(!c&&!(a===23553)||(o.length>111&&(n=l.getFloat32(108,c)),n>o.length&&(o=await this.readFirstDecompressedBytes(r.body,n)),!(o[0]===92&&o[1]===1||o[1]===92&&o[0]===1)))return null;const f=await Ye(o.buffer);if(!f)throw new Error("Could not read NIfTI header");const u=f.numBitsPerVoxel/8,m=[1,2,3].reduce((x,b)=>x*(f.dims[b]>1?f.dims[b]:1),1),g=[4,5,6].reduce((x,b)=>x*(f.dims[b]>1?f.dims[b]:1),1),A=Math.max(Math.min(s,g),1),p=f.vox_offset+A*m*u;if(A===g)return null;const w=await fetch(t,{headers:i,cache:"force-cache"});return(await this.readFirstDecompressedBytes(w.body,p)).buffer.slice(0,p)}static async loadInitialVolumes(t="",i={},s=NaN){if(isNaN(s))return null;const n=(await fetch(t,{headers:i,cache:"force-cache"})).body.getReader(),{value:o,done:l}=await n.read();let a=o;if(l||!a||a.length<2)throw new Error("Not enough data to determine compression");const c=new DataView(a.buffer,a.byteOffset,a.byteLength),h=c.getUint16(0,!0);if(h===35615)return await n.cancel(),this.loadInitialVolumesGz(t,i,s);const f=h===348;if(!f&&!(h===23553))return await n.cancel(),null;let m=352;for(a.length>111&&(m=c.getFloat32(108,f));a.length<m;){let v=function(S,E){const V=new Uint8Array(S.length+E.length);return V.set(S,0),V.set(E,S.length),V};const{value:C,done:I}=await n.read();if(I||!C)break;a=v(a,C)}const g=await Ye(a.buffer);if(!g)throw new Error("Could not read NIfTI header");const A=g.numBitsPerVoxel/8,p=[1,2,3].reduce((v,C)=>v*(g.dims[C]>1?g.dims[C]:1),1),w=[4,5,6].reduce((v,C)=>v*(g.dims[C]>1?g.dims[C]:1),1),y=Math.max(Math.min(s,w),1),x=g.vox_offset+y*p*A,b=new Uint8Array(x),M=Math.min(a.length,x);b.set(a.subarray(0,M),0);let D=M;for(;D<x;){const{value:v,done:C}=await n.read();if(C||!v)return await n.cancel(),null;const I=Math.min(v.length,x-D);b.set(v.subarray(0,I),D),D+=I}return await n.cancel(),b.buffer}static async loadFromUrl({url:t="",urlImgData:i="",headers:s={},name:r="",colormap:n="gray",opacity:o=1,cal_min:l=NaN,cal_max:a=NaN,trustCalMinMax:c=!0,percentileFrac:h=.02,ignoreZeroVoxels:d=!1,useQFormNotSForm:f=!1,colormapNegative:u="",frame4D:m=0,isManifest:g=!1,limitFrames4D:A=NaN,imageType:p=st.UNKNOWN,colorbarVisible:w=!0,buffer:y=new ArrayBuffer(0)}={}){if(t==="")throw Error("url must not be empty");let x=null,b=null;if(t instanceof Uint8Array&&(t=t.buffer),y.byteLength>0&&(t=y),t instanceof ArrayBuffer)if(b=t,r!=="")t=r;else{const I=new Uint8Array(b);t=I[0]===31&&I[1]===139?"array.nii.gz":"array.nii"}function M(I){const S=I.match(/\.([^.]+)(?:\.gz|\.bz2|\.xz)?$/);return S?S[1]:""}let D="";if(r===""?D=M(t):D=M(r),p===st.UNKNOWN&&(p=st.parse(D)),p===st.UNKNOWN&&typeof t=="string"){const I=await fetch(t,{});if(I.redirected){const S=this.extractFilenameFromUrl(I.url);S&&S.length>0&&r===""&&(r=S,D=M(r),p=st.parse(D))}}const v=p===st.DCM||st.NII;if(!b&&v&&(b=await this.loadInitialVolumes(t,s,A)),!b)if(g)b=await Ti.fetchDicomData(t,s),p=st.DCM_MANIFEST;else{const I=await fetch(t,{headers:s});if(!I.ok)throw Error(I.statusText);if(!I.body)throw new Error("No readable stream available");const S=await Wi(I.body),E=[],V=S.getReader();for(;;){const{done:O,value:G}=await V.read();if(O)break;E.push(G)}const T=E.reduce((O,G)=>O+G.length,0);b=new ArrayBuffer(T);const R=new Uint8Array(b);let N=0;for(const O of E)R.set(O,N),N+=O.length}D.toUpperCase()==="HEAD"&&i===""&&(i=t.substring(0,t.lastIndexOf("HEAD"))+"BRIK");let C=null;if(i)try{let I=await fetch(i,{headers:s});if(I.status===404&&i.includes("BRIK")&&(I=await fetch(`${i}.gz`,{headers:s})),I.ok&&I.body){const S=await Wi(I.body),E=[],V=S.getReader();for(;;){const{done:O,value:G}=await V.read();if(O)break;E.push(G)}const T=E.reduce((O,G)=>O+G.length,0);C=new ArrayBuffer(T);const R=new Uint8Array(C);let N=0;for(const O of E)R.set(O,N),N+=O.length}}catch(I){console.error("Error loading paired image data:",I)}if(!b)throw new Error("Unable to load buffer properly from volume");if(!r){let I;try{I=new URL(t).pathname.split("/")}catch{I=t.split("/")}r=I.slice(-1)[0],r.indexOf("?")>-1&&(r=r.slice(0,r.indexOf("?")))}return x=await this.new(b,r,n,o,C,l,a,c,h,d,f,u,m,p),x.url=t,x.colorbarVisible=w,x}static async readFileAsync(t,i=NaN){let s=t.stream();if(!isNaN(i)){let d=0;const f=new TransformStream({transform(u,m){if(d>=i){m.terminate();return}const g=i-d;u.length>g?(m.enqueue(u.slice(0,g)),m.terminate()):m.enqueue(u),d+=u.length}});s=s.pipeThrough(f)}const r=await Wi(s),n=[],o=r.getReader();for(;;){const{done:d,value:f}=await o.read();if(d)break;n.push(f)}const l=n.reduce((d,f)=>d+f.length,0),a=new ArrayBuffer(l),c=new Uint8Array(a);let h=0;for(const d of n)c.set(d,h),h+=d.length;return a}static async loadFromFile({file:t,name:i="",colormap:s="gray",opacity:r=1,urlImgData:n=null,cal_min:o=NaN,cal_max:l=NaN,trustCalMinMax:a=!0,percentileFrac:c=.02,ignoreZeroVoxels:h=!1,useQFormNotSForm:d=!1,colormapNegative:f="",frame4D:u=0,limitFrames4D:m=NaN,imageType:g=st.UNKNOWN}){let A=null,p=[];try{if(Array.isArray(t))p=await Promise.all(t.map(y=>this.readFileAsync(y)));else{if(isNaN(m))p=await this.readFileAsync(t);else{const y=await this.readFileAsync(t,512),x=new Uint8Array(y);if(!(x[0]===92&&x[1]===1||x[1]===92&&x[0]===1))p=await this.readFileAsync(t);else{const M=await Ye(y);if(!M)throw new Error("could not read nifti header");const D=M.numBitsPerVoxel/8,v=[1,2,3].reduce((E,V)=>E*(M.dims[V]>1?M.dims[V]:1),1),C=[4,5,6].reduce((E,V)=>E*(M.dims[V]>1?M.dims[V]:1),1),I=Math.max(Math.min(m,C),1),S=M.vox_offset+I*v*D;p=await this.readFileAsync(t,S)}}i=t.name}let w=null;n&&(w=await this.readFileAsync(n)),A=await this.new(p,i,s,r,w,o,l,a,c,h,d,f,u,g),A.fileObject=t}catch(w){throw P.error(w),new Error("could not build NVImage")}if(A===null)throw new Error("could not build NVImage");return A}static createNiftiArray(t=[256,256,256],i=[1,1,1],s=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],r=2,n=new Uint8Array){const o=this.createNiftiHeader(t,i,s,r),l=hi(o,!1);if(n.length<1)return l;const a=new Uint8Array(4),c=new Uint8Array(n.buffer),h=new Uint8Array(l.length+a.length+c.length);return h.set(l),h.set(a,l.length),h.set(c,l.length+a.length),h}static createNiftiHeader(t=[256,256,256],i=[1,1,1],s=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],r=2){const n=new et;n.littleEndian=!0,n.dims=[3,1,1,1,0,0,0,0],n.dims[0]=Math.max(3,t.length);for(let l=0;l<t.length;l++)n.dims[l+1]=t[l];n.pixDims=[1,1,1,1,1,0,0,0];for(let l=0;l<t.length;l++)n.pixDims[l+1]=i[l];if(s.length===16){let l=0;for(let a=0;a<4;a++)for(let c=0;c<4;c++)n.affine[a][c]=s[l],l++}let o=8;return r===256||r===2?o=8:r===512||r===4?o=16:r===16||r===768||r===8||r===2304?o=32:r===64?o=64:P.warn("Unsupported NIfTI datatypeCode: "+r),n.datatypeCode=r,n.numBitsPerVoxel=o,n.scl_inter=0,n.scl_slope=0,n.sform_code=2,n.magic="n+1",n.vox_offset=352,n}getVolumeData(t=[-1,0,0],i=[0,0,0],s="same"){let r=new Uint8Array;if(Math.min(...t)<0||Math.min(...i)<0)return[r,[0,0,0]];const n=this.dimsRAS.slice(1,4);for(let f=0;f<3;f++)if(t[f]=Math.min(t[f],n[f]-1),i[f]=Math.min(i[f],n[f]-1),i[f]<t[f]){const u=i[f];i[f]=t[f],t[f]=u}const o=[i[0]-t[0]+1,i[1]-t[1]+1,i[2]-t[2]+1],l=o[0]*o[1]*o[2];let a=this.hdr.datatypeCode;if(s==="uint8"?a=2:(s==="float32"||s==="scaled"||s==="normalized"||s==="windowed")&&(a=16),a===2)r=new Uint8Array(l);else if(a===4)r=new Int16Array(l);else if(a===512)r=new Uint16Array(l);else if(a===16)r=new Float32Array(l);else if(a===64)r=new Float64Array(l);else return P.error("getVolumeData unsupported datatype"),[r,[0,0,0]];const c=this.img2RASstep,h=this.img2RASstart;let d=0;for(let f=t[2];f<=i[2];f++){const u=h[2]+f*c[2];for(let m=t[1];m<=i[1];m++){const g=u+h[1]+m*c[1];for(let A=t[0];A<=i[0];A++){const p=h[0]+A*c[0];r[d++]=this.img[p+g]}}}if(s==="scaled"||s==="normalized"||s==="windowed")for(let f=0;f<r.length;f++)r[f]=r[f]*this.hdr.scl_slope+this.hdr.scl_inter;if(s==="normalized"||s==="windowed"){let f=this.cal_min,u=this.cal_max;s==="normalized"&&(f=this.global_min,u=this.global_max);const m=1/(u-f);for(let g=0;g<r.length;g++)r[g]=(r[g]-f)*m,r[g]=Math.max(Math.min(r[g],1),0)}return[r,o]}setVolumeData(t=[-1,0,0],i=[0,0,0],s=new Uint8Array){if(s.length<1||Math.min(...t)<0||Math.min(...i)<0)return;const r=this.dimsRAS.slice(1,4);for(let h=0;h<3;h++)if(t[h]=Math.min(t[h],r[h]-1),i[h]=Math.min(i[h],r[h]-1),i[h]<t[h]){const d=i[h];i[h]=t[h],t[h]=d}const n=[i[0]-t[0]+1,i[1]-t[1]+1,i[2]-t[2]+1],o=n[0]*n[1]*n[2];if(s.length<o){P.error("setVolumeData image does not have enough voxels");return}const l=this.img2RASstep,a=this.img2RASstart;let c=0;for(let h=t[2];h<=i[2];h++){const d=a[2]+h*l[2];for(let f=t[1];f<=i[1];f++){const u=d+a[1]+f*l[1];for(let m=t[0];m<=i[0];m++){const g=a[0]+m*l[0];this.img[g+u]=s[c++]}}}}static async loadFromBase64({base64:t,name:i="",colormap:s="gray",opacity:r=1,cal_min:n=NaN,cal_max:o=NaN,trustCalMinMax:l=!0,percentileFrac:a=.02,ignoreZeroVoxels:c=!1,useQFormNotSForm:h=!1,colormapNegative:d="",frame4D:f=0,imageType:u=st.UNKNOWN,cal_minNeg:m=NaN,cal_maxNeg:g=NaN,colorbarVisible:A=!0,colormapLabel:p=null}){function w(x){const b=window.atob(x),M=b.length,D=new Uint8Array(M);for(let v=0;v<M;v++)D[v]=b.charCodeAt(v);return D.buffer}let y=null;try{const x=w(t);y=await this.new(x,i,s,r,null,n,o,l,a,c,h,d,f,u,m,g,A,p)}catch(x){P.debug(x)}if(y===null)throw new Error("could not load NVImage");return y}clone(){const t=new Ti;return t.id=es(),t.hdr=Object.assign({},this.hdr),t.img=this.img.slice(),t.calculateRAS(),t.calMinMax(),t}zeroImage(){this.img.fill(0)}getImageMetadata(){if(!this.hdr)throw new Error("hdr undefined");const t=this.id,i=this.hdr.datatypeCode,s=this.hdr.dims,r=s[1],n=s[2],o=s[3],l=Math.max(1,s[4]),a=this.hdr.pixDims,c=a[1],h=a[2],d=a[3],f=a[4],u=Math.floor(this.hdr.numBitsPerVoxel/8);return{id:t,datatypeCode:i,nx:r,ny:n,nz:o,nt:l,dx:c,dy:h,dz:d,dt:f,bpv:u}}static zerosLike(t,i="same"){const s=t.clone();return s.zeroImage(),i==="uint8"&&(s.img=Uint8Array.from(s.img),s.hdr.datatypeCode=2,s.hdr.numBitsPerVoxel=8),i==="float32"&&(s.img=Float32Array.from(s.img),s.hdr.datatypeCode=16,s.hdr.numBitsPerVoxel=32),s}getValue(t,i,s,r=0,n=!1){if(!this.hdr)throw new Error("hdr undefined");if(!this.img)throw new Error("img undefined");const o=this.hdr.dims[1],l=this.hdr.dims[2],a=this.hdr.dims[3],c=this.permRAS.slice();if(c[0]!==1||c[1]!==2||c[2]!==3){const u=xt(t,i,s,1);Tt(u,u,this.toRASvox),t=u[0],i=u[1],s=u[2]}let h=t+i*o+s*o*l;if(this.hdr.datatypeCode===2304)return h*=4,Math.round(this.img[h]*.21+this.img[h+1]*.72+this.img[h+2]*.07);if(this.hdr.datatypeCode===128)return h*=3,Math.round(this.img[h]*.21+this.img[h+1]*.72+this.img[h+2]*.07);const d=r*o*l*a;let f=this.img[h+d];return n&&(f=this.imaginary[h+d]),this.hdr.scl_slope*f+this.hdr.scl_inter}toNiivueObject3D(t,i){const s=this.dimsRAS,r=this.matRAS,n=this.pixDimsRAS,o=-.5,l=-.5,a=-.5,c=s[1]-1+.5,h=s[2]-1+.5,d=s[3]-1+.5,f=this.vox2mm([o,l,a],r),u=this.vox2mm([o,h,a],r),m=this.vox2mm([o,l,d],r),g=this.vox2mm([o,h,d],r),A=this.vox2mm([c,l,a],r),p=this.vox2mm([c,h,a],r),w=this.vox2mm([c,l,d],r),y=this.vox2mm([c,h,d],r),x=[...m,0,0,1,...w,1,0,1,...y,1,1,1,...g,0,1,1,...f,0,0,0,...u,0,1,0,...p,1,1,0,...A,1,0,0],b=i.createBuffer();i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,b);const M=[0,3,2,2,1,0,4,7,6,6,5,4,5,6,2,2,3,5,4,0,1,1,7,4,7,1,2,2,6,7,4,5,3,3,0,4];i.bufferData(i.ELEMENT_ARRAY_BUFFER,new Uint16Array(M),i.STATIC_DRAW);const D=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,D),i.bufferData(i.ARRAY_BUFFER,new Float32Array(x),i.STATIC_DRAW);const v=i.createVertexArray();i.bindVertexArray(v),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,b),i.bindBuffer(i.ARRAY_BUFFER,D),i.enableVertexAttribArray(0),i.vertexAttribPointer(0,3,i.FLOAT,!1,24,0),i.enableVertexAttribArray(1),i.vertexAttribPointer(1,3,i.FLOAT,!1,24,12),i.bindVertexArray(null);const C=new ve(t,D,i.TRIANGLES,M.length,b,v),I=xl([...m,...w,...y,...g,...f,...u,...p,...A]);return C.extentsMin=I.min.slice(),C.extentsMax=I.max.slice(),C.furthestVertexFromOrigin=I.furthestVertexFromOrigin,C.originNegate=We(I.origin),dn(C.originNegate,C.originNegate),C.fieldOfViewDeObliqueMM=[s[1]*n[1],s[2]*n[2],s[3]*n[3]],C}applyOptionsUpdate(t){this.hdr.cal_min=t.cal_min,this.hdr.cal_max=t.cal_max,Object.assign(this,t)}getImageOptions(){return Si("","",this.name,this._colormap,this.opacity,this.hdr.cal_min,this.hdr.cal_max,this.trustCalMinMax,this.percentileFrac,this.ignoreZeroVoxels,this.useQFormNotSForm,this.colormapNegative,this.frame4D,this.imageType,this.colormapType)}toUint8Array(t=null){const i=t!==null,s=hi({...this.hdr},i);let r=t;if(i){const a=this.permRAS;if(a[0]!==1||a[1]!==2||a[2]!==3){const c=this.hdr.dims,h=[0,0,0];for(let x=0;x<3;x++)for(let b=0;b<3;b++)Math.abs(a[x])-1===b&&(h[b]=x*Math.sign(a[x]));let d=1;const f=[1,1,1],u=[!1,!1,!1];for(let x=0;x<h.length;x++)for(let b=0;b<h.length;b++)Math.abs(h[b])===x&&(f[b]=d,(h[b]<0||Object.is(h[b],-0))&&(u[b]=!0),d*=c[b+1]);let m=X.range(0,c[1]-1,1);u[0]&&(m=X.range(c[1]-1,0,-1));for(let x=0;x<c[1];x++)m[x]*=f[0];let g=X.range(0,c[2]-1,1);u[1]&&(g=X.range(c[2]-1,0,-1));for(let x=0;x<c[2];x++)g[x]*=f[1];let A=X.range(0,c[3]-1,1);u[2]&&(A=X.range(c[3]-1,0,-1));for(let x=0;x<c[3];x++)A[x]*=f[2];const p=new Uint8Array(t),w=new Uint8Array(c[1]*c[2]*c[3]);let y=0;for(let x=0;x<c[3];x++)for(let b=0;b<c[2];b++)for(let M=0;M<c[1];M++)w[y]=p[m[M]+g[b]+A[x]],y++;r=w,P.debug("drawing bytes"),P.debug(r)}}const n=i?r:new Uint8Array(this.img.buffer),o=new Uint8Array(4),l=new Uint8Array(s.length+o.length+n.length);return l.set(s),l.set(o,s.length),l.set(n,s.length+o.length),l}convertVox2Frac(t){return Q((t[0]+.5)/this.dimsRAS[1],(t[1]+.5)/this.dimsRAS[2],(t[2]+.5)/this.dimsRAS[3])}convertFrac2Vox(t){return Q(Math.round(t[0]*this.dims[1]-.5),Math.round(t[1]*this.dims[2]-.5),Math.round(t[2]*this.dims[3]-.5))}convertFrac2MM(t,i=!1){const s=xt(t[0],t[1],t[2],1);return i?Tt(s,s,this.frac2mm):Tt(s,s,this.frac2mmOrtho),s}convertMM2Frac(t,i=!1){const s=xt(t[0],t[1],t[2],1),r=this.dimsRAS,n=Q(0,0,0);if(typeof r>"u")return n;if(!i){const l=It(this.frac2mmOrtho);return zt(l,l),Tt(s,s,l),n[0]=s[0],n[1]=s[1],n[2]=s[2],n}if(r[1]<1||r[2]<1||r[3]<1)return n;const o=It(this.matRAS);return zt(o,o),Ht(o,o),Tt(s,s,o),n[0]=(s[0]+.5)/r[1],n[1]=(s[1]+.5)/r[2],n[2]=(s[2]+.5)/r[3],n}},kr=(e=>(e[e.NEVER=0]="NEVER",e[e.ALWAYS=1]="ALWAYS",e[e.AUTO=2]="AUTO",e))(kr||{}),Gr=(e=>(e[e.none=0]="none",e[e.contrast=1]="contrast",e[e.measurement=2]="measurement",e[e.pan=3]="pan",e[e.slicer3D=4]="slicer3D",e[e.callbackOnly=5]="callbackOnly",e[e.roiSelection=6]="roiSelection",e))(Gr||{}),le={textHeight:.06,colorbarHeight:.05,crosshairWidth:1,crosshairWidthUnit:"voxels",crosshairGap:0,rulerWidth:4,show3Dcrosshair:!1,backColor:[0,0,0,1],crosshairColor:[1,0,0,1],fontColor:[.5,.5,.5,1],selectionBoxColor:[1,1,1,.5],clipPlaneColor:[.7,0,.7,.5],clipThick:2,clipVolumeLow:[0,0,0],clipVolumeHigh:[1,1,1],rulerColor:[1,0,0,.8],colorbarMargin:.05,trustCalMinMax:!0,clipPlaneHotKey:"KeyC",viewModeHotKey:"KeyV",doubleTouchTimeout:500,longTouchTimeout:1e3,keyDebounceTime:50,isNearestInterpolation:!1,isResizeCanvas:!0,atlasOutline:0,isRuler:!1,isColorbar:!1,isOrientCube:!1,tileMargin:0,multiplanarPadPixels:0,multiplanarForceRender:!1,multiplanarEqualSize:!1,multiplanarShowRender:2,isRadiologicalConvention:!1,meshThicknessOn2D:1/0,dragMode:1,dragModePrimary:0,yoke3Dto2DZoom:!1,isDepthPickMesh:!1,isCornerOrientationText:!1,heroImageFraction:0,heroSliceType:4,sagittalNoseLeft:!1,isSliceMM:!1,isV1SliceShader:!1,forceDevicePixelRatio:0,logLevel:"info",loadingText:"loading ...",isForceMouseClickToVoxelCenters:!1,dragAndDropEnabled:!0,drawingEnabled:!1,penValue:1,floodFillNeighbors:6,isFilledPen:!1,thumbnail:"",maxDrawUndoBitmaps:8,sliceType:3,meshXRay:0,isAntiAlias:null,limitFrames4D:NaN,isAdditiveBlend:!1,showLegend:!0,legendBackgroundColor:[.3,.3,.3,.5],legendTextColor:[1,1,1,1],multiplanarLayout:0,renderOverlayBlend:1,sliceMosaicString:"",centerMosaic:!1,penSize:1,interactive:!0,clickToSegment:!1,clickToSegmentRadius:3,clickToSegmentBright:!0,clickToSegmentAutoIntensity:!1,clickToSegmentIntensityMax:NaN,clickToSegmentIntensityMin:NaN,clickToSegmentPercent:0,clickToSegmentMaxDistanceMM:Number.POSITIVE_INFINITY,clickToSegmentIs2D:!1,selectionBoxLineThickness:4,selectionBoxIsOutline:!1,scrollRequiresFocus:!1,showMeasureUnits:!0,measureTextJustify:"center",measureTextColor:[1,0,0,1],measureLineColor:[1,0,0,1],measureTextHeight:.03,isAlphaClipDark:!1,gradientOrder:1,gradientOpacity:0},Fi={gamma:1,azimuth:110,elevation:10,crosshairPos:Q(.5,.5,.5),clipPlane:[0,0,0,0],clipPlaneDepthAziElev:[2,0,0],volScaleMultiplier:1,pan2Dxyzmm:xt(0,0,0,1),clipThick:2,clipVolumeLow:[0,0,0],clipVolumeHigh:[1,1,1]},Xi=class Re{constructor(){F(this,"data",{title:"Untitled document",imageOptionsArray:[],meshOptionsArray:[],opts:{...le},previewImageDataURL:"",labels:[],encodedImageBlobs:[],encodedDrawingBlob:""}),F(this,"scene"),F(this,"volumes",[]),F(this,"meshDataObjects"),F(this,"meshes",[]),F(this,"drawBitmap",null),F(this,"imageOptionsMap",new Map),F(this,"meshOptionsMap",new Map),this.scene={onAzimuthElevationChange:()=>{},onZoom3DChange:()=>{},sceneData:{...Fi,pan2Dxyzmm:xt(0,0,0,1),crosshairPos:Q(.5,.5,.5)},get renderAzimuth(){return this.sceneData.azimuth},set renderAzimuth(t){this.sceneData.azimuth=t,this.onAzimuthElevationChange&&this.onAzimuthElevationChange(this.sceneData.azimuth,this.sceneData.elevation)},get renderElevation(){return this.sceneData.elevation},set renderElevation(t){this.sceneData.elevation=t,this.onAzimuthElevationChange&&this.onAzimuthElevationChange(this.sceneData.azimuth,this.sceneData.elevation)},get volScaleMultiplier(){return this.sceneData.volScaleMultiplier},set volScaleMultiplier(t){this.sceneData.volScaleMultiplier=t,this.onZoom3DChange(t)},get crosshairPos(){return this.sceneData.crosshairPos},set crosshairPos(t){this.sceneData.crosshairPos=t},get clipPlane(){return this.sceneData.clipPlane},set clipPlane(t){this.sceneData.clipPlane=t},get clipPlaneDepthAziElev(){return this.sceneData.clipPlaneDepthAziElev},set clipPlaneDepthAziElev(t){this.sceneData.clipPlaneDepthAziElev=t},get pan2Dxyzmm(){return this.sceneData.pan2Dxyzmm},set pan2Dxyzmm(t){this.sceneData.pan2Dxyzmm=t},get gamma(){return this.sceneData.gamma},set gamma(t){this.sceneData.gamma=t}}}get title(){return this.data.title}get previewImageDataURL(){return this.data.previewImageDataURL}set previewImageDataURL(t){this.data.previewImageDataURL=t}set title(t){this.data.title=t}get imageOptionsArray(){return this.data.imageOptionsArray}get encodedImageBlobs(){return this.data.encodedImageBlobs}get encodedDrawingBlob(){return this.data.encodedDrawingBlob}get opts(){return this.data.opts}set opts(t){this.data.opts={...t}}get labels(){return this.data.labels}set labels(t){this.data.labels=t}get customData(){return this.data.customData}set customData(t){this.data.customData=t}hasImage(t){return this.volumes.find(i=>i.id===t.id)!==void 0}hasImageFromUrl(t){return this.data.imageOptionsArray.find(i=>i.url===t)!==void 0}addImageOptions(t,i){if(!this.hasImage(t)&&!i.name)if(i.url){const r=/^(?:[a-z+]+:)?\/\//i.test(i.url)?new URL(i.url):new URL(i.url,window.location.href);i.name=r.pathname.split("/").pop(),i.name.toLowerCase().endsWith(".gz")&&(i.name=i.name.slice(0,-3)),i.name.toLowerCase().endsWith(".nii")||(i.name+=".nii")}else i.name="untitled.nii";i.imageType=st.NII,this.data.imageOptionsArray.push(i),this.imageOptionsMap.set(t.id,this.data.imageOptionsArray.length-1)}removeImage(t){if(this.imageOptionsMap.has(t.id)){const i=this.imageOptionsMap.get(t.id);this.data.imageOptionsArray.length>i&&this.data.imageOptionsArray.splice(i,1),this.imageOptionsMap.delete(t.id)}this.volumes=this.volumes.filter(i=>i.id!==t.id)}getImageOptions(t){return this.imageOptionsMap.has(t.id)?this.data.imageOptionsArray[this.imageOptionsMap.get(t.id)]:null}json(){const t={encodedImageBlobs:[],previewImageDataURL:this.data.previewImageDataURL,imageOptionsMap:new Map},i=[];t.sceneData={...this.scene.sceneData},t.opts={...this.opts},this.opts.meshThicknessOn2D===1/0&&(t.opts.meshThicknessOn2D="infinity"),t.labels=[...this.data.labels];for(const r of t.labels)delete r.onClick;if(t.customData=this.customData,this.volumes.length)for(let r=0;r<this.volumes.length;r++){const n=this.volumes[r];let o=this.getImageOptions(n);o===null?(P.warn("no options found for image, using default"),o={name:"",colormap:"gray",opacity:1,pairedImgData:null,cal_min:NaN,cal_max:NaN,trustCalMinMax:!0,percentileFrac:.02,ignoreZeroVoxels:!1,useQFormNotSForm:!1,colormapNegative:"",colormapLabel:null,imageType:st.NII,frame4D:0,limitFrames4D:NaN,url:"",urlImageData:"",alphaThreshold:!1,cal_minNeg:NaN,cal_maxNeg:NaN,colorbarVisible:!0}):"imageType"in o||(o.imageType=st.NII),o.colormap=n.colormap,o.colormapLabel=n.colormapLabel,o.opacity=n.opacity,o.cal_max=n.cal_max||NaN,o.cal_min=n.cal_min||NaN,i.push(o);const l=X.uint8tob64(n.toUint8Array());t.encodedImageBlobs.push(l),t.imageOptionsMap.set(n.id,r)}t.imageOptionsArray=[...i];const s=[];t.connectomes=[];for(const r of this.meshes){if(r.type==="connectome"){t.connectomes.push(JSON.stringify(r.json()));continue}const n={pts:r.pts,tris:r.tris,name:r.name,rgba255:Uint8Array.from(r.rgba255),opacity:r.opacity,connectome:r.connectome,dpg:r.dpg,dps:r.dps,dpv:r.dpv,meshShaderIndex:r.meshShaderIndex,layers:r.layers.map(o=>({values:o.values,nFrame4D:o.nFrame4D,frame4D:0,outlineBorder:o.outlineBorder,global_min:o.global_min,global_max:o.global_max,cal_min:o.cal_min,cal_max:o.cal_max,opacity:o.opacity,colormap:o.colormap,colormapNegative:o.colormapNegative,colormapLabel:o.colormapLabel,useNegativeCmap:o.useNegativeCmap})),hasConnectome:r.hasConnectome,edgeColormap:r.edgeColormap,edgeColormapNegative:r.edgeColormapNegative,edgeMax:r.edgeMax,edgeMin:r.edgeMin,edges:r.edges&&Array.isArray(r.edges)?[...r.edges]:[],extentsMax:r.extentsMax,extentsMin:r.extentsMin,furthestVertexFromOrigin:r.furthestVertexFromOrigin,nodeColormap:r.nodeColormap,nodeColormapNegative:r.nodeColormapNegative,nodeMaxColor:r.nodeMaxColor,nodeMinColor:r.nodeMinColor,nodeScale:r.nodeScale,legendLineThickness:r.legendLineThickness,offsetPt0:r.offsetPt0,nodes:r.nodes};r.offsetPt0&&r.offsetPt0.length>0&&(n.offsetPt0=r.offsetPt0,n.fiberGroupColormap=r.fiberGroupColormap,n.fiberColor=r.fiberColor,n.fiberDither=r.fiberDither,n.fiberRadius=r.fiberRadius,n.colormap=r.colormap),s.push(n)}return t.meshesString=JSON.stringify(Tn(s)),this.drawBitmap&&(t.encodedDrawingBlob=X.uint8tob64(this.drawBitmap)),t}async download(t,i){const s=this.json(),r=JSON.stringify(s),n=i?"application/gzip":"application/json";let o;i?o=await X.compressStringToArrayBuffer(r):o=r,X.download(o,t,n)}static deserializeMeshDataObjects(t){if(t.data.meshesString){t.meshDataObjects=In(JSON.parse(t.data.meshesString));for(const i of t.meshDataObjects)for(const s of i.layers)"colorMap"in s&&(s.colormap=s.colorMap,delete s.colorMap),"colorMapNegative"in s&&(s.colormapNegative=s.colorMapNegative,delete s.colorMapNegative)}}static async loadFromUrl(t){const s=await(await fetch(t)).arrayBuffer();let r;if(X.isArrayBufferCompressed(s)){const n=await X.decompressArrayBuffer(s);r=JSON.parse(n)}else{const n=new TextDecoder;r=JSON.parse(n.decode(s))}return Re.loadFromJSON(r)}static async loadFromFile(t){const i=await X.readFileAsync(t);let s;const r=new Re;return X.isArrayBufferCompressed(i)?s=await X.decompressArrayBuffer(i):s=new TextDecoder().decode(i),r.data=JSON.parse(s),r.data.opts.meshThicknessOn2D==="infinity"&&(r.data.opts.meshThicknessOn2D=1/0),r.scene.sceneData={...Fi,...r.data.sceneData},Re.deserializeMeshDataObjects(r),r}static loadFromJSON(t){const i=new Re;return i.data=t,i.data.opts.meshThicknessOn2D==="infinity"&&(i.data.opts.meshThicknessOn2D=1/0),i.scene.sceneData={...Fi,...t.sceneData},Re.deserializeMeshDataObjects(i),i}},vl={colormap:"gray",opacity:0,nFrame4D:0,frame4D:0,outlineBorder:0,cal_min:0,cal_max:0,cal_minNeg:0,cal_maxNeg:0,colormapType:0,values:new Array},Ne=class te{constructor(t,i,s="",r=new Uint8Array([255,255,255,255]),n=1,o=!0,l,a=null,c=null,h=null,d=null,f=!0,u=""){F(this,"id"),F(this,"name"),F(this,"anatomicalStructurePrimary"),F(this,"colorbarVisible"),F(this,"furthestVertexFromOrigin"),F(this,"extentsMin"),F(this,"extentsMax"),F(this,"opacity"),F(this,"visible"),F(this,"meshShaderIndex",0),F(this,"offsetPt0",null),F(this,"colormapInvert",!1),F(this,"fiberGroupColormap",null),F(this,"indexBuffer"),F(this,"vertexBuffer"),F(this,"vao"),F(this,"vaoFiber"),F(this,"pts"),F(this,"tris"),F(this,"layers"),F(this,"type","mesh"),F(this,"data_type"),F(this,"rgba255"),F(this,"fiberLength"),F(this,"fiberLengths"),F(this,"fiberDensity"),F(this,"fiberDither",.1),F(this,"fiberColor","Global"),F(this,"fiberDecimationStride",1),F(this,"fiberSides",5),F(this,"fiberRadius",0),F(this,"fiberOcclusion",0),F(this,"f32PerVertex",5),F(this,"fiberMask"),F(this,"colormap"),F(this,"dpg"),F(this,"dps"),F(this,"dpv"),F(this,"hasConnectome",!1),F(this,"connectome"),F(this,"indexCount"),F(this,"vertexCount",1),F(this,"nodeScale",4),F(this,"edgeScale",1),F(this,"legendLineThickness",0),F(this,"nodeColormap","warm"),F(this,"edgeColormap","warm"),F(this,"nodeColormapNegative"),F(this,"edgeColormapNegative"),F(this,"nodeMinColor"),F(this,"nodeMaxColor"),F(this,"edgeMin"),F(this,"edgeMax"),F(this,"nodes"),F(this,"edges"),F(this,"points"),this.anatomicalStructurePrimary=u,this.name=s,this.colorbarVisible=f,this.id=es();const m=Ae.getExtents(t);if(this.furthestVertexFromOrigin=m.mxDx,this.extentsMin=m.extentsMin,this.extentsMax=m.extentsMax,this.opacity=n>1?1:n,this.visible=o,this.meshShaderIndex=0,this.indexBuffer=l.createBuffer(),this.vertexBuffer=l.createBuffer(),this.vao=l.createVertexArray(),l.bindVertexArray(this.vao),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,this.indexBuffer),l.bindBuffer(l.ARRAY_BUFFER,this.vertexBuffer),l.enableVertexAttribArray(0),l.enableVertexAttribArray(1),this.f32PerVertex!==7?(l.vertexAttribPointer(0,3,l.FLOAT,!1,20,0),l.vertexAttribPointer(1,4,l.BYTE,!0,20,12),l.enableVertexAttribArray(2),l.vertexAttribPointer(2,4,l.UNSIGNED_BYTE,!0,20,16)):(l.vertexAttribPointer(0,3,l.FLOAT,!1,28,0),l.vertexAttribPointer(1,3,l.FLOAT,!1,28,12),l.enableVertexAttribArray(2),l.vertexAttribPointer(2,4,l.UNSIGNED_BYTE,!0,28,24)),l.bindVertexArray(null),this.vaoFiber=l.createVertexArray(),this.offsetPt0=null,this.hasConnectome=!1,this.colormapInvert=!1,this.fiberGroupColormap=null,this.pts=t,this.layers=[],this.type="mesh",this.tris=i,r[3]<1){this.rgba255=r,this.fiberLength=2,this.fiberDither=.1,this.fiberColor="Global",this.fiberDecimationStride=1,this.fiberMask=[],this.colormap=a,this.dpg=c,this.dps=h,this.dpv=d,c&&this.initValuesArray(c),h&&this.initValuesArray(h),d&&this.initValuesArray(d),this.offsetPt0=new Uint32Array(i),this.tris=new Uint32Array(0),this.updateFibers(l),l.bindVertexArray(this.vaoFiber),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,this.indexBuffer),l.bindBuffer(l.ARRAY_BUFFER,this.vertexBuffer),l.enableVertexAttribArray(0),l.vertexAttribPointer(0,3,l.FLOAT,!1,16,0),l.enableVertexAttribArray(1),l.vertexAttribPointer(1,4,l.UNSIGNED_BYTE,!0,16,12),l.bindVertexArray(null);return}if(a){this.connectome=a,this.hasConnectome=!0;const A=Object.keys(a);for(let p=0,w=A.length;p<w;p++)this[A[p]]=a[A[p]]}this.rgba255=r,this.updateMesh(l)}initValuesArray(t){for(let i=0;i<t.length;i++){const s=t[i].vals.reduce((n,o)=>Math.min(n,o)),r=t[i].vals.reduce((n,o)=>Math.max(n,o));t[i].global_min=s,t[i].global_max=r,t[i].cal_min=s,t[i].cal_max=r}return t}linesToCylinders(t,i,s){function r(C){return Q(C[0],C[1],C[2])}const n=Math.pow(2,32)-1,o=s.length;let l=0,a=0;for(let C=0;C<o;C++){if(s[C]===n){a++;continue}l++}const c=this.fiberSides,h=c*l,d=this.f32PerVertex;if(d!==5)throw Error("fiberSides > 1 requires f32PerVertex == 5");const f=new Float32Array(h*d),u=new Uint8Array(f.buffer);let m=0,g=ne(),A=ne(),p=ne();const w=pt();let y=pt(),x=0;const b=this.fiberRadius;for(let C=0;C<o;C++){const I=s[C]===n;if(I&&x<1)continue;let S=s[C]*4;if(x++,x<=1){g=xt(i[S+0],i[S+1],i[S+2],i[S+3]),A=re(g),C+1<o&&s[C+1]!==n&&(S=s[C+1]*4,p=xt(i[S+0],i[S+1],i[S+2],i[S+3]),bt(w,r(g),r(p)),Xt(w,w),y=ve.getFirstPerpVector(w));continue}I?p=re(A):p=xt(i[S+0],i[S+1],i[S+2],i[S+3]),bt(w,r(g),r(p)),Xt(w,w);const E=pt();Ci(E,y,w);const V=pt();Ci(V,w,E),y=We(y);const T=pt();Ci(T,w,V),Xt(T,T);const R=pt();for(let N=0;N<c;N++){const O=Math.cos(N/c*2*Math.PI),G=Math.sin(N/c*2*Math.PI);R[0]=b*(O*V[0]+G*T[0]),R[1]=b*(O*V[1]+G*T[1]),R[2]=b*(O*V[2]+G*T[2]),xe(R,r(A),R);const z=m*d;f[z+0]=R[0],f[z+1]=R[1],f[z+2]=R[2];const q=pt();bt(q,R,r(A)),Xt(q,q);const J=(z+3)*4;u[J+0]=q[0]*127,u[J+1]=q[1]*127,u[J+2]=q[2]*127,f[z+4]=A[3],m++}g=re(A),A=re(p),I&&(x=0)}const M=(l-a)*c*2*3,D=new Uint32Array(M);let v=0;m=0;for(let C=1;C<o;C++){if(s[C]===n){m+=c;continue}if(s[C-1]===n)continue;let I=m,S=m+c;const E=S,V=S+c;for(let T=0;T<c;T++)D[v++]=I,D[v++]=S++,S===V&&(S=V-c),D[v++]=S,D[v++]=I++,I===E&&(I=E-c),D[v++]=S,D[v++]=I;m+=c}t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,Uint32Array.from(D),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,u,t.STATIC_DRAW),this.indexCount=M}createFiberDensityMap(){if(this.fiberDensity)return;const t=this.pts,i=t.length/3;let s=0;for(let w=0;w<3;w++){const y=this.extentsMax[w]-this.extentsMin[w];s=Math.max(s,y)}if(this.fiberDensity=new Float32Array(i),s===0)return;const r=64,o=s/(r-1)/2,l=(r-1)/s;let a=new Float32Array(r*r*r);const c=[this.extentsMin[0]-o,this.extentsMin[1]-o,this.extentsMin[2]-o],h=[0,0,0],d=-1,f=r*r;let u=0;for(let w=0;w<i;w++){h[0]=Math.round((t[u++]-c[0])*l),h[1]=Math.round((t[u++]-c[1])*l),h[2]=Math.round((t[u++]-c[2])*l);const y=h[0]+h[1]*r+h[2]*f;y!==d&&a[y]++}function m(w,y){let x=w.slice(),b=-1;const M=y-1;for(let v=0;v<y;v++)for(let C=0;C<y;C++)for(let I=0;I<y;I++)b++,!(I<1||I>=M)&&(w[b]=x[b-1]+x[b]+x[b]+x[b+1]);b=-1,x=w.slice();for(let v=0;v<y;v++)for(let C=0;C<y;C++)for(let I=0;I<y;I++)b++,!(C<1||C>=M)&&(w[b]=x[b-y]+x[b]+x[b]+x[b+y]);const D=y*y;b=-1,x=w.slice();for(let v=0;v<y;v++)for(let C=0;C<y;C++)for(let I=0;I<y;I++)b++,!(v<1||v>=M)&&(w[b]=x[b-D]+x[b]+x[b]+x[D]);return w}a=m(a,r),a=m(a,r);let g=0,A=1/0;const p=r*r*r;for(let w=0;w<p;w++)a[w]<=0||(g=Math.max(g,a[w]),A=Math.min(A,a[w]));if(!(g<=1||g<=A)){u=0;for(let w=0;w<p;w++)a[w]=Math.max(0,a[w]-A);g-=A;for(let w=0;w<i;w++){h[0]=Math.round((t[u++]-c[0])*l),h[1]=Math.round((t[u++]-c[1])*l),h[2]=Math.round((t[u++]-c[2])*l);const y=h[0]+h[1]*r+h[2]*f;this.fiberDensity[w]=a[y]/g}}}updateFibers(t){if(!this.offsetPt0||!this.fiberLength)return;const i=this.pts,s=this.offsetPt0,r=s.length-1,n=i.length/3;if(!this.fiberLengths){this.fiberLengths=new Uint32Array(r);for(let M=0;M<r;M++){const D=s[M]*3,v=(s[M+1]-1)*3;let C=0;for(let I=D;I<v;I+=3){const S=Q(i[I+0]-i[I+3],i[I+1]-i[I+4],i[I+2]-i[I+5]);C+=Je(S)}this.fiberLengths[M]=C}}const o=new Float32Array(n*4),l=new Uint32Array(o.buffer);let a=0,c=0;for(let M=0;M<n;M++)o[c+0]=i[a+0],o[c+1]=i[a+1],o[c+2]=i[a+2],a+=3,c+=4;const h=this.fiberDither,d=h*.5;function f(M,D,v){const I=255*(h*Math.random()-d);return M=Math.max(Math.min(M+I,255),0),D=Math.max(Math.min(D+I,255),0),v=Math.max(Math.min(v+I,255),0),M+(D<<8)+(v<<16)}function u(M,D,v,C,I,S,E){const V=Q(Math.abs(M-C),Math.abs(D-I),Math.abs(v-S));Xt(V,V);const T=E-d;for(let R=0;R<3;R++)V[R]=255*Math.max(Math.min(Math.abs(V[R])+T,1),0);return V[0]+(V[1]<<8)+(V[2]<<16)}const m=this.fiberColor.toLowerCase();let g=null,A=null;if(m.startsWith("dps")&&this.dps&&this.dps.length>0){const M=parseInt(m.substring(3));M<this.dps.length&&this.dps[M].vals.length===r&&(g=this.dps[M].vals)}if(m.startsWith("dpv")&&this.dpv&&this.dpv.length>0){const M=parseInt(m.substring(3));M<this.dpv.length&&this.dpv[M].vals.length===n&&(A=this.dpv[M])}const p=new Int16Array(r);if(this.dpg&&this.fiberGroupColormap!==null){const M=new Uint8ClampedArray(this.dpg.length*4),D=new Array(this.dpg.length).fill(!1),v=this.fiberGroupColormap;v.A===void 0&&(v.A=Array.from(new Uint8ClampedArray(v.I.length).fill(255)));for(let C=0;C<v.I.length;C++){let I=v.I[C];I<0||I>=this.dpg.length||v.A[C]<1||(D[I]=!0,I*=4,M[I]=v.R[C],M[I+1]=v.G[C],M[I+2]=v.B[C],M[I+3]=255)}p.fill(-1);for(let C=0;C<this.dpg.length;C++)if(D[C])for(let I=0;I<this.dpg[C].vals.length;I++)p[this.dpg[C].vals[I]]=C;for(let C=0;C<r;C++){if(p[C]<0)continue;const I=p[C]%256*4,S=f(M[I],M[I+1],M[I+2]),E=s[C],V=s[C+1]-1,T=E*4+3,R=V*4+3;for(let N=T;N<=R;N+=4)l[N]=S}}else if(A){const M=mt.colormap(this.colormap,this.colormapInvert),D=A.cal_min,v=A.cal_max;let C=3;for(let I=0;I<n;I++){let S=Math.min(Math.max((A.vals[I]-D)/(v-D),0),1);S=Math.round(Math.max(Math.min(255,S*255)))*4;const E=M[S]+(M[S+1]<<8)+(M[S+2]<<16);l[C]=E,C+=4}}else if(g){const M=mt.colormap(this.colormap,this.colormapInvert);let D=g[0],v=g[0];for(let C=0;C<r;C++)D=Math.min(D,g[C]),v=Math.max(v,g[C]);v===D&&(D-=1);for(let C=0;C<r;C++){let I=(g[C]-D)/(v-D);I=Math.round(Math.max(Math.min(255,I*255)))*4;const S=M[I]+(M[I+1]<<8)+(M[I+2]<<16),E=s[C],V=s[C+1]-1,T=E*4+3,R=V*4+3;for(let N=T;N<=R;N+=4)l[N]=S}}else if(m.includes("fixed"))if(h===0){const M=this.rgba255[0]+(this.rgba255[1]<<8)+(this.rgba255[2]<<16);let D=3;for(let v=0;v<n;v++)l[D]=M,D+=4}else for(let M=0;M<r;M++){const D=f(this.rgba255[0],this.rgba255[1],this.rgba255[2]),v=s[M],C=s[M+1]-1,I=v*4+3,S=C*4+3;for(let E=I;E<=S;E+=4)l[E]=D}else if(m.includes("local"))for(let M=0;M<r;M++){const D=s[M],v=s[M+1]-1;let C=D*3;const I=v*3,S=h*Math.random();let E=u(i[C],i[C+1],i[C+2],i[C+4],i[C+5],i[C+6],S),V=D*4+3;for(;C<I;)l[V]=E,V+=4,C+=3,E=u(i[C-3],i[C-2],i[C-1],i[C+3],i[C+4],i[C+5],S);l[V]=l[V-4]}else for(let M=0;M<r;M++){const D=s[M],v=s[M+1]-1,C=D*3,I=v*3,S=u(i[C],i[C+1],i[C+2],i[I],i[I+1],i[I+2],h*Math.random()),E=D*4+3,V=v*4+3;for(let T=E;T<=V;T+=4)l[T]=S}if(this.fiberOcclusion>0){let M=function(D,v){const C=v*(D&255),I=v*(D>>8&255),S=v*(D>>16&255);return C+(I<<8)+(S<<16)};this.createFiberDensityMap();for(let D=0;D<r;D++){const v=s[D],C=s[D+1]-1,I=v*4+3,S=C*4+3;let E=v;const V=Math.min(this.fiberOcclusion,.99);for(let T=I;T<=S;T+=4){let R=this.fiberDensity[E++];if(R<=0)continue;R=R/((1/V-2)*(1-R)+1);const N=1-Math.min(R,.9);let O=l[T];O=M(O,N),l[T]=O}}}const w=this.fiberLength,y=Math.pow(2,32)-1,x=[];let b=-1;for(let M=0;M<r;M++)if(!(p[M]<0)&&!(this.fiberLengths[M]<w)&&(b++,b%this.fiberDecimationStride===0)){for(let D=s[M];D<s[M+1];D++)x.push(D);x.push(y)}this.fiberSides>2&&this.fiberRadius>0?this.linesToCylinders(t,o,x):(this.indexCount=x.length,t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,Uint32Array.from(l),t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,Uint32Array.from(x),t.STATIC_DRAW))}indexNearestXYZmm(t,i,s){const r=this.pts,n=this.pts.length/3;let o=0,l=1/0,a=0;for(let c=0;c<n;c++){const h=Math.pow(r[o]-t,2)+Math.pow(r[o+1]-i,2)+Math.pow(r[o+2]-s,2);h<l&&(l=h,a=c),o+=3}return l=Math.sqrt(l),[a,l]}unloadMesh(t){if(t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.bindVertexArray(null),t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.indexBuffer),t.deleteVertexArray(this.vao),t.deleteVertexArray(this.vaoFiber),this.offsetPt0=null,this.tris=null,this.pts=null,this.layers&&this.layers.length>0)for(let i=0;i<this.layers.length;i++)this.layers[i].values=null;if(this.dpg&&this.dpg.length>0)for(let i=0;i<this.dpg.length;i++)this.dpg[i].vals=null;if(this.dps&&this.dps.length>0)for(let i=0;i<this.dps.length;i++)this.dps[i].vals=null}blendColormap(t,i,s,r,n,o,l=!1){const a=this.pts.length/3,c=Math.min(s.opacity,1);function h(y,x,b){return y*(1-b)+x*b}function d(y,x){return Math.min(y+x,255)}const f=l?-1:1,u=Math.min(Math.max(s.frame4D,0),s.nFrame4D-1),m=a*u;let g=r;s.isTransparentBelowCalMin||(g=Number.NEGATIVE_INFINITY),s.colormapType!==0&&(r=Math.min(r,0));const A=255/(n-r);let p=new Array(a).fill(!1);if(s.outlineBorder!==0){const y=new Uint8Array(a).fill(0);for(let x=0;x<a;x++)f*s.values[x+m]>=g&&(y[x]=1);p=Ae.getClusterBoundaryU8(y,this.tris);for(let x=0;x<a;x++)f*s.values[x+m]<g&&(p[x]=!1)}const w=new Float32Array(256).fill(c);if(g>r&&s.colormapType===2){let y=Math.round((g-r)*A);y=Math.max(y,1);for(let x=1;x<y;x++)w[x]=c*Math.pow(x/y,2);w[0]=0,g=r+Number.EPSILON}for(let y=0;y<a;y++){const x=f*s.values[y+m];if(x<g)continue;let b=Math.round((x-r)*A);if(b<0&&s.isTransparentBelowCalMin)continue;b=Math.max(0,b),b=Math.min(255,b);let M=w[b];b*=4;let D=y*28+24;if(this.f32PerVertex!==7&&(D=y*20+16),s.isAdditiveBlend){const v=y*4;i[v+0]=d(i[v+0],o[b+0]),i[v+1]=d(i[v+1],o[b+1]),i[v+2]=d(i[v+2],o[b+2]),i[v+3]=d(i[v+3],255)}else{if(p[y]&&(M=s.outlineBorder,s.outlineBorder<0)){t[D+0]=0,t[D+1]=0,t[D+2]=0;continue}t[D+0]=h(t[D+0],o[b+0],M),t[D+1]=h(t[D+1],o[b+1],M),t[D+2]=h(t[D+2],o[b+2],M)}}}updateMesh(t){if(this.offsetPt0){this.updateFibers(t);return}if(this.hasConnectome)return;if(!this.pts||!this.tris||!this.rgba255){P.warn("underspecified mesh");return}function i(l,a,c){return l*(1-c)+a*c}const s=this.generatePosNormClr(this.pts,this.tris,this.rgba255),r=this.pts.length/3,n=new Uint8Array(s.buffer),o=new Uint8Array(r*4);if(this.layers&&this.layers.length>0)for(let l=0;l<this.layers.length;l++){const a=this.layers[l],c=a.opacity;if(c<=0||a.cal_min>a.cal_max)continue;if(a.outlineBorder===void 0&&(a.outlineBorder=0),a.isAdditiveBlend===void 0&&(a.isAdditiveBlend=!1),a.colormapLabel&&a.colormapLabel.R&&!a.colormapLabel.lut&&(a.colormapLabel=mt.makeLabelLut(a.colormapLabel)),a.colormapLabel&&a.colormapLabel.lut){const f=a.colormapLabel.lut,u=Math.floor(f.length/4),m=Math.min(Math.max(a.frame4D,0),a.nFrame4D-1),g=r*m,A=new Uint8Array(r*4);let p=0;for(let y=0;y<a.values.length;y++){let x=4*Math.min(Math.max(a.values[y+g],0),u-1);A[p+0]=f[x+0],A[p+1]=f[x+1],A[p+2]=f[x+2],p+=4}let w=new Array(r).fill(!1);a.outlineBorder!==0&&(w=Ae.getClusterBoundary(A,this.tris)),p=0;for(let y=0;y<a.values.length;y++){let x=y*28+24;this.f32PerVertex!==7&&(x=y*20+16);let b=c;if(w[y]&&(b=a.outlineBorder,a.outlineBorder<0)){n[x+0]=0,n[x+1]=0,n[x+2]=0,p+=4;continue}n[x+0]=i(n[x+0],A[p+0],b),n[x+1]=i(n[x+1],A[p+1],b),n[x+2]=i(n[x+2],A[p+2],b),p+=4}continue}if(a.values instanceof Uint8Array){const d=new Uint8Array(a.values.buffer);let f=new Array(r).fill(!0);a.outlineBorder!==0&&(f=Ae.getClusterBoundary(d,this.tris));let u=0;for(let m=0;m<a.values.length;m++){let g=m*28+24;this.f32PerVertex!==7&&(g=m*20+16);let A=c;if(f[m]&&(A=a.outlineBorder,a.outlineBorder<0)){n[g+0]=0,n[g+1]=0,n[g+2]=0,u+=4;continue}n[g+0]=i(n[g+0],d[u+0],A),n[g+1]=i(n[g+1],d[u+1],A),n[g+2]=i(n[g+2],d[u+2],A),u+=4}continue}a.useNegativeCmap&&(a.cal_min=Math.max(Number.EPSILON,a.cal_min),a.cal_max=Math.max(a.cal_min+1e-6,a.cal_max)),a.isTransparentBelowCalMin===void 0&&(a.isTransparentBelowCalMin=!0);const h=mt.colormap(a.colormap,a.colormapInvert);if(this.blendColormap(n,o,a,a.cal_min,a.cal_max,h),a.useNegativeCmap){const d=mt.colormap(a.colormapNegative,a.colormapInvert);let f=a.cal_min,u=a.cal_max;isFinite(a.cal_minNeg)&&isFinite(a.cal_minNeg)&&(f=-a.cal_minNeg,u=-a.cal_maxNeg),this.blendColormap(n,o,a,f,u,d,!0)}}t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,Uint32Array.from(this.tris),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW),this.indexCount=this.tris.length,this.vertexCount=this.pts.length}reverseFaces(t){if(this.offsetPt0||this.hasConnectome)return;const i=this.tris||[];for(let s=0;s<i.length;s+=3){const r=i[s];i[s]=i[s+1],i[s+1]=r}this.updateMesh(t)}hierarchicalOrder(){const s=this.tris.length/3,r=Math.log(s/20)/Math.log(4);if(s!==Math.pow(4,r)*20)return NaN;if(this.pts.length/3!==Math.pow(4,r)*10+2)return NaN;for(let o=0;o<15;o+=3)if(this.tris[o]!==0)return NaN;for(let o=15;o<24;o+=3)if(this.tris[o]!==3)return NaN;for(let o=24;o<30;o+=3)if(this.tris[o]!==4)return NaN;return r}decimateFaces(t,i){let s=this.tris;const r=12,n=20;for(let o=t-1;o>=i;o--){const l=Math.pow(4,o+1)*(r-2)+2,a=Math.pow(4,o)*(r-2)+2,c=s.length/3,h=Math.pow(4,o)*n;console.log(`order ${o+1} -> ${o} vertices ${l} -> ${a} faces ${c} -> ${h}`);const d=Array.from({length:l},(u,m)=>m+1);for(let u=0;u<c;u++){const m=s[3*u],g=s[3*u+1],A=s[3*u+2];d[m-1]=Math.min(d[m-1],g,A)}const f=new Uint32Array(h*3);for(let u=0;u<h;u++)f[3*u]=d[s[3*u]-1],f[3*u+1]=d[s[3*u+1]-1],f[3*u+2]=d[s[3*u+2]-1];s=f}this.tris=new Uint32Array(s)}decimateHierarchicalMesh(t,i=4){const s=this.hierarchicalOrder();if(isNaN(s))return P.warn("Unable to decimate mesh: it does not have a hierarchical structure"),!1;if(i>=s)return P.warn(`Unable to decimate mesh: input order (${s}) must be larger than downsampled order (${i})`),!1;const r=this.pts.length/3,o=Math.pow(4,i)*(12-2)+2;if(this.pts=new Float32Array(this.pts.slice(0,o*3)),this.decimateFaces(s,i),this.layers&&this.layers.length>0)for(let l=0;l<this.layers.length;l++){const a=this.layers[l];a.values instanceof Float32Array||a.values.length!==r?a.values=new Float32Array(a.values.slice(0,o)):P.warn("decimation logic needs to be updated")}return this.updateMesh(t),!0}async setLayerProperty(t,i,s,r){const n=this.layers[t];if(!n||!(i in n)){P.warn("mesh does not have property ",i," for layer ",n);return}if(i==="colormapLabel")if(typeof s=="object")n[i]=mt.makeLabelLut(s);else if(typeof s=="string"){const o=await mt.makeLabelLutFromUrl(s);n[i]=o,this.updateMesh(r);return}else P.error("colormapLabel requires a string or object");else n[i]=s;this.updateMesh(r)}setProperty(t,i,s){if(!(t in this)){P.warn("mesh does not have property ",t,this);return}this[t]=i,this.updateMesh(s)}generatePosNormClr(t,i,s){(t.length<3||s.length<4)&&(P.error("Catastrophic failure generatePosNormClr()"),P.debug("this",this),P.debug("pts",t),P.debug("rgba",s));const r=Ae.generateNormals(t,i),n=t.length/3,o=n===s.length/4,l=this.f32PerVertex,a=new Float32Array(n*l),c=new Uint8Array(a.buffer);let h=0,d=0,f=0,u=(l-1)*4;for(let m=0;m<n;m++)a[f+0]=t[h+0],a[f+1]=t[h+1],a[f+2]=t[h+2],l!==7?(c[u-4]=r[h+0]*127,c[u-3]=r[h+1]*127,c[u-2]=r[h+2]*127):(a[f+3]=r[h+0],a[f+4]=r[h+1],a[f+5]=r[h+2]),c[u]=s[d+0],c[u+1]=s[d+1],c[u+2]=s[d+2],c[u+3]=s[d+3],o&&(d+=4),h+=3,f+=l,u+=l*4;return a}static async readMesh(t,i,s,r=1,n=new Uint8Array([255,255,255,255]),o=!0){let l=new Uint32Array([]),a=new Float32Array([]),c="",h;const d=/(?:\.([^.]+))?$/;let f=d.exec(i)[1];if(f=f.toUpperCase(),f==="GZ"&&(f=d.exec(i.slice(0,-3))[1],f=f.toUpperCase()),f==="JCON"&&P.error("you should never see this message: load using nvconnectome not nvmesh"),f==="JSON"&&P.error("you should never see this message: load using nvconnectome not nvmesh"),n[3]=Math.max(1,n[3]),f==="TCK"||f==="TRK"||f==="TT"||f==="TRX"||f==="TRACT"){if(f==="TCK"?h=yt.readTCK(t):f==="TRACT"?h=yt.readTRACT(t):f==="TT"?h=await yt.readTT(t):f==="TRX"?h=await yt.readTRX(t):h=await yt.readTRK(t),typeof h>"u"){const A=new Float32Array([0,0,0,0,0,0]),p=new Uint32Array([0]);h={pts:A,offsetPt0:p},P.error("Creating empty tracts")}return n[3]=0,new te(h.pts,h.offsetPt0,i,n,r,o,s,"inferno",h.dpg||null,h.dps||null,h.dpv||null)}if(f==="GII")h=await yt.readGII(t);else if(f==="MZ3")h=await yt.readMZ3(t),"positions"in h||P.warn("MZ3 does not have positions (statistical overlay?)");else if(f==="ASC")h=yt.readASC(t);else if(f==="DFS")h=yt.readDFS(t);else if(f==="BYU"||f==="G")h=yt.readGEO(t);else if(f==="GEO")h=yt.readGEO(t,!0);else if(f==="ICO"||f==="TRI")h=yt.readICO(t);else if(f==="OFF")h=yt.readOFF(t);else if(f==="NV")h=yt.readNV(t);else if(f==="OBJ")h=await yt.readOBJ(t);else if(f==="PLY")h=yt.readPLY(t);else if(f==="WRL")h=yt.readWRL(t);else if(f==="X3D")h=yt.readX3D(t);else if(f==="FIB"||f==="VTK"){if(h=yt.readVTK(t),"offsetPt0"in h)return n[3]=0,new te(h.pts,h.offsetPt0,i,n,r,o,s,"inferno")}else f==="SRF"?h=await yt.readSRF(t):f==="STL"?h=yt.readSTL(t):h=yt.readFreeSurfer(t);if(h.anatomicalStructurePrimary&&(c=h.anatomicalStructurePrimary),h instanceof Float32Array)throw new Error("fatal: unknown mesh type loaded");if(!("positions"in h))throw new Error("positions not loaded");if(!h.indices)throw new Error("indices not loaded");if(a=h.positions,l=h.indices,"rgba255"in h&&h.rgba255.length>0&&(n=h.rgba255),"colors"in h&&h.colors&&h.colors.length===a.length){const A=a.length/3;n=new Uint8Array(A*4);let p=0,w=0;for(let y=0;y<A;y++)n[w++]=h.colors[p]*255,n[w++]=h.colors[p+1]*255,n[w++]=h.colors[p+2]*255,n[w++]=255,p+=3}const u=a.length/3;if(l.length/3<1||u<3)throw new Error("Mesh should have at least one triangle and three vertices");n[3]=Math.max(1,n[3]);const g=new te(a,l,i,n,r,o,s,null,null,null,null,!0,c);if("scalars"in h&&h.scalars.length>0){const A=await yt.readLayer(i,t,g,r,"gray");typeof A>"u"?P.warn("readLayer() failed to convert scalars"):(g.layers.push(A),g.updateMesh(s))}return g}static async loadLayer(t,i){let s=new Uint8Array().buffer;function r(m){const g=window.atob(m),A=g.length,p=new Uint8Array(A);for(let w=0;w<A;w++)p[w]=g.charCodeAt(w);return p.buffer}if(t.base64!==void 0)s=r(t.base64);else{if(!t.url)throw new Error("layer: missing url");const m=await fetch(t.url,{headers:t.headers});if(!m.ok)throw Error(m.statusText);s=await m.arrayBuffer()}let n,o=[];if(t.name&&t.name!=="")n=t.name;else{if(!t.url)throw new Error("layer: missing url");try{o=new URL(t.url).pathname.split("/")}catch{o=t.url.split("/")}finally{n=o.slice(-1)[0]}}n.indexOf("?")>-1&&(n=n.slice(0,n.indexOf("?")));let l=.5;"opacity"in t&&(l=t.opacity);let a="warm";"colormap"in t&&(a=t.colormap);let c="winter";"colormapNegative"in t&&(c=t.colormapNegative);let h=!1;"useNegativeCmap"in t&&(h=t.useNegativeCmap);let d=null;"cal_min"in t&&(d=t.cal_min);let f=null;"cal_max"in t&&(f=t.cal_max);const u=await yt.readLayer(n,s,i,l,a,c,h,d,f);u&&i.layers.push(u)}static async loadFromUrl({url:t="",headers:i={},gl:s,name:r="",opacity:n=1,rgba255:o=[255,255,255,255],visible:l=!0,layers:a=[],buffer:c=new ArrayBuffer(0)}={}){let h=t.split("/");if(r===""){try{h=new URL(t).pathname.split("/")}catch{h=t.split("/")}r=h.slice(-1)[0],r.indexOf("?")>-1&&(r=r.slice(0,r.indexOf("?")))}if(t==="")throw Error("url must not be empty");if(!s)throw Error("gl context is null");let d;if(c.byteLength>0)d=c;else{const u=await fetch(t,{headers:i});if(!u.ok)throw Error(u.statusText);d=await u.arrayBuffer()}const f=await this.readMesh(d,r,s,n,new Uint8Array(o),l);if(!a||a.length<1)return f;for(let u=0;u<a.length;u++)await te.loadLayer(a[u],f);return f.updateMesh(s),f}static async readFileAsync(t){return new Promise((i,s)=>{const r=new FileReader;r.onload=()=>{i(r.result)},r.onerror=s,r.readAsArrayBuffer(t)})}static async loadFromFile({file:t,gl:i,name:s="",opacity:r=1,rgba255:n=[255,255,255,255],visible:o=!0,layers:l=[]}={}){if(!t)throw new Error("file must be set");if(!i)throw new Error("rendering context must be set");const a=await te.readFileAsync(t),c=await te.readMesh(a,s,i,r,new Uint8Array(n),o);if(!l||l.length<1)return c;for(let h=0;h<l.length;h++)await te.loadLayer(l[h],c);return c.updateMesh(i),c}async loadFromBase64({base64:t,gl:i,name:s="",opacity:r=1,rgba255:n=[255,255,255,255],visible:o=!0,layers:l=[]}={}){if(!t)throw new Error("base64 must bet set");if(!i)throw new Error("rendering context must be set");function a(d){const f=window.atob(d),u=f.length,m=new Uint8Array(u);for(let g=0;g<u;g++)m[g]=f.charCodeAt(g);return m.buffer}const c=a(t),h=await te.readMesh(c,s,i,r,new Uint8Array(n),o);if(!l||l.length<1)return h;for(let d=0;d<l.length;d++)await te.loadLayer(l[d],h);return h.updateMesh(i),h}},wl="data:image/jpeg;base64,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ZwAAAAAAAAALY3JvcFJlY3RUb3Bsb25nAAAAAAA4QklNA+0AAAAAABAASAAAAAEAAQBIAAAAAQABOEJJTQQmAAAAAAAOAAAAAAAAAAAAAD+AAAA4QklNBA0AAAAAAAQAAAAeOEJJTQQZAAAAAAAEAAAAHjhCSU0D8wAAAAAACQAAAAAAAAAAAQA4QklNJxAAAAAAAAoAAQAAAAAAAAABOEJJTQP1AAAAAABIAC9mZgABAGxmZgAGAAAAAAABAC9mZgABAKGZmgAGAAAAAAABADIAAAABAFoAAAAGAAAAAAABADUAAAABAC0AAAAGAAAAAAABOEJJTQP4AAAAAABwAAD/////////////////////////////A+gAAAAA/////////////////////////////wPoAAAAAP////////////////////////////8D6AAAAAD/////////////////////////////A+gAADhCSU0EAAAAAAAAAgAAOEJJTQQCAAAAAAACAAA4QklNBDAAAAAAAAEBADhCSU0ELQAAAAAABgABAAAAMjhCSU0ECAAAAAAAEAAAAAEAAAJAAAACQAAAAAA4QklNBB4AAAAAAAQAAAAAOEJJTQQaAAAAAAM9AAAABgAAAAAAAAAAAAACAAAAAgAAAAAEAG0AYwA2ADEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAABudWxsAAAAAgAAAAZib3VuZHNPYmpjAAAAAQAAAAAAAFJjdDEAAAAEAAAAAFRvcCBsb25nAAAAAAAAAABMZWZ0bG9uZwAAAAAAAAAAQnRvbWxvbmcAAAIAAAAAAFJnaHRsb25nAAACAAAAAAZzbGljZXNWbExzAAAAAU9iamMAAAABAAAAAAAFc2xpY2UAAAASAAAAB3NsaWNlSURsb25nAAAAAAAAAAdncm91cElEbG9uZwAAAAAAAAAGb3JpZ2luZW51bQAAAAxFU2xpY2VPcmlnaW4AAAANYXV0b0dlbmVyYXRlZAAAAABUeXBlZW51bQAAAApFU2xpY2VUeXBlAAAAAEltZyAAAAAGYm91bmRzT2JqYwAAAAEAAAAAAABSY3QxAAAABAAA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bnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTgtMDctMTJUMjA6MDc6NDcrMDE6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE4LTA3LTEzVDE3OjU0OjI3KzAxOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE4LTA3LTEzVDE3OjU0OjI3KzAxOjAwIiBkYzpmb3JtYXQ9ImltYWdlL2pwZWciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3MmVhYjVmZS02NDZkLWVhNDMtODQyNC0xNWQzZTgwOWExNDQiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo0OGNjMGI3YS1iYTJkLWZmNDAtYmNkNC1jNGQzMzIyZjBiNzQiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDphYzFjM2NhNS1hYTg4LWI5NGMtOGE4MS05YmU4MjA3ZGZiODciPiA8cGhvdG9zaG9wOkRvY3VtZW50QW5jZXN0b3JzPiA8cmRmOkJhZz4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6YThjMGNhZTYtODNjYy1hYzQ4LWI2YzAtN2FiODNlOWJkMGM3PC9yZGY6bGk+IDwvcmRmOkJhZz4gPC9waG90b3Nob3A6RG9jdW1lbnRBbmNlc3RvcnM+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6YWMxYzNjYTUtYWE4OC1iOTRjLThhODEtOWJlODIwN2RmYjg3IiBzdEV2dDp3aGVuPSIyMDE4LTA3LTEyVDIwOjA3OjQ3KzAxOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpjYmI3MzZlZC0zOTRhLTM2NDgtYThiOC02Mzk1MmY0NDcxMjIiIHN0RXZ0OndoZW49IjIwMTgtMDctMTNUMTY6MTM6NTgrMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjQ2YjNkYTI3LWI4YjEtYmU0Yi1hYTQ4LTExZGM5NmZkNTIyZiIgc3RFdnQ6d2hlbj0iMjAxOC0wNy0xM1QxNzo1NDoyNyswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvanBlZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iZGVyaXZlZCIgc3RFdnQ6cGFyYW1ldGVycz0iY29udmVydGVkIGZyb20gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCB0byBpbWFnZS9qcGVnIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MmVhYjVmZS02NDZkLWVhNDMtODQyNC0xNWQzZTgwOWExNDQiIHN0RXZ0OndoZW49IjIwMTgtMDctMTNUMTc6NTQ6MjcrMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjQ2YjNkYTI3LWI4YjEtYmU0Yi1hYTQ4LTExZGM5NmZkNTIyZiIgc3RSZWY6ZG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjg3NjM1NDk5LWZiMTItYWU0MC04NWEzLThkMWFiN2NkZGVhOSIgc3RSZWY6b3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOmFjMWMzY2E1LWFhODgtYjk0Yy04YTgxLTliZTgyMDdkZmI4NyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8P3hwYWNrZXQgZW5kPSJ3Ij8+/+IMWElDQ19QUk9GSUxFAAEBAAAMSExpbm8CEAAAbW50clJHQiBYWVogB84AAgAJAAYAMQAAYWNzcE1TRlQAAAAASUVDIHNSR0IAAAAAAAAAAAAAAAEAAPbWAAEAAAAA0y1IUCAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARY3BydAAAAVAAAAAzZGVzYwAAAYQAAABsd3RwdAAAAfAAAAAUYmtwdAAAAgQAAAAUclhZWgAAAhgAAAAUZ1hZWgAAAiwAAAAUYlhZWgAAAkAAAAAUZG1uZAAAAlQAAABwZG1kZAAAAsQAAACIdnVlZAAAA0wAAACGdmlldwAAA9QAAAAkbHVtaQAAA/gAAAAUbWVhcwAABAwAAAAkdGVjaAAABDAAAAAMclRSQwAABDwAAAgMZ1RSQwAABDwAAAgMYlRSQwAABDwAAAgMdGV4dAAAAABDb3B5cmlnaHQgKGMpIDE5OTggSGV3bGV0dC1Q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",Ks="data:image/png;base64,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",qs={atlas:{type:"msdf",distanceRange:2,size:59.65625,width:512,height:256,yOrigin:"bottom"},metrics:{emSize:1,lineHeight:1.171875,ascender:.927734375,descender:-.244140625,underlineY:-.09765625,underlineThickness:.048828125},glyphs:[{unicode:32,advance:.24755859375},{unicode:33,advance:.25732421875,planeBounds:{left:.056159633438645884,bottom:-.02437761405677056,right:.20702396031135412,top:.7299440203067705},atlasBounds:{left:488.5,bottom:145.5,right:497.5,top:190.5}},{unicode:34,advance:.31982421875,planeBounds:{left:.049409125974004715,bottom:.48691155587022,right:.2840869677759953,top:.77187750662978},atlasBounds:{left:486.5,bottom:213.5,right:500.5,top:230.5}},{unicode:35,advance:.61572265625,planeBounds:{left:.037219103997511785,bottom:-.02169206718177056,right:.6239137085024882,top:.7326295671817705},atlasBounds:{left:66.5,bottom:51.5,right:101.5,top:96.5}},{unicode:36,advance:.5615234375,planeBounds:{left:.02956531458715296,bottom:-.12381369908983761,right:.5324464041628472,top:.8484230740898377},atlasBounds:{left:109.5,bottom:197.5,right:139.5,top:255.5}},{unicode:37,advance:.732421875,planeBounds:{left:.026481776289942378,bottom:-.030073418674698794,right:.7137525987100576,top:.7410109186746989},atlasBounds:{left:88.5,bottom:144.5,right:129.5,top:190.5}},{unicode:38,advance:.62158203125,planeBounds:{left:.03225572125458355,bottom:-.030073418674698794,right:.6357130287454166,top:.7410109186746989},atlasBounds:{left:130.5,bottom:144.5,right:166.5,top:190.5}},{unicode:39,advance:.17431640625,planeBounds:{left:.028244602049502358,bottom:.49895501673814824,right:.14558352295049765,top:.7671582645118518},atlasBounds:{left:498.5,bottom:62.5,right:505.5,top:78.5}},{unicode:40,advance:.341796875,planeBounds:{left:.042983329377291775,bottom:-.250029542422407,right:.34471198312270823,top:.8227834486724072},atlasBounds:{left:.5,bottom:191.5,right:18.5,top:255.5}},{unicode:41,advance:.34765625,planeBounds:{left:-.003159248747708225,bottom:-.250029542422407,right:.29856940499770823,top:.8227834486724072},atlasBounds:{left:19.5,bottom:191.5,right:37.5,top:255.5}},{unicode:42,advance:.4306640625,planeBounds:{left:-.011208599684062338,bottom:.27785390031593765,right:.44138438093406235,top:.7304468809340623},atlasBounds:{left:449.5,bottom:23.5,right:476.5,top:50.5}},{unicode:43,advance:.56689453125,planeBounds:{left:.01353503347629649,bottom:.053493525733368255,right:.5499415290237036,top:.6066627242666317},atlasBounds:{left:361.5,bottom:17.5,right:393.5,top:50.5}},{unicode:44,advance:.1962890625,planeBounds:{left:-.009919475797210583,bottom:-.15981695975478,right:.1744702570472106,top:.12514899100478},atlasBounds:{left:498.5,bottom:79.5,right:509.5,top:96.5}},{unicode:45,advance:.27587890625,planeBounds:{left:-.00527594412977999,bottom:.24333249267450235,right:.27969000662978,top:.36067141357549765},atlasBounds:{left:52.5,bottom:7.5,right:69.5,top:14.5}},{unicode:46,advance:.26318359375,planeBounds:{left:.051032680313645884,bottom:-.027092319686354116,right:.20189700718635412,top:.12377200718635412},atlasBounds:{left:501.5,bottom:221.5,right:510.5,top:230.5}},{unicode:47,advance:.412109375,planeBounds:{left:-.013733006073205867,bottom:-.08573505127848349,right:.4053345685732059,top:.7356373950284835},atlasBounds:{left:252.5,bottom:206.5,right:277.5,top:255.5}},{unicode:48,advance:.5615234375,planeBounds:{left:.037458384830081196,bottom:-.030073418674698794,right:.5235767714199189,top:.7410109186746989},atlasBounds:{left:167.5,bottom:144.5,right:196.5,top:190.5}},{unicode:49,advance:.5615234375,planeBounds:{left:.06023674350936354,bottom:-.01998308280677056,right:.37872810024063647,top:.7343385515567705},atlasBounds:{left:488.5,bottom:97.5,right:507.5,top:142.5}},{unicode:50,advance:.5615234375,planeBounds:{left:.025334353719224725,bottom:-.01680925468177056,right:.5449781462807752,top:.7375123796817705},atlasBounds:{left:278.5,bottom:51.5,right:309.5,top:96.5}},{unicode:51,advance:.5615234375,planeBounds:{left:.028181041080081196,bottom:-.030073418674698794,right:.5142994276699189,top:.7410109186746989},atlasBounds:{left:197.5,bottom:144.5,right:226.5,top:190.5}},{unicode:52,advance:.5615234375,planeBounds:{left:.005886103858368255,bottom:-.02169206718177056,right:.5590553023916317,top:.7326295671817705},atlasBounds:{left:310.5,bottom:51.5,right:343.5,top:96.5}},{unicode:53,advance:.5615234375,planeBounds:{left:.055524791080081196,bottom:-.02657487968177056,right:.5416431776699189,top:.7277467546817705},atlasBounds:{left:344.5,bottom:51.5,right:373.5,top:96.5}},{unicode:54,advance:.5615234375,planeBounds:{left:.046003306705081196,bottom:-.034712090549698794,right:.5321216932949189,top:.7363722467996989},atlasBounds:{left:227.5,bottom:144.5,right:256.5,top:190.5}},{unicode:55,advance:.5615234375,planeBounds:{left:.018010134969224725,bottom:-.02169206718177056,right:.5376539275307752,top:.7326295671817705},atlasBounds:{left:374.5,bottom:51.5,right:405.5,top:96.5}},{unicode:56,advance:.5615234375,planeBounds:{left:.037702525455081196,bottom:-.030073418674698794,right:.5238209120449189,top:.7410109186746989},atlasBounds:{left:257.5,bottom:144.5,right:286.5,top:190.5}},{unicode:57,advance:.5615234375,planeBounds:{left:.029401744205081196,bottom:-.025434746799698794,right:.5155201307949189,top:.7456495905496989},atlasBounds:{left:287.5,bottom:144.5,right:316.5,top:190.5}},{unicode:58,advance:.2421875,planeBounds:{left:.046394008438645884,bottom:-.029431286627488215,right:.19725833531135412,top:.5572633178774882},atlasBounds:{left:439.5,bottom:61.5,right:448.5,top:96.5}},{unicode:59,advance:.21142578125,planeBounds:{left:.001066852327789419,bottom:-.16459733294591408,right:.1854565851722106,top:.556198895445914},atlasBounds:{left:406.5,bottom:53.5,right:417.5,top:96.5}},{unicode:60,advance:.50830078125,planeBounds:{left:.016948142433865897,bottom:.0726146348300812,right:.4527784200661341,top:.5587330214199189},atlasBounds:{left:394.5,bottom:21.5,right:420.5,top:50.5}},{unicode:61,advance:.548828125,planeBounds:{left:.051535540940937666,bottom:.17620354038436353,right:.5041285215590624,top:.49469489711563647},atlasBounds:{left:477.5,bottom:31.5,right:504.5,top:50.5}},{unicode:62,advance:.5224609375,planeBounds:{left:.047629290940937666,bottom:.0731029160800812,right:.5002222715590624,top:.5592213026699189},atlasBounds:{left:421.5,bottom:21.5,right:448.5,top:50.5}},{unicode:63,advance:.47216796875,planeBounds:{left:.016704001808865897,bottom:-.027876153049698794,right:.4525342794411341,top:.7432081842996989},atlasBounds:{left:317.5,bottom:144.5,right:343.5,top:190.5}},{unicode:64,advance:.89794921875,planeBounds:{left:.034064457306783605,bottom:-.23896750384690937,right:.8721996065996072,top:.7165065663469093},atlasBounds:{left:155.5,bottom:198.5,right:205.5,top:255.5}},{unicode:65,advance:.65234375,planeBounds:{left:-.008838044092129387,bottom:-.02169206718177056,right:.6616700753421295,top:.7326295671817705},atlasBounds:{left:237.5,bottom:51.5,right:277.5,top:96.5}},{unicode:66,advance:.62255859375,planeBounds:{left:.06464099434422473,bottom:-.02169206718177056,right:.5842847869057752,top:.7326295671817705},atlasBounds:{left:205.5,bottom:51.5,right:236.5,top:96.5}},{unicode:67,advance:.65087890625,planeBounds:{left:.038439807122511785,bottom:-.030073418674698794,right:.6251344116274882,top:.7410109186746989},atlasBounds:{left:344.5,bottom:144.5,right:379.5,top:190.5}},{unicode:68,advance:.65576171875,planeBounds:{left:.06301501010836826,bottom:-.02169206718177056,right:.6161842086416317,top:.7326295671817705},atlasBounds:{left:162.5,bottom:51.5,right:195.5,top:96.5}},{unicode:69,advance:.568359375,planeBounds:{left:.0652904160800812,bottom:-.02169206718177056,right:.5514088026699189,top:.7326295671817705},atlasBounds:{left:132.5,bottom:51.5,right:161.5,top:96.5}},{unicode:70,advance:.552734375,planeBounds:{left:.059675181705081196,bottom:-.02169206718177056,right:.5457935682949189,top:.7326295671817705},atlasBounds:{left:102.5,bottom:51.5,right:131.5,top:96.5}},{unicode:71,advance:.68115234375,planeBounds:{left:.040148791497511785,bottom:-.030073418674698794,right:.6268433960024882,top:.7410109186746989},atlasBounds:{left:380.5,bottom:144.5,right:415.5,top:190.5}},{unicode:72,advance:.712890625,planeBounds:{left:.062365588372511785,bottom:-.02169206718177056,right:.6490601928774882,top:.7326295671817705},atlasBounds:{left:30.5,bottom:51.5,right:65.5,top:96.5}},{unicode:73,advance:.27197265625,planeBounds:{left:.06917965680657412,bottom:-.02169206718177056,right:.20328128069342588,top:.7326295671817705},atlasBounds:{left:196.5,bottom:51.5,right:204.5,top:96.5}},{unicode:74,advance:.5517578125,planeBounds:{left:.007184947330081194,bottom:-.02657487968177056,right:.4933033339199188,top:.7277467546817705},atlasBounds:{left:.5,bottom:51.5,right:29.5,top:96.5}},{unicode:75,advance:.626953125,planeBounds:{left:.061633166497511785,bottom:-.02169206718177056,right:.6483277710024882,top:.7326295671817705},atlasBounds:{left:452.5,bottom:97.5,right:487.5,top:142.5}},{unicode:76,advance:.5380859375,planeBounds:{left:.06341786132300943,bottom:-.02169206718177056,right:.5327735449269906,top:.7326295671817705},atlasBounds:{left:423.5,bottom:97.5,right:451.5,top:142.5}},{unicode:77,advance:.873046875,planeBounds:{left:.05911847969322944,bottom:-.02169206718177056,right:.8134401140567705,top:.7326295671817705},atlasBounds:{left:377.5,bottom:97.5,right:422.5,top:142.5}},{unicode:78,advance:.712890625,planeBounds:{left:.062365588372511785,bottom:-.02169206718177056,right:.6490601928774882,top:.7326295671817705},atlasBounds:{left:341.5,bottom:97.5,right:376.5,top:142.5}},{unicode:79,advance:.6875,planeBounds:{left:.033395854136655315,bottom:-.030073418674698794,right:.6536158646133446,top:.7410109186746989},atlasBounds:{left:416.5,bottom:144.5,right:453.5,top:190.5}},{unicode:80,advance:.630859375,planeBounds:{left:.061550166358368255,bottom:-.02169206718177056,right:.6147193648916317,top:.7326295671817705},atlasBounds:{left:273.5,bottom:97.5,right:306.5,top:142.5}},{unicode:81,advance:.6875,planeBounds:{left:.030466166636655315,bottom:-.14391866037519643,right:.6506861771133446,top:.7445045978751964},atlasBounds:{left:214.5,bottom:202.5,right:251.5,top:255.5}},{unicode:82,advance:.61572265625,planeBounds:{left:.06350329135836826,bottom:-.02169206718177056,right:.6166724898916317,top:.7326295671817705},atlasBounds:{left:186.5,bottom:97.5,right:219.5,top:142.5}},{unicode:83,advance:.59326171875,planeBounds:{left:.020778681983368255,bottom:-.030073418674698794,right:.5739478805166317,top:.7410109186746989},atlasBounds:{left:454.5,bottom:144.5,right:487.5,top:190.5}},{unicode:84,advance:.5966796875,planeBounds:{left:.005480822747511787,bottom:-.02169206718177056,right:.5921754272524882,top:.7326295671817705},atlasBounds:{left:112.5,bottom:97.5,right:147.5,top:142.5}},{unicode:85,advance:.6484375,planeBounds:{left:.049098994483368255,bottom:-.02657487968177056,right:.6022681930166317,top:.7277467546817705},atlasBounds:{left:78.5,bottom:97.5,right:111.5,top:142.5}},{unicode:86,advance:.63623046875,planeBounds:{left:-.008269192599201152,bottom:-.02169206718177056,right:.6454762238492011,top:.7326295671817705},atlasBounds:{left:38.5,bottom:97.5,right:77.5,top:142.5}},{unicode:87,advance:.88720703125,planeBounds:{left:.011923628617731797,bottom:-.02169206718177056,right:.8835841838822683,top:.7326295671817705},atlasBounds:{left:220.5,bottom:97.5,right:272.5,top:142.5}},{unicode:88,advance:.626953125,planeBounds:{left:.004098979136655316,bottom:-.02169206718177056,right:.6243189896133446,top:.7326295671817705},atlasBounds:{left:.5,bottom:97.5,right:37.5,top:142.5}},{unicode:89,advance:.6005859375,planeBounds:{left:-.010793598988344685,bottom:-.02169206718177056,right:.6094264114883446,top:.7326295671817705},atlasBounds:{left:148.5,bottom:97.5,right:185.5,top:142.5}},{unicode:90,advance:.5986328125,planeBounds:{left:.024196650733368255,bottom:-.02169206718177056,right:.5773658492666317,top:.7326295671817705},atlasBounds:{left:307.5,bottom:97.5,right:340.5,top:142.5}},{unicode:91,advance:.26513671875,planeBounds:{left:.05437250871693295,bottom:-.17280296457569408,right:.27228764753306706,top:.8329592145756942},atlasBounds:{left:59.5,bottom:195.5,right:72.5,top:255.5}},{unicode:92,advance:.41015625,planeBounds:{left:.0014037126767941326,bottom:-.08573505127848349,right:.4204712873232059,top:.7356373950284835},atlasBounds:{left:278.5,bottom:206.5,right:303.5,top:255.5}},{unicode:93,advance:.26513671875,planeBounds:{left:-.020659233400995285,bottom:-.17280296457569408,right:.2140186084009953,top:.8329592145756942},atlasBounds:{left:94.5,bottom:195.5,right:108.5,top:255.5}},{unicode:94,advance:.41796875,planeBounds:{left:.006855376669722368,bottom:.33229482979472236,right:.40916024833027764,top:.7345997014552776},atlasBounds:{left:486.5,bottom:231.5,right:510.5,top:255.5}},{unicode:95,advance:.451171875,planeBounds:{left:-.017473255794918804,bottom:-.09553469482549765,right:.4686451307949188,top:.021804226075497646},atlasBounds:{left:70.5,bottom:7.5,right:99.5,top:14.5}},{unicode:96,advance:.30908203125,planeBounds:{left:.00391839948107648,bottom:.5860277898277895,right:.2553589442689235,top:.7704175226722105},atlasBounds:{left:36.5,bottom:3.5,right:51.5,top:14.5}},{unicode:97,advance:.5439453125,planeBounds:{left:.028181041080081196,bottom:-.029187146002488215,right:.5142994276699189,top:.5575074585024882},atlasBounds:{left:30.5,bottom:15.5,right:59.5,top:50.5}},{unicode:98,advance:.56103515625,planeBounds:{left:.048932994205081196,bottom:-.032187684160555265,right:.5350513807949189,top:.7724220591605554},atlasBounds:{left:304.5,bottom:207.5,right:333.5,top:255.5}},{unicode:99,advance:.5234375,planeBounds:{left:.024518931705081196,bottom:-.029187146002488215,right:.5106373182949189,top:.5575074585024882},atlasBounds:{left:.5,bottom:15.5,right:29.5,top:50.5}},{unicode:100,advance:.56396484375,planeBounds:{left:.026227916080081196,bottom:-.032187684160555265,right:.5123463026699189,top:.7724220591605554},atlasBounds:{left:334.5,bottom:207.5,right:363.5,top:255.5}},{unicode:101,advance:.52978515625,planeBounds:{left:.026472056705081196,bottom:-.029187146002488215,right:.5125904432949189,top:.5575074585024882},atlasBounds:{left:468.5,bottom:61.5,right:497.5,top:96.5}},{unicode:102,advance:.34716796875,planeBounds:{left:.004575110905578838,bottom:-.022177918535555265,right:.3733545765944212,top:.7824318247855554},atlasBounds:{left:364.5,bottom:207.5,right:386.5,top:255.5}},{unicode:103,advance:.56103515625,planeBounds:{left:.026960337955081196,bottom:-.22888445766762702,right:.5130787245449189,top:.558962582667627},atlasBounds:{left:28.5,bottom:143.5,right:57.5,top:190.5}},{unicode:104,advance:.55078125,planeBounds:{left:.049826556565937666,bottom:-.01892352016762703,right:.5024195371840624,top:.768923520167627},atlasBounds:{left:.5,bottom:143.5,right:27.5,top:190.5}},{unicode:105,advance:.24267578125,planeBounds:{left:.046882289688645884,bottom:-.01680925468177056,right:.19774661656135412,top:.7375123796817705},atlasBounds:{left:498.5,bottom:145.5,right:507.5,top:190.5}},{unicode:106,advance:.23876953125,planeBounds:{left:-.048979545900995285,bottom:-.2324562772148376,right:.1856982959009953,top:.7397804959648377},atlasBounds:{left:140.5,bottom:197.5,right:154.5,top:255.5}},{unicode:107,advance:.5068359375,planeBounds:{left:.044294322330081196,bottom:-.01892352016762703,right:.5304127089199189,top:.768923520167627},atlasBounds:{left:58.5,bottom:143.5,right:87.5,top:190.5}},{unicode:108,advance:.24267578125,planeBounds:{left:.05428707868157412,bottom:-.01892352016762703,right:.18838870256842588,top:.768923520167627},atlasBounds:{left:477.5,bottom:208.5,right:485.5,top:255.5}},{unicode:109,advance:.87646484375,planeBounds:{left:.04430890170737297,bottom:-.024304333502488215,right:.832155942042627,top:.5623902710024882},atlasBounds:{left:116.5,bottom:15.5,right:163.5,top:50.5}},{unicode:110,advance:.5517578125,planeBounds:{left:.049826556565937666,bottom:-.024304333502488215,right:.5024195371840624,top:.5623902710024882},atlasBounds:{left:60.5,bottom:15.5,right:87.5,top:50.5}},{unicode:111,advance:.5703125,planeBounds:{left:.025090213094224725,bottom:-.029187146002488215,right:.5447340056557752,top:.5575074585024882},atlasBounds:{left:193.5,bottom:15.5,right:224.5,top:50.5}},{unicode:112,advance:.56103515625,planeBounds:{left:.048444712955081196,bottom:-.22644305141762702,right:.5345630995449189,top:.561403988917627},atlasBounds:{left:447.5,bottom:208.5,right:476.5,top:255.5}},{unicode:113,advance:.568359375,planeBounds:{left:.025983775455081196,bottom:-.22644305141762702,right:.5121021620449189,top:.561403988917627},atlasBounds:{left:417.5,bottom:208.5,right:446.5,top:255.5}},{unicode:114,advance:.33837890625,planeBounds:{left:.045180595002291775,bottom:-.024304333502488215,right:.34690924874770823,top:.5623902710024882},atlasBounds:{left:449.5,bottom:61.5,right:467.5,top:96.5}},{unicode:115,advance:.515625,planeBounds:{left:.021669814448009427,bottom:-.029187146002488215,right:.4910254980519906,top:.5575074585024882},atlasBounds:{left:164.5,bottom:15.5,right:192.5,top:50.5}},{unicode:116,advance:.32666015625,planeBounds:{left:-.019433670483564695,bottom:-.02877457520298586,right:.3158203892335647,top:.675258950202986},atlasBounds:{left:418.5,bottom:54.5,right:438.5,top:96.5}},{unicode:117,advance:.55126953125,planeBounds:{left:.048117572190937666,bottom:-.034069958502488215,right:.5007105528090624,top:.5526246460024882},atlasBounds:{left:88.5,bottom:15.5,right:115.5,top:50.5}},{unicode:118,advance:.484375,planeBounds:{left:-.002092396419918806,bottom:-.02080579450955998,right:.4840259901699188,top:.5491261070095601},atlasBounds:{left:331.5,bottom:16.5,right:360.5,top:50.5}},{unicode:119,advance:.75146484375,planeBounds:{left:-.002649098431770561,bottom:-.02080579450955998,right:.7516725359317705,top:.5491261070095601},atlasBounds:{left:225.5,bottom:16.5,right:270.5,top:50.5}},{unicode:120,advance:.49560546875,planeBounds:{left:-.0046143729128470395,bottom:-.02080579450955998,right:.4982667166628471,top:.5491261070095601},atlasBounds:{left:300.5,bottom:16.5,right:330.5,top:50.5}},{unicode:121,advance:.47314453125,planeBounds:{left:-.007219349544918806,bottom:-.23645281704262702,right:.4788990370449188,top:.551394223292627},atlasBounds:{left:387.5,bottom:208.5,right:416.5,top:255.5}},{unicode:122,advance:.49560546875,planeBounds:{left:.018007705073009427,bottom:-.02080579450955998,right:.4873633886769906,top:.5491261070095601},atlasBounds:{left:271.5,bottom:16.5,right:299.5,top:50.5}},{unicode:123,advance:.33837890625,planeBounds:{left:.011572188891435306,bottom:-.20234398020069408,right:.3468262486085647,top:.8034181989506942},atlasBounds:{left:73.5,bottom:195.5,right:93.5,top:255.5}},{unicode:124,advance:.24365234375,planeBounds:{left:.06315671142450235,bottom:-.15466084787519643,right:.18049563232549765,top:.7337624103751964},atlasBounds:{left:206.5,bottom:202.5,right:213.5,top:255.5}},{unicode:125,advance:.33837890625,planeBounds:{left:-.010156326733564695,bottom:-.20234398020069408,right:.3250977329835647,top:.8034181989506942},atlasBounds:{left:38.5,bottom:195.5,right:58.5,top:255.5}},{unicode:126,advance:.68017578125,planeBounds:{left:.046984728997511785,bottom:.1766063915990047,right:.6336793335024882,top:.4112842334009953},atlasBounds:{left:.5,bottom:.5,right:35.5,top:14.5}}],kerning:[]},Yr=class{constructor(e,t,i,s,r){F(this,"text"),F(this,"style"),F(this,"points"),F(this,"anchor"),F(this,"onClick"),this.text=e,this.style=t,this.points=i,this.anchor=s||0,this.onClick=r}},fi={name:"untitled connectome",nodeColormap:"warm",nodeColormapNegative:"winter",nodeMinColor:0,nodeMaxColor:4,nodeScale:3,edgeColormap:"warm",edgeColormapNegative:"winter",edgeMin:2,edgeMax:6,edgeScale:1,legendLineThickness:0},di=class zr extends Ne{constructor(t,i){super(new Float32Array([]),new Uint32Array([]),i.name,new Uint8Array([]),1,!0,t,i),F(this,"gl"),F(this,"nodesChanged"),this.gl=t,this.type="connectome",this.nodes&&this.updateLabels(),this.nodesChanged=new EventTarget}static convertLegacyConnectome(t){const i={nodes:[],edges:[],...fi};for(const r in t)if(r in fi){const n=r;i[n]=t[n]}const s=t.nodes;for(let r=0;r<s.names.length;r++)i.nodes.push({name:s.names[r],x:s.X[r],y:s.Y[r],z:s.Z[r],colorValue:s.Color[r],sizeValue:s.Size[r]});for(let r=0;r<s.names.length-1;r++)for(let n=r+1;n<s.names.length;n++){const o=t.edges[r*s.names.length+n];i.edges.push({first:r,second:n,colorValue:o})}return i}static convertFreeSurferConnectome(t,i="warm"){let s=!0;if("data_type"in t?t.data_type!=="fs_pointset"&&(s=!1):s=!1,"points"in t||(s=!1),!s)throw Error("not a valid FreeSurfer json pointset");const r=t.points.map(o=>({name:Array.isArray(o.comments)&&o.comments.length>0&&"text"in o.comments[0]?o.comments[0].text:"",x:o.coordinates.x,y:o.coordinates.y,z:o.coordinates.z,colorValue:1,sizeValue:1,metadata:o.comments}));return{...fi,nodeColormap:i,edgeColormap:i,nodes:r,edges:[]}}updateLabels(){const t=this.nodes;if(t&&t.length>0){const i=t.reduce((c,h)=>c.sizeValue>h.sizeValue?c:h).sizeValue;let s,r;if(typeof this.nodeMinColor<"u"&&isFinite(this.nodeMinColor))s=this.nodeMinColor;else{s=t[0].colorValue;for(let c=1;c<t.length;c++)t[c].colorValue<s&&(s=t[c].colorValue)}if(typeof this.nodeMaxColor<"u"&&isFinite(this.nodeMaxColor))r=this.nodeMaxColor;else{r=t[0].colorValue;for(let c=1;c<t.length;c++)t[c].colorValue>r&&(r=t[c].colorValue)}const n=mt.colormap(this.nodeColormap,this.colormapInvert),o=mt.colormap(this.nodeColormapNegative,this.colormapInvert),l="nodeColormapNegative"in this,a=this.legendLineThickness?this.legendLineThickness:0;for(let c=0;c<t.length;c++){let h=t[c].colorValue,d=!1;if(l&&h<0&&(d=!0,h=-h),s<r){if(h<s){P.warn("color value lower than min");continue}h=(h-s)/(r-s)}else h=1;h=Math.round(Math.max(Math.min(255,h*255)))*4;let f=[n[h],n[h+1],n[h+2],255];d&&(f=[o[h],o[h+1],o[h+2],255]),f=f.map(u=>u/255),P.debug("adding label for ",t[c]),t[c].label=new Yr(t[c].name,{textColor:f,bulletScale:t[c].sizeValue/i,bulletColor:f,lineWidth:a,lineColor:f,textScale:1,textAlignment:"left",lineTerminator:"none"},[t[c].x,t[c].y,t[c].z]),P.debug("label for node:",t[c].label)}}}addConnectomeNode(t){if(P.debug("adding node",t),!this.nodes)throw new Error("nodes not defined");this.nodes.push(t),this.updateLabels(),this.nodesChanged.dispatchEvent(new CustomEvent("nodeAdded",{detail:{node:t}}))}deleteConnectomeNode(t){const i=this.nodes.indexOf(t),s=this.edges;s&&(this.edges=s.filter(r=>r.first!==i&&r.second!==i)),this.nodes=this.nodes.filter(r=>r!==t),this.updateLabels(),this.updateConnectome(this.gl),this.nodesChanged.dispatchEvent(new CustomEvent("nodeDeleted",{detail:{node:t}}))}updateConnectomeNodeByIndex(t,i){this.nodes[t]=i,this.updateLabels(),this.updateConnectome(this.gl),this.nodesChanged.dispatchEvent(new CustomEvent("nodeChanged",{detail:{node:i}}))}updateConnectomeNodeByPoint(t,i){const s=this.nodes;if(!s)throw new Error("Node to update does not exist");const r=s.find(o=>X.arraysAreEqual([o.x,o.y,o.z],t));if(!r)throw new Error(`Node with point ${t} to update does not exist`);const n=s.findIndex(o=>o===r);this.updateConnectomeNodeByIndex(n,i)}addConnectomeEdge(t,i,s){const r=this.edges;let n=r.find(o=>(o.first===t||o.second===t)&&o.first+o.second===t+i);return n||(n={first:t,second:i,colorValue:s},r.push(n),this.updateConnectome(this.gl),n)}deleteConnectomeEdge(t,i){const s=this.edges,r=s.find(n=>(n.first===t||n.first===i)&&n.first+n.second===t+i);if(r)this.edges=s.filter(n=>n!==r);else throw new Error(`edge between ${t} and ${i} not found`);return this.updateConnectome(this.gl),r}findClosestConnectomeNode(t,i){const s=this.nodes;if(!s||s.length===0)return null;const r=s.map((n,o)=>({node:n,distance:Math.sqrt(Math.pow(n.x-t[0],2)+Math.pow(n.y-t[1],2)+Math.pow(n.z-t[2],2)),index:o})).filter(n=>n.distance<i).sort((n,o)=>n.distance-o.distance);return r.length>0?r[0].node:null}updateConnectome(t){const i=[],s=[],r=[];let n=mt.colormap(this.nodeColormap,this.colormapInvert),o=mt.colormap(this.nodeColormapNegative,this.colormapInvert),l="nodeColormapNegative"in this;this.nodeMinColor===void 0&&(this.nodeMinColor=NaN),this.nodeMaxColor===void 0&&(this.nodeMaxColor=NaN),this.edgeMin===void 0&&(this.edgeMin=NaN),this.edgeMax===void 0&&(this.edgeMax=NaN);let a=this.nodeMinColor,c=this.nodeMaxColor;if(!isFinite(a)||!isFinite(a)){const p=this.nodes;a=p[0].colorValue,c=p[0].colorValue;for(let w=0;w<p.length;w++)a=Math.min(a,p[w].colorValue),c=Math.max(c,p[w].colorValue)}const h=this.nodes,d=h.length;for(let p=0;p<d;p++){const w=h[p].sizeValue*this.nodeScale;if(w<=0)continue;let y=h[p].colorValue,x=!1;if(l&&y<0&&(x=!0,y=-y),a<c){if(y<a)continue;y=(y-a)/(c-a)}else y=1;y=Math.round(Math.max(Math.min(255,y*255)))*4;let b=[n[y],n[y+1],n[y+2],255];x&&(b=[o[y],o[y+1],o[y+2],255]);const M=Q(h[p].x,h[p].y,h[p].z);ve.makeColoredSphere(s,i,r,w,M,b)}n=mt.colormap(this.edgeColormap,this.colormapInvert),o=mt.colormap(this.edgeColormapNegative,this.colormapInvert),l="edgeColormapNegative"in this;const f=this.edges;if(f!==void 0&&f.length>0){if(a=this.edgeMin,c=this.edgeMax,!isFinite(a)||!isFinite(a)){a=f[0].colorValue,c=f[0].colorValue;for(let p=0;p<f.length;p++)a=Math.min(a,f[p].colorValue),c=Math.max(c,f[p].colorValue)}for(const p of f){let w=p.colorValue;const y=l&&w<0;y&&(w=-w);const x=w*this.edgeScale;if(x<=0)continue;if(a<c){if(w<a)continue;w=(w-a)/(c-a)}else w=1;w=Math.round(Math.max(Math.min(255,w*255)))*4;let b=[n[w],n[w+1],n[w+2],255];y&&(b=[o[w],o[w+1],o[w+2],255]);const M=Q(h[p.first].x,h[p.first].y,h[p.first].z),D=Q(h[p.second].x,h[p.second].y,h[p.second].z);ve.makeColoredCylinder(s,i,r,M,D,x,b)}}const u=new Float32Array(s),m=new Uint32Array(i),g=Ae.getExtents(u);this.furthestVertexFromOrigin=g.mxDx,this.extentsMin=g.extentsMin,this.extentsMax=g.extentsMax;const A=this.generatePosNormClr(u,m,new Uint8Array(r));t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,Uint32Array.from(m),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,Float32Array.from(A),t.STATIC_DRAW),this.indexCount=i.length}updateMesh(t){this.updateConnectome(t),this.updateLabels()}json(){const t={};for(const i in this)(i in fi||i==="nodes"||i==="edges")&&(t[i]=this[i]);return t}static async loadConnectomeFromUrl(t,i){const r=await(await fetch(i)).json();return new zr(t,r)}};function yl(e){return new Promise((t,i)=>{let s;e instanceof File?s=Promise.resolve(e):s=new Promise((r,n)=>{e.file(r,n)}),s.then(r=>{const n=new FileReader;n.onload=()=>{typeof n.result=="string"?t(n.result):i(new Error("Expected a string from FileReader.result"))},n.onerror=()=>{i(n.error??new Error("Unknown FileReader error"))},n.readAsDataURL(r)}).catch(r=>i(r))})}function bl(e){const t=e.hdr.dims,i=e.permRAS,s=t[1]*t[2]*t[3],r=new Int16Array(s),n=[0,0,0];for(let u=0;u<3;u++)for(let m=0;m<3;m++)Math.abs(i[u])-1===m&&(n[m]=u*Math.sign(i[u]));let o=1;const l=[1,1,1],a=[!1,!1,!1];for(let u=0;u<n.length;u++)for(let m=0;m<n.length;m++)Math.abs(n[m])===u&&(l[m]=o,(n[m]<0||Object.is(n[m],-0))&&(a[m]=!0),o*=t[m+1]);let c=X.range(0,t[1]-1,1);a[0]&&(c=X.range(t[1]-1,0,-1));for(let u=0;u<t[1];u++)c[u]*=l[0];let h=X.range(0,t[2]-1,1);a[1]&&(h=X.range(t[2]-1,0,-1));for(let u=0;u<t[2];u++)h[u]*=l[1];let d=X.range(0,t[3]-1,1);a[2]&&(d=X.range(t[3]-1,0,-1));for(let u=0;u<t[3];u++)d[u]*=l[2];let f=0;for(let u=0;u<t[3];u++)for(let m=0;m<t[2];m++)for(let g=0;g<t[1];g++)r[c[g]+h[m]+d[u]]=e.img[f],f++;return r}function Qs(e,t){const i=Math.floor(Math.log(e)/Math.log(10)),s=e/Math.pow(10,i);let r;return t?s<1.5?r=1:s<3?r=2:s<7?r=5:r=10:s<=1?r=1:s<=2?r=2:s<=5?r=5:r=10,r*Math.pow(10,i)}function qe(e,t,i=4){const s=Qs(t-e,!1),r=Qs(s/(i-1),!0),n=Math.floor(e/r)*r,o=Math.ceil(t/r)*r;return[r,n,o,n===e&&o===t]}function Hs(e,t){let i=qe(e,t,3);return i[3]||(i=qe(e,t,5)),i[3]||(i=qe(e,t,4)),i[3]||(i=qe(e,t,3)),i[3]||(i=qe(e,t,5)),[i[0],i[1],i[2]]}function ae(e){return e*(Math.PI/180)}function ji(e,t,i,s){let r=-e,n=-t;return isFinite(i)&&isFinite(s)&&(r=i,n=s),r>n&&([r,n]=[n,r]),[r,n]}function Ut(e,t=[0,1,2]){const i=pt();return i[0]=e[t[0]],i[1]=e[t[1]],i[2]=e[t[2]],i}function Ws(e){const t=xt(1,0,0,0),i=ne();return Tt(i,t,e),i[0]}function Cl(e,t,i,s){const r=xt(e,t,i,1),n=It(s);zt(n,n),r[0]=r[0]*2-1,r[1]=r[1]*2-1,r[2]=r[2]*2-1;const o=ne();return Tt(o,r,n),o[3]===0||(o[0]/=o[3],o[1]/=o[3],o[2]/=o[3]),o}function Dl(e){const t=[5960464477539063e-23,152587890625e-16,.00390625,1];return(e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3])/255}function Zi(e,t,i){return Math.min(Math.max(e,t),i)}function Il(e){const t=e.length;let i=0;const s=new Uint8Array(t+Math.ceil(.01*t)),r=new Int8Array(s.buffer);let n=0;for(;i<t;){let o=e[i];i++;let l=1;for(;l<129&&i<t&&e[i]===o;)i++,l++;if(l>1){r[n]=-l+1,n++,s[n]=o,n++;continue}for(;i<t&&!(l>127||i+2<t&&o!==e[i]&&e[i+2]===e[i]&&e[i+1]===e[i]);)o=e[i],i++,l++;s[n]=l-1,n++;for(let a=0;a<l;a++)s[n]=e[i-l+a],n++}return P.info("PackBits "+t+" -> "+n+" bytes (x"+t/n+")"),s.slice(0,n)}function Xs(e,t){const i=new Uint8Array(e.buffer),s=new Int8Array(i.buffer);let r=0;const n=new Uint8Array(t);let o=0;for(;r<i.length;){const l=s[r];if(r++,l<0){const a=s[r];r++;for(let c=0;c<1-l;c++)n[o]=a,o++}else for(let a=0;a<l+1;a++)n[o]=s[r],r++,o++}return n}function js(e,t){return e.scl_slope===0&&(e.scl_slope=1),t*e.scl_slope+e.scl_inter}var ge=["ASC","BYU","DFS","FSM","PIAL","ORIG","INFLATED","SMOOTHWM","SPHERE","WHITE","G","GEO","GII","ICO","MZ3","NV","OBJ","OFF","PLY","SRF","STL","TCK","TRACT","TRI","TRK","TT","TRX","VTK","WRL","X3D","JCON","JSON"],Zs=0,El=1,Ml=2,ui=33984,mi=33985,Ji=33986,Sl=33987,Tl=33988,Js=33989,_s=33990,Se=33991,$s=33992,Fl=33993,tr=33994,Vl=33995,Bl=33996,Ul=33997,Rl=33998,Nl=33999,er={filename:"",isSaveDrawing:!1,volumeByIndex:0},Pl=class{constructor(e=le){F(this,"loaders",{}),F(this,"dicomLoader",null),F(this,"canvas",null),F(this,"_gl",null),F(this,"isBusy",!1),F(this,"needsRefresh",!1),F(this,"colormapTexture",null),F(this,"colormapLists",[]),F(this,"volumeTexture",null),F(this,"gradientTexture",null),F(this,"gradientTextureAmount",0),F(this,"renderGradientValues",!1),F(this,"drawTexture",null),F(this,"drawUndoBitmaps",[]),F(this,"drawLut",mt.makeDrawLut("$itksnap")),F(this,"drawOpacity",.8),F(this,"clickToSegmentIsGrowing",!1),F(this,"clickToSegmentGrowingBitmap",null),F(this,"clickToSegmentXY",[0,0]),F(this,"renderDrawAmbientOcclusion",.4),F(this,"colorbarHeight",0),F(this,"drawPenLocation",[NaN,NaN,NaN]),F(this,"drawPenAxCorSag",-1),F(this,"drawFillOverwrites",!0),F(this,"drawPenFillPts",[]),F(this,"overlayTexture",null),F(this,"overlayTextureID",null),F(this,"sliceMMShader"),F(this,"sliceV1Shader"),F(this,"orientCubeShader"),F(this,"orientCubeShaderVAO",null),F(this,"rectShader"),F(this,"rectOutlineShader"),F(this,"renderShader"),F(this,"lineShader"),F(this,"line3DShader"),F(this,"passThroughShader"),F(this,"renderGradientShader"),F(this,"renderGradientValuesShader"),F(this,"renderSliceShader"),F(this,"renderVolumeShader"),F(this,"pickingMeshShader"),F(this,"pickingImageShader"),F(this,"colorbarShader"),F(this,"fontShader",null),F(this,"fiberShader"),F(this,"fontTexture",null),F(this,"circleShader"),F(this,"matCapTexture",null),F(this,"bmpShader",null),F(this,"bmpTexture",null),F(this,"thumbnailVisible",!1),F(this,"bmpTextureWH",1),F(this,"growCutShader"),F(this,"orientShaderAtlasU",null),F(this,"orientShaderAtlasI",null),F(this,"orientShaderU",null),F(this,"orientShaderI",null),F(this,"orientShaderF",null),F(this,"orientShaderRGBU",null),F(this,"surfaceShader",null),F(this,"blurShader",null),F(this,"sobelBlurShader",null),F(this,"sobelFirstOrderShader",null),F(this,"sobelSecondOrderShader",null),F(this,"genericVAO",null),F(this,"unusedVAO",null),F(this,"crosshairs3D",null),F(this,"DEFAULT_FONT_GLYPH_SHEET",Ks),F(this,"DEFAULT_FONT_METRICS",qs),F(this,"fontMetrics"),F(this,"fontMets",null),F(this,"backgroundMasksOverlays",0),F(this,"overlayOutlineWidth",0),F(this,"overlayAlphaShader",1),F(this,"position"),F(this,"extentsMin"),F(this,"extentsMax"),F(this,"resizeObserver",null),F(this,"syncOpts",{"3d":!1,"2d":!1,zoomPan:!1,cal_min:!1,cal_max:!1,clipPlane:!1,gamma:!1,sliceType:!1,crosshair:!1}),F(this,"readyForSync",!1),F(this,"uiData",{mousedown:!1,touchdown:!1,mouseButtonLeftDown:!1,mouseButtonCenterDown:!1,mouseButtonRightDown:!1,mouseDepthPicker:!1,clickedTile:-1,pan2DxyzmmAtMouseDown:[0,0,0,1],prevX:0,prevY:0,currX:0,currY:0,currentTouchTime:0,lastTouchTime:0,touchTimer:null,doubleTouch:!1,isDragging:!1,dragStart:[0,0],dragEnd:[0,0],dragClipPlaneStartDepthAziElev:[0,0,0],lastTwoTouchDistance:0,multiTouchGesture:!1,windowX:0,windowY:0}),F(this,"back",null),F(this,"overlays",[]),F(this,"deferredVolumes",[]),F(this,"deferredMeshes",[]),F(this,"furthestVertexFromOrigin",100),F(this,"volScale",[]),F(this,"vox",[]),F(this,"mousePos",[0,0]),F(this,"screenSlices",[]),F(this,"cuboidVertexBuffer"),F(this,"otherNV",null),F(this,"volumeObject3D",null),F(this,"pivot3D",[0,0,0]),F(this,"furthestFromPivot",10),F(this,"currentClipPlaneIndex",0),F(this,"lastCalled",new Date().getTime()),F(this,"selectedObjectId",-1),F(this,"CLIP_PLANE_ID",1),F(this,"VOLUME_ID",254),F(this,"DISTANCE_FROM_CAMERA",-.54),F(this,"graph",{LTWH:[0,0,640,480],opacity:0,vols:[0],autoSizeMultiplanar:!1,normalizeValues:!1,isRangeCalMinMax:!1}),F(this,"meshShaders",[{Name:"Phong",Frag:No},{Name:"Matte",Frag:Lo},{Name:"Harmonic",Frag:ko},{Name:"Hemispheric",Frag:Oo},{Name:"Crevice",Frag:Ro},{Name:"Edge",Frag:Vo},{Name:"Diffuse",Frag:Bo},{Name:"Outline",Frag:Fo},{Name:"Specular",Frag:Uo},{Name:"Toon",Frag:To},{Name:"Flat",Frag:Gs},{Name:"Matcap",Frag:Po}]),F(this,"dragModes",{contrast:1,measurement:2,none:0,pan:3,slicer3D:4,callbackOnly:5}),F(this,"sliceTypeAxial",0),F(this,"sliceTypeCoronal",1),F(this,"sliceTypeSagittal",2),F(this,"sliceTypeMultiplanar",3),F(this,"sliceTypeRender",4),F(this,"onDragRelease",()=>{}),F(this,"onMouseUp",()=>{}),F(this,"onLocationChange",()=>{}),F(this,"onIntensityChange",()=>{}),F(this,"onClickToSegment",()=>{}),F(this,"onImageLoaded",()=>{}),F(this,"onMeshLoaded",()=>{}),F(this,"onFrameChange",()=>{}),F(this,"onError",()=>{}),F(this,"onColormapChange",()=>{}),F(this,"onInfo",()=>{}),F(this,"onWarn",()=>{}),F(this,"onDebug",()=>{}),F(this,"onVolumeAddedFromUrl",()=>{}),F(this,"onVolumeWithUrlRemoved",()=>{}),F(this,"onVolumeUpdated",()=>{}),F(this,"onMeshAddedFromUrl",()=>{}),F(this,"onMeshAdded",()=>{}),F(this,"onMeshWithUrlRemoved",()=>{}),F(this,"onZoom3DChange",()=>{}),F(this,"onAzimuthElevationChange",()=>{}),F(this,"onClipPlaneChange",()=>{}),F(this,"onCustomMeshShaderAdded",()=>{}),F(this,"onMeshShaderChanged",()=>{}),F(this,"onMeshPropertyChanged",()=>{}),F(this,"onDicomLoaderFinishedWithImages",()=>{}),F(this,"onDocumentLoaded",()=>{}),F(this,"document",new Xi),F(this,"mediaUrlMap",new Map),F(this,"initialized",!1),F(this,"currentDrawUndoBitmap");for(const t in e)typeof e[t]=="function"?this[t]=e[t]:this.opts[t]=le[t]===void 0?le[t]:e[t];this.opts.forceDevicePixelRatio===0?this.uiData.dpr=window.devicePixelRatio||1:this.opts.forceDevicePixelRatio<0?this.uiData.dpr=1:this.uiData.dpr=this.opts.forceDevicePixelRatio,this.currentDrawUndoBitmap=this.opts.maxDrawUndoBitmaps,this.opts.drawingEnabled&&this.createEmptyDrawing(),this.opts.thumbnail.length>0&&(this.thumbnailVisible=!0),P.setLogLevel(this.opts.logLevel)}get scene(){return this.document.scene}get opts(){return this.document.opts}get sliceMosaicString(){return this.document.opts.sliceMosaicString||""}set sliceMosaicString(e){this.document.opts.sliceMosaicString=e}get isAlphaClipDark(){return this.document.opts.isAlphaClipDark}set isAlphaClipDark(e){this.document.opts.isAlphaClipDark=e}get volumes(){return this.document.volumes}set volumes(e){this.document.volumes=e}get meshes(){return this.document.meshes}set meshes(e){this.document.meshes=e}get drawBitmap(){return this.document.drawBitmap}set drawBitmap(e){this.document.drawBitmap=e}get volScaleMultiplier(){return this.scene.volScaleMultiplier}set volScaleMultiplier(e){this.setScale(e)}async saveScene(e="niivue.png"){function t(s,r){const n=document.createElement("a");document.body.appendChild(n),n.style.display="none";const o=window.URL.createObjectURL(s);n.href=o,n.download=r,n.click(),n.remove()}const i=this.canvas;if(!i)throw new Error("canvas not defined");this.drawScene(),i.toBlob(s=>{s&&(e===""&&(e=`niivue-screenshot-${new Date().toString()}.png`,e=e.replace(/\s/g,"_")),t(s,e))})}async attachTo(e,t=null){return await this.attachToCanvas(document.getElementById(e),t),P.debug("attached to element with id: ",e),this}async attachToCanvas(e,t=null){return this.canvas=e,t===null&&(t=navigator.hardwareConcurrency>6,P.debug("AntiAlias ",t," Threads ",navigator.hardwareConcurrency)),this.gl=this.canvas.getContext("webgl2",{alpha:!0,antialias:t}),P.info("NIIVUE VERSION ",Ns),this.canvas.parentElement.style.backgroundColor="black",this.opts.isResizeCanvas&&(this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.display="block",this.canvas.width=this.canvas.offsetWidth,this.canvas.height=this.canvas.offsetHeight,window.addEventListener("resize",()=>{requestAnimationFrame(()=>{this.resizeListener()})}),this.resizeObserver=new ResizeObserver(()=>{requestAnimationFrame(()=>{this.resizeListener()})}),this.resizeObserver.observe(this.canvas.parentElement)),this.opts.interactive&&this.registerInteractions(),await this.init(),this.drawScene(),this}syncWith(e,t={"2d":!0,"3d":!0}){e instanceof Array||(e=[e]),this.otherNV=e,this.syncOpts={...t}}broadcastTo(e,t={"2d":!0,"3d":!0}){e instanceof Array||(e=[e]),this.otherNV=e,this.syncOpts=t}doSync3d(e){e.scene.renderAzimuth=this.scene.renderAzimuth,e.scene.renderElevation=this.scene.renderElevation,e.scene.volScaleMultiplier=this.scene.volScaleMultiplier}doSync2d(e){const t=this.frac2mm(this.scene.crosshairPos);e.scene.crosshairPos=e.mm2frac(t),e.scene.pan2Dxyzmm=re(this.scene.pan2Dxyzmm)}doSyncGamma(e){const t=this.scene.gamma,i=e.scene.gamma;t!==i&&e.setGamma(t)}doSyncZoomPan(e){e.scene.pan2Dxyzmm=re(this.scene.pan2Dxyzmm)}doSyncCrosshair(e){const t=this.frac2mm(this.scene.crosshairPos);e.scene.crosshairPos=e.mm2frac(t)}doSyncCalMin(e){this.volumes[0].cal_min!==e.volumes[0].cal_min&&(e.volumes[0].cal_min=this.volumes[0].cal_min,e.updateGLVolume())}doSyncCalMax(e){this.volumes[0].cal_max!==e.volumes[0].cal_max&&(e.volumes[0].cal_max=this.volumes[0].cal_max,e.updateGLVolume())}doSyncSliceType(e){e.setSliceType(this.opts.sliceType)}doSyncClipPlane(e){e.setClipPlane(this.scene.clipPlaneDepthAziElev)}sync(){if(!(!this.gl||!this.otherNV||typeof this.otherNV>"u")&&this.gl.canvas.matches(":focus"))for(let e=0;e<this.otherNV.length;e++)this.otherNV[e]!==this&&(this.syncOpts.gamma&&this.doSyncGamma(this.otherNV[e]),this.syncOpts.crosshair&&this.doSyncCrosshair(this.otherNV[e]),this.syncOpts.zoomPan&&this.doSyncZoomPan(this.otherNV[e]),this.syncOpts.sliceType&&this.doSyncSliceType(this.otherNV[e]),this.syncOpts.cal_min&&this.doSyncCalMin(this.otherNV[e]),this.syncOpts.cal_max&&this.doSyncCalMax(this.otherNV[e]),this.syncOpts.clipPlane&&this.doSyncClipPlane(this.otherNV[e]),this.syncOpts["2d"]&&this.doSync2d(this.otherNV[e]),this.syncOpts["3d"]&&this.doSync3d(this.otherNV[e]),this.otherNV[e].drawScene(),this.otherNV[e].createOnLocationChange())}arrayEquals(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((i,s)=>i===t[s])}resizeListener(){if(!(!this.canvas||!this.gl)){if(!this.opts.isResizeCanvas){this.opts.forceDevicePixelRatio>=0&&P.warn("this.opts.forceDevicePixelRatio requires isResizeCanvas"),this.drawScene();return}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.display="block",this.opts.forceDevicePixelRatio===0?this.uiData.dpr=window.devicePixelRatio||1:this.opts.forceDevicePixelRatio<0?this.uiData.dpr=1:this.uiData.dpr=this.opts.forceDevicePixelRatio,P.debug("devicePixelRatio: "+this.uiData.dpr),"width"in this.canvas.parentElement?(this.canvas.width=this.canvas.parentElement.width*this.uiData.dpr,this.canvas.height=this.canvas.parentElement.height*this.uiData.dpr):(this.canvas.width=this.canvas.offsetWidth*this.uiData.dpr,this.canvas.height=this.canvas.offsetHeight*this.uiData.dpr),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.drawScene()}}getRelativeMousePosition(e,t){if(t=t||e.target,!t)return;const i=t.getBoundingClientRect();return{x:e.clientX-i.left,y:e.clientY-i.top}}getNoPaddingNoBorderCanvasRelativeMousePosition(e,t){return t=t||e.target,this.getRelativeMousePosition(e,t)}mouseContextMenuListener(e){e.preventDefault()}mouseDownListener(e){e.preventDefault(),this.drawPenLocation=[NaN,NaN,NaN],this.drawPenAxCorSag=-1,this.uiData.mousedown=!0,this.setDragStart(0,0),this.setDragEnd(0,0),P.debug("mouse down"),P.debug(e);const t=this.getNoPaddingNoBorderCanvasRelativeMousePosition(e,this.gl.canvas);if(!t)return;const[i,s]=[t.x*this.uiData.dpr,t.y*this.uiData.dpr];this.opts.clickToSegment&&(this.clickToSegmentXY=[i,s]);const r=this.getLabelAtPoint([i,s]);if(r){if(r.onClick){r.onClick(r);return}for(const n of this.meshes)if(n.type==="connectome")for(const o of n.nodes)o.label===r&&(this.scene.crosshairPos=this.mm2frac([o.x,o.y,o.z]),this.updateGLVolume(),this.drawScene())}this.uiData.clickedTile=this.tileIndex(i,s),e.button===Zs&&e.shiftKey?(this.uiData.mouseButtonCenterDown=!0,this.mouseCenterButtonHandler(e)):e.button===Zs?(this.uiData.mouseButtonLeftDown=!0,this.mouseLeftButtonHandler(e)):e.button===Ml?(this.uiData.mouseButtonRightDown=!0,this.mouseRightButtonHandler(e)):e.button===El&&(this.uiData.mouseButtonCenterDown=!0,this.mouseCenterButtonHandler(e))}mouseLeftButtonHandler(e){if(e.ctrlKey||this.opts.dragModePrimary===0){const t=this.getNoPaddingNoBorderCanvasRelativeMousePosition(e,this.gl.canvas);this.mouseDown(t.x,t.y),this.mouseClick(t.x,t.y)}else this.opts.dragModePrimary===1&&(this.uiData.windowX=e.x,this.uiData.windowY=e.y)}mouseCenterButtonHandler(e){const t=this.getNoPaddingNoBorderCanvasRelativeMousePosition(e,this.gl.canvas);this.mousePos=[t.x*this.uiData.dpr,t.y*this.uiData.dpr],this.opts.dragMode!==0&&(this.setDragStart(t.x,t.y),this.uiData.isDragging||(this.uiData.pan2DxyzmmAtMouseDown=re(this.scene.pan2Dxyzmm)),this.uiData.isDragging=!0,this.uiData.dragClipPlaneStartDepthAziElev=this.scene.clipPlaneDepthAziElev)}mouseRightButtonHandler(e){const t=this.getNoPaddingNoBorderCanvasRelativeMousePosition(e,this.gl.canvas);this.mousePos=[t.x*this.uiData.dpr,t.y*this.uiData.dpr],this.opts.dragMode!==0&&(this.setDragStart(t.x,t.y),this.uiData.isDragging||(this.uiData.pan2DxyzmmAtMouseDown=re(this.scene.pan2Dxyzmm)),this.uiData.isDragging=!0,this.uiData.dragClipPlaneStartDepthAziElev=this.scene.clipPlaneDepthAziElev)}calculateMinMaxVoxIdx(e){if(e.length>2)throw new Error("array must not contain more than two values");return[Math.floor(Math.min(e[0],e[1])),Math.floor(Math.max(e[0],e[1]))]}calculateNewRange({volIdx:e=0}={}){if(this.opts.sliceType===4&&this.sliceMosaicString.length<1||this.uiData.dragStart[0]===this.uiData.dragEnd[0]&&this.uiData.dragStart[1]===this.uiData.dragEnd[1])return;let t=this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]]);if(t[0]<0)return;const i=this.frac2vox(t,e);if(t=this.canvasPos2frac([this.uiData.dragEnd[0],this.uiData.dragEnd[1]]),t[0]<0)return;const s=this.frac2vox(t,e);let r=-Number.MAX_VALUE,n=Number.MAX_VALUE;const o=this.calculateMinMaxVoxIdx([i[0],s[0]]),l=this.calculateMinMaxVoxIdx([i[1],s[1]]),a=this.calculateMinMaxVoxIdx([i[2],s[2]]);i[0]-s[0]===0?o[1]=i[0]+1:i[1]-s[1]===0?l[1]=i[1]+1:i[2]-s[2]===0&&(a[1]=i[2]+1);const c=this.volumes[e].hdr,h=this.volumes[e].img;if(!c||!h)return;const d=c.dims[1],f=c.dims[2];for(let g=a[0];g<a[1];g++){const A=g*d*f;for(let p=l[0];p<l[1];p++){const w=p*d;for(let y=o[0];y<o[1];y++){const x=A+w+y;n>h[x]&&(n=h[x]),r<h[x]&&(r=h[x])}}}if(n>=r)return;const u=js(c,n),m=js(c,r);this.volumes[e].cal_min=u,this.volumes[e].cal_max=m,this.onIntensityChange(this.volumes[e])}generateMouseUpCallback(e,t){const i=this.tileIndex(this.uiData.dragStart[0],this.uiData.dragStart[1]),s=this.tileIndex(this.uiData.dragEnd[0],this.uiData.dragEnd[1]);let r=-1;i===s&&(r=s);let n=-1;r>=0&&(n=this.screenSlices[r].axCorSag);const o=this.frac2mm(e),l=this.frac2mm(t),a=pt();Es(a,Q(o[0],o[1],o[2]),Q(l[0],l[1],l[2]));const c=Je(a),h=this.frac2vox(e),d=this.frac2vox(t);this.onDragRelease({fracStart:e,fracEnd:t,voxStart:h,voxEnd:d,mmStart:o,mmEnd:l,mmLength:c,tileIdx:r,axCorSag:n})}mouseUpListener(){function e(s){return Object.prototype.toString.call(s).indexOf("Function")>-1}const t={mouseButtonRightDown:this.uiData.mouseButtonRightDown,mouseButtonCenterDown:this.uiData.mouseButtonCenterDown,isDragging:this.uiData.isDragging,mousePos:this.mousePos,fracPos:this.canvasPos2frac(this.mousePos)};this.uiData.mousedown=!1,this.uiData.mouseButtonRightDown=!1;const i=this.uiData.mouseButtonCenterDown;if(this.uiData.mouseButtonCenterDown=!1,this.uiData.mouseButtonLeftDown=!1,this.drawPenFillPts.length>0)this.drawPenFilled();else if(this.drawPenAxCorSag>=0&&this.opts.clickToSegment){const s=this.sumBitmap(this.drawBitmap);this.sumBitmap(this.clickToSegmentGrowingBitmap)>s&&this.updateBitmapFromClickToSegment()}if(this.drawAddUndoBitmap(),this.drawPenLocation=[NaN,NaN,NaN],this.drawPenAxCorSag=-1,e(this.onMouseUp)&&this.onMouseUp(t),this.uiData.isDragging){this.uiData.isDragging=!1,this.opts.dragMode===5&&this.drawScene();const s=this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]]),r=this.canvasPos2frac([this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);if(this.generateMouseUpCallback(s,r),this.opts.dragMode===6||this.opts.dragMode!==1||i||this.uiData.dragStart[0]===this.uiData.dragEnd[0]&&this.uiData.dragStart[1]===this.uiData.dragEnd[1])return;this.calculateNewRange({volIdx:0}),this.refreshLayers(this.volumes[0],0)}this.drawScene()}checkMultitouch(e){if(this.uiData.touchdown&&!this.uiData.multiTouchGesture){const t=this.canvas.getBoundingClientRect();this.mouseDown(e.touches[0].clientX-t.left,e.touches[0].clientY-t.top),this.mouseClick(e.touches[0].clientX-t.left,e.touches[0].clientY-t.top)}}touchStartListener(e){e.preventDefault(),this.uiData.touchTimer||(this.uiData.touchTimer=setTimeout(()=>{this.resetBriCon(e)},this.opts.longTouchTimeout)),this.uiData.touchdown=!0,this.uiData.currentTouchTime=new Date().getTime();const t=this.uiData.currentTouchTime-this.uiData.lastTouchTime;if(t<this.opts.doubleTouchTimeout&&t>0){this.uiData.doubleTouch=!0,this.setDragStart(e.targetTouches[0].clientX-e.target.getBoundingClientRect().left,e.targetTouches[0].clientY-e.target.getBoundingClientRect().top),this.resetBriCon(e),this.uiData.lastTouchTime=this.uiData.currentTouchTime;return}else this.uiData.doubleTouch=!1,this.setDragStart(0,0),this.setDragEnd(0,0),this.uiData.lastTouchTime=this.uiData.currentTouchTime;this.uiData.touchdown&&e.touches.length<2?this.uiData.multiTouchGesture=!1:this.uiData.multiTouchGesture=!0,setTimeout(this.checkMultitouch.bind(this),1,e)}touchEndListener(e){if(e.preventDefault(),this.uiData.touchdown=!1,this.uiData.lastTwoTouchDistance=0,this.uiData.multiTouchGesture=!1,this.uiData.touchTimer&&(clearTimeout(this.uiData.touchTimer),this.uiData.touchTimer=null),this.uiData.isDragging){this.uiData.isDragging=!1,this.opts.dragMode===1&&(this.calculateNewRange(),this.refreshLayers(this.volumes[0],0));const t=this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]]),i=this.canvasPos2frac([this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);this.generateMouseUpCallback(t,i)}this.mouseUpListener()}windowingHandler(e,t,i=0){const s=this.uiData.windowX,r=this.uiData.windowY;let n=this.volumes[0].cal_min,o=this.volumes[0].cal_max;const l=this.volumes[0].global_min,a=this.volumes[0].global_max;t<r?(n+=1,o+=1):t>r&&(n-=1,o-=1),e>s?(n-=1,o+=1):e<s&&(n+=1,o-=1),o-n<1&&(o=n+1),n<l&&(n=l),o>a&&(o=a),n>o&&(n=o-1),this.volumes[i].cal_min=n,this.volumes[i].cal_max=o,this.refreshLayers(this.volumes[i],0),this.uiData.windowX=e,this.uiData.windowY=t}mouseMoveListener(e){if(this.uiData.mousedown){const t=this.getNoPaddingNoBorderCanvasRelativeMousePosition(e,this.gl.canvas);if(!t)return;const i=t.x*this.uiData.dpr,s=t.y*this.uiData.dpr;if(this.tileIndex(i,s)!==this.uiData.clickedTile)return;if(this.uiData.mouseButtonLeftDown){const n=this.opts.dragModePrimary===0,o=this.opts.dragModePrimary===1;e.ctrlKey||n?(this.mouseMove(t.x,t.y),this.mouseClick(t.x,t.y)):o&&this.windowingHandler(e.x,e.y)}else(this.uiData.mouseButtonRightDown||this.uiData.mouseButtonCenterDown)&&this.setDragEnd(t.x,t.y);this.drawScene(),this.uiData.prevX=this.uiData.currX,this.uiData.prevY=this.uiData.currY}else if(!this.uiData.mousedown&&this.opts.clickToSegment){const t=this.getNoPaddingNoBorderCanvasRelativeMousePosition(e,this.gl.canvas);if(!t)return;const i=t.x*this.uiData.dpr,s=t.y*this.uiData.dpr;this.mousePos=[i,s],this.drawScene()}}resetBriCon(e=null){if(this.uiData.isDragging)return;let t=!1;this.opts.sliceType===4&&(t=!0);let i=0,s=0;if(e!==null&&("targetTouches"in e?(i=e.targetTouches[0].clientX-e.target.getBoundingClientRect().left,s=e.targetTouches[0].clientY-e.target.getBoundingClientRect().top):(i=e.offsetX,s=e.offsetY),i*=this.uiData.dpr,s*=this.uiData.dpr,this.inRenderTile(i,s)>=0&&(t=!0)),t){this.uiData.mouseDepthPicker=!0,this.drawScene(),this.drawScene();return}this.opts.dragMode!==4&&(this.volumes.length<1||this.uiData.doubleTouch||(this.volumes[0].cal_min=this.volumes[0].robust_min,this.volumes[0].cal_max=this.volumes[0].robust_max,this.onIntensityChange(this.volumes[0]),this.refreshLayers(this.volumes[0],0),this.drawScene()))}setDragStart(e,t){e*=this.uiData.dpr,t*=this.uiData.dpr,this.uiData.dragStart[0]=e,this.uiData.dragStart[1]=t}setDragEnd(e,t){e*=this.uiData.dpr,t*=this.uiData.dpr,this.uiData.dragEnd[0]=e,this.uiData.dragEnd[1]=t}touchMoveListener(e){if(this.uiData.touchdown&&e.touches.length<2){const t=this.canvas.getBoundingClientRect();if(this.uiData.isDragging||(this.uiData.pan2DxyzmmAtMouseDown=re(this.scene.pan2Dxyzmm)),this.uiData.isDragging=!0,this.uiData.doubleTouch&&this.uiData.isDragging){this.setDragEnd(e.targetTouches[0].clientX-e.target.getBoundingClientRect().left,e.targetTouches[0].clientY-e.target.getBoundingClientRect().top),this.drawScene();return}const i=this.opts.dragModePrimary===0,s=this.opts.dragModePrimary===1;i?(this.mouseClick(e.touches[0].clientX-t.left,e.touches[0].clientY-t.top),this.mouseMove(e.touches[0].clientX-t.left,e.touches[0].clientY-t.top)):s&&(this.windowingHandler(e.touches[0].pageX,e.touches[0].pageY),this.drawScene())}else this.handlePinchZoom(e)}handlePinchZoom(e){if(e.targetTouches.length===2&&e.changedTouches.length===2){const t=Math.hypot(e.touches[0].pageX-e.touches[1].pageX,e.touches[0].pageY-e.touches[1].pageY),i=this.canvas.getBoundingClientRect();this.mousePos=[e.touches[0].clientX-i.left,e.touches[0].clientY-i.top],t<this.uiData.lastTwoTouchDistance?this.sliceScroll2D(-.01,e.touches[0].clientX-i.left,e.touches[0].clientY-i.top):this.sliceScroll2D(.01,e.touches[0].clientX-i.left,e.touches[0].clientY-i.top),this.uiData.lastTwoTouchDistance=t}}keyUpListener(e){if(e.code===this.opts.clipPlaneHotKey){const t=new Date().getTime();if(t-this.lastCalled>this.opts.keyDebounceTime){switch(this.currentClipPlaneIndex=(this.currentClipPlaneIndex+1)%7,this.currentClipPlaneIndex){case 0:this.scene.clipPlaneDepthAziElev=[2,0,0];break;case 1:this.scene.clipPlaneDepthAziElev=[0,270,0];break;case 2:this.scene.clipPlaneDepthAziElev=[0,90,0];break;case 3:this.scene.clipPlaneDepthAziElev=[0,0,0];break;case 4:this.scene.clipPlaneDepthAziElev=[0,180,0];break;case 5:this.scene.clipPlaneDepthAziElev=[0,0,-90];break;case 6:this.scene.clipPlaneDepthAziElev=[0,0,90];break}this.setClipPlane(this.scene.clipPlaneDepthAziElev)}this.lastCalled=t}else if(e.code===this.opts.viewModeHotKey){const t=new Date().getTime();t-this.lastCalled>this.opts.keyDebounceTime&&(this.setSliceType((this.opts.sliceType+1)%5),this.lastCalled=t)}}keyDownListener(e){e.code==="KeyH"&&this.opts.sliceType===4?this.setRenderAzimuthElevation(this.scene.renderAzimuth-1,this.scene.renderElevation):e.code==="KeyL"&&this.opts.sliceType===4?this.setRenderAzimuthElevation(this.scene.renderAzimuth+1,this.scene.renderElevation):e.code==="KeyJ"&&this.opts.sliceType===4?this.setRenderAzimuthElevation(this.scene.renderAzimuth,this.scene.renderElevation+1):e.code==="KeyK"&&this.opts.sliceType===4?this.setRenderAzimuthElevation(this.scene.renderAzimuth,this.scene.renderElevation-1):e.code==="KeyH"&&this.opts.sliceType!==4?this.moveCrosshairInVox(-1,0,0):e.code==="KeyL"&&this.opts.sliceType!==4?this.moveCrosshairInVox(1,0,0):e.code==="KeyU"&&this.opts.sliceType!==4&&e.ctrlKey?this.moveCrosshairInVox(0,0,1):e.code==="KeyD"&&this.opts.sliceType!==4&&e.ctrlKey?this.moveCrosshairInVox(0,0,-1):e.code==="KeyJ"&&this.opts.sliceType!==4?this.moveCrosshairInVox(0,-1,0):e.code==="KeyK"&&this.opts.sliceType!==4?this.moveCrosshairInVox(0,1,0):e.code==="KeyM"&&this.opts.sliceType!==4?(this.opts.dragMode++,this.opts.dragMode>=4&&(this.opts.dragMode=0),P.info("drag mode changed to ",Gr[this.opts.dragMode])):e.code==="ArrowLeft"?this.setFrame4D(this.volumes[0].id,this.volumes[0].frame4D-1):e.code==="ArrowRight"?this.setFrame4D(this.volumes[0].id,this.volumes[0].frame4D+1):e.code==="Slash"&&e.shiftKey&&alert(`NIIVUE VERSION: ${Ns}`)}wheelListener(e){if(e.preventDefault(),e.stopPropagation(),this.thumbnailVisible)return;const t=this.uiData.dragStart.reduce((n,o)=>n+o,0),i=this.uiData.dragEnd.reduce((n,o)=>n+o,0),s=t>0&&i>0;if(this.opts.dragMode===6&&s){const n=e.deltaY>0?1:-1;this.uiData.dragStart[0]<this.uiData.dragEnd[0]?(this.uiData.dragStart[0]-=n,this.uiData.dragEnd[0]+=n):(this.uiData.dragStart[0]+=n,this.uiData.dragEnd[0]-=n),this.uiData.dragStart[1]<this.uiData.dragEnd[1]?(this.uiData.dragStart[1]-=n,this.uiData.dragEnd[1]+=n):(this.uiData.dragStart[1]+=n,this.uiData.dragEnd[1]-=n),this.uiData.isDragging=!0,this.drawScene(),this.uiData.isDragging=!1;const o=this.tileIndex(this.uiData.dragStart[0],this.uiData.dragStart[1]);this.generateMouseUpCallback(this.screenXY2TextureFrac(this.uiData.dragStart[0],this.uiData.dragStart[1],o),this.screenXY2TextureFrac(this.uiData.dragEnd[0],this.uiData.dragEnd[1],o));return}const r=this.canvas.getBoundingClientRect();e.deltaY<0?this.sliceScroll2D(-.01,e.clientX-r.left,e.clientY-r.top):this.sliceScroll2D(.01,e.clientX-r.left,e.clientY-r.top)}registerInteractions(){if(!this.canvas)throw new Error("canvas undefined");this.canvas.addEventListener("mousedown",this.mouseDownListener.bind(this)),this.canvas.addEventListener("mouseup",this.mouseUpListener.bind(this)),this.canvas.addEventListener("mousemove",this.mouseMoveListener.bind(this)),this.canvas.addEventListener("touchstart",this.touchStartListener.bind(this)),this.canvas.addEventListener("touchend",this.touchEndListener.bind(this)),this.canvas.addEventListener("touchmove",this.touchMoveListener.bind(this)),this.canvas.addEventListener("wheel",this.wheelListener.bind(this)),this.canvas.addEventListener("contextmenu",this.mouseContextMenuListener.bind(this)),this.canvas.addEventListener("dblclick",this.resetBriCon.bind(this)),this.canvas.addEventListener("dragenter",this.dragEnterListener.bind(this),!1),this.canvas.addEventListener("dragover",this.dragOverListener.bind(this),!1),this.canvas.addEventListener("drop",this.dropListener.bind(this),!1),this.canvas.setAttribute("tabindex","0"),this.canvas.addEventListener("keyup",this.keyUpListener.bind(this),!1),this.canvas.addEventListener("keydown",this.keyDownListener.bind(this),!1)}dragEnterListener(e){e.stopPropagation(),e.preventDefault()}dragOverListener(e){e.stopPropagation(),e.preventDefault()}getFileExt(e,t=!0){P.debug("fullname: ",e);const i=/(?:\.([^.]+))?$/;let s=i.exec(e)[1];if(s=s.toUpperCase(),s==="GZ")s=i.exec(e.slice(0,-3))[1],s=s.toUpperCase();else if(s==="CBOR"){const r=s;s=i.exec(e.slice(0,-5))[1],s=s.toUpperCase(),s=`${s}.${r}`}return t?s:s.toLowerCase()}async addVolumeFromUrl(e){const t=await Rt.loadFromUrl(e);return this.document.addImageOptions(t,e),t.onColormapChange=this.onColormapChange,this.mediaUrlMap.set(t,e.url),this.onVolumeAddedFromUrl&&this.onVolumeAddedFromUrl(e,t),this.addVolume(t),t}async addVolumesFromUrl(e){const t=e.map(async s=>{const r=this.getFileExt(s.name||s.url);if(r==="DCM")throw new Error("DICOM files must be loaded using useDicomLoader");if(this.loaders[r]){let l=s.url;const a=this.loaders[r].toExt;let c=s.name||s.url;if(c=c.split("/").pop(),typeof s.url=="string"){const d=s.url;try{const f=await fetch(d);if(!f.ok)throw new Error(`Failed to load file: ${f.statusText}`);l=await f.arrayBuffer()}catch(f){throw new Error(`Failed to load url ${d}: ${f}`)}}const h=await this.loaders[r].loader(l);s.url=h,s.name=`${c}.${a}`}const n={url:s.url,headers:s.headers,name:s.name,colormap:s.colormap?s.colormap:s.colorMap,colormapNegative:s.colormapNegative?s.colormapNegative:s.colorMapNegative,opacity:s.opacity,urlImgData:s.urlImgData,cal_min:s.cal_min,cal_max:s.cal_max,trustCalMinMax:this.opts.trustCalMinMax,isManifest:s.isManifest,frame4D:s.frame4D,limitFrames4D:s.limitFrames4D||this.opts.limitFrames4D,colorbarVisible:s.colorbarVisible},o=await Rt.loadFromUrl(n);return this.document.addImageOptions(o,n),o.onColormapChange=this.onColormapChange,this.mediaUrlMap.set(o,n.url),this.onVolumeAddedFromUrl&&this.onVolumeAddedFromUrl(n,o),o}),i=await Promise.all(t);for(let s=0;s<i.length;s++)this.addVolume(i[s]);return i}getMediaByUrl(e){return[...this.mediaUrlMap.entries()].filter(t=>t[1]===e).map(t=>t[0]).pop()}removeVolumeByUrl(e){const t=this.getMediaByUrl(e);if(t)this.removeVolume(t);else throw new Error("No volume with URL present")}async traverseFileTree(e,t="",i){return new Promise(s=>{if(e.isFile)e.file(r=>{r.fullPath=t+r.name,r._webkitRelativePath=t+r.name,i.push(r),s(i)});else if(e.isDirectory){const r=e.createReader(),n=()=>{r.readEntries(o=>{if(o.length>0){const l=[];for(const a of o)l.push(this.traverseFileTree(a,t+e.name+"/",i));Promise.all(l).then(n).catch(a=>{throw a})}else s(i)})};n()}})}readDirectory(e){const t=e.createReader();let i=[];const s=async n=>{const o=[],l=async a=>new Promise((c,h)=>a.file(c,h));for(let a=0;a<n.length;a++)o.push(await l(n[a])),console.log(o);return o},r=()=>{t.readEntries(n=>{n.length?(i=i.concat(n),r()):s(i).then(async o=>{console.log(o)}).catch(o=>{throw o})})};return r(),i}isMeshExt(e){const t=this.getFileExt(e);return P.debug("dropped ext"),P.debug(t),ge.includes(t)}async loadFromArrayBuffer(e,t){const i=this.getFileExt(t);if(ge.includes(i)){await this.addMeshFromUrl({url:t,buffer:e});return}const s=Si(t);s.buffer=e,s.name=t,await this.addVolumeFromUrl(s)}async loadFromFile(e){const t=this.getFileExt(e.name);if(ge.includes(t)){await Ne.loadFromFile({file:e,gl:this.gl,name:e.name}).then(i=>{this.addMesh(i)});return}await Rt.loadFromFile({file:e,name:e.name}).then(i=>{this.addVolume(i)})}useLoader(e,t,i){this.loaders={...this.loaders,[t.toUpperCase()]:{loader:e,toExt:i}}}useDicomLoader(e){this.dicomLoader=e}getDicomLoader(){return this.dicomLoader}async dropListener(e){if(e.stopPropagation(),e.preventDefault(),!this.opts.dragAndDropEnabled)return;const t=[],i=e.dataTransfer;if(!i)return;const s=i.getData("text/uri-list");if(s){const r=Si(s),n=this.getFileExt(s);P.debug("dropped ext"),P.debug(n),ge.includes(n)?this.addMeshFromUrl({url:s}).catch(o=>{throw o}):n==="NVD"?this.loadDocumentFromUrl(s).catch(o=>{throw o}):this.addVolumeFromUrl(r).catch(o=>{throw o})}else{const r=i.items;if(r.length>0){!e.shiftKey&&!e.altKey&&(this.volumes=[],this.overlays=[],this.meshes=[]),this.closeDrawing();for(const n of Array.from(r)){const o=n.webkitGetAsEntry();if(P.debug(o),!o)throw new Error("could not get entry from file");if(o.isFile){const l=this.getFileExt(o.name);let a;if(o.name.lastIndexOf("HEAD")!==-1)for(const c of Array.from(r)){const h=c.webkitGetAsEntry();if(!h)throw new Error("could not get paired entry");const d=o.name.substring(0,o.name.lastIndexOf("HEAD")),f=h.name.substring(0,h.name.lastIndexOf("BRIK"));d===f&&(a=h)}if(o.name.lastIndexOf("BRIK")!==-1)continue;if(this.loaders[l]){const c=await yl(o);await this.loadImages([{url:c,name:`${o.name}`}]);continue}if(ge.includes(l)){o.file(c=>{(async()=>{try{const h=await Ne.loadFromFile({file:c,gl:this.gl,name:c.name});this.addMesh(h)}catch(h){console.error("Error loading mesh:",h)}})().catch(h=>console.error(h))});continue}else if(l==="NVD"){o.file(c=>{(async()=>{try{const h=await Xi.loadFromFile(c);await this.loadDocument(h),P.debug("loaded document")}catch(h){console.error(h)}})().catch(h=>console.error(h))});break}o.file(c=>{(async()=>{try{if(a)a.file(h=>{(async()=>{try{const d=await Rt.loadFromFile({file:c,urlImgData:h,limitFrames4D:this.opts.limitFrames4D});this.addVolume(d)}catch(d){console.error(d)}})().catch(console.error)});else{const h=await Rt.loadFromFile({file:c,urlImgData:a,limitFrames4D:this.opts.limitFrames4D});e.altKey?(P.debug("alt key detected: assuming this is a drawing overlay"),this.drawClearAllUndoBitmaps(),this.loadDrawing(h)):this.addVolume(h)}}catch(h){console.error(h)}})().catch(console.error)})}else o.isDirectory&&this.traverseFileTree(o,"",t).then(l=>{const a=this.getDicomLoader().loader;if(!a)throw new Error("No loader for DICOM files");a(l).then(async c=>{console.log(c);const h=c.map(d=>Rt.loadFromUrl({url:d.data,name:d.name,limitFrames4D:this.opts.limitFrames4D}));Promise.all(h).then(async d=>{console.log("from dicom loader"),console.log(d),await this.onDicomLoaderFinishedWithImages(d)}).catch(d=>{throw d})}).catch(c=>{console.error("Error loading DICOM files:",c)})}).catch(l=>{throw l})}}}this.drawScene()}setMultiplanarPadPixels(e){this.opts.multiplanarPadPixels=e,this.drawScene()}setMultiplanarLayout(e){typeof e=="string"&&(e=parseInt(e)),this.opts.multiplanarLayout=e,this.drawScene()}setCornerOrientationText(e){this.opts.isCornerOrientationText=e,this.updateGLVolume()}setHeroImage(e){this.opts.heroImageFraction=e,this.drawScene()}setRadiologicalConvention(e){this.opts.isRadiologicalConvention=e,this.updateGLVolume()}setDefaults(e={},t=!1){this.document.opts={...le},this.scene.sceneData={...Fi};for(const i in e)typeof e[i]=="function"?this[i]=e[i]:this.opts[i]=le[i]===void 0?le[i]:e[i];if(this.scene.pan2Dxyzmm=[0,0,0,1],t&&this.volumes&&this.volumes.length>0)for(let i=0;i<this.volumes.length;i++)this.volumes[i].cal_min=this.volumes[i].robust_min,this.volumes[i].cal_max=this.volumes[i].robust_max;this.updateGLVolume()}setMeshThicknessOn2D(e){this.opts.meshThicknessOn2D=e,this.updateGLVolume()}setSliceMosaicString(e){this.sliceMosaicString=e,this.updateGLVolume()}setSliceMM(e){this.opts.isSliceMM=e,this.updateGLVolume()}setAdditiveBlend(e){this.opts.isAdditiveBlend=e,this.updateGLVolume()}getRadiologicalConvention(){return this.opts.isRadiologicalConvention}setHighResolutionCapable(e){typeof e=="boolean"&&(e=e?0:-1),this.opts.forceDevicePixelRatio=e,this.resizeListener(),this.drawScene()}addVolume(e){this.volumes.push(e);const t=this.volumes.length===1?0:this.volumes.length-1;this.setVolume(e,t),this.onImageLoaded(e),P.debug("loaded volume",e.name),P.debug(e)}addMesh(e){this.meshes.push(e);const t=this.meshes.length===1?0:this.meshes.length-1;this.setMesh(e,t),this.onMeshLoaded(e)}getVolumeIndexByID(e){const t=this.volumes.length;for(let i=0;i<t;i++)if(this.volumes[i].id===e)return i;return-1}drawAddUndoBitmap(){if(!this.drawBitmap||this.drawBitmap.length<1){P.debug("drawAddUndoBitmap error: No drawing open");return}this.currentDrawUndoBitmap++,this.currentDrawUndoBitmap>=this.opts.maxDrawUndoBitmaps&&(this.currentDrawUndoBitmap=0),this.drawUndoBitmaps[this.currentDrawUndoBitmap]=Il(this.drawBitmap)}drawClearAllUndoBitmaps(){if(this.currentDrawUndoBitmap=this.opts.maxDrawUndoBitmaps,!(!this.drawUndoBitmaps||this.drawUndoBitmaps.length<1))for(let e=this.drawUndoBitmaps.length-1;e>=0;e--)this.drawUndoBitmaps[e]=new Uint8Array}drawUndo(){if(this.drawUndoBitmaps.length<1){P.debug("undo bitmaps not loaded");return}if(this.currentDrawUndoBitmap--,this.currentDrawUndoBitmap<0&&(this.currentDrawUndoBitmap=this.drawUndoBitmaps.length-1),this.currentDrawUndoBitmap>=this.drawUndoBitmaps.length&&(this.currentDrawUndoBitmap=0),this.drawUndoBitmaps[this.currentDrawUndoBitmap].length<2){P.debug("drawUndo is misbehaving");return}this.drawBitmap=Xs(this.drawUndoBitmaps[this.currentDrawUndoBitmap],this.drawBitmap.length),this.refreshDrawing(!0)}loadDrawing(e){if(this.drawBitmap&&P.debug("Overwriting open drawing!"),!this.back)throw new Error("back undefined");this.drawClearAllUndoBitmaps();const t=e.hdr.dims;if(t[1]!==this.back.hdr.dims[1]||t[2]!==this.back.hdr.dims[2]||t[3]!==this.back.hdr.dims[3])return P.debug("drawing dimensions do not match background image"),!1;e.img.constructor!==Uint8Array&&P.debug("Drawings should be UINT8");const i=e.permRAS,s=t[1]*t[2]*t[3];this.drawBitmap=new Uint8Array(s),this.drawTexture=this.r8Tex(this.drawTexture,Se,this.back.dims,!0);const r=[0,0,0];for(let m=0;m<3;m++)for(let g=0;g<3;g++)Math.abs(i[m])-1===g&&(r[g]=m*Math.sign(i[m]));let n=1;const o=[1,1,1],l=[!1,!1,!1];for(let m=0;m<r.length;m++)for(let g=0;g<r.length;g++)Math.abs(r[g])===m&&(o[g]=n,(r[g]<0||Object.is(r[g],-0))&&(l[g]=!0),n*=t[g+1]);let a=X.range(0,t[1]-1,1);l[0]&&(a=X.range(t[1]-1,0,-1));for(let m=0;m<t[1];m++)a[m]*=o[0];let c=X.range(0,t[2]-1,1);l[1]&&(c=X.range(t[2]-1,0,-1));for(let m=0;m<t[2];m++)c[m]*=o[1];let h=X.range(0,t[3]-1,1);l[2]&&(h=X.range(t[3]-1,0,-1));for(let m=0;m<t[3];m++)h[m]*=o[2];const d=e.img,f=this.drawBitmap;let u=0;for(let m=0;m<t[3];m++)for(let g=0;g<t[2];g++)for(let A=0;A<t[1];A++)f[a[A]+c[g]+h[m]]=d[u],u++;return this.drawAddUndoBitmap(),this.refreshDrawing(!1),this.drawScene(),!0}binarize(e){const t=e.hdr.dims,i=t[1]*t[2]*t[3],s=new Uint8Array(i);for(let r=0;r<i;r++)e.img[r]!==0&&(s[r]=1);e.img=s,e.hdr.datatypeCode=2,e.hdr.cal_min=0,e.hdr.cal_max=1}async loadDrawingFromUrl(e,t=!1){this.drawBitmap&&P.debug("Overwriting open drawing!"),this.drawClearAllUndoBitmaps();let i=!1;try{const s=await Rt.loadFromUrl(Si(e));t&&await this.binarize(s),i=this.loadDrawing(s)}catch{P.error("loadDrawingFromUrl() failed to load "+e),this.drawClearAllUndoBitmaps()}return i}findOtsu(e=2){if(this.volumes.length<1)return[];const t=this.volumes[0].img,i=t.length;if(i<1)return[];const s=256,r=s-1,n=new Array(s).fill(0),o=this.volumes[0].cal_min,l=this.volumes[0].cal_max;if(l<=o)return[];const a=(l-o)/s;function c(p){return p*a+o}const h=(s-1)/Math.abs(l-o),d=this.volumes[0].hdr.scl_inter,f=this.volumes[0].hdr.scl_slope;for(let p=0;p<i;p++){let w=t[p]*f+d;w=Math.min(Math.max(w,o),l),w=Math.round((w-o)*h),n[w]++}const u=Array(s).fill(0).map(()=>Array(s).fill(0)),m=Array(s).fill(0).map(()=>Array(s).fill(0));for(let p=1;p<s;++p)u[p][p]=n[p],m[p][p]=p*n[p];for(let p=1;p<s-1;++p)u[1][p+1]=u[1][p]+n[p+1],m[1][p+1]=m[1][p]+(p+1)*n[p+1];for(let p=2;p<s;p++)for(let w=p+1;w<s;w++)u[p][w]=u[1][w]-u[1][p-1],m[p][w]=m[1][w]-m[1][p-1];for(let p=1;p<s;++p)for(let w=p+1;w<s;w++)u[p][w]!==0&&(u[p][w]=m[p][w]*m[p][w]/u[p][w]);let g=0;const A=[1/0,1/0,1/0];if(e>3)for(let p=0;p<s-3;p++)for(let w=p+1;w<s-2;w++)for(let y=w+1;y<s-1;y++){const x=u[0][p]+u[p+1][w]+u[w+1][y]+u[y+1][r];x>g&&(A[0]=p,A[1]=w,A[2]=y,g=x)}else if(e===3)for(let p=0;p<s-2;p++)for(let w=p+1;w<s-1;w++){const y=u[0][p]+u[p+1][w]+u[w+1][r];y>g&&(A[0]=p,A[1]=w,g=y)}else for(let p=0;p<s-1;p++){const w=u[0][p]+u[p+1][r];w>g&&(A[0]=p,g=w)}return[c(A[0]),c(A[1]),c(A[2])]}drawOtsu(e=2){if(this.volumes.length===0)return;const t=this.volumes[0].img.length,i=this.findOtsu(e);if(i.length<3)return;this.drawBitmap||this.createEmptyDrawing();const s=this.drawBitmap,r=this.volumes[0].img;for(let n=0;n<t;n++){if(s[n]!==0)continue;const o=r[n];o>i[0]&&(s[n]=1),o>i[1]&&(s[n]=2),o>i[2]&&(s[n]=3)}this.drawAddUndoBitmap(),this.refreshDrawing(!0)}removeHaze(e=5,t=0){const i=this.volumes[t].img,s=this.volumes[t].hdr,r=i.length;let n=2;(e===5||e===1)&&(n=4),(e===4||e===2)&&(n=3);const o=this.findOtsu(n);if(o.length<3)return;let l=o[0];e===1&&(l=o[2]),e===2&&(l=o[1]);const a=s.scl_inter,c=s.scl_slope,h=this.volumes[t].global_min;for(let d=0;d<r;d++)i[d]*c+a<l&&(i[d]=h);this.refreshLayers(this.volumes[t],0),this.drawScene()}async saveImage(e=er){var o;const t={...er,...e},{filename:i,isSaveDrawing:s,volumeByIndex:r}=t;if(P.debug("saveImage",i,s,r),((o=this.back)==null?void 0:o.dims)===void 0)return P.debug("No voxelwise image open"),!1;if(s){if(!this.drawBitmap)return P.debug("No drawing open"),!1;const l=this.volumes[0].permRAS;if(l[0]===1&&l[1]===2&&l[2]===3)return P.debug("saving drawing"),await this.volumes[0].saveToDisk(i,this.drawBitmap);{P.debug("saving drawing");const a=this.volumes[0].hdr.dims,c=[0,0,0];for(let x=0;x<3;x++)for(let b=0;b<3;b++)Math.abs(l[x])-1===b&&(c[b]=x*Math.sign(l[x]));let h=1;const d=[1,1,1],f=[!1,!1,!1];for(let x=0;x<c.length;x++)for(let b=0;b<c.length;b++)Math.abs(c[b])===x&&(d[b]=h,(c[b]<0||Object.is(c[b],-0))&&(f[b]=!0),h*=a[b+1]);let u=X.range(0,a[1]-1,1);f[0]&&(u=X.range(a[1]-1,0,-1));for(let x=0;x<a[1];x++)u[x]*=d[0];let m=X.range(0,a[2]-1,1);f[1]&&(m=X.range(a[2]-1,0,-1));for(let x=0;x<a[2];x++)m[x]*=d[1];let g=X.range(0,a[3]-1,1);f[2]&&(g=X.range(a[3]-1,0,-1));for(let x=0;x<a[3];x++)g[x]*=d[2];const A=new Uint8Array(this.drawBitmap),p=new Uint8Array(a[1]*a[2]*a[3]);let w=0;for(let x=0;x<a[3];x++)for(let b=0;b<a[2];b++)for(let M=0;M<a[1];M++)p[w]=A[u[M]+m[b]+g[x]],w++;return P.debug("saving drawing"),this.volumes[0].saveToDisk(i,p)}}return P.debug("saving image"),this.volumes[r].saveToDisk(i)}getMeshIndexByID(e){if(typeof e=="number")return e>=this.meshes.length?-1:e;const t=this.meshes.length;for(let i=0;i<t;i++)if(this.meshes[i].id===e)return i;return-1}setMeshProperty(e,t,i){const s=this.getMeshIndexByID(e);if(s<0){P.warn("setMeshProperty() id not loaded",e);return}this.meshes[s].setProperty(t,i,this.gl),this.updateGLVolume(),this.onMeshPropertyChanged(s,t,i)}indexNearestXYZmm(e,t,i,s){const r=this.getMeshIndexByID(e);return r<0?(P.warn("indexNearestXYZmm() id not loaded",e),[NaN,NaN]):this.meshes[r].indexNearestXYZmm(t,i,s)}decimateHierarchicalMesh(e,t=3){const i=this.getMeshIndexByID(e);if(i<0){P.warn("reverseFaces() id not loaded",e);return}const s=this.meshes[i].decimateHierarchicalMesh(this.gl,t);return this.updateGLVolume(),s}reverseFaces(e){const t=this.getMeshIndexByID(e);if(t<0){P.warn("reverseFaces() id not loaded",e);return}this.meshes[t].reverseFaces(this.gl),this.updateGLVolume()}async setMeshLayerProperty(e,t,i,s){const r=this.getMeshIndexByID(e);if(r<0){P.warn("setMeshLayerProperty() id not loaded",e);return}await this.meshes[r].setLayerProperty(t,i,s,this.gl),this.updateGLVolume()}setPan2Dxyzmm(e){this.scene.pan2Dxyzmm=e,this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=e[3]),this.drawScene()}setRenderAzimuthElevation(e,t){this.scene.renderAzimuth=e,this.scene.renderElevation=t,this.onAzimuthElevationChange(e,t),this.drawScene()}getOverlayIndexByID(e){const t=this.overlays.length;for(let i=0;i<t;i++)if(this.overlays[i].id===e)return i;return-1}setVolume(e,t=0){const i=this.volumes.length;if(t>i)return;const s=this.getVolumeIndexByID(e.id);t===0?(this.volumes.splice(s,1),this.volumes.unshift(e),this.back=this.volumes[0],this.overlays=this.volumes.slice(1)):t<0?(this.volumes.splice(this.getVolumeIndexByID(e.id),1),this.back=this.volumes[0],this.volumes.length>1?this.overlays=this.volumes.slice(1):this.overlays=[]):(this.volumes.splice(s,1),this.volumes.splice(t,0,e),this.overlays=this.volumes.slice(1),this.back=this.volumes[0]),this.updateGLVolume()}setMesh(e,t=0){this.meshes.forEach(r=>{P.debug("MESH: ",r.name)});const i=this.meshes.length;if(t>i)return;const s=this.getMeshIndexByID(e.id);t===0?(this.meshes.splice(s,1),this.meshes.unshift(e)):t<0?this.meshes.splice(this.getMeshIndexByID(e.id),1):(this.meshes.splice(s,1),this.meshes.splice(t,0,e)),this.updateGLVolume(),this.meshes.forEach(r=>{P.debug(r.name)})}removeVolume(e){if(this.setVolume(e,-1),this.mediaUrlMap.has(e)){const t=this.mediaUrlMap.get(e);this.onVolumeWithUrlRemoved(t),this.mediaUrlMap.delete(e)}this.drawScene()}removeVolumeByIndex(e){if(e>=this.volumes.length)throw new Error("Index of volume out of bounds");this.removeVolume(this.volumes[e])}removeMesh(e){if(e.unloadMesh(this.gl),this.setMesh(e,-1),this.mediaUrlMap.has(e)){const t=this.mediaUrlMap.get(e);this.onMeshWithUrlRemoved(t),this.mediaUrlMap.delete(e)}}removeMeshByUrl(e){const t=this.getMediaByUrl(e);t&&(this.removeMesh(t),this.mediaUrlMap.delete(t),this.onMeshWithUrlRemoved(e))}moveVolumeToBottom(e){this.setVolume(e,0)}moveVolumeUp(e){const t=this.getVolumeIndexByID(e.id);this.setVolume(e,t+1)}moveVolumeDown(e){const t=this.getVolumeIndexByID(e.id);this.setVolume(e,t-1)}moveVolumeToTop(e){this.setVolume(e,this.volumes.length-1)}mouseDown(e,t){e*=this.uiData.dpr,t*=this.uiData.dpr,this.mousePos=[e,t]}mouseMove(e,t){e*=this.uiData.dpr,t*=this.uiData.dpr;const i=(e-this.mousePos[0])/this.uiData.dpr,s=(t-this.mousePos[1])/this.uiData.dpr;this.mousePos=[e,t],!(this.inRenderTile(e,t)<0)&&(Math.abs(i)<1&&Math.abs(s)<1||(this.scene.renderAzimuth+=i,this.scene.renderElevation+=s,this.drawScene()))}sph2cartDeg(e,t){const i=-t*(Math.PI/180),s=(e-90)%360*(Math.PI/180),r=[Math.cos(i)*Math.cos(s),Math.cos(i)*Math.sin(s),Math.sin(i)],n=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);return n<=0||(r[0]/=n,r[1]/=n,r[2]/=n),r}setClipPlane(e){const t=this.sph2cartDeg(e[1]+180,e[2]);this.scene.clipPlane=[t[0],t[1],t[2],e[0]],this.scene.clipPlaneDepthAziElev=e,this.onClipPlaneChange(this.scene.clipPlane),this.drawScene()}setCrosshairColor(e){this.opts.crosshairColor=e,this.drawScene()}setCrosshairWidth(e){this.opts.crosshairWidth=e,this.crosshairs3D&&(this.crosshairs3D.mm[0]=NaN),this.drawScene()}setDrawColormap(e){this.drawLut=mt.makeDrawLut(e),this.updateGLVolume()}setDrawingEnabled(e){this.opts.drawingEnabled=e,this.opts.drawingEnabled&&(this.drawBitmap||this.createEmptyDrawing()),this.drawScene()}setPenValue(e,t=!1){this.opts.penValue=e,this.opts.isFilledPen=t,this.drawScene()}setDrawOpacity(e){this.drawOpacity=e,this.drawScene()}setSelectionBoxColor(e){this.opts.selectionBoxColor=e}sliceScroll2D(e,t,i,s=!0){if(this.opts.scrollRequiresFocus&&this.canvas!==document.activeElement){P.warn("Canvas element does not have focus. Scroll events will not be processed.");return}if(this.inGraphTile(t,i)){let r=this.volumes[0].frame4D;e>0&&r++,e<0&&r--,this.setFrame4D(this.volumes[0].id,r);return}if(e!==0&&this.opts.dragMode===3&&this.inRenderTile(this.uiData.dpr*t,this.uiData.dpr*i)===-1){let r=this.scene.pan2Dxyzmm[3]*(1+10*e);r=Math.round(r*10)/10;const n=this.scene.pan2Dxyzmm[3]-r;this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=r),this.scene.pan2Dxyzmm[3]=r;const o=this.frac2mm(this.scene.crosshairPos);this.scene.pan2Dxyzmm[0]+=n*o[0],this.scene.pan2Dxyzmm[1]+=n*o[1],this.scene.pan2Dxyzmm[2]+=n*o[2],this.drawScene(),this.canvas.focus(),this.sync();return}this.mouseClick(t,i,e,s)}setSliceType(e){return this.opts.sliceType=e,this.drawScene(),this}setOpacity(e,t){this.volumes[e].opacity=t,this.updateGLVolume()}setScale(e){this.scene.volScaleMultiplier=e,this.drawScene()}setClipPlaneColor(e){this.opts.clipPlaneColor=e,this.renderShader.use(this.gl),this.gl.uniform4fv(this.renderShader.uniforms.clipPlaneColor,this.opts.clipPlaneColor),this.drawScene()}setClipPlaneThick(e){this.opts.clipThick=e,this.renderShader.use(this.gl),this.gl.uniform1f(this.renderShader.uniforms.clipThick,this.opts.clipThick),this.drawScene()}setClipVolume(e,t){this.opts.clipVolumeLow=[Math.min(e[0],t[0]),Math.min(e[1],t[1]),Math.min(e[2],t[2])],this.opts.clipVolumeHigh=[Math.max(e[0],t[0]),Math.max(e[1],t[1]),Math.max(e[2],t[2])],this.renderShader.use(this.gl),this.gl.uniform3fv(this.renderShader.uniforms.clipLo,this.opts.clipVolumeLow),this.gl.uniform3fv(this.renderShader.uniforms.clipHi,this.opts.clipVolumeHigh),this.pickingImageShader.use(this.gl),this.gl.uniform3fv(this.pickingImageShader.uniforms.clipLo,this.opts.clipVolumeLow),this.gl.uniform3fv(this.pickingImageShader.uniforms.clipHi,this.opts.clipVolumeHigh),this.drawScene()}async setVolumeRenderIllumination(e=0){this.renderGradientValues=Number.isNaN(e),this.renderShader=this.renderVolumeShader,this.renderGradientValues?this.renderShader=this.renderGradientValuesShader:e>0||this.opts.gradientOpacity>0?this.renderShader=this.renderGradientShader:e<0&&(this.renderShader=this.renderSliceShader),this.initRenderShader(this.renderShader,e),this.renderShader.use(this.gl),this.setClipPlaneColor(this.opts.clipPlaneColor),Number.isNaN(e)?this.gradientTextureAmount=1:this.gradientTextureAmount=e,!(this.volumes.length<1)&&(this.refreshLayers(this.volumes[0],0),this.drawScene())}async setGradientOpacity(e=0){this.opts.gradientOpacity=e,this.renderGradientValues?this.renderShader=this.renderGradientValuesShader:this.gradientTextureAmount>0||e>0?this.renderShader=this.renderGradientShader:this.gradientTextureAmount<0&&(this.renderShader=this.renderSliceShader),this.initRenderShader(this.renderShader,this.gradientTextureAmount),this.renderShader.use(this.gl),this.drawScene()}overlayRGBA(e){const t=e.hdr,i=t.dims[1]*t.dims[2]*t.dims[3],s=new Uint8ClampedArray(i*4),r=.2*Math.min(Math.min(t.dims[1],t.dims[2]),t.dims[3]),n=.5*t.dims[1],o=.5*t.dims[2],l=.5*t.dims[3];let a=0;for(let c=0;c<t.dims[3];c++)for(let h=0;h<t.dims[2];h++)for(let d=0;d<t.dims[1];d++){const f=Math.abs(d-n),u=Math.abs(h-o),m=Math.abs(c-l),g=Math.sqrt(f*f+u*u+m*m);let A=0;g<r&&(A=255),s[a++]=0,s[a++]=A,s[a++]=0,s[a++]=A*.5}return s}vox2mm(e,t){return X.vox2mm(e,t)}cloneVolume(e){return this.volumes[e].clone()}async loadDocumentFromUrl(e){const t=await Xi.loadFromUrl(e);await this.loadDocument(t)}async loadDocument(e){this.volumes=[],this.meshes=[],this.document=e,this.document.labels=this.document.labels?this.document.labels:[];const t={...le,...e.opts};this.scene.pan2Dxyzmm=e.scene.pan2Dxyzmm?e.scene.pan2Dxyzmm:[0,0,0,1],this.document.opts=t,this.setClipPlane(this.scene.clipPlaneDepthAziElev),P.debug("load document",e),this.mediaUrlMap.clear(),this.createEmptyDrawing();const i=e.encodedImageBlobs;for(let r=0;r<e.imageOptionsArray.length;r++){const n=e.imageOptionsArray[r],o=i[r];if(o){"colorMap"in n&&(n.colormap=n.colorMap);const l=await Rt.loadFromBase64({base64:o,...n});if(l){if(l.colormapLabel){const a=Object.keys(l.colormapLabel.lut).length,c=new Uint8ClampedArray(a);for(const h in l.colormapLabel.lut)c[h]=l.colormapLabel.lut[h];l.colormapLabel.lut=c}this.addVolume(l)}}}this.volumes.length>0&&(this.back=this.volumes[0]);for(const r of e.meshDataObjects??[]){const n={gl:this.gl,...r};r.offsetPt0&&(n.rgba255[3]=0,n.tris=new Uint32Array(r.offsetPt0)),P.debug(n);const o=new Ne(n.pts,n.tris,n.name,n.rgba255,n.opacity,n.visible,this.gl,n.connectome,n.dpg,n.dps,n.dpv);r.offsetPt0&&(o.fiberGroupColormap=r.fiberGroupColormap,o.fiberColor=r.fiberColor,o.fiberDither=r.fiberDither,o.fiberRadius=r.fiberRadius,o.colormap=r.colormap),o.meshShaderIndex=n.meshShaderIndex,o.layers=n.layers,o.updateMesh(this.gl),P.debug(o),this.addMesh(o)}if(e.data.connectomes)for(const r of e.data.connectomes){const n=JSON.parse(r),o=this.loadConnectomeAsMesh(n);o.updateMesh(this.gl),this.addMesh(o)}this.createEmptyDrawing();const s=e.encodedDrawingBlob;if(s){const r=await X.b64toUint8(s);if(r){const n=this.back.dims;let o=n[1]*n[2]*n[3];if(r.length-352===o&&(o+=352),r.length!==o)throw new Error(`drawBitmap size does not match the texture dimensions (${n[1]}${n[2]}${n[3]}) ${o} != ${n[1]*n[2]*n[3]}.`);this.drawBitmap=r,this.refreshDrawing()}}return this.updateGLVolume(),this.drawScene(),this.onDocumentLoaded(e),this}async generateLoadDocumentJavaScript(e,t){const i=this.json(),s=await X.compressToBase64String(JSON.stringify(i));return`
        ${t}

        async function saveNiivueAsHtml(pageName) {
          //get new docstring
          const docString = nv1.json();
          const html =
          document.getElementsByTagName("html")[0]
              .innerHTML.replace(base64, await NVUtilities.compressToBase64String(JSON.stringify(docString)));
          NVUtilities.download(html, pageName, "application/html");
        }

        var nv1 = new Niivue();
        nv1.attachTo("${e}");
        var base64 = "${s}";
        NVUtilities.decompressBase64String(base64).then((jsonText) => {
          var json = JSON.parse(jsonText); // string -> JSON
          var doc = NVDocument.loadFromJSON(json);
          nv1.loadDocument(doc);
          nv1.updateGLVolume();
        });

      `}async generateHTML(e="gl1",t){return`<!DOCTYPE html>
        <html lang="en">
          <head>
            <meta charset="utf-8" />
            <meta http-equiv="X-UA-Compatible" content="IE=edge" />
            <meta name="viewport" content="width=device-width,initial-scale=1.0" />
            <title>Save as HTML</title>
            <style>
            html {
              height: auto;
              min-height: 100%;
              margin: 0;
            }
            body {
              display: flex;
              flex-direction: column;
              margin: 0;
              min-height: 100%;
              width: 100%;
              position: absolute;
              font-family: system-ui, Arial, Helvetica, sans-serif;
              background: #ffffff;
              color: black;
              user-select: none; /* Standard syntax */
            }
            header {
              margin: 10px;
            }
            main {
              flex: 1;
              background: #000000;
              position: relative;
            }
            footer {
              margin: 10px;
            }
            canvas {
              position: absolute;
              cursor: crosshair;
            }
            canvas:focus {
              outline: 0px;
            }
            div {
              display: table-row;
              background-color: blue;
            }
            </style>
          </head>
          <body>
            <noscript>niivue requires JavaScript.</noscript>
            <header>
            Save the current scene as HTML
            <button id="save">Save as HTML</button>
            </header>
            <main>
              <canvas id="gl1"></canvas>
            </main>
            <script type="module" async>
              ${await this.generateLoadDocumentJavaScript(e,t)}
              function saveAsHtml() {
                saveNiivueAsHtml("page.html");
              }
              // assign our event handler
              var button = document.getElementById("save");
              button.onclick = saveAsHtml;
            <\/script>
          </body>
        </html>`}async saveHTML(e="untitled.html",t="gl1",i){const s=await this.generateHTML(t,i);return X.download(s,e,"application/html")}json(){return this.document.opts=this.opts,this.document.scene=this.scene,this.document.volumes=this.volumes,this.document.meshes=this.meshes,this.drawScene(),this.document.previewImageDataURL=this.canvas.toDataURL(),this.document.json()}async saveDocument(e="untitled.nvd",t=!0){return this.document.title=e,P.debug("saveDocument",this.volumes[0]),this.drawScene(),this.document.previewImageDataURL=this.canvas.toDataURL(),this.document.volumes=this.volumes,this.document.meshes=this.meshes,this.document.download(e,t)}async loadImages(e){const t=[],i=[];for(const s of e)if("url"in s){const r=this.getFileExt(s.name?s.name:s.url);if(this.loaders[r]){const n=this.loaders[r].toExt.toUpperCase();ge.includes(n)?i.push(s):t.push(s);continue}ge.includes(r.toUpperCase())?i.push(s):t.push(s)}return t.length>0&&await this.loadVolumes(t),i.length>0&&await this.loadMeshes(i),this}async loadDicoms(e){if(!this.getDicomLoader())throw new Error("No dicom loader set. Please set a dicom loader before loading dicoms");this.drawScene(),this.volumes=[],this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT);const t=e.map(async s=>{let r=null;if(s.isManifest)r=await Rt.fetchDicomData(s.url);else{const h=await fetch(s.url);if(!h.ok)throw new Error(`Failed to load file: ${h.statusText}`);const d=await h.arrayBuffer();r=[{name:s.url.split("/").pop(),data:d}]}const n=this.getDicomLoader().loader,o=await n(r);console.log(o);const l=o[0].name,a=o[0].data;return await Rt.loadFromUrl({url:a,name:l})}),i=await Promise.all(t);return i.length===1?this.addVolume(i[0]):this.onDicomLoaderFinishedWithImages(i),this}async loadVolumes(e){return this.drawScene(),this.thumbnailVisible?(this.deferredVolumes=e,this):(this.volumes=[],this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),await this.addVolumesFromUrl(e),this)}async addMeshFromUrl(e){const t=this.getFileExt(e.url);if(t==="JCON"||t==="JSON"){const r=await(await fetch(e.url,{})).json(),n=this.loadConnectomeAsMesh(r);return this.mediaUrlMap.set(n,e.url),this.onMeshAddedFromUrl(e,n),this.addMesh(n),n}const i=await Ne.loadFromUrl({...e,gl:this.gl});return this.mediaUrlMap.set(i,e.url),this.onMeshAddedFromUrl(e,i),this.addMesh(i),i}async addMeshesFromUrl(e){const t=e.map(async s=>{const r=this.getFileExt(s.name||s.url);if(this.loaders[r]){let o=s.url;const l=this.loaders[r].toExt;let a=s.name||s.url;if(a=a.split("/").pop(),typeof s.url=="string"){const u=s.url;try{const m=await fetch(u);if(!m.ok)throw new Error(`Failed to load file: ${m.statusText}`);o=await m.arrayBuffer()}catch(m){throw new Error(`Failed to load url ${u}: ${m}`)}}const{positions:c,indices:h,colors:d=null}=await this.loaders[r].loader(o);s.name=`${a}.${l}`;const f=await Ae.createMZ3Async(c,h,!1,d);s.buffer=f}if(r==="JCON"||r==="JSON"){const l=await(await fetch(s.url,{})).json(),a=this.loadConnectomeAsMesh(l);return this.mediaUrlMap.set(a,s.url),this.onMeshAddedFromUrl(s,a),a}const n=await Ne.loadFromUrl({...s,gl:this.gl});return this.mediaUrlMap.set(n,s.url),this.onMeshAddedFromUrl(s,n),n}),i=await Promise.all(t);for(let s=0;s<i.length;s++)this.addMesh(i[s]);return i}async loadMeshes(e){return this.drawScene(),this.thumbnailVisible?(this.deferredMeshes=e,this):(this.initialized,this.meshes=[],this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),await this.addMeshesFromUrl(e),this.updateGLVolume(),this.drawScene(),this)}async loadConnectomeFromUrl(e,t={}){const s=await(await fetch(e,{headers:t})).json();return this.loadConnectome(s)}async loadFreeSurferConnectomeFromUrl(e,t={}){const s=await(await fetch(e,{headers:t})).json();return this.loadFreeSurferConnectome(s)}async loadFreeSurferConnectome(e){const t=di.convertFreeSurferConnectome(e);return this.loadConnectome(t)}handleNodeAdded(e){const t=e.detail.node,i=[1,1,1,1];this.addLabel(t.name,{textColor:i,bulletScale:1,bulletColor:i,lineWidth:0,lineColor:i,lineTerminator:"none",textScale:1},[t.x,t.y,t.z]),this.drawScene()}loadConnectomeAsMesh(e){let t=e;if("data_type"in e&&e.data_type==="fs_pointset")t=di.convertFreeSurferConnectome(e),P.warn("converted FreeSurfer connectome",t);else if("nodes"in e){const i=e.nodes;"names"in i&&"X"in i&&"Y"in i&&"Z"in i&&"Color"in i&&"Size"in i&&(t=di.convertLegacyConnectome(e),P.warn("converted legacy connectome",t))}else throw new Error("not a known connectome format");return new di(this.gl,t)}loadConnectome(e){this.drawScene(),this.meshes=[],this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT);const t=this.loadConnectomeAsMesh(e);return this.addMesh(t),this.drawScene(),this}createEmptyDrawing(){if(this.back===null||!this.back.dims||Math.min(Math.min(this.back.dims[1],this.back.dims[2]),this.back.dims[3])<1)return;const t=this.back.dims[1]*this.back.dims[2]*this.back.dims[3];this.drawBitmap=new Uint8Array(t),this.clickToSegmentGrowingBitmap=new Uint8Array(t),this.drawClearAllUndoBitmaps(),this.drawAddUndoBitmap(),this.drawTexture=this.r8Tex(this.drawTexture,Se,this.back.dims,!0),this.refreshDrawing(!1)}r16Tex(e,t,i,s){e&&this.gl.deleteTexture(e),e=this.gl.createTexture(),this.gl.activeTexture(t),this.gl.bindTexture(this.gl.TEXTURE_3D,e),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R16I,i[1],i[2],i[3]);const r=i[1]*i[2]*i[3];return s.length!==r&&(s=new Int16Array(r)),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i[1],i[2],i[3],this.gl.RED_INTEGER,this.gl.SHORT,s),e}drawGrowCut(){if(!this.back||!this.back.dims)throw new Error("back not defined");const e=this.back.hdr,t=this.gl,i=e.dims[1]*e.dims[2]*e.dims[3];if(!this.drawBitmap||this.drawBitmap.length!==i){P.debug("bitmap dims are wrong");return}const s=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,s),t.disable(t.CULL_FACE),t.viewport(0,0,this.back.dims[1],this.back.dims[2]),t.disable(t.BLEND);let r=bl(this.back);const n=this.r16Tex(null,Vl,this.back.dims,r);for(let x=1;x<i;x++)r[x]=this.drawBitmap[x];const o=this.r16Tex(null,Rl,this.back.dims,r),l=this.r16Tex(null,Nl,this.back.dims,r),a=1e4;for(let x=1;x<i;x++)r[x]>0&&(r[x]=a);const c=this.r16Tex(null,Bl,this.back.dims,r),h=this.r16Tex(null,Ul,this.back.dims,r);t.bindVertexArray(this.genericVAO);const d=this.growCutShader;d.use(t);const f=128;t.uniform1i(d.uniforms.finalPass,0),t.uniform1i(d.uniforms.backTex,11);for(let x=0;x<f;x++){t.uniform1i(d.uniforms.labelTex,14),t.uniform1i(d.uniforms.strengthTex,12);for(let b=0;b<this.back.dims[3];b++){const M=1/this.back.dims[3]*(b+.5);t.uniform1f(d.uniforms.coordZ,M),t.framebufferTextureLayer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,l,0,b),t.framebufferTextureLayer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT1,h,0,b),t.drawBuffers([t.COLOR_ATTACHMENT0,t.COLOR_ATTACHMENT1]),t.checkFramebufferStatus(t.FRAMEBUFFER)!==t.FRAMEBUFFER_COMPLETE&&P.error("Incomplete framebuffer"),t.drawArrays(t.TRIANGLE_STRIP,0,4)}x===f-1&&t.uniform1i(d.uniforms.finalPass,1),t.uniform1i(d.uniforms.labelTex,15),t.uniform1i(d.uniforms.strengthTex,13);for(let b=0;b<this.back.dims[3];b++){const M=1/this.back.dims[3]*(b+.5);t.uniform1f(d.uniforms.coordZ,M),t.framebufferTextureLayer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,o,0,b),t.framebufferTextureLayer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT1,c,0,b),t.drawBuffers([t.COLOR_ATTACHMENT0,t.COLOR_ATTACHMENT1]),t.checkFramebufferStatus(t.FRAMEBUFFER)!==t.FRAMEBUFFER_COMPLETE&&P.error("Incomplete framebuffer"),t.drawArrays(t.TRIANGLE_STRIP,0,4)}}t.drawBuffers([t.COLOR_ATTACHMENT0]);const u=t.COLOR_ATTACHMENT1,m=o;t.readBuffer(u);const g=t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT),A=t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE);(g!==t.RED_INTEGER||A!==t.SHORT)&&P.debug("readPixels will fail."),r=new Int16Array;const p=this.back.dims[1]*this.back.dims[2],w=new Int16Array(p);for(let x=0;x<this.back.dims[3];x++)t.framebufferTextureLayer(t.FRAMEBUFFER,u,m,0,x),t.readPixels(0,0,this.back.dims[1],this.back.dims[2],g,A,w),r=Int16Array.from([...r,...w]);let y=r[0];for(let x=0;x<r.length;x++)y=Math.max(y,r[x]);for(let x=1;x<i;x++)this.drawBitmap[x]=r[x];t.deleteTexture(n),t.deleteTexture(c),t.deleteTexture(h),t.deleteTexture(o),t.deleteTexture(l),t.bindVertexArray(this.unusedVAO),t.viewport(0,0,t.canvas.width,t.canvas.height),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteFramebuffer(s),this.drawAddUndoBitmap(),this.refreshDrawing(!0)}drawPt(e,t,i,s){var h;if(!((h=this.back)!=null&&h.dims))throw new Error("back.dims not set");const r=this.back.dims[1],n=this.back.dims[2],o=this.back.dims[3];e=Math.min(Math.max(e,0),r-1),t=Math.min(Math.max(t,0),n-1),i=Math.min(Math.max(i,0),o-1),this.drawBitmap[e+t*r+i*r*n]=s;const l=this.drawPenAxCorSag===0,a=this.drawPenAxCorSag===1,c=this.drawPenAxCorSag===2;if(this.opts.penSize>1){const d=Math.floor(this.opts.penSize/2);for(let f=-d;f<=d;f++)for(let u=-d;u<=d;u++)l?this.drawBitmap[e+f+(t+u)*r+i*r*n]=s:a?this.drawBitmap[e+f+t*r+(i+u)*r*n]=s:c&&(this.drawBitmap[e+(t+u)*r+(i+f)*r*n]=s)}}drawPenLine(e,t,i){const s=Math.abs(e[0]-t[0]),r=Math.abs(e[1]-t[1]),n=Math.abs(e[2]-t[2]);let o=-1,l=-1,a=-1;t[0]>e[0]&&(o=1),t[1]>e[1]&&(l=1),t[2]>e[2]&&(a=1);let c=e[0],h=e[1],d=e[2];const f=t[0],u=t[1],m=t[2];if(s>=r&&s>=n){let g=2*r-s,A=2*n-s;for(;c!==f;)c+=o,g>=0&&(h+=l,g-=2*s),A>=0&&(d+=a,A-=2*s),g+=2*r,A+=2*n,this.drawPt(c,h,d,i)}else if(r>=s&&r>=n){let g=2*s-r,A=2*n-r;for(;h!==u;)h+=l,g>=0&&(c+=o,g-=2*r),A>=0&&(d+=a,A-=2*r),g+=2*s,A+=2*n,this.drawPt(c,h,d,i)}else{let g=2*r-n,A=2*s-n;for(;d!==m;)d+=a,g>=0&&(h+=l,g-=2*n),A>=0&&(c+=o,A-=2*n),g+=2*r,A+=2*s,this.drawPt(c,h,d,i)}}drawingBinaryDilationWithSeed(e,t=6){try{let i=function(A){return A[0]+A[1]*l+A[2]*a};const s=this.drawBitmap,r=this.back.dims[1],n=this.back.dims[2],o=this.back.dims[3],l=r,a=r*n,c=a*o,h=i(e);if(h<0||h>=c)throw new Error("Seed index is out of bounds.");const d=s[h];if(d===0)throw new Error("Seed voxel is not part of a filled cluster.");const f=s.slice();for(let A=0;A<c;A++)f[A]=f[A]===d?1:0;this.drawFloodFillCore(f,h,t);const u=s.slice(),m=[],g=[-a,a,-r,r,-1,1];m.push(...g),t>6&&m.push(-r-1,-r+1,r-1,r+1,-a-r,-a+r,-a-1,-a+1,a-r,a+r,a-1,a+1),t>18&&m.push(-a-r-1,-a-r+1,-a+r-1,-a+r+1,a-r-1,a-r+1,a+r-1,a+r+1);for(let A=0;A<c;A++)if(f[A]===2){const p=A%r,w=Math.floor(A%a/r),y=Math.floor(A/a);for(const x of m){const b=A+x;if(b<0||b>=c)continue;const M=b%r,D=Math.floor(b%a/r),v=Math.floor(b/a);Math.abs(M-p)>1||Math.abs(D-w)>1||Math.abs(v-y)>1||s[b]===0&&(u[b]=d)}}this.drawBitmap=u,this.drawAddUndoBitmap(),this.refreshDrawing(!0)}catch(i){P.error("Error in drawingBinaryDilationWithSeed:",i)}}drawFloodFillCore(e,t,i=6){var c;if(!((c=this.back)!=null&&c.dims))throw new Error("back.dims undefined");const s=[this.back.dims[1],this.back.dims[2],this.back.dims[3]],r=s[0],n=r*s[1];function o(h){return h[0]+h[1]*r+h[2]*n}function l(h){const d=Math.floor(h/n),f=Math.floor((h-d*n)/r);return[Math.floor(h%r),f,d]}const a=[];for(a.push(t),e[t]=2;a.length>0;){let h=function(u){const m=f.slice();if(m[0]+=u[0],m[1]+=u[1],m[2]+=u[2],m[0]<0||m[1]<0||m[2]<0||m[0]>=s[0]||m[1]>=s[1]||m[2]>=s[2])return;const g=o(m);e[g]===1&&(e[g]=2,a.push(g))};const d=a[0];a.shift();const f=l(d);h([0,0,-1]),h([0,0,1]),h([0,-1,0]),h([0,1,0]),h([-1,0,0]),h([1,0,0]),!(i<=6)&&(h([-1,-1,0]),h([1,1,0]),h([-1,1,0]),h([1,1,0]),h([0,-1,-1]),h([0,1,-1]),h([-1,0,-1]),h([1,0,-1]),h([0,-1,1]),h([0,1,1]),h([-1,0,1]),h([1,0,1]),!(i<=18)&&(h([-1,-1,-1]),h([1,-1,-1]),h([-1,1,-1]),h([1,1,-1]),h([-1,-1,1]),h([1,-1,1]),h([-1,1,1]),h([1,1,1])))}}drawFloodFill(e,t=0,i=0,s=NaN,r=NaN,n=6,o=Number.POSITIVE_INFINITY,l=!1){var D;if(!this.drawBitmap)throw new Error("drawBitmap undefined");if(!((D=this.back)!=null&&D.dims))throw new Error("back.dims undefined");t=Math.abs(t);const a=[this.back.dims[1],this.back.dims[2],this.back.dims[3]];if(e[0]<0||e[1]<0||e[2]<0||e[0]>=a[0]||e[1]>=a[1]||e[2]>=a[2])return;const c=a[0],h=c*a[1],d=h*a[2];let f=this.drawBitmap.slice(),u=this.drawBitmap;if(this.clickToSegmentIsGrowing&&(f=this.clickToSegmentGrowingBitmap.slice(),u=this.clickToSegmentGrowingBitmap),f.length!==h*a[2])return;let m=-1;l&&this.drawPenAxCorSag===0?m=2:l&&this.drawPenAxCorSag===1?m=1:l&&this.drawPenAxCorSag===2&&(m=0);function g(v){const C=Math.floor(v/h),I=Math.floor((v-C*h)/c);return[Math.floor(v%c),I,C]}function A(v){return v[0]+v[1]*c+v[2]*h}const p=v=>this.vox2mm(v,this.back.matRAS),w=p(e),y=o**2;function x(v){const C=g(v);if(m>=0&&C[m]!==e[m])return!1;const I=p(C);return(I[0]-w[0])**2+(I[1]-w[1])**2+(I[2]-w[2])**2<=y}const b=A(e),M=f[b];if(M===t){i!==0?P.debug("drawFloodFill selected voxel is not part of a drawing"):P.debug("drawFloodFill selected voxel is already desired color");return}for(let v=1;v<d;v++)if(f[v]=0,u[v]===M){if(!x(v))continue;f[v]=1}if(this.drawFloodFillCore(f,b,n),i!==0){const v=this.volumes[0].img2RAS();let C=v[b],I=C;if(isFinite(r)&&isFinite(s))C=r,I=s;else{for(let S=1;S<d;S++)f[S]===2&&(C=Math.max(C,v[S]),I=Math.min(I,v[S]));i===Number.POSITIVE_INFINITY&&(C=i),i===Number.NEGATIVE_INFINITY&&(I=i)}P.debug("Intensity range of selected cluster :",I,C);for(let S=1;S<d;S++)if(f[S]=0,v[S]>=I&&v[S]<=C){if(!x(S))continue;f[S]=1}this.drawFloodFillCore(f,b,n),t=M}for(let v=1;v<d;v++)f[v]===2&&(u[v]=t);this.clickToSegmentIsGrowing?(this.clickToSegmentGrowingBitmap=u,this.refreshDrawing(!0,this.clickToSegmentIsGrowing)):(this.drawBitmap=u.slice(),this.opts.clickToSegment||this.drawAddUndoBitmap(),this.refreshDrawing(!0,this.clickToSegmentIsGrowing))}drawPenFilled(){var u;const e=this.drawPenFillPts.length;if(e<2){this.drawPenFillPts=[];return}const t=this.drawPenAxCorSag;let i=0,s=1;if(t===1&&(s=2),t===2&&(i=1,s=2),!((u=this.back)!=null&&u.dims))throw new Error("back.dims undefined");const r=[this.back.dims[i+1],this.back.dims[s+1]],n=new Uint8Array(r[0]*r[1]);let o=1;function l(m,g){const A=Math.abs(m[0]-g[0]),p=Math.abs(m[1]-g[1]);n[m[0]+m[1]*r[0]]=o,n[g[0]+g[1]*r[0]]=o;let w=-1,y=-1;g[0]>m[0]&&(w=1),g[1]>m[1]&&(y=1);let x=m[0],b=m[1];const M=g[0],D=g[1];if(A>=p){let v=2*p-A;for(;x!==M;)x+=w,v>=0&&(b+=y,v-=2*A),v+=2*p,n[x+b*r[0]]=o}else{let v=2*A-p;for(;b!==D;)b+=y,v>=0&&(x+=w,v-=2*p),v+=2*A,n[x+b*r[0]]=o}}const a=[this.drawPenFillPts[0][i],this.drawPenFillPts[0][s]];let c=a;for(let m=1;m<e;m++){const g=[this.drawPenFillPts[m][i],this.drawPenFillPts[m][s]];l(c,g),c=g}l(a,c);const h=[];function d(m){if(m[0]<0||m[1]<0||m[0]>=r[0]||m[1]>=r[1])return;const g=m[0]+m[1]*r[0];n[g]===0&&(h.push(m),n[g]=2)}for(let m=0;m<r[0];m++)d([m,0]);for(let m=0;m<r[0];m++)d([m,r[1]-1]);for(let m=0;m<r[1];m++)d([0,m]);for(let m=0;m<r[1];m++)d([r[0]-1,m]);for(;h.length>0;){const m=h.shift();d([m[0]-1,m[1]]),d([m[0]+1,m[1]]),d([m[0],m[1]-1]),d([m[0],m[1]+1])}o=this.opts.penValue;const f=this.drawPenFillPts[0][3-(i+s)];if(!this.drawBitmap)throw new Error("drawBitmap undefined");if(t===0){const m=f*r[0]*r[1];for(let g=0;g<r[0]*r[1];g++)n[g]!==2&&(this.drawBitmap[g+m]=o)}else{let m=1;const g=this.back.dims[1]*this.back.dims[2];let A=f*this.back.dims[1];t===2&&(m=this.back.dims[1],A=f);let p=0;for(let w=0;w<r[1];w++)for(let y=0;y<r[0];y++)n[p]!==2&&(this.drawBitmap[y*m+w*g+A]=o),p++}if(!this.drawFillOverwrites&&this.drawUndoBitmaps[this.currentDrawUndoBitmap].length>0){const m=this.drawBitmap.length,g=Xs(this.drawUndoBitmaps[this.currentDrawUndoBitmap],m);for(let A=0;A<m;A++)g[A]!==0&&(this.drawBitmap[A]=g[A])}this.drawPenFillPts=[],this.drawAddUndoBitmap(),this.refreshDrawing(!1)}closeDrawing(){this.drawClearAllUndoBitmaps(),this.rgbaTex(this.drawTexture,Se,[2,2,2,2],!0),this.drawBitmap=null,this.clickToSegmentGrowingBitmap=null,this.drawScene()}refreshDrawing(e=!0,t=!1){var r;if(!((r=this.back)!=null&&r.dims))throw new Error("back.dims undefined");if(!this.drawBitmap)throw new Error("drawBitmap undefined");const i=this.back.dims.slice(),s=this.back.dims[1]*this.back.dims[2]*this.back.dims[3];this.drawBitmap.length===8?(i[1]=2,i[2]=2,i[3]=2):s!==this.drawBitmap.length&&P.warn("Drawing bitmap must match the background image"),this.gl.activeTexture(Se),this.gl.bindTexture(this.gl.TEXTURE_3D,this.drawTexture),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i[1],i[2],i[3],this.gl.RED,this.gl.UNSIGNED_BYTE,t?this.clickToSegmentGrowingBitmap:this.drawBitmap),e&&this.drawScene()}r8Tex(e,t,i,s=!1){if(e&&this.gl.deleteTexture(e),e=this.gl.createTexture(),this.gl.activeTexture(t),this.gl.bindTexture(this.gl.TEXTURE_3D,e),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R8,i[1],i[2],i[3]),s){const r=new Uint8Array(i[1]*i[2]*i[3]);this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i[1],i[2],i[3],this.gl.RED,this.gl.UNSIGNED_BYTE,r)}return e}rgbaTex(e,t,i,s=!1){if(e&&this.gl.deleteTexture(e),e=this.gl.createTexture(),this.gl.activeTexture(t),this.gl.bindTexture(this.gl.TEXTURE_3D,e),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGBA8,i[1],i[2],i[3]),s){const r=new Uint8Array(i[1]*i[2]*i[3]*4);this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i[1],i[2],i[3],this.gl.RGBA,this.gl.UNSIGNED_BYTE,r)}return e}rgba16Tex(e,t,i,s=!1){if(e&&this.gl.deleteTexture(e),e=this.gl.createTexture(),this.gl.activeTexture(t),this.gl.bindTexture(this.gl.TEXTURE_3D,e),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,2),this.gl.pixelStorei(this.gl.PACK_ALIGNMENT,2),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGBA16UI,i[1],i[2],i[3]),s){const r=new Uint16Array(i[1]*i[2]*i[3]*4);this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i[1],i[2],i[3],this.gl.RGBA_INTEGER,this.gl.UNSIGNED_SHORT,r)}return e}requestCORSIfNotSameOrigin(e,t){new URL(t,window.location.href).origin!==window.location.origin&&(e.crossOrigin="")}async loadPngAsTexture(e,t){return new Promise((i,s)=>{const r=new Image;r.onload=()=>{if(!this.bmpShader)return;let n;t===4?(this.bmpTexture!==null&&this.gl.deleteTexture(this.bmpTexture),this.bmpTexture=this.gl.createTexture(),n=this.bmpTexture,this.bmpTextureWH=r.width/r.height,this.gl.activeTexture(Tl),this.bmpShader.use(this.gl),this.gl.uniform1i(this.bmpShader.uniforms.bmpTexture,4)):t===5?(this.gl.activeTexture(Js),this.matCapTexture!==null&&this.gl.deleteTexture(this.matCapTexture),this.matCapTexture=this.gl.createTexture(),n=this.matCapTexture):(this.fontShader.use(this.gl),this.gl.activeTexture(Sl),this.gl.uniform1i(this.fontShader.uniforms.fontTexture,3),this.fontTexture!==null&&this.gl.deleteTexture(this.fontTexture),this.fontTexture=this.gl.createTexture(),n=this.fontTexture),this.gl.bindTexture(this.gl.TEXTURE_2D,n),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,r),i(n),t!==4&&this.drawScene()},r.onerror=s,this.requestCORSIfNotSameOrigin(r,e),r.src=e})}async loadFontTexture(e){return this.loadPngAsTexture(e,3)}async loadBmpTexture(e){return this.loadPngAsTexture(e,4)}async loadMatCapTexture(e){return this.loadPngAsTexture(e,5)}initFontMets(){if(!this.fontMetrics)throw new Error("fontMetrics undefined");this.fontMets={distanceRange:this.fontMetrics.atlas.distanceRange,size:this.fontMetrics.atlas.size,mets:{}};for(let i=0;i<256;i++)this.fontMets.mets[i]={xadv:0,uv_lbwh:[0,0,0,0],lbwh:[0,0,0,0]};const e=this.fontMetrics.atlas.width,t=this.fontMetrics.atlas.height;for(let i=0;i<this.fontMetrics.glyphs.length;i++){const s=this.fontMetrics.glyphs[i],r=s.unicode;if(this.fontMets.mets[r].xadv=s.advance,s.planeBounds===void 0)continue;let n=s.atlasBounds.left/e,o=(t-s.atlasBounds.top)/t,l=(s.atlasBounds.right-s.atlasBounds.left)/e,a=(s.atlasBounds.top-s.atlasBounds.bottom)/t;this.fontMets.mets[r].uv_lbwh=[n,o,l,a],n=s.planeBounds.left,o=s.planeBounds.bottom,l=s.planeBounds.right-s.planeBounds.left,a=s.planeBounds.top-s.planeBounds.bottom,this.fontMets.mets[r].lbwh=[n,o,l,a]}}async loadFont(e=Ks,t=qs){await this.loadFontTexture(e);const i=await fetch(t);if(!i.ok)throw Error(i.statusText);const s=await i.text();this.fontMetrics=JSON.parse(s),this.initFontMets(),this.fontShader.use(this.gl),this.drawScene()}async loadDefaultMatCap(){return this.loadMatCapTexture(wl)}async loadDefaultFont(){await this.loadFontTexture(this.DEFAULT_FONT_GLYPH_SHEET),this.fontMetrics=this.DEFAULT_FONT_METRICS,this.initFontMets()}async initText(){this.fontShader=new ot(this.gl,Ao,po),this.fontShader.use(this.gl),await this.loadDefaultFont(),await this.loadDefaultMatCap(),this.drawLoadingText(this.opts.loadingText)}meshShaderNameToNumber(e="Phong"){const t=e.toLowerCase();for(let i=0;i<this.meshShaders.length;i++)if(this.meshShaders[i].Name.toLowerCase()===t)return i}setMeshShader(e,t=2){let i=0;if(typeof t=="number"?i=t:i=this.meshShaderNameToNumber(t),i===void 0)throw new Error("shaderIndex undefined");i=Math.min(i,this.meshShaders.length-1),i=Math.max(i,0);const s=this.getMeshIndexByID(e);if(s>=this.meshes.length){P.debug("Unable to change shader until mesh is loaded (maybe you need async)");return}this.meshes[s].meshShaderIndex=i,this.updateGLVolume(),this.onMeshShaderChanged(s,i)}createCustomMeshShader(e,t="Custom"){if(!e)throw new Error("Need fragment shader");const i=this.meshShaderNameToNumber(t);i>=0&&(this.gl.deleteProgram(this.meshShaders[i].shader.program),this.meshShaders.splice(i,1));const s=new ot(this.gl,Hi,e);return s.use(this.gl),{Name:t,Frag:e,shader:s}}setCustomMeshShader(e="",t="Custom"){const i=this.createCustomMeshShader(e,t);return this.meshShaders.push(i),this.onCustomMeshShaderAdded(e,t),this.meshShaders.length-1}meshShaderNames(e=!0){const t=[];for(let i=0;i<this.meshShaders.length;i++)t.push(this.meshShaders[i].Name);return e===!0?t.sort():t}initRenderShader(e,t=0){e.use(this.gl),this.gl.uniform1i(e.uniforms.volume,0),this.gl.uniform1i(e.uniforms.colormap,1),this.gl.uniform1i(e.uniforms.overlay,2),this.gl.uniform1i(e.uniforms.drawing,7),this.gl.uniform1fv(e.uniforms.renderDrawAmbientOcclusion,[this.renderDrawAmbientOcclusion,1]),this.gl.uniform1f(e.uniforms.gradientAmount,t);const i=new Float32Array(256);for(let s=0;s<256;s++)this.opts.gradientOpacity===0?i[s]=1:i[s]=Math.pow(s/255,this.opts.gradientOpacity*8);this.gl.uniform1fv(this.gl.getUniformLocation(e.program,"gradientOpacity"),i)}async init(){const e=this.gl.getExtension("WEBGL_debug_renderer_info");if(e){const n=this.gl.getParameter(e.UNMASKED_VENDOR_WEBGL),o=this.gl.getParameter(e.UNMASKED_RENDERER_WEBGL);P.info("renderer vendor: ",n),P.info("renderer: ",o)}else P.info("debug_renderer_info unavailable");const t=this.gl.getParameter(this.gl.RENDERER);P.info("firefox renderer: ",t),this.gl.clearDepth(0),this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl.FRONT),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.volumeTexture=this.rgbaTex(this.volumeTexture,ui,[2,2,2,2],!0),this.overlayTexture=this.rgbaTex(this.overlayTexture,Ji,[2,2,2,2],!0),this.drawTexture=this.r8Tex(this.drawTexture,Se,[2,2,2,2],!0);const i=[1,1,0,1,0,0,0,1,0,0,0,0],s=this.gl;this.cuboidVertexBuffer=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,this.cuboidVertexBuffer),s.bufferData(s.ARRAY_BUFFER,new Float32Array(i),s.STATIC_DRAW),this.genericVAO=s.createVertexArray(),s.bindVertexArray(this.genericVAO),s.bindBuffer(s.ARRAY_BUFFER,this.cuboidVertexBuffer),s.enableVertexAttribArray(0),s.vertexAttribPointer(0,3,s.FLOAT,!1,0,0),s.bindVertexArray(this.unusedVAO),this.pickingMeshShader=new ot(s,Hi,So),this.pickingMeshShader.use(s),this.pickingImageShader=new ot(s,Ke,Yo),this.pickingImageShader.use(s),s.uniform1i(this.pickingImageShader.uniforms.volume,0),s.uniform1i(this.pickingImageShader.uniforms.colormap,1),s.uniform1i(this.pickingImageShader.uniforms.overlay,2),s.uniform1i(this.pickingImageShader.uniforms.drawing,7),this.sliceMMShader=new ot(s,Ps,oo),this.sliceMMShader.use(s),s.uniform1i(this.sliceMMShader.uniforms.volume,0),s.uniform1i(this.sliceMMShader.uniforms.colormap,1),s.uniform1i(this.sliceMMShader.uniforms.overlay,2),s.uniform1i(this.sliceMMShader.uniforms.drawing,7),s.uniform1f(this.sliceMMShader.uniforms.drawOpacity,this.drawOpacity),this.sliceV1Shader=new ot(s,Ps,ao),this.sliceV1Shader.use(s),s.uniform1i(this.sliceV1Shader.uniforms.volume,0),s.uniform1i(this.sliceV1Shader.uniforms.colormap,1),s.uniform1i(this.sliceV1Shader.uniforms.overlay,2),s.uniform1i(this.sliceV1Shader.uniforms.drawing,7),s.uniform1f(this.sliceV1Shader.uniforms.drawOpacity,this.drawOpacity),this.orientCubeShader=new ot(s,zo,Ko),this.orientCubeShaderVAO=s.createVertexArray(),s.bindVertexArray(this.orientCubeShaderVAO);const r=s.createBuffer();s.enableVertexAttribArray(0),s.enableVertexAttribArray(1),s.bindBuffer(s.ARRAY_BUFFER,r),s.bufferData(s.ARRAY_BUFFER,Zo,s.STATIC_DRAW),s.vertexAttribPointer(0,3,s.FLOAT,!1,24,0),s.enableVertexAttribArray(1),s.vertexAttribPointer(1,3,s.FLOAT,!1,24,12),s.bindVertexArray(this.unusedVAO),this.rectShader=new ot(s,Ls,Ki),this.rectShader.use(s),this.rectOutlineShader=new ot(s,Ls,lo),this.rectOutlineShader.use(s),this.lineShader=new ot(s,fo,Ki),this.lineShader.use(s),this.line3DShader=new ot(s,uo,Ki),this.line3DShader.use(s),this.circleShader=new ot(s,xo,vo),this.circleShader.use(s),this.renderVolumeShader=new ot(s,Ke,so),this.initRenderShader(this.renderVolumeShader),this.renderSliceShader=new ot(s,Ke,io),this.initRenderShader(this.renderSliceShader),this.renderGradientShader=new ot(s,Ke,ro),this.initRenderShader(this.renderGradientShader,.3),s.uniform1i(this.renderGradientShader.uniforms.matCap,5),s.uniform1i(this.renderGradientShader.uniforms.gradient,6),this.renderGradientValuesShader=new ot(s,Ke,no),this.initRenderShader(this.renderGradientValuesShader),s.uniform1i(this.renderGradientValuesShader.uniforms.matCap,5),s.uniform1i(this.renderGradientValuesShader.uniforms.gradient,6),this.renderShader=this.renderVolumeShader,this.colorbarShader=new ot(s,co,ho),this.colorbarShader.use(s),s.uniform1i(this.colorbarShader.uniforms.colormap,1),this.blurShader=new ot(s,li,Ho),this.sobelBlurShader=new ot(s,li,Wo),this.sobelFirstOrderShader=new ot(s,li,Xo),this.sobelSecondOrderShader=new ot(s,li,jo),this.growCutShader=new ot(s,bo,Co),this.passThroughShader=new ot(s,qo,Qo),this.orientShaderAtlasU=new ot(s,Me,qi.concat(ks)),this.orientShaderAtlasI=new ot(s,Me,Os.concat(ks)),this.orientShaderU=new ot(s,Me,qi.concat(Qi)),this.orientShaderI=new ot(s,Me,Os.concat(Qi)),this.orientShaderF=new ot(s,Me,wo.concat(Qi)),this.orientShaderRGBU=new ot(s,Me,qi.concat(yo)),this.surfaceShader=new ot(s,Do,Io),this.surfaceShader.use(s),this.fiberShader=new ot(s,Eo,Mo),this.pickingImageShader.use(s);for(let n=0;n<this.meshShaders.length;n++){const o=this.meshShaders[n];o.Name==="Flat"?o.shader=new ot(s,Go,Gs):o.shader=new ot(s,Hi,o.Frag),o.shader.use(s),o.shader.isMatcap=o.Name==="Matcap",o.shader.isMatcap&&s.uniform1i(o.shader.uniforms.matCap,5)}return this.bmpShader=new ot(s,mo,go),await this.initText(),this.opts.thumbnail.length>0&&(await this.loadBmpTexture(this.opts.thumbnail),this.thumbnailVisible=!0),this.updateGLVolume(),this.initialized=!0,this.resizeListener(),this.drawScene(),this}gradientGL(e){const t=this.gl,i=[0,0,0,0,1,0,1,0,0,1,1,0],s=t.createVertexArray();t.bindVertexArray(s);const r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW),t.enableVertexAttribArray(0),t.vertexAttribPointer(0,3,t.FLOAT,!1,0,0);const n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n),t.disable(t.CULL_FACE),t.viewport(0,0,e.dims[1],e.dims[2]),t.disable(t.BLEND);const o=this.rgbaTex(null,$s,e.dims,!0),l=this.opts.gradientOrder===2?this.sobelBlurShader:this.blurShader;l.use(t),t.activeTexture(ui),t.bindTexture(t.TEXTURE_3D,this.volumeTexture);const a=.7;t.uniform1i(l.uniforms.intensityVol,0),t.uniform1f(l.uniforms.dX,a/e.dims[1]),t.uniform1f(l.uniforms.dY,a/e.dims[2]),t.uniform1f(l.uniforms.dZ,a/e.dims[3]),t.bindVertexArray(s);for(let d=0;d<e.dims[3]-1;d++){const f=1/e.dims[3]*(d+.5);t.uniform1f(l.uniforms.coordZ,f),t.framebufferTextureLayer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,o,0,d);const u=t.checkFramebufferStatus(t.FRAMEBUFFER);u!==t.FRAMEBUFFER_COMPLETE&&P.error("framebuffer status: ",u),t.clear(t.DEPTH_BUFFER_BIT),t.drawArrays(t.TRIANGLE_STRIP,0,i.length/3)}const c=this.opts.gradientOrder===2?this.sobelSecondOrderShader:this.sobelFirstOrderShader;c.use(t),t.activeTexture($s),t.bindTexture(t.TEXTURE_3D,o),t.uniform1i(c.uniforms.intensityVol,8);const h=.7;t.uniform1f(c.uniforms.dX,h/e.dims[1]),t.uniform1f(c.uniforms.dY,h/e.dims[2]),t.uniform1f(c.uniforms.dZ,h/e.dims[3]),this.opts.gradientOrder===2&&(t.uniform1f(c.uniforms.dX2,2*h/e.dims[1]),t.uniform1f(c.uniforms.dY2,2*h/e.dims[2]),t.uniform1f(c.uniforms.dZ2,2*h/e.dims[3])),t.uniform1f(c.uniforms.coordZ,.5),t.bindVertexArray(s),this.gradientTexture!==null&&t.deleteTexture(this.gradientTexture),this.gradientTexture=this.rgbaTex(this.gradientTexture,_s,e.dims);for(let d=0;d<e.dims[3]-1;d++){const f=1/e.dims[3]*(d+.5);t.uniform1f(c.uniforms.coordZ,f),t.framebufferTextureLayer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,this.gradientTexture,0,d);const u=t.checkFramebufferStatus(t.FRAMEBUFFER);u!==t.FRAMEBUFFER_COMPLETE&&P.error("framebuffer status: ",u),t.clear(t.DEPTH_BUFFER_BIT),t.drawArrays(t.TRIANGLE_STRIP,0,i.length/3)}t.deleteFramebuffer(n),t.deleteTexture(o),t.deleteBuffer(r),t.bindFramebuffer(t.FRAMEBUFFER,null)}updateGLVolume(){var i;let e=0;const t=this.volumes.length;this.refreshColormaps();for(let s=0;s<t;s++)this.volumes[s].toRAS&&(this.refreshLayers(this.volumes[s],e),e++);if(this.furthestVertexFromOrigin=0,t>0&&(this.furthestVertexFromOrigin=((i=this.volumeObject3D)==null?void 0:i.furthestVertexFromOrigin)??0),this.meshes)for(let s=0;s<this.meshes.length;s++)this.furthestVertexFromOrigin=Math.max(this.furthestVertexFromOrigin,this.meshes[s].furthestVertexFromOrigin);this.onVolumeUpdated&&this.onVolumeUpdated(),this.drawScene()}getDescriptives(e){const{layer:t=0,masks:i=[],drawingIsMask:s=!1,roiIsMask:r=!1,startVox:n=[0,0,0],endVox:o=[0,0,0]}=e;let l=null;const a=this.volumes[t].hdr,c=this.volumes[t].pixDimsRAS;let h=a.scl_slope;isNaN(h)&&(h=1);let d=a.scl_inter;isNaN(d)&&(d=1);const f=this.volumes[t].img,u=f.length,m=new Float32Array(u);for(let E=0;E<u;E++)m[E]=f[E]*h+d;const g=new Uint8Array(u);for(let E=0;E<u;E++)g[E]=1;if(i.length>0)for(let E=0;E<i.length;E++){const V=this.volumes[i[E]].img;if(V.length!==u){P.debug("Mask resolution does not match image. Skipping masking layer "+i[E]);continue}for(let T=0;T<u;T++)(V[T]===0||isNaN(V[T]))&&(g[T]=0)}else if(i.length<1&&s)for(let E=0;E<u;E++)(this.drawBitmap[E]===0||isNaN(this.drawBitmap[E]))&&(g[E]=0);else if(i.length<1&&r){g.fill(0),console.log("startVox",n),console.log("endVox",o);let E=-1;if(n[0]===o[0])E=0;else if(n[1]===o[1])E=1;else if(n[2]===o[2])E=2;else{console.error("Error: No constant dimension found.");return}const T=[0,1,2].filter(ct=>ct!==E),R=[];R[E]=n[E],R[T[0]]=(n[T[0]]+o[T[0]])/2,R[T[1]]=(n[T[1]]+o[T[1]])/2;const N=Math.abs(o[T[0]]-n[T[0]])/2,O=Math.abs(o[T[1]]-n[T[1]])/2,G=a.dims[1],z=a.dims[2],q=Math.max(0,Math.floor(R[T[0]]-N)),J=Math.min(a.dims[T[0]+1]-1,Math.ceil(R[T[0]]+N)),_=Math.max(0,Math.floor(R[T[1]]-O)),tt=Math.min(a.dims[T[1]+1]-1,Math.ceil(R[T[1]]+O)),$=R[E];if($<0||$>=a.dims[E+1]){console.error("Error: Constant dimension value is out of bounds.");return}for(let ct=q;ct<=J;ct++)for(let ft=_;ft<=tt;ft++){const ut=[];ut[E]=$,ut[T[0]]=ct,ut[T[1]]=ft;const At=(ut[T[0]]-R[T[0]])/N,Kt=(ut[T[1]]-R[T[1]])/O;if(At*At+Kt*Kt<=1){const de=ut[0],ye=ut[1],jt=ut[2]*G*z+ye*G+de;g[jt]=1}}const dt=c[T[0]+1]*c[T[1]+1];l=g.reduce((ct,ft)=>ct+(ft===1?1:0),0)*dt;const rt=N*c[T[0]+1],ht=O*c[T[1]+1];l=Math.PI*rt*ht}let A=0,p=0,w=0,y=Number.NEGATIVE_INFINITY,x=Number.POSITIVE_INFINITY,b=0,M=0,D=0;for(let E=0;E<u;E++){if(g[E]<1)continue;const V=m[E];A++;let T=p+(V-p)/A;w=w+(V-p)*(V-T),p=T,V!==0&&(b++,T=M+(V-M)/b,D=D+(V-M)*(V-T),M=T,x=Math.min(V,y),y=Math.max(V,y))}const v=Math.sqrt(w/(A-1)),C=Math.sqrt(D/(b-1)),I=x,S=y;return A!==b&&(x=Math.min(0,y),y=Math.max(0,y)),{mean:p,stdev:v,nvox:A,volumeMM3:A*a.pixDims[1]*a.pixDims[2]*a.pixDims[3],volumeML:A*a.pixDims[1]*a.pixDims[2]*a.pixDims[3]*.001,min:x,max:y,meanNot0:M,stdevNot0:C,nvoxNot0:b,minNot0:I,maxNot0:S,cal_min:this.volumes[t].cal_min,cal_max:this.volumes[t].cal_max,robust_min:this.volumes[t].robust_min,robust_max:this.volumes[t].robust_max,area:l}}refreshLayers(e,t){var M;if(this.volumes.length<1)return;this.refreshColormaps();const i=e.hdr;let s=e.img;e.frame4D>0&&e.frame4D<e.nFrame4D&&(s=e.img.slice(e.frame4D*e.nVox3D,(e.frame4D+1)*e.nVox3D));const r=e.opacity;if(t>1&&r===0)return;let n=null;if(!this.back)throw new Error("back undefined");this.gl.bindVertexArray(this.unusedVAO),this.crosshairs3D&&(this.crosshairs3D.mm[0]=NaN);let o=It(e.toRAS);if(t===0){this.volumeObject3D=e.toNiivueObject3D(this.VOLUME_ID,this.gl),zt(o,o),this.back.matRAS=e.matRAS,this.back.dims=e.dimsRAS,this.back.pixDims=e.pixDimsRAS,n=this.rgbaTex(this.volumeTexture,ui,e.dimsRAS);const{volScale:D,vox:v}=this.sliceScale(!0);if(this.volScale=D,this.vox=v,this.volumeObject3D.scale=D,!this.renderShader)throw new Error("renderShader undefined");this.renderShader.use(this.gl),this.gl.uniform3fv(this.renderShader.uniforms.texVox,v),this.gl.uniform3fv(this.renderShader.uniforms.volScale,D);const C=this.pickingImageShader;C.use(this.gl),this.gl.uniform1i(C.uniforms.volume,0),this.gl.uniform1i(C.uniforms.colormap,1),this.gl.uniform1i(C.uniforms.overlay,2),this.gl.uniform3fv(C.uniforms.volScale,D),P.debug(this.volumeObject3D)}else{((M=this.back)==null?void 0:M.dims)===void 0&&P.error("Fatal error: Unable to render overlay: background dimensions not defined!");const D=this.mm2frac(e.mm000,0,!0);let v=this.mm2frac(e.mm100,0,!0),C=this.mm2frac(e.mm010,0,!0),I=this.mm2frac(e.mm001,0,!0);v=bt(v,v,D),C=bt(C,C,D),I=bt(I,I,D),o=Qt(v[0],C[0],I[0],D[0],v[1],C[1],I[1],D[1],v[2],C[2],I[2],D[2],0,0,0,1),zt(o,o),t===1?(n=this.rgbaTex(this.overlayTexture,Ji,this.back.dims),this.overlayTexture=n,this.overlayTextureID=n):n=this.overlayTextureID}const l=this.gl.createFramebuffer();this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,l),this.gl.disable(this.gl.CULL_FACE),this.gl.viewport(0,0,this.back.dims[1],this.back.dims[2]),this.gl.disable(this.gl.BLEND);const a=this.gl.createTexture();this.gl.activeTexture(Fl),this.gl.bindTexture(this.gl.TEXTURE_3D,a),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1);let c=this.orientShaderU;if(!i)throw new Error("hdr undefined");if(!s)throw new Error("img undefined");if(i.datatypeCode===2)i.intent_code===1002&&(c=this.orientShaderAtlasU),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R8UI,i.dims[1],i.dims[2],i.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RED_INTEGER,this.gl.UNSIGNED_BYTE,s);else if(i.datatypeCode===4)c=this.orientShaderI,i.intent_code===1002&&(c=this.orientShaderAtlasI),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R16I,i.dims[1],i.dims[2],i.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RED_INTEGER,this.gl.SHORT,s);else if(i.datatypeCode===16)this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R32F,i.dims[1],i.dims[2],i.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RED,this.gl.FLOAT,s),c=this.orientShaderF;else if(i.datatypeCode===64){let D=new Float32Array;D=Float32Array.from(s),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R32F,i.dims[1],i.dims[2],i.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RED,this.gl.FLOAT,D),c=this.orientShaderF}else i.datatypeCode===128?(c=this.orientShaderRGBU,c.use(this.gl),this.gl.uniform1i(c.uniforms.hasAlpha,0),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGB8UI,i.dims[1],i.dims[2],i.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RGB_INTEGER,this.gl.UNSIGNED_BYTE,s)):i.datatypeCode===512?(i.intent_code===1002&&(c=this.orientShaderAtlasU),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R16UI,i.dims[1],i.dims[2],i.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RED_INTEGER,this.gl.UNSIGNED_SHORT,s)):i.datatypeCode===2304&&(c=this.orientShaderRGBU,c.use(this.gl),this.gl.uniform1i(c.uniforms.hasAlpha,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGBA8UI,i.dims[1],i.dims[2],i.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RGBA_INTEGER,this.gl.UNSIGNED_BYTE,s));e.global_min===void 0&&e.calMinMax();let h=null;if(this.gl.bindVertexArray(this.genericVAO),t>1){if(!this.back.dims)throw new Error("back.dims undefined");h=this.rgbaTex(h,tr,this.back.dims),this.gl.bindTexture(this.gl.TEXTURE_3D,h);const D=this.passThroughShader;D.use(this.gl),this.gl.uniform1i(D.uniforms.in3D,2);for(let v=0;v<this.back.dims[3];v++){const C=1/this.back.dims[3]*(v+.5);this.gl.uniform1f(D.uniforms.coordZ,C),this.gl.framebufferTextureLayer(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,h,0,v),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}else h=this.rgbaTex(h,tr,[2,2,2,2]);c.use(this.gl),this.gl.activeTexture(mi);let d=null;if(e.colormapLabel!==null&&e.colormapLabel.lut.length>7){const D=e.colormapLabel.max-e.colormapLabel.min+1;d=this.createColormapTexture(d,1,D),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,D,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e.colormapLabel.lut),this.gl.uniform1f(c.uniforms.cal_min,e.colormapLabel.min-.5),this.gl.uniform1f(c.uniforms.cal_max,e.colormapLabel.max+.5),this.gl.bindTexture(this.gl.TEXTURE_2D,d)}else this.gl.bindTexture(this.gl.TEXTURE_2D,this.colormapTexture),this.gl.uniform1f(c.uniforms.cal_min,e.cal_min),this.gl.uniform1f(c.uniforms.cal_max,e.cal_max);"alphaThreshold"in e&&(P.warn("alphaThreshold is deprecated: use colormapType"),e.alphaThreshold===!0&&(e.colormapType=2),e.alphaThreshold===!1&&(e.colormapType=1),delete e.alphaThreshold);const f=e.colormapType!==0?1:0,u=e.colormapType===2?1:0;this.gl.uniform1i(c.uniforms.isAlphaThreshold,u),this.gl.uniform1i(c.uniforms.isColorbarFromZero,f),this.gl.uniform1i(c.uniforms.isAdditiveBlend,this.opts.isAdditiveBlend?1:0);let m=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY;if(e.colormapNegative.length>0&&(m=Math.min(-e.cal_min,-e.cal_max),g=Math.max(-e.cal_min,-e.cal_max),isFinite(e.cal_minNeg)&&isFinite(e.cal_maxNeg)&&(m=Math.min(e.cal_minNeg,e.cal_maxNeg),g=Math.max(e.cal_minNeg,e.cal_maxNeg))),t>0&&this.overlayOutlineWidth>0){const D=e.cal_min,v=e.cal_max;let C=Math.min(D,v)<=0&&Math.max(D,v)>=0;!C&&m<g&&(C=m<=0&&g>=0),C&&P.error("issue1139: do not use overlayOutlineWidth when thresholds cross or touch zero")}if(!c)throw new Error("orientShader undefined");this.gl.uniform1f(c.uniforms.layer??null,t),this.gl.uniform1f(c.uniforms.cal_minNeg??null,m),this.gl.uniform1f(c.uniforms.cal_maxNeg??null,g),this.gl.bindTexture(this.gl.TEXTURE_3D,a),this.gl.uniform1i(c.uniforms.intensityVol??null,9),this.gl.uniform1i(c.uniforms.blend3D??null,10),this.gl.uniform1i(c.uniforms.colormap??null,1),this.gl.uniform1f(c.uniforms.scl_inter??null,i.scl_inter),this.gl.uniform1f(c.uniforms.scl_slope??null,i.scl_slope),this.gl.uniform1f(c.uniforms.opacity??null,r),this.gl.uniform1i(c.uniforms.modulationVol??null,7);let A=null;if(e.modulationImage!==null&&e.modulationImage>=0&&e.modulationImage<this.volumes.length){P.debug("modulating",this.volumes);const D=this.volumes[e.modulationImage].hdr;if(D.dims[1]===i.dims[1]&&D.dims[2]===i.dims[2]&&D.dims[3]===i.dims[3]){e.modulateAlpha?(this.gl.uniform1i(c.uniforms.modulation,2),this.gl.uniform1f(c.uniforms.opacity,1)):this.gl.uniform1i(c.uniforms.modulation,1),A=this.r8Tex(A,this.gl.TEXTURE7,i.dims,!0),this.gl.activeTexture(this.gl.TEXTURE7),this.gl.bindTexture(this.gl.TEXTURE_3D,A);const v=i.dims[1]*i.dims[2]*i.dims[3],C=new Uint8Array(v),I=this.volumes[e.modulationImage].cal_min,S=1/(this.volumes[e.modulationImage].cal_max-I),E=this.volumes[e.modulationImage].img.buffer;let V=new Uint8Array(E);switch(D.datatypeCode){case 4:V=new Int16Array(E);break;case 16:V=new Float32Array(E);break;case 64:V=new Float64Array(E);break;case 128:V=new Uint8Array(E);break;case 512:V=new Uint16Array(E);break}P.debug(this.volumes[e.modulationImage]);const T=this.volumes[e.modulationImage].colormapNegative.length>0;let R=this.volumes[e.modulationImage].cal_min,N=this.volumes[e.modulationImage].cal_max;isFinite(this.volumes[e.modulationImage].cal_minNeg)&&isFinite(this.volumes[e.modulationImage].cal_maxNeg)&&(R=this.volumes[e.modulationImage].cal_minNeg,N=this.volumes[e.modulationImage].cal_minNeg),R=Math.abs(R),N=Math.abs(N),R>N&&([R,N]=[N,R]);const O=1/(N-R);let G=Math.abs(e.modulateAlpha);G=Math.max(G,1);const z=this.volumes[e.modulationImage].frame4D*v;for(let q=0;q<v;q++){const J=V[q+z]*D.scl_slope+D.scl_inter;let _=(J-I)*S;T&&J<0&&(_=(Math.abs(J)-R)*O),_=Math.min(Math.max(_,0),1),_=Math.pow(_,G)*255,C[q]=_}this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RED,this.gl.UNSIGNED_BYTE,C)}else P.debug("Modulation image dimensions do not match target")}else this.gl.uniform1i(c.uniforms.modulation,0);if(this.gl.uniformMatrix4fv(c.uniforms.mtx,!1,o),!this.back.dims)throw new Error("back.dims undefined");let p=0;i.intent_code===1002&&(p=this.opts.atlasOutline),this.gl.uniform4fv(c.uniforms.xyzaFrac,[1/this.back.dims[1],1/this.back.dims[2],1/this.back.dims[3],p]),P.debug("back dims: ",this.back.dims);for(let D=0;D<this.back.dims[3];D++){const v=1/this.back.dims[3]*(D+.5);this.gl.uniform1f(c.uniforms.coordZ,v),this.gl.framebufferTextureLayer(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,n,0,D),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}if(this.gl.bindVertexArray(this.unusedVAO),this.gl.deleteTexture(a),this.gl.deleteTexture(A),this.gl.deleteTexture(h),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.deleteFramebuffer(l),t===0&&(this.volumeTexture=n,this.gradientTextureAmount>0?this.gradientGL(i):(this.gradientTexture!==null&&this.gl.deleteTexture(this.gradientTexture),this.gradientTexture=null)),!this.renderShader)throw new Error("renderShader undefined");this.renderShader.use(this.gl);const w=this.sliceScale(!0),y=w.vox,x=w.volScale;if(this.gl.uniform1f(this.renderShader.uniforms.overlays,this.overlays),this.gl.uniform4fv(this.renderShader.uniforms.clipPlaneColor,this.opts.clipPlaneColor),this.gl.uniform1f(this.renderShader.uniforms.clipThick,this.opts.clipThick),this.gl.uniform3fv(this.renderShader.uniforms.clipLo,this.opts.clipVolumeLow),this.gl.uniform3fv(this.renderShader.uniforms.clipHi,this.opts.clipVolumeHigh),this.gl.uniform1f(this.renderShader.uniforms.backOpacity,this.volumes[0].opacity),this.gl.uniform1f(this.renderShader.uniforms.renderOverlayBlend,this.opts.renderOverlayBlend),this.gl.uniform4fv(this.renderShader.uniforms.clipPlane,this.scene.clipPlane),this.gl.uniform3fv(this.renderShader.uniforms.texVox,y),this.gl.uniform3fv(this.renderShader.uniforms.volScale,x),!this.pickingImageShader)throw new Error("pickingImageShader undefined");this.pickingImageShader.use(this.gl),this.gl.uniform1f(this.pickingImageShader.uniforms.overlays,this.overlays.length),this.gl.uniform3fv(this.pickingImageShader.uniforms.texVox,y),this.gl.uniform3fv(this.pickingImageShader.uniforms.clipLo,this.opts.clipVolumeLow),this.gl.uniform3fv(this.pickingImageShader.uniforms.clipHi,this.opts.clipVolumeHigh);let b=this.sliceMMShader;if(this.opts.isV1SliceShader&&(b=this.sliceV1Shader),!b)throw new Error("slice shader undefined");b.use(this.gl),this.gl.uniform1f(b.uniforms.overlays,this.overlays.length),this.gl.uniform1f(b.uniforms.drawOpacity,this.drawOpacity),d!==null&&(this.gl.deleteTexture(d),this.gl.activeTexture(mi),this.gl.bindTexture(this.gl.TEXTURE_2D,this.colormapTexture)),this.gl.uniform1i(b.uniforms.drawing,7),this.gl.activeTexture(Se),this.gl.bindTexture(this.gl.TEXTURE_3D,this.drawTexture),this.updateInterpolation(t)}colormaps(){return mt.colormaps()}addColormap(e,t){mt.addColormap(e,t)}setColormap(e,t){const i=this.getVolumeIndexByID(e);this.volumes[i].colormap=t,this.updateGLVolume()}idx(e,t,i,s){return i*s[0]*s[1]+t*s[0]+e}check_previous_slice(e,t,i,s,r,n,o,l){const a=new Uint32Array(27);let c=0;if(!r)return 0;const h=e[this.idx(i,s,r,n)];if(o>=6){const d=this.idx(i,s,r-1,n);h===e[d]&&(a[c++]=t[d])}if(o>=18){if(i){const d=this.idx(i-1,s,r-1,n);h===e[d]&&(a[c++]=t[d])}if(s){const d=this.idx(i,s-1,r-1,n);h===e[d]&&(a[c++]=t[d])}if(i<n[0]-1){const d=this.idx(i+1,s,r-1,n);h===e[d]&&(a[c++]=t[d])}if(s<n[1]-1){const d=this.idx(i,s+1,r-1,n);h===e[d]&&(a[c++]=t[d])}}if(o===26){if(i&&s){const d=this.idx(i-1,s-1,r-1,n);h===e[d]&&(a[c++]=t[d])}if(i<n[0]-1&&s){const d=this.idx(i+1,s-1,r-1,n);h===e[d]&&(a[c++]=t[d])}if(i&&s<n[1]-1){const d=this.idx(i-1,s+1,r-1,n);h===e[d]&&(a[c++]=t[d])}if(i<n[0]-1&&s<n[1]-1){const d=this.idx(i+1,s+1,r-1,n);h===e[d]&&(a[c++]=t[d])}}return c?(this.fill_tratab(l,a,c),a[0]):0}do_initial_labelling(e,t,i){let s=1;const r=8192;let n=r,o=new Uint32Array(n).fill(0);const l=new Uint32Array(t[0]*t[1]*t[2]).fill(0),a=new Uint32Array(27);for(let c=0;c<t[2];c++)for(let h=0;h<t[1];h++)for(let d=0;d<t[0];d++){let f=0;const u=e[this.idx(d,h,c,t)];if(u!==0){if(a[0]=this.check_previous_slice(e,l,d,h,c,t,i,o),a[0]&&(f+=1),i>=6){if(d){const m=this.idx(d-1,h,c,t);u===e[m]&&(a[f++]=l[m])}if(h){const m=this.idx(d,h-1,c,t);u===e[m]&&(a[f++]=l[m])}}if(i>=18){if(h&&d){const m=this.idx(d-1,h-1,c,t);u===e[m]&&(a[f++]=l[m])}if(h&&d<t[0]-1){const m=this.idx(d+1,h-1,c,t);u===e[m]&&(a[f++]=l[m])}}if(f)l[this.idx(d,h,c,t)]=a[0],this.fill_tratab(o,a,f);else{if(l[this.idx(d,h,c,t)]=s,s>=n){n+=r;const m=new Uint32Array(n);m.set(o),o=m}o[s-1]=s,s++}}}for(let c=0;c<s-1;c++){let h=c;for(;o[h]!==h+1;)h=o[h]-1;o[c]=h+1}return[s-1,o,l]}fill_tratab(e,t,i){let s=0;const r=new Uint32Array(i+5).fill(0);let o=2147483647;for(let l=0;l<i;l++){let a=t[l];for(s=0;e[a-1]!==a;)if(a=e[a-1],s++,s>100){P.info(`
Ooh no!!`);break}r[l]=a,o=Math.min(o,a)}for(let l=0;l<i;l++)e[r[l]-1]=o}translate_labels(e,t,i,s){const r=t[0]*t[1]*t[2];let n=0;const o=new Uint32Array(r).fill(0);for(let c=0;c<s;c++)n=Math.max(n,i[c]);const l=new Uint32Array(n).fill(0);let a=0;for(let c=0;c<r;c++)e[c]&&(l[i[e[c]-1]-1]||(a+=1,l[i[e[c]-1]-1]=a),o[c]=l[i[e[c]-1]-1]);return[a,o]}largest_original_cluster_labels(e,t,i){const s=e.length,r=new Uint32Array(t+1).fill(0),n=new Uint32Array(t+1).fill(0);for(let a=0;a<s;a++){const c=e[a],h=i[a];r[h]=c,n[h]++}let o=0;for(let a=0;a<t+1;a++){const c=r[a];o=Math.max(o,c);for(let h=0;h<t+1;h++)h!==a&&c===r[h]&&(n[a]<n[h]||n[a]===n[h]&&a<h)&&(r[a]=0)}const l=new Uint32Array(s).fill(0);for(let a=0;a<s;a++)l[a]=r[i[a]];return[o,l]}bwlabel(e,t,i=26,s=!1,r=!1){const n=Date.now(),o=t[0]*t[1]*t[2],l=new Uint32Array(o).fill(0);if(![6,18,26].includes(i))return P.info("bwlabel: conn must be 6, 18 or 26."),[0,l];if(t[0]<2||t[1]<2||t[2]<1)return P.info("bwlabel: img must be 2 or 3-dimensional"),[0,l];if(s)for(let u=0;u<o;u++)e[u]!==0&&(l[u]=1);else l.set(e);let[a,c,h]=this.do_initial_labelling(l,t,i);c===void 0&&(c=new Uint32Array);const[d,f]=this.translate_labels(h,t,c,a);if(P.info(i+" neighbor clustering into "+d+" regions in "+(Date.now()-n)+"ms"),r){const[u,m]=this.largest_original_cluster_labels(l,d,f);return[u,m]}return[d,f]}async createConnectedLabelImage(e,t=26,i=!1,s=!1){var h,d;const r=this.getVolumeIndexByID(e),n=Uint32Array.from(((h=this.volumes[r].dims)==null?void 0:h.slice(1,4))??[]),o=Uint32Array.from(((d=this.volumes[r].img)==null?void 0:d.slice())??[]),[l,a]=this.bwlabel(o,n,t,i,s),c=this.volumes[r].clone();c.opacity=.5,c.colormap="random";for(let f=0;f<c.img.length;f++)c.img[f]=a[f];return c.cal_min=0,c.cal_max=l,c}async scalecropUint8(e,t=0,i=255,s,r){const n=e.length,o=new Uint8Array(n);for(let l=0;l<n;l++){let a=e[l];a=t+r*(a-s),a=Math.max(a,t),a=Math.min(a,i),o[l]=a}return o}async scalecropFloat32(e,t=0,i=1,s,r){const n=e.length,o=new Float32Array(n);for(let l=0;l<n;l++){let a=e[l];a=t+r*(a-s),a=Math.max(a,t),a=Math.min(a,i),o[l]=a}return o}getScale(e,t=0,i=255,s=0,r=.999){let n=e.global_min,o=e.global_max;if(e.hdr.datatypeCode===2)return[n,1];if((!isFinite(s)||!isFinite(r))&&isFinite(e.cal_min)&&isFinite(e.cal_max)&&e.cal_max>e.cal_min){n=e.cal_min,o=e.cal_max;const w=(i-t)/(o-n);return P.info(" Robust Rescale:  min: "+n+"  max: "+o+" scale: "+w),console.log("Robust Rescale:  min: "+n+"  max: "+o+" scale: "+w),[n,w]}const l=e.img,a=e.hdr.dims[1]*e.hdr.dims[2]*e.hdr.dims[3];if(e.hdr.scl_slope!==1||e.hdr.scl_inter!==0){const w=e.img,y=new Float32Array(e.img.length);for(let x=0;x<a;x++)y[x]=w[x]*e.hdr.scl_slope+e.hdr.scl_inter}if(n<0&&P.warn("WARNING: Input image has value(s) below 0.0 !"),P.info(" Input:    min: "+n+"  max: "+o),s===0&&r===1)return[n,1];let c=0;for(let w=0;w<a;w++)Math.abs(l[w])>=1e-15&&c++;const h=1e3,d=(o-n)/h,f=new Array(h).fill(0);for(let w=0;w<a;w++){const y=l[w];let x=Math.floor((y-n)/d);x=Math.min(x,h-1),f[x]++}const u=new Array(h).fill(0);u[0]=f[0];for(let w=1;w<h;w++)u[w]=u[w-1]+f[w];let m=Math.floor(s*a),g=0;for(;g<h&&!(u[g]>=m);)g++;const A=n;for(n=g*d+A,m=a-Math.floor((1-r)*c),g=0;g<h-1&&!(u[g+1]>=m);)g++;o=g*d+A;let p=1;return n!==o&&(p=(i-t)/(o-n)),P.info(" Rescale:  min: "+n+"  max: "+o+" scale: "+p),[n,p]}conformVox2Vox(e,t,i=256,s=1,r=!1){const n=t.flat(),o=Qt(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15]),l=xt(e[1]/2,e[2]/2,e[3]/2,1),a=ne(),c=nt();Ht(c,o),Tt(a,l,c);const h=Q(a[0],a[1],a[2]),d=Q(s,s,s);let f=Qt(-1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1);r&&(f=Qt(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),Ht(f,f);const u=xt(i,i,i,1),m=nt();Ds(m,f,d);const g=xt(u[0],u[1],u[2],1);Tt(g,g,m),An(g,g,.5);const A=pt();bt(A,h,Q(g[0],g[1],g[2]));const p=nt();Ht(p,m),p[3]=A[0],p[7]=A[1],p[11]=A[2];const w=nt();zt(w,p);const y=nt();Ar(y,o,w);const x=nt();return zt(x,y),[p,y,x]}async createNiftiArray(e=[256,256,256],t=[1,1,1],i=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],s=2,r=new Uint8Array){return await Rt.createNiftiArray(e,t,i,s,r)}async niftiArray2NVImage(e=new Uint8Array){return await Rt.loadFromUrl({url:e})}async loadFromUrl(e){return await Rt.loadFromUrl({url:e})}async conform(e,t=!1,i=!0,s=!1,r=!1){const l=this.conformVox2Vox(e.hdr.dims,e.hdr.affine.flat(),256,1,t),a=l[0],c=l[2],h=256*256*256,d=new Float32Array(h),f=new Float32Array(e.img),u=e.hdr.dims[1]*e.hdr.dims[2]*e.hdr.dims[3];if(e.hdr.scl_slope!==1||e.hdr.scl_inter!==0)for(let I=0;I<u;I++)f[I]=f[I]*e.hdr.scl_slope+e.hdr.scl_inter;const m=e.hdr.dims[1],g=e.hdr.dims[2],A=e.hdr.dims[3],p=m*g;let w=-1;function y(I,S,E){return I+S*m+E*p}const x=c[0],b=c[4],M=c[8];if(i)for(let I=0;I<256;I++)for(let S=0;S<256;S++){const E=S*c[1]+I*c[2]+c[3],V=S*c[5]+I*c[6]+c[7],T=S*c[9]+I*c[10]+c[11];for(let R=0;R<256;R++){const N=R*x+E,O=R*b+V,G=R*M+T,z=Math.floor(N),q=Math.floor(O),J=Math.floor(G);if(w++,z<0||q<0||J<0)continue;const _=Math.ceil(N),tt=Math.ceil(O),$=Math.ceil(G);if(_>=m||tt>=g||$>=A)continue;const dt=N-z,lt=O-q,rt=G-J,ht=1-dt,Ct=1-lt,ct=1-rt,ft=y(z,q,J);let ut=0;ut+=f[ft]*ht*Ct*ct,ut+=f[ft+p]*ht*Ct*rt,ut+=f[ft+m]*ht*lt*ct,ut+=f[ft+m+p]*ht*lt*rt,ut+=f[ft+1]*dt*Ct*ct,ut+=f[ft+1+p]*dt*Ct*rt,ut+=f[ft+1+m]*dt*lt*ct,ut+=f[ft+1+m+p]*dt*lt*rt,d[w]=ut}}else for(let I=0;I<256;I++)for(let S=0;S<256;S++){const E=S*c[1]+I*c[2]+c[3],V=S*c[5]+I*c[6]+c[7],T=S*c[9]+I*c[10]+c[11];for(let R=0;R<256;R++){const N=Math.round(R*x+E),O=Math.round(R*b+V),G=Math.round(R*M+T);w++,!(N<0||O<0||G<0)&&(N>=m||O>=g||G>=A||(d[w]=f[y(N,O,G)]))}}let D=0;r&&(D=NaN);let v=new Uint8Array;if(s){const I=await this.getScale(e,0,1,D),S=await this.scalecropFloat32(d,0,1,I[0],I[1]);v=await this.createNiftiArray([256,256,256],[1,1,1],Array.from(a),16,new Uint8Array(S.buffer))}else{const I=await this.getScale(e,0,255,D),S=await this.scalecropUint8(d,0,255,I[0],I[1]);v=await this.createNiftiArray([256,256,256],[1,1,1],Array.from(a),2,S)}return await this.niftiArray2NVImage(v)}setRenderDrawAmbientOcclusion(e){if(!this.renderShader)throw new Error("renderShader undefined");this.renderDrawAmbientOcclusion=e,this.renderShader.use(this.gl),this.gl.uniform1fv(this.renderShader.uniforms.renderDrawAmbientOcclusion,[this.renderDrawAmbientOcclusion,1]),this.drawScene()}setColorMap(e,t){this.setColormap(e,t)}setColormapNegative(e,t){const i=this.getVolumeIndexByID(e);this.volumes[i].colormapNegative=t,this.updateGLVolume()}setModulationImage(e,t,i=0){const s=this.getVolumeIndexByID(e);let r=null;t.length>0&&(r=this.getVolumeIndexByID(t)),this.volumes[s].modulationImage=r,this.volumes[s].modulateAlpha=i,this.updateGLVolume()}setGamma(e=1){this.scene.gamma=e,mt.gamma=e,this.updateGLVolume()}async loadDeferred4DVolumes(e){const t=this.getVolumeIndexByID(e),i=this.volumes[t];if(i.nTotalFrame4D<=i.nFrame4D)return;i.nTotalFrame4D=i.nFrame4D;let s;i.fileObject?s=await Rt.loadFromFile({file:i.fileObject}):s=await Rt.loadFromUrl({url:i.url}),s&&(i.img=s.img.slice(),i.nTotalFrame4D=s.nTotalFrame4D,i.nFrame4D=s.nFrame4D,this.updateGLVolume())}setFrame4D(e,t){const i=this.getVolumeIndexByID(e),s=this.volumes[i];t>s.nFrame4D-1&&(t=s.nFrame4D-1),t<0&&(t=0),t!==s.frame4D&&(s.frame4D=t,this.updateGLVolume(),this.onFrameChange(s,t),this.createOnLocationChange())}getFrame4D(e){const t=this.getVolumeIndexByID(e);return this.volumes[t].frame4D}colormapFromKey(e){return mt.colormapFromKey(e)}colormap(e="",t=!1){return mt.colormap(e,t)}createColormapTexture(e=null,t=0,i=256){return e!==null&&this.gl.deleteTexture(e),t<1||i<1?null:(e=this.gl.createTexture(),this.gl.activeTexture(mi),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.texStorage2D(this.gl.TEXTURE_2D,1,this.gl.RGBA8,i,t),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),e)}addColormapList(e="",t=NaN,i=NaN,s=!1,r=!1,n=!0,o=!1){e.length<1&&(n=!1),this.colormapLists.push({name:e,min:t,max:i,isColorbarFromZero:s,negative:r,visible:n,invert:o})}refreshColormaps(){if(this.colormapLists=[],this.volumes.length<1&&this.meshes.length<1)return;const e=this.volumes.length;if(e>0)for(let n=0;n<e;n++){const o=this.volumes[n],l=ji(o.cal_min,o.cal_max,o.cal_minNeg,o.cal_maxNeg),a=o.colormapType!==0;this.addColormapList(o.colormapNegative,l[0],l[1],a,!0,o.colorbarVisible,o.colormapInvert),this.addColormapList(o.colormap,o.cal_min,o.cal_max,a,!1,o.colorbarVisible,o.colormapInvert)}const t=this.meshes.length;if(t>0)for(let n=0;n<t;n++){const o=this.meshes[n];if(!o.colorbarVisible)continue;const l=o.layers.length;if("edgeColormap"in o&&"edges"in o&&o.edges!==void 0){const a=ji(o.edgeMin,o.edgeMax,NaN,NaN);this.addColormapList(o.edgeColormapNegative,a[0],a[1],!1,!0,!0,o.colormapInvert),this.addColormapList(o.edgeColormap,o.edgeMin,o.edgeMax,!1,!1,!0,o.colormapInvert)}if(!(l<1))for(let a=0;a<l;a++){const c=this.meshes[n].layers[a];if(!c.colorbarVisible||c.colormap.length<1)continue;const h=c.colormapType!==0,d=ji(c.cal_min,c.cal_max,c.cal_minNeg,c.cal_maxNeg);this.addColormapList(c.colormapNegative,d[0],d[1],h,!0,!0,c.colormapInvert),this.addColormapList(c.colormap,c.cal_min,c.cal_max,h,!1,!0,c.colormapInvert)}}const i=this.colormapLists.length;if(i<1)return;this.colormapTexture=this.createColormapTexture(this.colormapTexture,i+1);let s=new Uint8ClampedArray;function r(n){const o=new Uint8ClampedArray(s.length+n.length);o.set(s),o.set(n,s.length),s=o}for(let n=0;n<i;n++)r(Array.from(this.colormap(this.colormapLists[n].name,this.colormapLists[n].invert)));return r(Array.from(this.drawLut.lut)),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,256,i+1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,s),this}sliceScale(e=!1){var n;let t=this.screenFieldOfViewMM(0);e&&(t=this.screenFieldOfViewVox(0));const i=Math.max(t[0],Math.max(t[1],t[2])),s=[t[0]/i,t[1]/i,t[2]/i];if(!((n=this.back)!=null&&n.dims))throw new Error("back.dims undefined");const r=[this.back.dims[1],this.back.dims[2],this.back.dims[3]];return{volScale:s,vox:r,longestAxis:i,dimsMM:t}}tileIndex(e,t){for(let i=0;i<this.screenSlices.length;i++){const s=this.screenSlices[i].leftTopWidthHeight;if(e>s[0]&&t>s[1]&&e<s[0]+s[2]&&t<s[1]+s[3])return i}return-1}inRenderTile(e,t){const i=this.tileIndex(e,t);return i>=0&&this.screenSlices[i].axCorSag===4?i:-1}sliceScroll3D(e=0){if(e!==0){if(this.volumes.length>0&&this.scene.clipPlaneDepthAziElev[0]<1.8){const t=this.scene.clipPlaneDepthAziElev.slice();return e>0&&(t[0]=Math.min(1.5,t[0]+.025)),e<0&&(t[0]=Math.max(-1.5,t[0]-.025)),t[0]!==this.scene.clipPlaneDepthAziElev[0]?(this.scene.clipPlaneDepthAziElev=t,this.setClipPlane(this.scene.clipPlaneDepthAziElev)):void 0}e>0&&(this.scene.volScaleMultiplier=Math.min(2,this.scene.volScaleMultiplier*1.1)),e<0&&(this.scene.volScaleMultiplier=Math.max(.5,this.scene.volScaleMultiplier*.9)),this.drawScene()}}deleteThumbnail(){this.bmpTexture&&(this.gl.deleteTexture(this.bmpTexture),this.bmpTexture=null,this.thumbnailVisible=!1)}inGraphTile(e,t){if(this.graph.opacity<=0||this.volumes.length<1||this.volumes[0].nFrame4D<1||!this.graph.plotLTWH||this.graph.plotLTWH[2]<1||this.graph.plotLTWH[3]<1)return!1;const i=[(e-this.graph.LTWH[0])/this.graph.LTWH[2],(t-this.graph.LTWH[1])/this.graph.LTWH[3]];return i[0]>0&&i[1]>0&&i[0]<=1&&i[1]<=1}updateBitmapFromClickToSegment(){if(this.clickToSegmentGrowingBitmap===null||this.drawBitmap===null||this.clickToSegmentGrowingBitmap.length!==this.drawBitmap.length)return;const e=this.drawBitmap.length;for(let t=0;t<e;t++)this.drawBitmap[t]=this.clickToSegmentGrowingBitmap[t]}sumBitmap(e){let t=0;for(let i=0;i<e.length;i++)t+=e[i];return t}mouseClick(e,t,i=0,s=!0){if(e*=this.uiData.dpr,t*=this.uiData.dpr,this.canvas.focus(),this.thumbnailVisible){this.thumbnailVisible=!1,Promise.all([this.loadVolumes(this.deferredVolumes),this.loadMeshes(this.deferredMeshes)]).catch(r=>{throw r});return}if(this.inGraphTile(e,t)){if(!this.graph.plotLTWH)throw new Error("plotLTWH undefined");const r=[(e-this.graph.plotLTWH[0])/this.graph.plotLTWH[2],(t-this.graph.plotLTWH[1])/this.graph.plotLTWH[3]];if(r[0]>0&&r[1]>0&&r[0]<=1&&r[1]<=1){const n=Math.round(r[0]*(this.volumes[0].nFrame4D-1));this.setFrame4D(this.volumes[0].id,n);return}r[0]>.5&&r[1]>1&&this.loadDeferred4DVolumes(this.volumes[0].id).catch(n=>{throw n});return}if(this.inRenderTile(e,t)>=0){this.sliceScroll3D(i),this.drawScene();return}if(!(this.screenSlices.length<1||this.gl.canvas.height<1||this.gl.canvas.width<1))for(let r=0;r<this.screenSlices.length;r++){const n=this.screenSlices[r].axCorSag;if(this.drawPenAxCorSag>=0&&this.drawPenAxCorSag!==n||n>2)continue;let o=this.screenXY2TextureFrac(e,t,r,!1);if(!(o[0]<0)){if(!s){this.scene.crosshairPos[2-n]=i,this.drawScene();return}if(i!==0){let l=1;i<0&&(l=-1);const a=[0,0,0];a[2-n]=l,this.moveCrosshairInVox(a[0],a[1],a[2]),this.drawScene(),this.createOnLocationChange(n);return}if(this.opts.isForceMouseClickToVoxelCenters?this.scene.crosshairPos=We(this.vox2frac(this.frac2vox(o))):this.scene.crosshairPos=We(o),this.opts.drawingEnabled){let l=this.frac2vox(this.scene.crosshairPos);if(this.opts.clickToSegment){o=this.screenXY2TextureFrac(this.clickToSegmentXY[0],this.clickToSegmentXY[1],r,!1),l=this.frac2vox(o);let a=0,c=this.opts.clickToSegmentPercent+a;if(this.uiData.mousedown){const u=(this.clickToSegmentXY[0]-e)/this.gl.canvas.width,m=(this.clickToSegmentXY[1]-t)/this.gl.canvas.height;a=Math.max(Math.abs(u),Math.abs(m)),c=this.opts.clickToSegmentPercent+a}let h=this.back.getValue(l[0],l[1],l[2]);this.opts.clickToSegmentAutoIntensity&&(c!==0&&(h===0&&(h=.01),this.opts.clickToSegmentIntensityMax=h*(1+c),this.opts.clickToSegmentIntensityMin=h*(1-c)),h>(this.back.cal_min+this.back.cal_max)*.5?this.opts.clickToSegmentBright=!0:this.opts.clickToSegmentBright=!1);const d=this.opts.clickToSegmentBright?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;if(this.drawPenAxCorSag=n,this.drawPenAxCorSag===0){const u=[this.back.pixDimsRAS[0],this.back.pixDimsRAS[1]],m=Math.min(...u);this.opts.penSize=Math.ceil(this.opts.clickToSegmentRadius/m)}else if(this.drawPenAxCorSag===1){const u=[this.back.pixDimsRAS[0],this.back.pixDimsRAS[2]],m=Math.min(...u);this.opts.penSize=Math.ceil(this.opts.clickToSegmentRadius/m)}else if(this.drawPenAxCorSag===2){const u=[this.back.pixDimsRAS[1],this.back.pixDimsRAS[2]],m=Math.min(...u);this.opts.penSize=Math.ceil(this.opts.clickToSegmentRadius/m)}if(this.drawPt(l[0],l[1],l[2],this.opts.penValue),a!==0?(this.clickToSegmentIsGrowing=!0,this.clickToSegmentGrowingBitmap=this.drawBitmap.slice()):this.clickToSegmentIsGrowing=!1,this.drawFloodFill([l[0],l[1],l[2]],0,d,this.opts.clickToSegmentIntensityMin,this.opts.clickToSegmentIntensityMax,this.opts.floodFillNeighbors,this.opts.clickToSegmentMaxDistanceMM,this.opts.clickToSegmentIs2D),this.drawScene(),this.createOnLocationChange(n),this.clickToSegmentIsGrowing)return;const f=this.getDescriptives({layer:0,masks:[],drawingIsMask:!0});this.onClickToSegment({mL:f.volumeML,mm3:f.volumeMM3});return}if(!isFinite(this.opts.penValue)||this.opts.penValue<0||Object.is(this.opts.penValue,-0)){isFinite(this.opts.penValue)?this.drawFloodFill(l,Math.abs(this.opts.penValue),this.opts.penValue,NaN,NaN,this.opts.floodFillNeighbors):this.drawFloodFill(l,0,this.opts.penValue,NaN,NaN,this.opts.floodFillNeighbors);return}if(isNaN(this.drawPenLocation[0]))this.drawPenAxCorSag=n,this.drawPenFillPts=[],this.drawPt(...l,this.opts.penValue);else{if(l[0]===this.drawPenLocation[0]&&l[1]===this.drawPenLocation[1]&&l[2]===this.drawPenLocation[2])return;this.drawPenLine(l,this.drawPenLocation,this.opts.penValue)}this.drawPenLocation=l,this.opts.isFilledPen&&this.drawPenFillPts.push(l),this.refreshDrawing(!1)}this.drawScene(),this.createOnLocationChange(n);return}}}drawRuler(){let e=[],t=[];for(let h=0;h<this.screenSlices.length;h++)if(this.screenSlices[h].axCorSag!==4&&this.screenSlices[h].fovMM.length>1){t=this.screenSlices[h].leftTopWidthHeight,e=this.screenSlices[h].fovMM;break}if(t.length<4)return;const s=100/e[0]*t[2],r=Math.max(Math.round(s*.1),2),n=Math.floor(t[0]+.5*t[2]-.5*s),o=Number(this.opts.rulerWidth),l=Math.floor(t[1]+t[3]-r)+.5*o,a=[n,l,n+s,l];let c=[0,0,0,1];this.opts.rulerColor[0]+this.opts.rulerColor[1]+this.opts.rulerColor[2]<.8&&(c=[1,1,1,1]),this.drawRuler10cm(a,c,o+1),this.drawRuler10cm(a,this.opts.rulerColor,o)}drawRuler10cm(e,t,i=1){if(!this.lineShader)throw new Error("lineShader undefined");this.gl.bindVertexArray(this.genericVAO),this.lineShader.use(this.gl),this.gl.uniform4fv(this.lineShader.uniforms.lineColor,t),this.gl.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.lineShader.uniforms.thickness,i),this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,e),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4);const s=-.1*(e[0]-e[2]),r=e[1]-Math.floor(.5*this.opts.rulerWidth),n=Math.floor(r-.35*s),o=Math.floor(r-.7*s);for(let l=0;l<11;l++){let a=e[0]+l*s;a=Math.max(a,e[0]+.5*i),a=Math.min(a,e[2]-.5*i);const c=[a,r,a,n];l%5===0&&(c[3]=o),this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,c),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}this.gl.bindVertexArray(this.unusedVAO)}screenXY2mm(e,t,i=-1){let s;for(let r=0;r<this.screenSlices.length;r++){let n=r;if(i>=0&&(n=i),this.screenSlices[n].axCorSag>2)continue;const l=this.screenSlices[n].leftTopWidthHeight;if(e<l[0]||t<l[1]||e>l[0]+l[2]||t>l[1]+l[3]||(s=this.screenXY2TextureFrac(e,t,n,!1),s[0]<0))continue;const a=this.frac2mm(s);return xt(a[0],a[1],a[2],n)}return xt(NaN,NaN,NaN,NaN)}dragForPanZoom(e){const t=this.screenXY2mm(e[2],e[3]);if(isNaN(t[0]))return;const i=this.screenXY2mm(e[0],e[1],t[3]);if(isNaN(i[0])||isNaN(t[0])||isNaN(t[3]))return;const s=ne(),r=this.uiData.pan2DxyzmmAtMouseDown[3];pn(s,t,i),this.scene.pan2Dxyzmm[0]=this.uiData.pan2DxyzmmAtMouseDown[0]+r*s[0],this.scene.pan2Dxyzmm[1]=this.uiData.pan2DxyzmmAtMouseDown[1]+r*s[1],this.scene.pan2Dxyzmm[2]=this.uiData.pan2DxyzmmAtMouseDown[2]+r*s[2],this.canvas.focus()}dragForCenterButton(e){this.dragForPanZoom(e)}dragForSlicer3D(e){let t=this.uiData.pan2DxyzmmAtMouseDown[3];const i=e[3]-e[1];t+=i*.01,t=Math.max(t,.1),t=Math.min(t,10);const r=this.scene.pan2Dxyzmm[3]-t;this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=t),this.scene.pan2Dxyzmm[3]=t;const n=this.frac2mm(this.scene.crosshairPos);this.scene.pan2Dxyzmm[0]+=r*n[0],this.scene.pan2Dxyzmm[1]+=r*n[1],this.scene.pan2Dxyzmm[2]+=r*n[2]}drawMeasurementTool(e){function t(a,c,h,d,f){const u=a-h,m=c-d;if(u===0&&m===0)return{origin:[h+f,d],terminus:[h+f,d]};const g=Math.sqrt(u*u+m*m),A=f*u/g,p=f*m/g;return{origin:[a+A,c+p],terminus:[h-A,d-p]}}const i=this.gl;if(i.bindVertexArray(this.genericVAO),i.depthFunc(i.ALWAYS),i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),!this.lineShader)throw new Error("lineShader undefined");this.lineShader.use(this.gl),i.uniform4fv(this.lineShader.uniforms.lineColor,this.opts.rulerColor),i.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[i.canvas.width,i.canvas.height]),i.uniform1f(this.lineShader.uniforms.thickness,this.opts.rulerWidth),i.uniform4fv(this.lineShader.uniforms.startXYendXY,e),i.drawArrays(i.TRIANGLE_STRIP,0,4);const s=this.opts.measureLineColor;s[3]=1,i.uniform4fv(this.lineShader.uniforms.lineColor,s);const r=this.opts.rulerWidth;i.uniform1f(this.lineShader.uniforms.thickness,r*2);let n=[e[0],e[1]-r,e[0],e[1]+r];i.uniform4fv(this.lineShader.uniforms.startXYendXY,n),i.drawArrays(i.TRIANGLE_STRIP,0,4),n=[e[2],e[3]-r,e[2],e[3]+r],i.uniform4fv(this.lineShader.uniforms.startXYendXY,n),i.drawArrays(i.TRIANGLE_STRIP,0,4);let o=this.canvasPos2frac([e[0],e[1]]),l=this.canvasPos2frac([e[2],e[3]]);if(o[0]>=0&&l[0]>=0){const a=this.frac2mm(o);o=Q(a[0],a[1],a[2]);const c=this.frac2mm(l);l=Q(c[0],c[1],c[2]);const h=pt();Es(h,o,l);const d=Je(h);let f=2;d>9&&(f=1),d>99&&(f=0);let u=d.toFixed(f);this.opts.showMeasureUnits&&(u=`${u} mm`);let m=e;const[g,A,p,w]=e,{origin:y,terminus:x}=t(g,A,p,w,30);switch(this.opts.measureTextJustify){case"start":m=[...y,...y.map(b=>b+1)];break;case"end":m=m=[...x,...x.map(b=>b+1)];break;default:m=e;break}this.drawTextBetween(m,u,this.opts.measureTextHeight/this.opts.textHeight,this.opts.measureTextColor)}i.bindVertexArray(this.unusedVAO)}drawRect(e,t=[1,0,0,-1]){if(t[3]<0&&(t=this.opts.crosshairColor),!this.rectShader)throw new Error("rectShader undefined");this.opts.selectionBoxIsOutline?(this.drawCircle(e,t,.1),this.rectOutlineShader.use(this.gl),this.gl.enable(this.gl.BLEND),this.gl.uniform1f(this.rectOutlineShader.uniforms.thickness,this.opts.selectionBoxLineThickness),this.gl.uniform4fv(this.rectOutlineShader.uniforms.lineColor,t),this.gl.uniform2fv(this.rectOutlineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform4f(this.rectOutlineShader.uniforms.leftTopWidthHeight,e[0],e[1],e[2],e[3]),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)):(this.rectShader.use(this.gl),this.gl.enable(this.gl.BLEND),this.gl.uniform4fv(this.rectShader.uniforms.lineColor,t),this.gl.uniform2fv(this.rectShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform4f(this.rectShader.uniforms.leftTopWidthHeight,e[0],e[1],e[2],e[3]),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO))}drawCircle(e,t=this.opts.fontColor,i=1){if(!this.circleShader)throw new Error("circleShader undefined");this.circleShader.use(this.gl),this.gl.enable(this.gl.BLEND),this.gl.uniform4fv(this.circleShader.uniforms.circleColor,t),this.gl.uniform2fv(this.circleShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform4f(this.circleShader.uniforms.leftTopWidthHeight,e[0],e[1],e[2],e[3]),this.gl.uniform1f(this.circleShader.uniforms.fillPercent,i),this.gl.uniform4fv(this.circleShader.uniforms.circleColor,t),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}drawSelectionBox(e){if(this.opts.dragMode===6){this.drawCircle(e,this.opts.selectionBoxColor,.1);return}this.drawRect(e,this.opts.selectionBoxColor)}effectiveCanvasHeight(){return this.gl.canvas.height-this.colorbarHeight}effectiveCanvasWidth(){return this.gl.canvas.width-this.getLegendPanelWidth()}getAllLabels(){const s=this.meshes.filter(n=>n.type==="connectome").flatMap(n=>n.nodes).map(n=>n.label).filter(n=>n!==void 0);return[...this.document.labels,...s]}getConnectomeLabels(){const s=this.meshes.filter(o=>o.type==="connectome").flatMap(o=>o.nodes).map(o=>o.label).filter(o=>o!==void 0),r=this.document.labels.filter(o=>o.anchor==null||o.anchor===0),n=new Set(s);for(const o of r)n.add(o);return Array.from(n)}getBulletMarginWidth(){let e=0;const t=this.getConnectomeLabels();if(t.length===0)return 0;const i=t.length===1?t[0].style.bulletScale:t.reduce((n,o)=>n.style.bulletScale>o.style.bulletScale?n:o).style.bulletScale,s=t.length===1?t[0]:t.reduce((n,o)=>{const l=this.opts.textHeight*this.gl.canvas.height*n.style.textScale,a=this.opts.textHeight*this.gl.canvas.height*o.style.textScale;return this.textHeight(l,n.text)>this.textHeight(a,o.text)?n:o}),r=this.opts.textHeight*this.gl.canvas.height*s.style.textScale;return e=this.textHeight(r,s.text)*i,e+=r,e}getLegendPanelWidth(){const e=this.getConnectomeLabels();if(!this.opts.showLegend||e.length===0)return 0;const i=this.opts.textHeight*this.gl.canvas.height*1;let s=0;const r=e.reduce((a,c)=>{const h=this.opts.textHeight*this.gl.canvas.height*a.style.textScale,d=this.opts.textHeight*this.gl.canvas.height*c.style.textScale;return this.textWidth(h,a.text)>this.textWidth(d,c.text)?a:c}),n=this.opts.textHeight*this.gl.canvas.height*r.style.textScale,o=this.textWidth(n,r.text),l=this.getBulletMarginWidth();return o&&(s=l+o,s+=i*2),s>=this.gl.canvas.width?0:s}getLegendPanelHeight(){const e=this.getConnectomeLabels();let t=0;const s=this.opts.textHeight*this.gl.canvas.height*1;for(const r of e){const n=this.opts.textHeight*this.gl.canvas.height*r.style.textScale,o=this.textHeight(n,r.text);t+=o}return t&&(t+=s/2*(e.length+1)),t}reserveColorbarPanel(){let e=Math.max(this.opts.textHeight,.01);e=e*Math.min(this.gl.canvas.height,this.gl.canvas.width);const t=3*e,i=[0,this.gl.canvas.height-t,this.gl.canvas.width,t];return this.colorbarHeight=i[3]+1,i}drawColorbarCore(e=0,t=[0,0,0,0],i=!1,s=0,r=1,n){if(t[2]<=0||t[3]<=0)return;let o=Math.max(this.opts.textHeight,.01);o=o*Math.min(this.gl.canvas.height,this.gl.canvas.width);let l=o;const a=3*o;let c=o;if(t[3]<a){if(t[3]<3)return;l=1,c=t[3]-2}this.gl.disable(this.gl.DEPTH_TEST),this.colorbarHeight=t[3]+1;const h=[t[0]+l,t[1],t[2]-2*l,c],d=[h[0]-1,h[1]-1,h[2]+2,h[3]+2];if(this.drawRect(d,this.opts.crosshairColor),!this.colorbarShader)throw new Error("colorbarShader undefined");this.colorbarShader.use(this.gl),this.gl.activeTexture(mi),this.gl.bindTexture(this.gl.TEXTURE_2D,this.colormapTexture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST);const f=e;if(this.gl.uniform1f(this.colorbarShader.uniforms.layer,f),this.gl.uniform2fv(this.colorbarShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.disable(this.gl.CULL_FACE),i){const M=[h[0]+h[2],h[1],-h[2],h[3]];this.gl.uniform4fv(this.colorbarShader.uniforms.leftTopWidthHeight,M)}else this.gl.uniform4fv(this.colorbarShader.uniforms.leftTopWidthHeight,h);this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);let u=0;if(n&&r<0&&i?(u=r,r=0):n&&s>0&&(u=s,s=0),s===r||o<1)return;const m=Math.abs(r-s);let[g,A]=Hs(s,r);A<s&&(A+=g);function p(M){return M.toFixed(6).replace(/\.?0*$/,"")}let w=A;const y=[0,h[1]+h[3]-o*.5,2,o*.75],x=y[1]+y[3],b=1;for(;w<=r;){y[0]=h[0]+(w-s)/m*h[2],this.drawRect(y);const M=p(b*w);this.drawTextBelow([y[0],x],M),w+=g}if(u!==0){const M=[h[0]+(u-s)/m*h[2],h[1]-h[3]*.25,2,h[3]*1.5];this.drawRect(M)}}drawColorbar(){const e=this.colormapLists,t=e.length;if(t<1)return;let i=0;for(let l=0;l<t;l++)e[l].visible&&i++;if(i<1)return;let s=this.reserveColorbarPanel(),r=Math.max(this.opts.textHeight,.01);r=r*Math.min(this.gl.canvas.height,this.gl.canvas.width);const n=3*r;let o=s[2]/i;(s[2]<=0||s[3]<=0)&&(o=this.gl.canvas.width/i,s=[0,this.gl.canvas.height-n,o,n]),s[2]=o;for(let l=0;l<t;l++)e[l].visible&&(this.drawColorbarCore(l,s,e[l].negative,e[l].min,e[l].max,e[l].isColorbarFromZero),s[0]+=o)}textWidth(e,t){if(!t)return 0;let i=0;const s=new TextEncoder().encode(t);for(let r=0;r<t.length;r++)i+=e*this.fontMets.mets[s[r]].xadv;return i}textHeight(e,t){if(!t)return 0;const i=new Set(Array.from(t)),s=new TextEncoder().encode(Array.from(i).join("")),n=Object.values(this.fontMets.mets).filter((o,l)=>s.includes(l)).reduce((o,l)=>o.lbwh[3]>l.lbwh[3]?o:l).lbwh[3];return e*n}drawChar(e,t,i){if(!this.fontShader)throw new Error("fontShader undefined");const s=this.fontMets.mets[i],r=e[0]+t*s.lbwh[0],n=-(t*s.lbwh[1]),o=t*s.lbwh[2],l=t*s.lbwh[3],a=e[1]+(n-l)+t;return this.gl.uniform4f(this.fontShader.uniforms.leftTopWidthHeight,r,a,o,l),this.gl.uniform4fv(this.fontShader.uniforms.uvLeftTopWidthHeight,s.uv_lbwh),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),t*s.xadv}drawLoadingText(e){if(e){if(!this.canvas)throw new Error("canvas undefined");this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.enable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.drawTextBelow([this.canvas.width/2,this.canvas.height/2],e,3)}}drawText(e,t,i=1,s=null){if(this.opts.textHeight<=0)return;if(!this.fontShader)throw new Error("fontShader undefined");this.fontShader.use(this.gl);const r=this.opts.textHeight*Math.min(this.gl.canvas.height,this.gl.canvas.width)*i;this.gl.enable(this.gl.BLEND),this.gl.uniform2f(this.fontShader.uniforms.canvasWidthHeight,this.gl.canvas.width,this.gl.canvas.height),s===null&&(s=this.opts.fontColor),this.gl.uniform4fv(this.fontShader.uniforms.fontColor,s);let n=r/this.fontMets.size*this.fontMets.distanceRange;n=Math.max(n,1),this.gl.uniform1f(this.fontShader.uniforms.screenPxRange,n);const o=new TextEncoder().encode(t);this.gl.bindVertexArray(this.genericVAO);for(let l=0;l<t.length;l++)e[0]+=this.drawChar(e,r,o[l]);this.gl.bindVertexArray(this.unusedVAO)}drawTextRight(e,t,i=1,s=null){this.opts.textHeight<=0||(e[1]-=.5*this.opts.textHeight*this.gl.canvas.height,this.drawText(e,t,i,s))}drawTextLeft(e,t,i=1,s=null){if(this.opts.textHeight<=0)return;const r=this.opts.textHeight*this.gl.canvas.height*i;e[0]-=this.textWidth(r,t),e[1]-=.5*r,this.drawText(e,t,i,s)}drawTextRightBelow(e,t,i=1,s=null){this.opts.textHeight<=0||this.drawText(e,t,i,s)}drawTextBetween(e,t,i=1,s=null){if(this.opts.textHeight<=0)return;const r=[(e[0]+e[2])*.5,(e[1]+e[3])*.5],n=this.opts.textHeight*this.gl.canvas.height*i,o=this.textWidth(n,t);r[0]-=.5*o,r[1]-=.5*n;const l=[r[0]-1,r[1]-1,o+2,n+2];let a=s;a===null&&(a=this.opts.crosshairColor),a&&a[0]+a[1]+a[2]>.8?a=[0,0,0,.5]:a=[1,1,1,.5],this.drawRect(l,a),this.drawText(r,t,i,s)}drawTextBelow(e,t,i=1,s=null){if(this.opts.textHeight<=0)return;if(!this.canvas)throw new Error("canvas undefined");let r=this.opts.textHeight*this.gl.canvas.height*i,n=this.textWidth(r,t);n>this.canvas.width&&(i*=(this.canvas.width-2)/n,r=this.opts.textHeight*this.gl.canvas.height*i,n=this.textWidth(r,t)),e[0]-=.5*this.textWidth(r,t),e[0]=Math.max(e[0],1),e[0]=Math.min(e[0],this.canvas.width-n-1),this.drawText(e,t,i,s)}updateInterpolation(e,t=!1){let i=this.gl.LINEAR;!t&&this.opts.isNearestInterpolation&&(i=this.gl.NEAREST),e===0?this.gl.activeTexture(ui):this.gl.activeTexture(Ji),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,i),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,i)}setAtlasOutline(e){this.opts.atlasOutline=e,this.updateGLVolume(),this.drawScene()}setInterpolation(e){this.opts.isNearestInterpolation=e;const t=this.volumes.length;if(!(t<1)){for(let i=0;i<t;i++)this.updateInterpolation(i);this.drawScene()}}calculateMvpMatrix2D(e,t,i,s=1/0,r=0,n=0,o=0,l){this.gl.viewport(e[0],this.gl.canvas.height-(e[1]+e[3]),e[2],e[3]);let c=t[0],h=i[0],d=[c,t[1]],f=[h-c,i[1]-t[1]];l&&(d=[i[0],t[1]],f=[t[0]-i[0],i[1]-t[1]],c=-i[0],h=-t[0]);const u=2*Math.max(Math.abs(t[2]),Math.abs(i[2])),m=nt();let g=.01,A=u*8;if(s!==1/0){let M=l;o===0&&(n===0||n===180)&&(M=!M);let D=u*1.8-r;M||(D=u*1.8+r),g=D-s,A=D+s}ni(m,c,h,t[1],i[1],g,A);const p=nt();p[0]=-1;const w=Q(0,0,-u*1.8);Be(p,p,w),si(p,p,ae(270-o)),ri(p,p,ae(n-180));const y=nt();zt(y,p);const x=nt();Ht(x,y);const b=nt();return ce(b,m,p),{modelViewProjectionMatrix:b,modelMatrix:p,normalMatrix:x,leftTopMM:d,fovMM:f}}swizzleVec3MM(e,t){return t===1?e=Ut(e,[0,2,1]):t===2&&(e=Ut(e,[1,2,0])),e}screenFieldOfViewVox(e=0){const t=We(this.volumeObject3D.fieldOfViewDeObliqueMM);return this.swizzleVec3MM(t,e)}screenFieldOfViewMM(e=0,t=!1){if(!t&&!this.opts.isSliceMM)return this.screenFieldOfViewVox(e);const i=this.volumeObject3D.extentsMin,s=this.volumeObject3D.extentsMax;let r=Q(i[0],i[1],i[2]),n=Q(s[0],s[1],s[2]);r=this.swizzleVec3MM(r,e),n=this.swizzleVec3MM(n,e);const o=pt();return bt(o,n,r),o}screenFieldOfViewExtendedVox(e=0){const t=this.volumes[0].extentsMinOrtho,i=this.volumes[0].extentsMaxOrtho;let s=Q(t[0],t[1],t[2]),r=Q(i[0],i[1],i[2]);const n=nt();s=this.swizzleVec3MM(s,e),r=this.swizzleVec3MM(r,e);const o=pt();return bt(o,r,s),{mnMM:s,mxMM:r,rotation:n,fovMM:o}}screenFieldOfViewExtendedMM(e=0){if(!this.volumeObject3D)throw new Error("volumeObject3D undefined");const t=this.volumeObject3D.extentsMin,i=this.volumeObject3D.extentsMax;let s=Q(t[0],t[1],t[2]),r=Q(i[0],i[1],i[2]);const n=nt();s=this.swizzleVec3MM(s,e),r=this.swizzleVec3MM(r,e);const o=pt();return bt(o,r,s),{mnMM:s,mxMM:r,rotation:n,fovMM:o}}drawSliceOrientationText(e,t,i=[NaN,NaN]){this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height);let s="S";t===0&&(s="A");let r=this.opts.isRadiologicalConvention?"R":"L";if(t===2&&(r=this.opts.sagittalNoseLeft?"A":"P"),this.opts.isCornerOrientationText){this.drawTextRightBelow([e[0],e[1]],r+s);return}let n=!0,o=!0;if(!isNaN(i[0])){const l=this.opts.textHeight*this.gl.canvas.height+2;i[1]>l&&(this.drawTextBelow([e[0]+e[2]*.5,e[1]+i[1]-l],s),n=!1);const a=this.textWidth(l,r)+2;i[0]>a&&(this.drawTextRight([e[0]+i[0]-a,e[1]+e[3]*.5],r),o=!1)}n&&this.drawTextBelow([e[0]+e[2]*.5,e[1]],s),o&&this.drawTextRight([e[0],e[1]+e[3]*.5],r)}xyMM2xyzMM(e,t){let i=2;e===1&&(i=1),e===2&&(i=0);let s=[0,0,0],r=[1,1,0],n=[1,0,1];s[i]=t,r[i]=t,n[i]=t,s=this.frac2mm(s),r=this.frac2mm(r),n=this.frac2mm(n),s=this.swizzleVec3MM(Q(s[0],s[1],s[2]),e),r=this.swizzleVec3MM(Q(r[0],r[1],r[2]),e),n=this.swizzleVec3MM(Q(n[0],n[1],n[2]),e);const o=(r[0]-s[0])*(n[1]-s[1])-(n[0]-s[0])*(r[1]-s[1]);let l=(r[0]-s[0])*(n[2]-s[2])-(n[0]-s[0])*(r[2]-s[2]);l/=o;let a=(r[1]-s[1])*(n[2]-s[2])-(n[1]-s[1])*(r[2]-s[2]);a/=o;const c=[0,0,0,0,0];return c[0]=s[0],c[1]=s[1],c[2]=s[2],c[3]=a,c[4]=l,c}draw2DMain(e,t,i=NaN){let s=this.volumes[0].frac2mm.slice(),r=this.screenFieldOfViewExtendedMM(t),n=nt();this.opts.isSliceMM||(s=this.volumes[0].frac2mmOrtho.slice(),n=It(this.volumes[0].mm2ortho),r=this.screenFieldOfViewExtendedVox(t));let o=this.opts.isRadiologicalConvention&&t<2;i===1/0||i===-1/0?(o=i!==1/0,t===1&&(o=!o)):this.opts.sagittalNoseLeft&&t===2&&(o=!o);let l=0,a=0;t===2?a=o?90:-90:t===1?a=o?180:0:(a=o?180:0,l=o?-90:90);const c=this.gl;let h=!1;if(e[2]===0||e[3]===0){h=!0;const p=c.canvas.width/r.fovMM[0],w=c.canvas.height/r.fovMM[1],y=Math.min(p,w),x=p/y,b=w/y;r.fovMM[0]*=x,r.fovMM[1]*=b;let M=(r.mnMM[0]+r.mxMM[0])*.5;r.mnMM[0]=M-r.fovMM[0]*.5,r.mxMM[0]=M+r.fovMM[0]*.5,M=(r.mnMM[1]+r.mxMM[1])*.5,r.mnMM[1]=M-r.fovMM[1]*.5,r.mxMM[1]=M+r.fovMM[1]*.5,e=[0,0,c.canvas.width,c.canvas.height]}if(isNaN(i)){const p=this.scene.pan2Dxyzmm,w=this.swizzleVec3MM(Q(p[0],p[1],p[2]),t),y=this.scene.pan2Dxyzmm[3];r.mnMM[0]-=w[0],r.mxMM[0]-=w[0],r.mnMM[1]-=w[1],r.mxMM[1]-=w[1],r.mnMM[0]/=y,r.mxMM[0]/=y,r.mnMM[1]/=y,r.mxMM[1]/=y}let d=2;t===1&&(d=1),t===2&&(d=0);let f=this.scene.crosshairPos[d],u=this.frac2mm(this.scene.crosshairPos);!isNaN(i)&&i!==1/0&&i!==-1/0&&(u=this.frac2mm([.5,.5,.5]),u[d]=i,f=this.mm2frac(u)[d]);const m=u[d];c.clear(c.DEPTH_BUFFER_BIT);let g=this.calculateMvpMatrix2D(e,r.mnMM,r.mxMM,1/0,0,a,l,o);if(i===1/0||i===-1/0){const p=e.slice();this.draw3D(e,g.modelViewProjectionMatrix,g.modelMatrix,g.normalMatrix,a,l);const w=this.screenSlices[this.screenSlices.length-1];w.leftTopWidthHeight=p,w.axCorSag=t,w.sliceFrac=1/0,w.AxyzMxy=this.xyMM2xyzMM(t,f),w.leftTopMM=g.leftTopMM,w.fovMM=g.fovMM;return}c.enable(c.DEPTH_TEST),c.blendFunc(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA),c.disable(c.BLEND),c.depthFunc(c.GREATER),c.disable(c.CULL_FACE);let A=this.sliceMMShader;if(this.opts.isV1SliceShader&&(A=this.sliceV1Shader),!A)throw new Error("slice Shader undefined");if(A.use(this.gl),c.uniform1f(A.uniforms.overlayOutlineWidth,this.overlayOutlineWidth),c.uniform1f(A.uniforms.overlayAlphaShader,this.overlayAlphaShader),c.uniform1i(A.uniforms.isAlphaClipDark,this.isAlphaClipDark?1:0),c.uniform1i(A.uniforms.backgroundMasksOverlays,this.backgroundMasksOverlays),c.uniform1f(A.uniforms.drawOpacity,this.drawOpacity),c.enable(c.BLEND),c.blendFunc(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA),c.uniform1f(A.uniforms.opacity,this.volumes[0].opacity),c.uniform1i(A.uniforms.axCorSag,t),c.uniform1f(A.uniforms.slice,f),c.uniformMatrix4fv(A.uniforms.frac2mm,!1,s),c.uniformMatrix4fv(A.uniforms.mvpMtx,!1,g.modelViewProjectionMatrix.slice()),c.bindVertexArray(this.genericVAO),c.drawArrays(c.TRIANGLE_STRIP,0,4),c.bindVertexArray(this.unusedVAO),this.screenSlices.push({leftTopWidthHeight:e,axCorSag:t,sliceFrac:f,AxyzMxy:this.xyMM2xyzMM(t,f),leftTopMM:g.leftTopMM,screen2frac:[],fovMM:g.fovMM}),isNaN(i)&&this.drawCrosshairs3D(!0,1,g.modelViewProjectionMatrix,!0,this.opts.isSliceMM),this.opts.meshThicknessOn2D>0){this.opts.meshThicknessOn2D!==1/0&&(g=this.calculateMvpMatrix2D(e,r.mnMM,r.mxMM,this.opts.meshThicknessOn2D,m,a,l,o));const p=It(g.modelViewProjectionMatrix);ce(p,p,n),this.drawMesh3D(!0,1,p,g.modelMatrix,g.normalMatrix)}isNaN(i)&&this.drawCrosshairs3D(!1,.15,g.modelViewProjectionMatrix,!0,this.opts.isSliceMM),h&&this.drawSliceOrientationText(e,t),this.readyForSync=!0}draw2D(e,t,i=NaN,s=[NaN,NaN]){const r=[NaN,NaN];if(s[0]===1/0){const n=this.sliceScale().volScale;let o=this.scaleSlice(n[0],n[1],[0,0],[e[2],e[3]]);t===1&&(o=this.scaleSlice(n[0],n[2],[0,0],[e[2],e[3]])),t===2&&(o=this.scaleSlice(n[1],n[2],[0,0],[e[2],e[3]])),s[0]=o[2],s[1]=o[3]}if(isNaN(s[0]))this.draw2DMain(e,t,i);else{const n=e.slice();r[0]=Math.floor(.5*(n[2]-s[0])),r[1]=Math.floor(.5*(n[3]-s[1])),n[0]+=r[0],n[1]+=r[1],n[2]=s[0],n[3]=s[1],this.draw2DMain(n,t,i)}i===1/0||i===-1/0||t===4||e[2]!==0&&e[3]!==0&&this.drawSliceOrientationText(e,t,r)}calculateMvpMatrix(e,t=[0,0,0,0],i,s){(t[2]===0||t[3]===0)&&(t=[0,0,this.gl.canvas.width,this.gl.canvas.height]);const r=t[2]/t[3];let n=this.furthestFromPivot;const o=this.pivot3D,l=nt();n=.8*n/this.scene.volScaleMultiplier,r<1?ni(l,-n,n,-n/r,n/r,n*.01,n*8):ni(l,-n*r,n*r,-n,n,n*.01,n*8);const a=nt();a[0]=-1;const c=Q(0,0,-n*1.8);Be(a,a,c),this.position&&Be(a,a,this.position),si(a,a,ae(270-s)),ri(a,a,ae(i-180)),Be(a,a,[-o[0],-o[1],-o[2]]);const h=nt();zt(h,a);const d=nt();Ht(d,h);const f=nt();return ce(f,l,a),[f,a,d]}calculateModelMatrix(e,t){if(!this.back)throw new Error("back undefined");const i=nt();if(i[0]=-1,si(i,i,ae(270-t)),ri(i,i,ae(e-180)),this.back.obliqueRAS){const s=It(this.back.obliqueRAS);ce(i,i,s)}return i}calculateRayDirection(e,t){const i=this.calculateModelMatrix(e,t),s=Qt(1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1),r=nt();ce(r,s,i);const n=nt();zt(n,r);const o=xt(0,0,-1,1);Tt(o,o,n);const l=Q(o[0],o[1],o[2]);Xt(l,l);const a=5e-5;return Math.abs(l[0])<a&&(l[0]=a),Math.abs(l[1])<a&&(l[1]=a),Math.abs(l[2])<a&&(l[2]=a),l}sceneExtentsMinMax(e=!0){let t=Q(0,0,0),i=Q(0,0,0);if(this.volumes.length>0){if(!this.volumeObject3D)throw new Error("volumeObject3D undefined");t=Q(this.volumeObject3D.extentsMin[0],this.volumeObject3D.extentsMin[1],this.volumeObject3D.extentsMin[2]),i=Q(this.volumeObject3D.extentsMax[0],this.volumeObject3D.extentsMax[1],this.volumeObject3D.extentsMax[2]),e||(t=Q(this.volumes[0].extentsMinOrtho[0],this.volumes[0].extentsMinOrtho[1],this.volumes[0].extentsMinOrtho[2]),i=Q(this.volumes[0].extentsMaxOrtho[0],this.volumes[0].extentsMaxOrtho[1],this.volumes[0].extentsMaxOrtho[2]))}if(this.meshes.length>0){if(this.volumes.length<1){const r=this.meshes[0].extentsMin,n=this.meshes[0].extentsMax;t=Q(r[0],r[1],r[2]),i=Q(n[0],n[1],n[2])}for(let r=0;r<this.meshes.length;r++){const n=this.meshes[r].extentsMin,o=this.meshes[r].extentsMax,l=Q(n[0],n[1],n[2]);os(t,t,l);const a=Q(o[0],o[1],o[2]);as(i,i,a)}}const s=pt();return bt(s,i,t),[t,i,s]}setPivot3D(){const[e,t]=this.sceneExtentsMinMax(),i=pt();xe(i,e,t),fn(i,i,.5),this.pivot3D=[i[0],i[1],i[2]],bt(i,t,e),this.extentsMin=e,this.extentsMax=t,this.furthestFromPivot=he(i)*.5}getMaxVols(){if(this.volumes.length<1)return 0;let e=0;for(let t=0;t<this.volumes.length;t++)e=Math.max(e,this.volumes[t].nFrame4D);return e}detectPartialllyLoaded4D(){if(this.volumes.length<1)return!1;for(let e=0;e<this.volumes.length;e++)if(this.volumes[e].nFrame4D<this.volumes[e].hdr.dims[4])return!0;return!1}drawGraph(){if(this.getMaxVols()<2)return;const e=this.graph;let t=0;if(this.graph.autoSizeMultiplanar&&this.opts.sliceType===3)for(let V=0;V<this.screenSlices.length;V++){const T=this.screenSlices[V].axCorSag;if(T===0&&(t=this.screenSlices[V].leftTopWidthHeight[1]),T!==2)continue;const R=this.screenSlices[V].leftTopWidthHeight.slice();R[1]===t?(e.LTWH[0]=R[0]+R[2],e.LTWH[1]=R[1]):(e.LTWH[0]=R[0],e.LTWH[1]=R[1]+R[3]),e.LTWH[2]=R[2],e.LTWH[3]=R[2]}if(e.opacity<=0||e.LTWH[2]<=5||e.LTWH[3]<=5||Math.floor(e.LTWH[0]+e.LTWH[2])>this.gl.canvas.width||Math.floor(e.LTWH[1]+e.LTWH[3])>this.gl.canvas.height)return;e.backColor=[.15,.15,.15,e.opacity],e.lineColor=[1,1,1,1],this.opts.backColor[0]+this.opts.backColor[1]+this.opts.backColor[2]>1.5&&(e.backColor=[.95,.95,.95,e.opacity],e.lineColor=[0,0,0,1]),e.textColor=e.lineColor.slice(),e.lineThickness=4,e.lineAlpha=1,e.lines=[];const i=[];if(e.vols.length<1)this.volumes[0]!=null&&i.push(0);else for(let V=0;V<e.vols.length;V++){const T=e.vols[V];this.volumes[T]==null||this.volumes[T].nFrame4D<2||i.push(T)}if(i.length<1)return;const s=this.volumes[i[0]].nFrame4D;if(this.graph.selectedColumn=this.volumes[i[0]].frame4D,s<2){P.debug("Unable to generate a graph: Selected volume is 3D not 4D");return}for(let V=0;V<i.length;V++){e.lines[V]=[];const T=this.frac2vox(this.scene.crosshairPos),R=this.volumes[i[V]];let N=R.nFrame4D;N=Math.min(N,s);for(let O=0;O<N;O++){const G=R.getValue(T[0],T[1],T[2],O);e.lines[V].push(G)}}e.lineRGB=[[1,0,0],[0,.7,0],[0,0,1],[1,1,0],[1,0,1],[0,1,1],[1,1,1],[0,0,0]];let r=e.lines[0][0],n=e.lines[0][0];for(let V=0;V<e.lines.length;V++)for(let T=0;T<e.lines[V].length;T++){const R=e.lines[V][T];r=Math.min(R,r),n=Math.max(R,n)}const o=this.volumes[i[0]].cal_min,l=this.volumes[i[0]].cal_max;if(e.isRangeCalMinMax&&o<l&&isFinite(o)&&isFinite(l)&&(r=o,n=l),e.normalizeValues&&n>r){const V=n-r;for(let T=0;T<e.lines.length;T++)for(let R=0;R<e.lines[T].length;R++){const N=e.lines[T][R];e.lines[T][R]=(N-r)/V}r=0,n=1}r>=n&&(n=r+1),this.drawRect(e.LTWH,e.backColor);const[a,c,h]=Hs(r,n),d=Math.max(0,-1*Math.floor(Math.log(a)/Math.log(10)));r=Math.min(c,r),n=Math.max(h,n);function f(V){return V.toFixed(6).replace(/\.?0*$/,"")}const m=.07*(Math.min(e.LTWH[2],e.LTWH[3])/(this.fontMets.size*this.uiData.dpr));let g=this.opts.textHeight*this.gl.canvas.height*m;g<16&&(g=0);let A=0,p=c;if(g>0)for(;p<=n;){const V=p.toFixed(d),T=this.textWidth(g,V);A=Math.max(T,A),p+=a}const w=.05,y=Math.abs(e.LTWH[2]),x=Math.abs(e.LTWH[3]),b=[e.LTWH[0]+w*y+A,e.LTWH[1]+w*x,e.LTWH[2]-A-2*w*y,e.LTWH[3]-g-2*w*x];this.graph.LTWH=e.LTWH,this.graph.plotLTWH=b,this.drawRect(b,this.opts.backColor);const M=n-r,D=b[3]/M,v=b[2]/(e.lines[0].length-1),C=b[1]+b[3];p=c+.5*a;const I=e.lineColor.slice();for(I[3]=.25*e.lineColor[3];p<=n;){const V=C-(p-r)*D;this.drawLine([b[0],V,b[0]+b[2],V],.5*e.lineThickness,I),p+=a}p=c;const S=.5*e.lineThickness;for(;p<=n;){const V=C-(p-r)*D;this.drawLine([b[0]-S,V,b[0]+b[2]+e.lineThickness,V],e.lineThickness,e.lineColor);const T=p.toFixed(d);g>0&&this.drawTextLeft([b[0]-6,V],T,m,e.textColor),p+=a}let E=1;for(;e.lines[0].length/E>20;)E*=5;for(let V=0;V<e.lines[0].length;V+=E){const T=V*v+b[0];let R=e.lineThickness;if(V%2===1)R*=.5,this.drawLine([T,b[1],T,b[1]+b[3]],R,I);else{const N=f(V);g>0&&this.drawTextBelow([T,2+b[1]+b[3]],N,m,e.textColor),this.drawLine([T,b[1],T,b[1]+b[3]],R,e.lineColor)}}for(let V=0;V<e.lines.length;V++){let T=[1,0,0,e.lineAlpha];V<e.lineRGB.length&&(T=[e.lineRGB[V][0],e.lineRGB[V][1],e.lineRGB[V][2],e.lineAlpha]);for(let R=1;R<e.lines[V].length;R++){const N=(R-1)*v,O=R*v,G=(e.lines[V][R-1]-r)*D,z=(e.lines[V][R]-r)*D,q=[b[0]+N,b[1]+b[3]-G,b[0]+O,b[1]+b[3]-z];this.drawLine(q,e.lineThickness,T)}}if(e.selectedColumn>=0&&e.selectedColumn<e.lines[0].length){const V=e.selectedColumn*v+b[0];this.drawLine([V,b[1],V,b[1]+b[3]],e.lineThickness,[e.lineRGB[3][0],e.lineRGB[3][1],e.lineRGB[3][2],1])}this.detectPartialllyLoaded4D()&&this.drawTextBelow([b[0]+b[2],b[1]+b[3]+g*.5],"...",m,e.textColor)}depthPicker(e,t){if(!this.uiData.mouseDepthPicker)return;this.uiData.mouseDepthPicker=!1;const i=this.gl,s=this.mousePos[0]*e[2]/e[2],r=i.canvas.height-this.mousePos[1]*e[3]/e[3]-1,n=new Uint8Array(4);if(i.readPixels(s,r,1,1,i.RGBA,i.UNSIGNED_BYTE,n),this.selectedObjectId=n[3],this.selectedObjectId===this.VOLUME_ID){this.scene.crosshairPos=new Float32Array(n.slice(0,3)).map(d=>d/255);return}const o=Dl(n);if(o>1)return;const l=(this.mousePos[0]-e[0])/e[2],a=(i.canvas.height-this.mousePos[1]-e[1])/e[3],c=Cl(l,a,o,t),h=this.mm2frac(c,0,!0);h[0]<0||h[0]>1||h[1]<0||h[1]>1||h[2]<0||h[2]>1||(this.scene.crosshairPos=this.mm2frac(c,0,!0))}drawImage3D(e,t,i){if(this.volumes.length===0)return;const s=this.gl,r=this.calculateRayDirection(t,i),n=this.volumeObject3D;if(n){s.enable(s.BLEND),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA),s.enable(s.CULL_FACE),s.cullFace(s.FRONT);let o=this.renderShader;if(this.uiData.mouseDepthPicker&&(o=this.pickingImageShader),o.use(this.gl),s.uniform1i(o.uniforms.backgroundMasksOverlays,this.backgroundMasksOverlays),this.gradientTextureAmount>0){s.activeTexture(_s),s.bindTexture(s.TEXTURE_3D,this.gradientTexture);const l=this.calculateModelMatrix(t,i),a=nt();zt(a,l);const c=nt();Ht(c,a),s.uniformMatrix4fv(o.uniforms.normMtx,!1,c)}this.drawBitmap&&this.drawBitmap.length>8?s.uniform2f(o.uniforms.renderDrawAmbientOcclusionXY,this.renderDrawAmbientOcclusion,this.drawOpacity):s.uniform2f(o.uniforms.renderDrawAmbientOcclusionXY,this.renderDrawAmbientOcclusion,0),s.uniformMatrix4fv(o.uniforms.mvpMtx,!1,e),s.uniformMatrix4fv(o.uniforms.matRAS,!1,this.back.matRAS),s.uniform3fv(o.uniforms.rayDir,r),this.gradientTextureAmount<0?s.uniform4fv(o.uniforms.clipPlane,[this.scene.crosshairPos[0],this.scene.crosshairPos[1],this.scene.crosshairPos[2],30]):s.uniform4fv(o.uniforms.clipPlane,this.scene.clipPlane),s.uniform1f(o.uniforms.drawOpacity,1),s.bindVertexArray(n.vao),s.drawElements(n.mode,n.indexCount,s.UNSIGNED_SHORT,0),s.bindVertexArray(this.unusedVAO)}}drawOrientationCube(e,t=0,i=0){if(!this.opts.isOrientCube)return;const s=.05*Math.min(e[2],e[3]);if(s<5)return;const r=this.gl;r.enable(r.CULL_FACE),r.cullFace(r.BACK),this.orientCubeShader.use(this.gl),r.bindVertexArray(this.orientCubeShaderVAO);const n=nt(),o=nt();ni(o,0,r.canvas.width,0,r.canvas.height,-10*s,10*s);let l=0;e[1]===0&&(l=r.canvas.height-this.effectiveCanvasHeight()),Be(n,n,[1.8*s+e[0],l+1.8*s+e[1],0]),Ds(n,n,[s,s,s]),si(n,n,ae(270-i)),ri(n,n,ae(-t));const a=nt();ce(a,o,n),r.uniformMatrix4fv(this.orientCubeShader.uniforms.u_matrix,!1,a),r.drawArrays(r.TRIANGLE_STRIP,0,168),r.bindVertexArray(this.unusedVAO),this.gl.disable(this.gl.CULL_FACE)}createOnLocationChange(e=NaN){const[t,i,s]=this.sceneExtentsMinMax(!0),r=Math.max(Math.max(s[0],s[1]),s[2]);function n(d){return Math.max(0,-Math.ceil(Math.log10(Math.abs(d))))}let o=n(r*.001);const l=this.frac2mm(this.scene.crosshairPos,0,!0);function a(d,f=0){return parseFloat(d.toFixed(f))}let c=a(l[0],o)+""+a(l[1],o)+""+a(l[2],o);if(this.volumes.length>0&&this.volumes[0].nFrame4D>0&&(c+=""+a(this.volumes[0].frame4D)),this.volumes.length>0){let d=" = ";for(let m=0;m<this.volumes.length;m++){const g=this.volumes[m].mm2vox(l);let A=this.volumes[m].getValue(g[0],g[1],g[2],this.volumes[m].frame4D);if(o=3,this.volumes[m].colormapLabel!==null){const p=Math.round(A);p>=0&&p<this.volumes[m].colormapLabel.labels.length?d+=this.volumes[m].colormapLabel.labels[p]:d+="undefined("+a(A,o)+")"}else d+=a(A,o);this.volumes[m].imaginary&&(A=this.volumes[m].getValue(g[0],g[1],g[2],this.volumes[m].frame4D,!0),A>=0&&(d+="+"),d+=a(A,o)),d+="   "}c+=d;const f=this.back.dimsRAS,u=f[1]*f[2]*f[3];if(this.drawBitmap&&this.drawBitmap.length===u){const m=this.frac2vox(this.scene.crosshairPos),g=m[0]+m[1]*f[1]+m[2]*f[1]*f[2];c+=" "+this.drawLut.labels[this.drawBitmap[g]]}}const h={mm:this.frac2mm(this.scene.crosshairPos,0,!0),axCorSag:e,vox:this.frac2vox(this.scene.crosshairPos),frac:this.scene.crosshairPos,xy:[this.mousePos[0],this.mousePos[1]],values:this.volumes.map(d=>{const f=this.frac2mm(this.scene.crosshairPos,0,!0),u=d.mm2vox(f),m=d.getValue(u[0],u[1],u[2],d.frame4D);return{name:d.name,value:m,id:d.id,mm:f,vox:u}}),string:c};this.onLocationChange(h)}addLabel(e,t,i,s,r){const n={textColor:this.opts.legendTextColor,textScale:1,textAlignment:"left",lineWidth:0,lineColor:this.opts.legendTextColor,lineTerminator:"none",bulletScale:0,bulletColor:this.opts.legendTextColor},o=t?{...n,...t}:{...n},l=new Yr(e,{...o},i,s,r);return this.document.labels.push(l),l}calculateScreenPoint(e,t,i){const s=ne();return Tt(s,[...e,1],t),s[3]!==0&&(s[0]=(s[0]/s[3]+1)*.5*i[2],s[1]=(1-s[1]/s[3])*.5*i[3],s[2]/=s[3],s[0]+=i[0],s[1]+=i[1]),s}getLabelAtPoint(e){const i=this.opts.textHeight*Math.min(this.gl.canvas.height,this.gl.canvas.width)*1,s=this.opts.textHeight*this.gl.canvas.height*1;for(const c of this.document.labels){if(c.anchor==null||c.anchor===0)continue;const h=this.opts.textHeight*this.gl.canvas.height*c.style.textScale,d=this.textHeight(h,c.text),f=this.textWidth(h,c.text);if(!(c.anchor&1&&e[0]>f)&&!(c.anchor&2&&(e[0]<(this.gl.canvas.width-f)/2||e[0]>(this.gl.canvas.width+f)/2))&&!(c.anchor&4&&e[0]<this.gl.canvas.width-f)&&!(c.anchor&8&&(e[1]<s/2||e[1]>d+s/2))&&!(c.anchor&16&&(e[1]<(this.gl.canvas.height-d-s)/2||e[1]>(this.gl.canvas.height+d-s/2)/2))&&!(c.anchor&32&&(e[1]<this.gl.canvas.height-d-s||e[1]>this.gl.canvas.height-s/2)))return c}P.debug("screenPoint",e);const r=this.getLegendPanelHeight(),n=this.getLegendPanelWidth(),o=this.gl.canvas.width-n;let l=(this.canvas.height-r)/2;if(P.debug("panelrect",o,l,o+n,l+r),e[0]<o||e[1]<l||e[0]>o+n||e[1]>l+r)return null;const a=this.getConnectomeLabels();for(const c of a){const h=this.opts.textHeight*this.gl.canvas.height*c.style.textScale,d=this.textHeight(h,c.text);if(e[1]>=l&&e[1]<=l+d+i/2)return c;l+=d,l+=i/2}return null}drawLabelLine(e,t,i,s,r=!1){const n=Array.isArray(e.points)&&Array.isArray(e.points[0])?e.points:[e.points];for(const o of n){const l=this.calculateScreenPoint(o,i,s);r?this.drawDottedLine([...t,l[0],l[1]],e.style.lineWidth,e.style.lineColor):this.draw3DLine(t,[l[0],l[1],l[2]],e.style.lineWidth,e.style.lineColor)}}draw3DLabel(e,t,i,s,r,n,o){const l=e.text,a=t[0],c=t[1],h=this.opts.textHeight*Math.min(this.gl.canvas.height,this.gl.canvas.width)*1,d=this.textHeight(e.style.textScale,l)*h;if(e.style.lineWidth>0&&Array.isArray(e.points)&&this.drawLabelLine(e,[a,c+d],i,s,o),e.style.bulletScale){const u=e.style.bulletScale*d,m=d-u,g=c+m/2+u/2,A=a+(r-u)/2;this.drawCircle([A,g,u,u],e.style.bulletColor)}let f=a;if(n)if(e.style.textAlignment!=="left"){const u=this.textWidth(e.style.textScale,e.text)*h;if(e.style.textAlignment==="right")f=a+n-h*1.5-u;else{const m=n-(r||h);f+=(m-u)/2}}else f+=r;this.drawText([f,c],l,e.style.textScale,e.style.textColor)}draw3DLabels(e,t,i=!1){const s=this.getConnectomeLabels();if(!this.opts.showLegend||s.length===0)return;if(!this.canvas)throw new Error("canvas undefined");const r=this.gl;r.disable(r.CULL_FACE),r.viewport(0,0,this.canvas.width,this.canvas.height);const o=this.opts.textHeight*Math.min(this.gl.canvas.height,this.gl.canvas.width)*1,l=this.getBulletMarginWidth(),a=this.getLegendPanelHeight(),c=this.getLegendPanelWidth(),h=r.canvas.width-c;let d=(this.canvas.height-a)/2;this.drawRect([r.canvas.width-c,d,c-o,a],this.opts.legendBackgroundColor);const f=r.getParameter(r.BLEND),u=r.getParameter(r.DEPTH_FUNC);i||(r.disable(r.BLEND),r.depthFunc(r.GREATER));for(const m of s){this.draw3DLabel(m,[h,d],e,t,l,c,i);const g=this.opts.textHeight*this.gl.canvas.height*m.style.textScale,A=this.textHeight(g,m.text);d+=A,d+=o/2}i||(r.depthFunc(u),f&&r.enable(r.BLEND))}drawAnchoredLabels(){const e=this.opts.textHeight*Math.min(this.gl.canvas.height,this.gl.canvas.width)*1,t=this.document.labels.filter(i=>i.anchor!=null&&i.anchor!==0);for(const i of t){const s=i.text,r=this.textHeight(i.style.textScale,s)*e,n=this.textWidth(i.style.textScale,s)*e;let o,l;const c=this.opts.textHeight*this.gl.canvas.height*1,h=c;let d=c/4,f=0,u=0;i.anchor&1&&(o=0),i.anchor&4&&(o=this.canvas.width-n,f-=c/4),i.anchor&2&&(o=(this.canvas.width-n)/2,f-=c/4,d+=c/4),i.anchor&8&&(l=0),i.anchor&16&&(l=(this.canvas.height-r-c)/2,u-=c/4),i.anchor&32&&(l=this.canvas.height-r-c,u-=c/4),this.drawRect([o+f,l+u,n+d,r+h],i.style.backgroundColor),this.draw3DLabel(i,[o,l])}}draw3D(e=[0,0,0,0],t=null,i=null,s=null,r=null,n=0){const o=r!==null;this.setPivot3D(),o||(r=this.scene.renderAzimuth,n=this.scene.renderElevation);const l=this.gl;t===null&&([t,i,s]=this.calculateMvpMatrix(null,e,r,n));let a=[...e];if(e[2]===0||e[3]===0?(e=[0,0,l.canvas.width,l.canvas.height],a=[...e],this.screenSlices.push({leftTopWidthHeight:e,axCorSag:4,sliceFrac:0,AxyzMxy:[],leftTopMM:[],fovMM:[Ws(i),0]})):(this.screenSlices.push({leftTopWidthHeight:e.slice(),axCorSag:4,sliceFrac:0,AxyzMxy:[],leftTopMM:[],fovMM:[Ws(i),0]}),e[1]=l.canvas.height-e[3]-e[1]),l.enable(l.DEPTH_TEST),l.depthFunc(l.ALWAYS),l.depthMask(!0),l.clearDepth(0),this.draw3DLabels(t,a,!1),l.viewport(e[0],e[1],e[2],e[3]),this.volumes.length>0&&(this.updateInterpolation(0,!0),this.updateInterpolation(1,!0),this.drawImage3D(t,r,n)),this.updateInterpolation(0),this.updateInterpolation(1),o||this.drawCrosshairs3D(!0,1,t),this.drawMesh3D(!0,1,t,i,s),this.uiData.mouseDepthPicker){this.depthPicker(e,t),this.createOnLocationChange(),this.draw3D(e,t,i,s,r,n);return}this.opts.meshXRay>0&&this.drawMesh3D(!1,this.opts.meshXRay,t,i,s),this.draw3DLabels(t,a,!1),l.viewport(e[0],e[1],e[2],e[3]),o||this.drawCrosshairs3D(!1,.15,t),l.viewport(0,0,l.canvas.width,l.canvas.height),this.drawOrientationCube(e,r,n);const c="azimuth: "+this.scene.renderAzimuth.toFixed(0)+" elevation: "+this.scene.renderElevation.toFixed(0);return this.readyForSync=!0,this.sync(),this.draw3DLabels(t,a,!0),c}drawMesh3D(e=!0,t=1,i,s,r){if(this.meshes.length<1)return;const n=this.gl;i||([i,s,r]=this.calculateMvpMatrix(this.volumeObject3D,void 0,this.scene.renderAzimuth,this.scene.renderElevation)),n.enable(n.DEPTH_TEST),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),n.disable(n.BLEND),n.depthFunc(n.GREATER),n.disable(n.CULL_FACE),e?(n.disable(n.BLEND),n.depthFunc(n.GREATER)):(n.enable(n.BLEND),n.depthFunc(n.ALWAYS),n.enable(n.CULL_FACE)),n.cullFace(n.BACK);let o=this.meshShaders[0].shader,l=!1;for(let a=0;a<this.meshes.length;a++)if(this.meshes[a].visible!==!1&&(o=this.meshShaders[this.meshes[a].meshShaderIndex].shader,this.uiData.mouseDepthPicker&&(o=this.pickingMeshShader),o.use(this.gl),n.uniformMatrix4fv(o.uniforms.mvpMtx,!1,i),n.uniformMatrix4fv(o.uniforms.normMtx,!1,r),n.uniform1f(o.uniforms.opacity,t),!(this.meshes[a].indexCount<3))){if(this.meshes[a].offsetPt0&&(this.meshes[a].fiberSides<3||this.meshes[a].fiberRadius<=0)){l=!0;continue}o.isMatcap&&(n.activeTexture(Js),n.bindTexture(n.TEXTURE_2D,this.matCapTexture)),n.bindVertexArray(this.meshes[a].vao),n.drawElements(n.TRIANGLES,this.meshes[a].indexCount,n.UNSIGNED_INT,0),n.bindVertexArray(this.unusedVAO)}if(!l){n.enable(n.BLEND),n.depthFunc(n.ALWAYS);return}o=this.fiberShader,o.use(this.gl),n.uniformMatrix4fv(o.uniforms.mvpMtx,!1,i),n.uniform1f(o.uniforms.opacity,t);for(let a=0;a<this.meshes.length;a++)this.meshes[a].indexCount<3||this.meshes[a].offsetPt0&&(this.meshes[a].fiberSides>=3&&this.meshes[a].fiberRadius>0||(n.bindVertexArray(this.meshes[a].vaoFiber),n.drawElements(n.LINE_STRIP,this.meshes[a].indexCount,n.UNSIGNED_INT,0),n.bindVertexArray(this.unusedVAO)));n.enable(n.BLEND),n.depthFunc(n.ALWAYS),this.readyForSync=!0}drawCrosshairs3D(e=!0,t=1,i=null,s=!1,r=!0){var u,m;if(!this.opts.show3Dcrosshair&&!s||this.opts.crosshairWidth<=0&&s)return;const n=this.gl,o=this.frac2mm(this.scene.crosshairPos,0,r);let l=1;const[a,c,h]=this.sceneExtentsMinMax(r);if(this.volumes.length>0){if(!this.back)throw new Error("back undefined");l=.5*Math.min(Math.min(this.back.pixDims[1],this.back.pixDims[2]),this.back.pixDims[3])}else(h[0]<50||h[0]>1e3)&&(l=h[0]*.02);if(l*=this.opts.crosshairWidth,((u=this.opts)==null?void 0:u.crosshairWidthUnit)==="percent"&&(l=h[0]*this.opts.crosshairWidth*.5*.01),((m=this.opts)==null?void 0:m.crosshairWidthUnit)==="mm"&&(l=this.opts.crosshairWidth*.5),(this.crosshairs3D===null||this.crosshairs3D.mm[0]!==o[0]||this.crosshairs3D.mm[1]!==o[1]||this.crosshairs3D.mm[2]!==o[2])&&(this.crosshairs3D!==null&&(n.deleteBuffer(this.crosshairs3D.indexBuffer),n.deleteBuffer(this.crosshairs3D.vertexBuffer)),this.crosshairs3D=ve.generateCrosshairs(this.gl,1,o,a,c,l,20,this.opts.crosshairGap),this.crosshairs3D.mm=o),!this.surfaceShader)throw new Error("surfaceShader undefined");const d=this.surfaceShader;d.use(this.gl),i==null&&([i]=this.calculateMvpMatrix(this.crosshairs3D,void 0,this.scene.renderAzimuth,this.scene.renderElevation)),n.uniformMatrix4fv(d.uniforms.mvpMtx,!1,i),n.disable(n.CULL_FACE),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.crosshairs3D.indexBuffer),n.enable(n.DEPTH_TEST);const f=[...this.opts.crosshairColor];e?(n.disable(n.BLEND),n.depthFunc(n.GREATER)):(n.enable(n.BLEND),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),n.depthFunc(n.ALWAYS)),f[3]=t,n.uniform4fv(d.uniforms.surfaceColor,f),n.bindVertexArray(this.crosshairs3D.vao),n.drawElements(n.TRIANGLES,this.crosshairs3D.indexCount,n.UNSIGNED_INT,0),n.bindVertexArray(this.unusedVAO)}mm2frac(e,t=0,i=!1){if(this.volumes.length<1){const s=Q(.1,.5,.5),[r,n,o]=this.sceneExtentsMinMax();return s[0]=(e[0]-r[0])/o[0],s[1]=(e[1]-r[1])/o[1],s[2]=(e[2]-r[2])/o[2],isFinite(s)||(isFinite(s[0])||(s[0]=.5),isFinite(s[1])||(s[1]=.5),isFinite(s[2])||(s[2]=.5),this.meshes.length<1&&P.error("mm2frac() not finite: objects not (yet) loaded.")),s}return this.volumes[t].convertMM2Frac(e,i||this.opts.isSliceMM)}vox2frac(e,t=0){return this.volumes[t].convertVox2Frac(e)}frac2vox(e,t=0){return this.volumes.length<=t?[0,0,0]:this.volumes[t].convertFrac2Vox(e)}moveCrosshairInVox(e,t,i){const s=this.frac2vox(this.scene.crosshairPos);s[0]+=e,s[1]+=t,s[2]+=i,s[0]=Zi(s[0],0,this.volumes[0].dimsRAS[1]-1),s[1]=Zi(s[1],0,this.volumes[0].dimsRAS[2]-1),s[2]=Zi(s[2],0,this.volumes[0].dimsRAS[3]-1),this.scene.crosshairPos=this.vox2frac(s),this.createOnLocationChange(),this.drawScene()}frac2mm(e,t=0,i=!1){const s=xt(e[0],e[1],e[2],1);if(this.volumes.length>0)return this.volumes[t].convertFrac2MM(e,i||this.opts.isSliceMM);{const[r,n]=this.sceneExtentsMinMax(),o=(l,a,c)=>l*(1-c)+a*c;s[0]=o(r[0],n[0],e[0]),s[1]=o(r[1],n[1],e[1]),s[2]=o(r[2],n[2],e[2])}return s}screenXY2TextureFrac(e,t,i,s=!0){const r=Q(-1,-1,-1),n=this.screenSlices[i].axCorSag;if(n>2)return r;const o=this.screenSlices[i].leftTopWidthHeight.slice();let l=!1;o[2]<0&&(l=!0,o[0]+=o[2],o[2]=-o[2]);let a=(e-o[0])/o[2];l&&(a=1-a);const c=1-(t-o[1])/o[3];if(a<0||a>1||c<0||c>1||this.screenSlices[i].AxyzMxy.length<4)return r;let h=Q(0,0,0);h[0]=this.screenSlices[i].leftTopMM[0]+a*this.screenSlices[i].fovMM[0],h[1]=this.screenSlices[i].leftTopMM[1]+c*this.screenSlices[i].fovMM[1];const d=this.screenSlices[i].AxyzMxy;h[2]=d[2]+d[4]*(h[1]-d[1])-d[3]*(h[0]-d[0]),n===1&&(h=Ut(h,[0,2,1])),n===2&&(h=Ut(h,[2,0,1]));const f=this.mm2frac(h);return s&&(f[0]<0||f[0]>1||f[1]<0||f[1]>1||f[2]<0||f[2]>1)?r:f}canvasPos2frac(e){for(let t=0;t<this.screenSlices.length;t++){const i=this.screenXY2TextureFrac(e[0],e[1],t);if(i[0]>=0)return i}return[-1,-1,-1]}scaleSlice(e,t,i=[0,0],s=[0,0]){const r=s[0]===0?this.effectiveCanvasWidth()-i[0]:s[0]-i[0],n=s[1]===0?this.effectiveCanvasHeight()-i[1]:s[1]-i[1];let o=r/e;t*o>n&&(o=n/t);const l=e*o,a=t*o;return[(r-l)*.5,(n-a)*.5,l,a,o]}drawThumbnail(){if(!this.bmpShader)throw new Error("bmpShader undefined");this.bmpShader.use(this.gl),this.gl.uniform2f(this.bmpShader.uniforms.canvasWidthHeight,this.gl.canvas.width,this.gl.canvas.height);let e=this.gl.canvas.height,t=this.gl.canvas.height*this.bmpTextureWH;t>this.gl.canvas.width&&(e=this.gl.canvas.width/this.bmpTextureWH,t=this.gl.canvas.width),this.gl.uniform4f(this.bmpShader.uniforms.leftTopWidthHeight,0,0,t,e),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}drawLine(e,t=1,i=[1,0,0,-1]){if(this.gl.bindVertexArray(this.genericVAO),!this.lineShader)throw new Error("lineShader undefined");this.lineShader.use(this.gl),i[3]<0&&(i=this.opts.crosshairColor),this.gl.uniform4fv(this.lineShader.uniforms.lineColor,i),this.gl.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.lineShader.uniforms.thickness,t),this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,e),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}draw3DLine(e,t,i=1,s=[1,0,0,-1]){if(this.gl.bindVertexArray(this.genericVAO),!this.line3DShader)throw new Error("line3DShader undefined");this.line3DShader.use(this.gl),s[3]<0&&(s=this.opts.crosshairColor),this.gl.uniform4fv(this.line3DShader.uniforms.lineColor,s),this.gl.uniform2fv(this.line3DShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.line3DShader.uniforms.thickness,i),this.gl.uniform2fv(this.line3DShader.uniforms.startXY,e),this.gl.uniform3fv(this.line3DShader.uniforms.endXYZ,t),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}drawDottedLine(e,t=1,i=[1,0,0,-1]){if(this.gl.bindVertexArray(this.genericVAO),!this.lineShader)throw new Error("lineShader undefined");this.lineShader.use(this.gl);const s=i[3]<0?[...this.opts.crosshairColor]:[...i];s[3]=.3;const r=Ss(e[2]-e[0],e[3]-e[1]),n=Ts(r);wn(r,r);const l=this.opts.textHeight*Math.min(this.gl.canvas.height,this.gl.canvas.width)*1;vn(r,r,l/2);const a=Ts(r);let c=Math.floor(n/a);n%a&&c++;const h=[e[0],e[1]];this.gl.uniform4fv(this.lineShader.uniforms.lineColor,s),this.gl.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.lineShader.uniforms.thickness,t);for(let d=0;d<c-1;d++){if(d%2){h[0]+=r[0],h[1]+=r[1];continue}const f=[h[0],h[1],h[0]+r[0],h[1]+r[1]];this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,f),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),h[0]+=r[0],h[1]+=r[1]}this.gl.bindVertexArray(this.unusedVAO)}drawGraphLine(e,t=[1,0,0,.5],i=2){this.drawLine(e,i,t)}drawCrossLinesMM(e,t,i,s,r){if(e<0||this.screenSlices.length<=e)return;const n=this.screenSlices[e];let o=n.sliceFrac;o===1/0&&P.warn("Rendering approximate cross lines in world view mode"),o===1/0&&(o=.5);let a=s.slice(),c=r.slice();const h=Math.max(1,this.opts.crosshairWidth);t===1&&(a=i.slice()),t===2&&(a=i.slice(),c=s.slice());function d(f){const u=Ss(0,0);return u[0]=n.leftTopWidthHeight[0]+(f[0]-n.leftTopMM[0])/n.fovMM[0]*n.leftTopWidthHeight[2],u[1]=n.leftTopWidthHeight[1]+n.leftTopWidthHeight[3]-(f[1]-n.leftTopMM[1])/n.fovMM[1]*n.leftTopWidthHeight[3],u}if(a.length>0&&t===0){const f=o,u=1;for(let m=0;m<a.length;m++){const g=this.frac2mm([.5,.5,.5]);g[u]=a[m];let A=this.mm2frac(g);A=A[u];let p=this.frac2mm([0,A,f]);p=Ut(p,[0,1,2]);let w=this.frac2mm([1,A,f]);w=Ut(w,[0,1,2]),p=d(p),w=d(w),this.drawLine([p[0],p[1],w[0],w[1]],h)}}if(a.length>0&&t===1){const f=o,u=2;for(let m=0;m<a.length;m++){const g=this.frac2mm([.5,.5,.5]);g[u]=a[m];let A=this.mm2frac(g);A=A[u];let p=this.frac2mm([0,f,A]);p=Ut(p,[0,2,1]);let w=this.frac2mm([1,f,A]);w=Ut(w,[0,2,1]),p=d(p),w=d(w),this.drawLine([p[0],p[1],w[0],w[1]],h)}}if(a.length>0&&t===2){const f=o,u=2;for(let m=0;m<a.length;m++){const g=this.frac2mm([.5,.5,.5]);g[u]=a[m];let A=this.mm2frac(g);A=A[u];let p=this.frac2mm([f,0,A]);p=Ut(p,[1,2,0]);let w=this.frac2mm([f,1,A]);w=Ut(w,[1,2,0]),p=d(p),w=d(w),this.drawLine([p[0],p[1],w[0],w[1]],h)}}if(c.length>0&&t===0){const f=o,u=0;for(let m=0;m<c.length;m++){const g=this.frac2mm([.5,.5,.5]);g[u]=c[m];let A=this.mm2frac(g);A=A[u];let p=this.frac2mm([A,0,f]);p=Ut(p,[0,1,2]);let w=this.frac2mm([A,1,f]);w=Ut(w,[0,1,2]),p=d(p),w=d(w),this.drawLine([p[0],p[1],w[0],w[1]],h)}}if(c.length>0&&t===1){const f=o,u=0;for(let m=0;m<c.length;m++){const g=this.frac2mm([.5,.5,.5]);g[u]=c[m];let A=this.mm2frac(g);A=A[u];let p=this.frac2mm([A,f,0]);p=Ut(p,[0,2,1]);let w=this.frac2mm([A,f,1]);w=Ut(w,[0,2,1]),p=d(p),w=d(w),this.drawLine([p[0],p[1],w[0],w[1]],h)}}if(c.length>0&&t===2){const f=o,u=1;for(let m=0;m<c.length;m++){const g=this.frac2mm([.5,.5,.5]);g[u]=c[m];let A=this.mm2frac(g);A=A[u];let p=this.frac2mm([f,A,0]);p=Ut(p,[1,2,0]);let w=this.frac2mm([f,A,1]);w=Ut(w,[1,2,0]),p=d(p),w=d(w),this.drawLine([p[0],p[1],w[0],w[1]],h)}}}drawCrossLines(e,t,i,s,r){if(e<0||this.screenSlices.length<=e)return;if(this.opts.isSliceMM)return this.drawCrossLinesMM(e,t,i,s,r);if(this.screenSlices[e].sliceFrac===1/0)return this.drawCrossLinesMM(e,t,i,s,r);const n=this.screenSlices[e];let o=s.slice(),l=r.slice();if(t===1&&(o=i.slice()),t===2&&(o=i.slice(),l=s.slice()),o.length>0){const a=n.leftTopWidthHeight.slice();let c=2;t===0&&(c=1);const h=this.frac2mm([.5,.5,.5]);for(let d=0;d<o.length;d++){h[c]=o[d];const f=this.mm2frac(h);this.drawRect([a[0],a[1]+a[3]-f[c]*a[3],a[2],1])}}if(l.length>0){const a=n.leftTopWidthHeight.slice(),c=n.fovMM[0]<0;let h=0;t===2&&(h=1);const d=this.frac2mm([.5,.5,.5]);for(let f=0;f<l.length;f++){d[h]=l[f];const u=this.mm2frac(d);c?this.drawRect([a[0]+(a[2]-u[h]*a[2]),a[1],1,a[3]]):this.drawRect([a[0]+u[h]*a[2],a[1],1,a[3]])}}}drawMosaic(e){if(this.volumes.length===0){P.debug("Unable to draw mosaic until voxel-based image is loaded");return}this.screenSlices=[];const t=this.screenFieldOfViewMM(0,!0),i=this.screenFieldOfViewMM(0);e=e.replaceAll(";"," ;").trim();const s=[],r=[],n=[],o=e.split(/\s+/);let l=1;const a=this.opts.textHeight;let c=0,h=0;for(let d=0;d<2;d++){let f=!1,u=!1;f=!1;let m=0,g=0,A=0,p=0,w=!1,y=0;for(let M=0;M<o.length;M++){const D=o[M];if(D.includes("X")){u=!0;continue}if(D.includes("L")){w=!D.includes("-");continue}if(D.includes("V")||D.includes("H")){M++;continue}D.includes("A")&&(y=0),D.includes("C")&&(y=1),D.includes("S")&&(y=2),D.includes("R")&&(f=!0),D.includes(";")&&(A+=m,p=Math.max(p,g),m=0,g=0);const v=parseFloat(D);if(isNaN(v))continue;let C=0,I=0,S=i;if(f&&(S=t),y===2?C=S[1]:C=S[0],y===0?I=S[1]:I=S[2],d===0)f||(y===0&&s.push(v),y===1&&r.push(v),y===2&&n.push(v));else{const E=[c+l*g,h+l*A,l*C,l*I];if(this.opts.textHeight=w?a:0,f){let V=v<0?-1/0:1/0;Object.is(v,-0)&&(V=-1/0),this.draw2D(E,y,V)}else this.draw2D(E,y,v);u&&this.drawCrossLines(this.screenSlices.length-1,y,s,r,n),f=!1,u=!1}g+=C,m=Math.max(m,I)}if(A+=m,p=Math.max(p,g),p<=0||A<=0)break;const x=this.gl.canvas.width/p,b=this.effectiveCanvasHeight()/A;l=Math.min(x,b),this.opts.centerMosaic&&(c=Math.floor(.5*(this.gl.canvas.width-p*l)),h=Math.floor(.5*(this.effectiveCanvasHeight()-A*l)))}this.opts.textHeight=a}drawSceneCore(){var r,n,o;if(!this.initialized)return;if(this.colorbarHeight=0,this.gl.clearColor(this.opts.backColor[0],this.opts.backColor[1],this.opts.backColor[2],this.opts.backColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.bmpTexture&&this.thumbnailVisible){this.drawThumbnail();return}let e="";if(this.volumes.length===0||typeof this.volumes[0].dims>"u"){if(this.meshes.length>0){this.screenSlices=[],this.draw3D(),this.opts.isColorbar&&this.drawColorbar();return}this.drawLoadingText(this.opts.loadingText);return}if(this.back===null)return;if(this.uiData.isDragging&&this.scene.clipPlaneDepthAziElev[0]<1.8&&this.inRenderTile(this.uiData.dragStart[0],this.uiData.dragStart[1])>=0){const l=this.uiData.dragStart[0]-this.uiData.dragEnd[0],a=this.uiData.dragStart[1]-this.uiData.dragEnd[1],c=this.uiData.dragClipPlaneStartDepthAziElev.slice();if(c[1]-=l,c[1]=c[1]%360,c[2]+=a,c[1]!==this.scene.clipPlaneDepthAziElev[1]||c[2]!==this.scene.clipPlaneDepthAziElev[2])return this.scene.clipPlaneDepthAziElev=c,this.setClipPlane(this.scene.clipPlaneDepthAziElev)}if(this.sliceMosaicString.length<1&&this.opts.sliceType===4){this.opts.isColorbar&&this.reserveColorbarPanel(),this.screenSlices=[],this.draw3D(),this.opts.isColorbar&&this.drawColorbar();return}this.opts.isColorbar&&this.reserveColorbarPanel();const t=this.getMaxVols(),i=this.opts.sliceType===3&&t>1&&this.graph.autoSizeMultiplanar&&this.graph.opacity>0;if(this.sliceMosaicString.length>0)this.drawMosaic(this.sliceMosaicString);else{const l=[0,0];let a=!1;if(this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.screenSlices=[],this.opts.sliceType===0)this.draw2D([0,0,0,0],0);else if(this.opts.sliceType===1)this.draw2D([0,0,0,0],1);else if(this.opts.sliceType===2)this.draw2D([0,0,0,0],2);else{let c=function(G,z){return[(G-1)*m+G*g,(z-1)*m+z*g]},h=!1;this.opts.multiplanarForceRender?(h=!0,this.opts.multiplanarForceRender?this.opts.multiplanarShowRender=1:this.opts.multiplanarShowRender=2,delete this.opts.multiplanarForceRender):this.opts.multiplanarShowRender===1&&(h=!0);const d=isFinite(this.drawPenLocation[0])&&this.opts.drawingEnabled,{volScale:f}=this.sliceScale(),u=f.slice();this.opts.multiplanarEqualSize&&(f[0]=1,f[1]=1,f[2]=1),typeof this.opts.multiplanarPadPixels!="number"&&P.debug("multiplanarPadPixels must be numeric");const m=parseFloat(`${this.opts.multiplanarPadPixels}`);let g=this.opts.tileMargin;g<0&&(g=2*(2+Math.ceil(Math.max(this.opts.textHeight,.01)*Math.min(this.gl.canvas.height,this.gl.canvas.width))));let A=[this.effectiveCanvasWidth(),this.effectiveCanvasHeight()];this.opts.heroImageFraction>0&&this.opts.heroImageFraction<1&&(h=!1,a=!0,A[0]>A[1]&&this.opts.multiplanarLayout!==3?l[0]=A[0]*this.opts.heroImageFraction:l[1]=A[1]*this.opts.heroImageFraction,A=[A[0]-l[0],A[1]-l[1]]);const p=this.scaleSlice(f[0]+f[1],f[1]+f[2],c(2,2),A),w=Math.max(Math.max(f[1],f[2]),f[0]),y=this.scaleSlice(f[0]+f[0]+f[1],Math.max(f[1],f[2]),c(3,1),A),x=this.scaleSlice(f[0]+f[0]+f[1]+w,Math.max(f[1],f[2]),c(4,1),A),b=this.scaleSlice(w,f[1]+f[2]+f[2],c(1,3),A),M=this.scaleSlice(w,f[1]+f[2]+f[2]+w,c(1,4),A);let D=!d&&(t<2||!i),v=!1,C=!1,I=!1;this.opts.multiplanarLayout===1?v=!0:this.opts.multiplanarLayout===2?C=!0:this.opts.multiplanarLayout===3?I=!0:b[4]>y[4]&&b[4]>p[4]?v=!0:y[4]>p[4]?I=!0:C=!0;let S=p;if(v?(S=b,!a&&(h||this.opts.multiplanarShowRender===2&&M[4]>=b[4])?S=M:D=!1):I&&(S=y,!a&&(h||this.opts.multiplanarShowRender===2&&x[4]>=y[4])?S=x:D=!1),a){const G=l[0]===0?this.effectiveCanvasWidth():l[0],z=l[1]===0?this.effectiveCanvasHeight():l[1];if(((r=this.opts)==null?void 0:r.heroSliceType)===0||((n=this.opts)==null?void 0:n.heroSliceType)===1||((o=this.opts)==null?void 0:o.heroSliceType)===2)this.draw2D([0,0,G,z],this.opts.heroSliceType,NaN,[1/0,1/0]);else{const q=S.slice(),J=this.effectiveCanvasWidth();G===J&&(q[0]=0),this.draw3D([q[0],0,G,z])}S[0]+=l[0],S[1]+=l[1],D=!1}const E=f[0]*S[4]+g,V=f[1]*S[4]+g,T=f[2]*S[4]+g,R=u[0]*S[4],N=u[1]*S[4],O=u[2]*S[4];if(v){if(this.draw2D([S[0],S[1],E,V],0,NaN,[R,N]),this.draw2D([S[0],S[1]+V+m,E,T],1,NaN,[R,O]),this.draw2D([S[0],S[1]+V+m+T+m,V,T],2,NaN,[N,O]),D){const G=w*S[4];this.draw3D([S[0],S[1]+V+T+T+m*3,G,G])}}else if(I){if(this.draw2D([S[0],S[1],E,V],0,NaN,[R,N]),this.draw2D([S[0]+E+m,S[1],E,T],1,NaN,[R,O]),this.draw2D([S[0]+E+E+m*2,S[1],V,T],2,NaN,[N,O]),D){const G=w*S[4];this.draw3D([S[0]+E+E+V+m*3,S[1],G,G])}}else C&&(h||(D=!1),this.opts.multiplanarShowRender===2&&(D=!0),a&&(D=!1),this.draw2D([S[0],S[1]+T+m,E,V],0,NaN,[R,N]),this.draw2D([S[0],S[1],E,T],1,NaN,[R,O]),this.draw2D([S[0]+E+m,S[1],V,T],2,NaN,[N,O]),D&&this.draw3D([S[0]+E+m,S[1]+T+m,V,V]))}}if(this.opts.isRuler&&this.drawRuler(),this.opts.isColorbar&&this.drawColorbar(),i&&this.drawGraph(),this.uiData.isDragging){if(this.uiData.mouseButtonCenterDown){this.dragForCenterButton([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);return}if(this.opts.dragMode===4){this.dragForSlicer3D([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);return}if(this.opts.dragMode===3){this.dragForPanZoom([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);return}if(this.inRenderTile(this.uiData.dragStart[0],this.uiData.dragStart[1])>=0)return;if(this.opts.dragMode===2){this.drawMeasurementTool([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);return}const l=Math.abs(this.uiData.dragStart[0]-this.uiData.dragEnd[0]),a=Math.abs(this.uiData.dragStart[1]-this.uiData.dragEnd[1]);this.drawSelectionBox([Math.min(this.uiData.dragStart[0],this.uiData.dragEnd[0]),Math.min(this.uiData.dragStart[1],this.uiData.dragEnd[1]),l,a]);return}if(this.opts.clickToSegment){const l=this.mousePos[0],a=this.mousePos[1];if(this.inRenderTile(l,a)>=0)return;const c=this.tileIndex(l,a);if(c>-1){const h=this.screenSlices[c].fovMM,f=this.screenSlices[c].leftTopWidthHeight[2]/h[0],u=this.opts.crosshairColor,m=[u[0],u[1],u[2],.4],g=this.opts.clickToSegmentRadius*f;this.drawCircle([l-g,a-g,g*2,g*2],m,1)}}const s=this.frac2mm([this.scene.crosshairPos[0],this.scene.crosshairPos[1],this.scene.crosshairPos[2]]);return e=s[0].toFixed(2)+""+s[1].toFixed(2)+""+s[2].toFixed(2),this.readyForSync=!0,this.sync(),this.drawAnchoredLabels(),e}drawScene(){if(this.isBusy){this.needsRefresh=!0;return}this.isBusy=!1,this.needsRefresh=!1;let e=this.drawSceneCore();return this._gl!==null&&this.gl.finish(),this.needsRefresh&&(e=this.drawScene()),e}get gl(){if(!this._gl)throw new Error("unable to get WebGL context. Maybe the browser doesn't support WebGL2.");return this._gl}set gl(e){this._gl=e}};function Ft(e){return(t,...i)=>Ll(e,t,i)}function Oe(e,t){return Ft(Kr(e,t).get)}const{apply:Ll,getOwnPropertyDescriptor:Kr,getPrototypeOf:ms,ownKeys:Ol}=Reflect,{iterator:ei,toStringTag:kl}=Symbol,Gl=Object,{create:gs,defineProperty:Yl}=Gl,zl=Array,Kl=zl.prototype,qr=Kl[ei],ql=Ft(qr),Qr=ArrayBuffer,Ql=Qr.prototype;Oe(Ql,"byteLength");const ir=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:null;ir&&Oe(ir.prototype,"byteLength");const Hr=ms(Uint8Array);Hr.from;const Lt=Hr.prototype;Lt[ei];Ft(Lt.keys);Ft(Lt.values);Ft(Lt.entries);Ft(Lt.set);Ft(Lt.reverse);Ft(Lt.fill);Ft(Lt.copyWithin);Ft(Lt.sort);Ft(Lt.slice);Ft(Lt.subarray);Oe(Lt,"buffer");Oe(Lt,"byteOffset");Oe(Lt,"length");Oe(Lt,kl);const Hl=Uint8Array,Wr=Uint16Array,As=Uint32Array,Wl=Float32Array,_e=ms([][ei]()),Xr=Ft(_e.next),Xl=Ft(function*(){}().next),jl=ms(_e),Zl=DataView.prototype,Jl=Ft(Zl.getUint16),ps=WeakMap,jr=ps.prototype,Zr=Ft(jr.get),_l=Ft(jr.set),Jr=new ps,$l=gs(null,{next:{value:function(){const t=Zr(Jr,this);return Xr(t)}},[ei]:{value:function(){return this}}});function tc(e){if(e[ei]===qr&&_e.next===Xr)return e;const t=gs($l);return _l(Jr,t,ql(e)),t}const ec=new ps,ic=gs(jl,{next:{value:function(){const t=Zr(ec,this);return Xl(t)},writable:!0,configurable:!0}});for(const e of Ol(_e))e!=="next"&&Yl(ic,e,Kr(_e,e));const _r=new Qr(4),sc=new Wl(_r),rc=new As(_r),_t=new Wr(512),$t=new Hl(512);for(let e=0;e<256;++e){const t=e-127;t<-24?(_t[e]=0,_t[e|256]=32768,$t[e]=24,$t[e|256]=24):t<-14?(_t[e]=1024>>-t-14,_t[e|256]=1024>>-t-14|32768,$t[e]=-t-1,$t[e|256]=-t-1):t<=15?(_t[e]=t+15<<10,_t[e|256]=t+15<<10|32768,$t[e]=13,$t[e|256]=13):t<128?(_t[e]=31744,_t[e|256]=64512,$t[e]=24,$t[e|256]=24):(_t[e]=31744,_t[e|256]=64512,$t[e]=13,$t[e|256]=13)}const xs=new As(2048);for(let e=1;e<1024;++e){let t=e<<13,i=0;for(;(t&8388608)===0;)t<<=1,i-=8388608;t&=-8388609,i+=947912704,xs[e]=t|i}for(let e=1024;e<2048;++e)xs[e]=939524096+(e-1024<<13);const ke=new As(64);for(let e=1;e<31;++e)ke[e]=e<<23;ke[31]=1199570944;ke[32]=2147483648;for(let e=33;e<63;++e)ke[e]=2147483648+(e-32<<23);ke[63]=3347054592;const $r=new Wr(64);for(let e=1;e<64;++e)e!==32&&($r[e]=1024);function nc(e){const t=e>>10;return rc[0]=xs[$r[t]+(e&1023)]+ke[t],sc[0]}function tn(e,t,...i){return nc(Jl(e,t,...tc(i)))}var gi={exports:{}},sr;function oc(){if(sr)return gi.exports;sr=1;function e(t,i,s){const r=s&&s.debug||!1;r&&console.log("[xml-utils] getting "+i+" in "+t);const n=typeof t=="object"?t.outer:t,o=n.slice(0,n.indexOf(">")+1),l=['"',"'"];for(let a=0;a<l.length;a++){const c=l[a],h=i+"\\="+c+"([^"+c+"]*)"+c;r&&console.log("[xml-utils] pattern:",h);const f=new RegExp(h).exec(o);if(r&&console.log("[xml-utils] match:",f),f)return f[1]}}return gi.exports=e,gi.exports.default=e,gi.exports}var ac=oc();const _i=ls(ac);var Ai={exports:{}},pi={exports:{}},xi={exports:{}},rr;function lc(){if(rr)return xi.exports;rr=1;function e(t,i,s){const n=new RegExp(i).exec(t.slice(s));return n?s+n.index:-1}return xi.exports=e,xi.exports.default=e,xi.exports}var vi={exports:{}},nr;function cc(){if(nr)return vi.exports;nr=1;function e(t,i,s){const n=new RegExp(i).exec(t.slice(s));return n?s+n.index+n[0].length-1:-1}return vi.exports=e,vi.exports.default=e,vi.exports}var wi={exports:{}},or;function hc(){if(or)return wi.exports;or=1;function e(t,i){const s=new RegExp(i,"g"),r=t.match(s);return r?r.length:0}return wi.exports=e,wi.exports.default=e,wi.exports}var ar;function fc(){if(ar)return pi.exports;ar=1;const e=lc(),t=cc(),i=hc();function s(r,n,o){const l=o&&o.debug||!1,a=!(o&&typeof o.nested===!1),c=o&&o.startIndex||0;l&&console.log("[xml-utils] starting findTagByName with",n," and ",o);const h=e(r,`<${n}[ 
>/]`,c);if(l&&console.log("[xml-utils] start:",h),h===-1)return;const d=r.slice(h+n.length);let f=t(d,"^[^<]*[ /]>",0);const u=f!==-1&&d[f-1]==="/";if(l&&console.log("[xml-utils] selfClosing:",u),u===!1)if(a){let p=0,w=1,y=0;for(;(f=t(d,"[ /]"+n+">",p))!==-1;){const x=d.substring(p,f+1);if(w+=i(x,"<"+n+`[ 
	>]`),y+=i(x,"</"+n+">"),y>=w)break;p=f}}else f=t(d,"[ /]"+n+">",0);const m=h+n.length+f+1;if(l&&console.log("[xml-utils] end:",m),m===-1)return;const g=r.slice(h,m);let A;return u?A=null:A=g.slice(g.indexOf(">")+1,g.lastIndexOf("<")),{inner:A,outer:g,start:h,end:m}}return pi.exports=s,pi.exports.default=s,pi.exports}var lr;function dc(){if(lr)return Ai.exports;lr=1;const e=fc();function t(i,s,r){const n=[],o=r&&r.debug||!1,l=r&&typeof r.nested=="boolean"?r.nested:!0;let a=r&&r.startIndex||0,c;for(;c=e(i,s,{debug:o,startIndex:a});)l?a=c.start+1+s.length:a=c.end,n.push(c);return o&&console.log("findTagsByName found",n.length,"tags"),n}return Ai.exports=t,Ai.exports.default=t,Ai.exports}var uc=dc();const mc=ls(uc),Ze={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},ee={};for(const e in Ze)Ze.hasOwnProperty(e)&&(ee[Ze[e]]=parseInt(e,10));const gc=[ee.BitsPerSample,ee.ExtraSamples,ee.SampleFormat,ee.StripByteCounts,ee.StripOffsets,ee.StripRowCounts,ee.TileByteCounts,ee.TileOffsets,ee.SubIFDs],$i={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},it={};for(const e in $i)$i.hasOwnProperty(e)&&(it[$i[e]]=parseInt(e,10));const qt={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,CMYK:5,YCbCr:6,CIELab:8},Ac={Unspecified:0},nh={AddCompression:1},oh={None:0,Deflate:1,Zstandard:2},pc={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"};function xc(e,t){const{width:i,height:s}=e,r=new Uint8Array(i*s*3);let n;for(let o=0,l=0;o<e.length;++o,l+=3)n=256-e[o]/t*256,r[l]=n,r[l+1]=n,r[l+2]=n;return r}function vc(e,t){const{width:i,height:s}=e,r=new Uint8Array(i*s*3);let n;for(let o=0,l=0;o<e.length;++o,l+=3)n=e[o]/t*256,r[l]=n,r[l+1]=n,r[l+2]=n;return r}function wc(e,t){const{width:i,height:s}=e,r=new Uint8Array(i*s*3),n=t.length/3,o=t.length/3*2;for(let l=0,a=0;l<e.length;++l,a+=3){const c=e[l];r[a]=t[c]/65536*256,r[a+1]=t[c+n]/65536*256,r[a+2]=t[c+o]/65536*256}return r}function yc(e){const{width:t,height:i}=e,s=new Uint8Array(t*i*3);for(let r=0,n=0;r<e.length;r+=4,n+=3){const o=e[r],l=e[r+1],a=e[r+2],c=e[r+3];s[n]=255*((255-o)/256)*((255-c)/256),s[n+1]=255*((255-l)/256)*((255-c)/256),s[n+2]=255*((255-a)/256)*((255-c)/256)}return s}function bc(e){const{width:t,height:i}=e,s=new Uint8ClampedArray(t*i*3);for(let r=0,n=0;r<e.length;r+=3,n+=3){const o=e[r],l=e[r+1],a=e[r+2];s[n]=o+1.402*(a-128),s[n+1]=o-.34414*(l-128)-.71414*(a-128),s[n+2]=o+1.772*(l-128)}return s}const Cc=.95047,Dc=1,Ic=1.08883;function Ec(e){const{width:t,height:i}=e,s=new Uint8Array(t*i*3);for(let r=0,n=0;r<e.length;r+=3,n+=3){const o=e[r+0],l=e[r+1]<<24>>24,a=e[r+2]<<24>>24;let c=(o+16)/116,h=l/500+c,d=c-a/200,f,u,m;h=Cc*(h*h*h>.008856?h*h*h:(h-16/116)/7.787),c=Dc*(c*c*c>.008856?c*c*c:(c-16/116)/7.787),d=Ic*(d*d*d>.008856?d*d*d:(d-16/116)/7.787),f=h*3.2406+c*-1.5372+d*-.4986,u=h*-.9689+c*1.8758+d*.0415,m=h*.0557+c*-.204+d*1.057,f=f>.0031308?1.055*f**(1/2.4)-.055:12.92*f,u=u>.0031308?1.055*u**(1/2.4)-.055:12.92*u,m=m>.0031308?1.055*m**(1/2.4)-.055:12.92*m,s[n]=Math.max(0,Math.min(1,f))*255,s[n+1]=Math.max(0,Math.min(1,u))*255,s[n+2]=Math.max(0,Math.min(1,m))*255}return s}const Mc="modulepreload",Sc=function(e,t){return new URL(e,t).href},cr={},we=function(t,i,s){let r=Promise.resolve();if(i&&i.length>0){const o=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),a=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));r=Promise.allSettled(i.map(c=>{if(c=Sc(c,s),c in cr)return;cr[c]=!0;const h=c.endsWith(".css"),d=h?'[rel="stylesheet"]':"";if(!!s)for(let m=o.length-1;m>=0;m--){const g=o[m];if(g.href===c&&(!h||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${d}`))return;const u=document.createElement("link");if(u.rel=h?"stylesheet":Mc,h||(u.as="script"),u.crossOrigin="",u.href=c,a&&u.setAttribute("nonce",a),document.head.appendChild(u),h)return new Promise((m,g)=>{u.addEventListener("load",m),u.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function n(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&n(l.reason);return t().catch(n)})},en=new Map;function fe(e,t){Array.isArray(e)||(e=[e]),e.forEach(i=>en.set(i,t))}async function Tc(e){const t=en.get(e.Compression);if(!t)throw new Error(`Unknown compression method identifier: ${e.Compression}`);const i=await t();return new i(e)}fe([void 0,1],()=>we(()=>import("./raw-in9isEBO.js"),__vite__mapDeps([0,1]),import.meta.url).then(e=>e.default));fe(5,()=>we(()=>import("./lzw-_aCqfs4w.js"),__vite__mapDeps([2,1]),import.meta.url).then(e=>e.default));fe(6,()=>{throw new Error("old style JPEG compression is not supported.")});fe(7,()=>we(()=>import("./jpeg-CKYXsxFN.js"),__vite__mapDeps([3,1]),import.meta.url).then(e=>e.default));fe([8,32946],()=>we(()=>import("./deflate-B9JhHpvg.js"),__vite__mapDeps([4,5,1]),import.meta.url).then(e=>e.default));fe(32773,()=>we(()=>import("./packbits-DDWKfGV_.js"),__vite__mapDeps([6,1]),import.meta.url).then(e=>e.default));fe(34887,()=>we(()=>import("./lerc-aPj8nzU2.js"),__vite__mapDeps([7,5,1]),import.meta.url).then(async e=>(await e.zstd.init(),e)).then(e=>e.default));fe(50001,()=>we(()=>import("./webimage-DBgUwIbt.js"),__vite__mapDeps([8,1]),import.meta.url).then(e=>e.default));function Pi(e,t,i,s=1){return new(Object.getPrototypeOf(e)).constructor(t*i*s)}function Fc(e,t,i,s,r){const n=t/s,o=i/r;return e.map(l=>{const a=Pi(l,s,r);for(let c=0;c<r;++c){const h=Math.min(Math.round(o*c),i-1);for(let d=0;d<s;++d){const f=Math.min(Math.round(n*d),t-1),u=l[h*t+f];a[c*s+d]=u}}return a})}function Le(e,t,i){return(1-i)*e+i*t}function Vc(e,t,i,s,r){const n=t/s,o=i/r;return e.map(l=>{const a=Pi(l,s,r);for(let c=0;c<r;++c){const h=o*c,d=Math.floor(h),f=Math.min(Math.ceil(h),i-1);for(let u=0;u<s;++u){const m=n*u,g=m%1,A=Math.floor(m),p=Math.min(Math.ceil(m),t-1),w=l[d*t+A],y=l[d*t+p],x=l[f*t+A],b=l[f*t+p],M=Le(Le(w,y,g),Le(x,b,g),h%1);a[c*s+u]=M}}return a})}function Bc(e,t,i,s,r,n="nearest"){switch(n.toLowerCase()){case"nearest":return Fc(e,t,i,s,r);case"bilinear":case"linear":return Vc(e,t,i,s,r);default:throw new Error(`Unsupported resampling method: '${n}'`)}}function Uc(e,t,i,s,r,n){const o=t/s,l=i/r,a=Pi(e,s,r,n);for(let c=0;c<r;++c){const h=Math.min(Math.round(l*c),i-1);for(let d=0;d<s;++d){const f=Math.min(Math.round(o*d),t-1);for(let u=0;u<n;++u){const m=e[h*t*n+f*n+u];a[c*s*n+d*n+u]=m}}}return a}function Rc(e,t,i,s,r,n){const o=t/s,l=i/r,a=Pi(e,s,r,n);for(let c=0;c<r;++c){const h=l*c,d=Math.floor(h),f=Math.min(Math.ceil(h),i-1);for(let u=0;u<s;++u){const m=o*u,g=m%1,A=Math.floor(m),p=Math.min(Math.ceil(m),t-1);for(let w=0;w<n;++w){const y=e[d*t*n+A*n+w],x=e[d*t*n+p*n+w],b=e[f*t*n+A*n+w],M=e[f*t*n+p*n+w],D=Le(Le(y,x,g),Le(b,M,g),h%1);a[c*s*n+u*n+w]=D}}}return a}function Nc(e,t,i,s,r,n,o="nearest"){switch(o.toLowerCase()){case"nearest":return Uc(e,t,i,s,r,n);case"bilinear":case"linear":return Rc(e,t,i,s,r,n);default:throw new Error(`Unsupported resampling method: '${o}'`)}}function Pc(e,t,i){let s=0;for(let r=t;r<i;++r)s+=e[r];return s}function rs(e,t,i){switch(e){case 1:if(t<=8)return new Uint8Array(i);if(t<=16)return new Uint16Array(i);if(t<=32)return new Uint32Array(i);break;case 2:if(t===8)return new Int8Array(i);if(t===16)return new Int16Array(i);if(t===32)return new Int32Array(i);break;case 3:switch(t){case 16:case 32:return new Float32Array(i);case 64:return new Float64Array(i)}break}throw Error("Unsupported data format/bitsPerSample")}function Lc(e,t){return(e===1||e===2)&&t<=32&&t%8===0?!1:!(e===3&&(t===16||t===32||t===64))}function Oc(e,t,i,s,r,n,o){const l=new DataView(e),a=i===2?o*n:o*n*s,c=i===2?1:s,h=rs(t,r,a),d=parseInt("1".repeat(r),2);if(t===1){let f;i===1?f=s*r:f=r;let u=n*f;(u&7)!==0&&(u=u+7&-8);for(let m=0;m<o;++m){const g=m*u;for(let A=0;A<n;++A){const p=g+A*c*r;for(let w=0;w<c;++w){const y=p+w*r,x=(m*n+A)*c+w,b=Math.floor(y/8),M=y%8;if(M+r<=8)h[x]=l.getUint8(b)>>8-r-M&d;else if(M+r<=16)h[x]=l.getUint16(b)>>16-r-M&d;else if(M+r<=24){const D=l.getUint16(b)<<8|l.getUint8(b+2);h[x]=D>>24-r-M&d}else h[x]=l.getUint32(b)>>32-r-M&d}}}}return h.buffer}class kc{constructor(t,i,s,r,n,o){this.fileDirectory=t,this.geoKeys=i,this.dataView=s,this.littleEndian=r,this.tiles=n?{}:null,this.isTiled=!t.StripOffsets;const l=t.PlanarConfiguration;if(this.planarConfiguration=typeof l>"u"?1:l,this.planarConfiguration!==1&&this.planarConfiguration!==2)throw new Error("Invalid planar configuration.");this.source=o}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return typeof this.fileDirectory.SamplesPerPixel<"u"?this.fileDirectory.SamplesPerPixel:1}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:typeof this.fileDirectory.RowsPerStrip<"u"?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBlockWidth(){return this.getTileWidth()}getBlockHeight(t){return this.isTiled||(t+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-t*this.getTileHeight()}getBytesPerPixel(){let t=0;for(let i=0;i<this.fileDirectory.BitsPerSample.length;++i)t+=this.getSampleByteSize(i);return t}getSampleByteSize(t){if(t>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${t} is out of range.`);return Math.ceil(this.fileDirectory.BitsPerSample[t]/8)}getReaderForSample(t){const i=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[t]:1,s=this.fileDirectory.BitsPerSample[t];switch(i){case 1:if(s<=8)return DataView.prototype.getUint8;if(s<=16)return DataView.prototype.getUint16;if(s<=32)return DataView.prototype.getUint32;break;case 2:if(s<=8)return DataView.prototype.getInt8;if(s<=16)return DataView.prototype.getInt16;if(s<=32)return DataView.prototype.getInt32;break;case 3:switch(s){case 16:return function(r,n){return tn(this,r,n)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}break}throw Error("Unsupported data format/bitsPerSample")}getSampleFormat(t=0){return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[t]:1}getBitsPerSample(t=0){return this.fileDirectory.BitsPerSample[t]}getArrayForSample(t,i){const s=this.getSampleFormat(t),r=this.getBitsPerSample(t);return rs(s,r,i)}async getTileOrStrip(t,i,s,r,n){const o=Math.ceil(this.getWidth()/this.getTileWidth()),l=Math.ceil(this.getHeight()/this.getTileHeight());let a;const{tiles:c}=this;this.planarConfiguration===1?a=i*o+t:this.planarConfiguration===2&&(a=s*o*l+i*o+t);let h,d;this.isTiled?(h=this.fileDirectory.TileOffsets[a],d=this.fileDirectory.TileByteCounts[a]):(h=this.fileDirectory.StripOffsets[a],d=this.fileDirectory.StripByteCounts[a]);const f=(await this.source.fetch([{offset:h,length:d}],n))[0];let u;return c===null||!c[a]?(u=(async()=>{let m=await r.decode(this.fileDirectory,f);const g=this.getSampleFormat(),A=this.getBitsPerSample();return Lc(g,A)&&(m=Oc(m,g,this.planarConfiguration,this.getSamplesPerPixel(),A,this.getTileWidth(),this.getBlockHeight(i))),m})(),c!==null&&(c[a]=u)):u=c[a],{x:t,y:i,sample:s,data:await u}}async _readRaster(t,i,s,r,n,o,l,a,c){const h=this.getTileWidth(),d=this.getTileHeight(),f=this.getWidth(),u=this.getHeight(),m=Math.max(Math.floor(t[0]/h),0),g=Math.min(Math.ceil(t[2]/h),Math.ceil(f/h)),A=Math.max(Math.floor(t[1]/d),0),p=Math.min(Math.ceil(t[3]/d),Math.ceil(u/d)),w=t[2]-t[0];let y=this.getBytesPerPixel();const x=[],b=[];for(let v=0;v<i.length;++v)this.planarConfiguration===1?x.push(Pc(this.fileDirectory.BitsPerSample,0,i[v])/8):x.push(0),b.push(this.getReaderForSample(i[v]));const M=[],{littleEndian:D}=this;for(let v=A;v<p;++v)for(let C=m;C<g;++C){let I;this.planarConfiguration===1&&(I=this.getTileOrStrip(C,v,0,n,c));for(let S=0;S<i.length;++S){const E=S,V=i[S];this.planarConfiguration===2&&(y=this.getSampleByteSize(V),I=this.getTileOrStrip(C,v,V,n,c));const T=I.then(R=>{const N=R.data,O=new DataView(N),G=this.getBlockHeight(R.y),z=R.y*d,q=R.x*h,J=z+G,_=(R.x+1)*h,tt=b[E],$=Math.min(G,G-(J-t[3]),u-z),dt=Math.min(h,h-(_-t[2]),f-q);for(let lt=Math.max(0,t[1]-z);lt<$;++lt)for(let rt=Math.max(0,t[0]-q);rt<dt;++rt){const ht=(lt*h+rt)*y,Ct=tt.call(O,ht+x[E],D);let ct;r?(ct=(lt+z-t[1])*w*i.length+(rt+q-t[0])*i.length+E,s[ct]=Ct):(ct=(lt+z-t[1])*w+rt+q-t[0],s[E][ct]=Ct)}});M.push(T)}}if(await Promise.all(M),o&&t[2]-t[0]!==o||l&&t[3]-t[1]!==l){let v;return r?v=Nc(s,t[2]-t[0],t[3]-t[1],o,l,i.length,a):v=Bc(s,t[2]-t[0],t[3]-t[1],o,l,a),v.width=o,v.height=l,v}return s.width=o||t[2]-t[0],s.height=l||t[3]-t[1],s}async readRasters({window:t,samples:i=[],interleave:s,pool:r=null,width:n,height:o,resampleMethod:l,fillValue:a,signal:c}={}){const h=t||[0,0,this.getWidth(),this.getHeight()];if(h[0]>h[2]||h[1]>h[3])throw new Error("Invalid subsets");const d=h[2]-h[0],f=h[3]-h[1],u=d*f,m=this.getSamplesPerPixel();if(!i||!i.length)for(let w=0;w<m;++w)i.push(w);else for(let w=0;w<i.length;++w)if(i[w]>=m)return Promise.reject(new RangeError(`Invalid sample index '${i[w]}'.`));let g;if(s){const w=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,y=Math.max.apply(null,this.fileDirectory.BitsPerSample);g=rs(w,y,u*i.length),a&&g.fill(a)}else{g=[];for(let w=0;w<i.length;++w){const y=this.getArrayForSample(i[w],u);Array.isArray(a)&&w<a.length?y.fill(a[w]):a&&!Array.isArray(a)&&y.fill(a),g.push(y)}}const A=r||await Tc(this.fileDirectory);return await this._readRaster(h,i,g,s,A,n,o,l,c)}async readRGB({window:t,interleave:i=!0,pool:s=null,width:r,height:n,resampleMethod:o,enableAlpha:l=!1,signal:a}={}){const c=t||[0,0,this.getWidth(),this.getHeight()];if(c[0]>c[2]||c[1]>c[3])throw new Error("Invalid subsets");const h=this.fileDirectory.PhotometricInterpretation;if(h===qt.RGB){let p=[0,1,2];if(this.fileDirectory.ExtraSamples!==Ac.Unspecified&&l){p=[];for(let w=0;w<this.fileDirectory.BitsPerSample.length;w+=1)p.push(w)}return this.readRasters({window:t,interleave:i,samples:p,pool:s,width:r,height:n,resampleMethod:o,signal:a})}let d;switch(h){case qt.WhiteIsZero:case qt.BlackIsZero:case qt.Palette:d=[0];break;case qt.CMYK:d=[0,1,2,3];break;case qt.YCbCr:case qt.CIELab:d=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const f={window:c,interleave:!0,samples:d,pool:s,width:r,height:n,resampleMethod:o,signal:a},{fileDirectory:u}=this,m=await this.readRasters(f),g=2**this.fileDirectory.BitsPerSample[0];let A;switch(h){case qt.WhiteIsZero:A=xc(m,g);break;case qt.BlackIsZero:A=vc(m,g);break;case qt.Palette:A=wc(m,u.ColorMap);break;case qt.CMYK:A=yc(m);break;case qt.YCbCr:A=bc(m);break;case qt.CIELab:A=Ec(m);break;default:throw new Error("Unsupported photometric interpretation.")}if(!i){const p=new Uint8Array(A.length/3),w=new Uint8Array(A.length/3),y=new Uint8Array(A.length/3);for(let x=0,b=0;x<A.length;x+=3,++b)p[b]=A[x],w[b]=A[x+1],y[b]=A[x+2];A=[p,w,y]}return A.width=m.width,A.height=m.height,A}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const t=[];for(let i=0;i<this.fileDirectory.ModelTiepoint.length;i+=6)t.push({i:this.fileDirectory.ModelTiepoint[i],j:this.fileDirectory.ModelTiepoint[i+1],k:this.fileDirectory.ModelTiepoint[i+2],x:this.fileDirectory.ModelTiepoint[i+3],y:this.fileDirectory.ModelTiepoint[i+4],z:this.fileDirectory.ModelTiepoint[i+5]});return t}getGDALMetadata(t=null){const i={};if(!this.fileDirectory.GDAL_METADATA)return null;const s=this.fileDirectory.GDAL_METADATA;let r=mc(s,"Item");t===null?r=r.filter(n=>_i(n,"sample")===void 0):r=r.filter(n=>Number(_i(n,"sample"))===t);for(let n=0;n<r.length;++n){const o=r[n];i[_i(o,"name")]=o.inner}return i}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const t=this.fileDirectory.GDAL_NODATA;return Number(t.substring(0,t.length-1))}getOrigin(){const t=this.fileDirectory.ModelTiepoint,i=this.fileDirectory.ModelTransformation;if(t&&t.length===6)return[t[3],t[4],t[5]];if(i)return[i[3],i[7],i[11]];throw new Error("The image does not have an affine transformation.")}getResolution(t=null){const i=this.fileDirectory.ModelPixelScale,s=this.fileDirectory.ModelTransformation;if(i)return[i[0],-i[1],i[2]];if(s)return s[1]===0&&s[4]===0?[s[0],-s[5],s[10]]:[Math.sqrt(s[0]*s[0]+s[4]*s[4]),-Math.sqrt(s[1]*s[1]+s[5]*s[5]),s[10]];if(t){const[r,n,o]=t.getResolution();return[r*t.getWidth()/this.getWidth(),n*t.getHeight()/this.getHeight(),o*t.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return this.geoKeys.GTRasterTypeGeoKey===1}getBoundingBox(t=!1){const i=this.getHeight(),s=this.getWidth();if(this.fileDirectory.ModelTransformation&&!t){const[r,n,o,l,a,c,h,d]=this.fileDirectory.ModelTransformation,u=[[0,0],[0,i],[s,0],[s,i]].map(([A,p])=>[l+r*A+n*p,d+a*A+c*p]),m=u.map(A=>A[0]),g=u.map(A=>A[1]);return[Math.min(...m),Math.min(...g),Math.max(...m),Math.max(...g)]}else{const r=this.getOrigin(),n=this.getResolution(),o=r[0],l=r[1],a=o+n[0]*s,c=l+n[1]*i;return[Math.min(o,a),Math.min(l,c),Math.max(o,a),Math.max(l,c)]}}}class Gc{constructor(t){this._dataView=new DataView(t)}get buffer(){return this._dataView.buffer}getUint64(t,i){const s=this.getUint32(t,i),r=this.getUint32(t+4,i);let n;if(i){if(n=s+2**32*r,!Number.isSafeInteger(n))throw new Error(`${n} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return n}if(n=2**32*s+r,!Number.isSafeInteger(n))throw new Error(`${n} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return n}getInt64(t,i){let s=0;const r=(this._dataView.getUint8(t+(i?7:0))&128)>0;let n=!0;for(let o=0;o<8;o++){let l=this._dataView.getUint8(t+(i?o:7-o));r&&(n?l!==0&&(l=~(l-1)&255,n=!1):l=~l&255),s+=l*256**o}return r&&(s=-s),s}getUint8(t,i){return this._dataView.getUint8(t,i)}getInt8(t,i){return this._dataView.getInt8(t,i)}getUint16(t,i){return this._dataView.getUint16(t,i)}getInt16(t,i){return this._dataView.getInt16(t,i)}getUint32(t,i){return this._dataView.getUint32(t,i)}getInt32(t,i){return this._dataView.getInt32(t,i)}getFloat16(t,i){return tn(this._dataView,t,i)}getFloat32(t,i){return this._dataView.getFloat32(t,i)}getFloat64(t,i){return this._dataView.getFloat64(t,i)}}class Yc{constructor(t,i,s,r){this._dataView=new DataView(t),this._sliceOffset=i,this._littleEndian=s,this._bigTiff=r}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(t,i){return this.sliceOffset<=t&&this.sliceTop>=t+i}readUint8(t){return this._dataView.getUint8(t-this._sliceOffset,this._littleEndian)}readInt8(t){return this._dataView.getInt8(t-this._sliceOffset,this._littleEndian)}readUint16(t){return this._dataView.getUint16(t-this._sliceOffset,this._littleEndian)}readInt16(t){return this._dataView.getInt16(t-this._sliceOffset,this._littleEndian)}readUint32(t){return this._dataView.getUint32(t-this._sliceOffset,this._littleEndian)}readInt32(t){return this._dataView.getInt32(t-this._sliceOffset,this._littleEndian)}readFloat32(t){return this._dataView.getFloat32(t-this._sliceOffset,this._littleEndian)}readFloat64(t){return this._dataView.getFloat64(t-this._sliceOffset,this._littleEndian)}readUint64(t){const i=this.readUint32(t),s=this.readUint32(t+4);let r;if(this._littleEndian){if(r=i+2**32*s,!Number.isSafeInteger(r))throw new Error(`${r} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return r}if(r=2**32*i+s,!Number.isSafeInteger(r))throw new Error(`${r} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return r}readInt64(t){let i=0;const s=(this._dataView.getUint8(t+(this._littleEndian?7:0))&128)>0;let r=!0;for(let n=0;n<8;n++){let o=this._dataView.getUint8(t+(this._littleEndian?n:7-n));s&&(r?o!==0&&(o=~(o-1)&255,r=!1):o=~o&255),i+=o*256**n}return s&&(i=-i),i}readOffset(t){return this._bigTiff?this.readUint64(t):this.readUint32(t)}}class zc{async fetch(t,i=void 0){return Promise.all(t.map(s=>this.fetchSlice(s,i)))}async fetchSlice(t){throw new Error(`fetching of slice ${t} not possible, not implemented`)}get fileSize(){return null}async close(){}}class vs extends Error{constructor(t){super(t),Error.captureStackTrace&&Error.captureStackTrace(this,vs),this.name="AbortError"}}class Kc extends zc{constructor(t){super(),this.arrayBuffer=t}fetchSlice(t,i){if(i&&i.aborted)throw new vs("Request aborted");return this.arrayBuffer.slice(t.offset,t.offset+t.length)}}function qc(e){return new Kc(e)}function ns(e){switch(e){case it.BYTE:case it.ASCII:case it.SBYTE:case it.UNDEFINED:return 1;case it.SHORT:case it.SSHORT:return 2;case it.LONG:case it.SLONG:case it.FLOAT:case it.IFD:return 4;case it.RATIONAL:case it.SRATIONAL:case it.DOUBLE:case it.LONG8:case it.SLONG8:case it.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${e}`)}}function Qc(e){const t=e.GeoKeyDirectory;if(!t)return null;const i={};for(let s=4;s<=t[3]*4;s+=4){const r=pc[t[s]],n=t[s+1]?Ze[t[s+1]]:null,o=t[s+2],l=t[s+3];let a=null;if(!n)a=l;else{if(a=e[n],typeof a>"u"||a===null)throw new Error(`Could not get value of geoKey '${r}'.`);typeof a=="string"?a=a.substring(l,l+o-1):a.subarray&&(a=a.subarray(l,l+o),o===1&&(a=a[0]))}i[r]=a}return i}function Te(e,t,i,s){let r=null,n=null;const o=ns(t);switch(t){case it.BYTE:case it.ASCII:case it.UNDEFINED:r=new Uint8Array(i),n=e.readUint8;break;case it.SBYTE:r=new Int8Array(i),n=e.readInt8;break;case it.SHORT:r=new Uint16Array(i),n=e.readUint16;break;case it.SSHORT:r=new Int16Array(i),n=e.readInt16;break;case it.LONG:case it.IFD:r=new Uint32Array(i),n=e.readUint32;break;case it.SLONG:r=new Int32Array(i),n=e.readInt32;break;case it.LONG8:case it.IFD8:r=new Array(i),n=e.readUint64;break;case it.SLONG8:r=new Array(i),n=e.readInt64;break;case it.RATIONAL:r=new Uint32Array(i*2),n=e.readUint32;break;case it.SRATIONAL:r=new Int32Array(i*2),n=e.readInt32;break;case it.FLOAT:r=new Float32Array(i),n=e.readFloat32;break;case it.DOUBLE:r=new Float64Array(i),n=e.readFloat64;break;default:throw new RangeError(`Invalid field type: ${t}`)}if(t===it.RATIONAL||t===it.SRATIONAL)for(let l=0;l<i;l+=2)r[l]=n.call(e,s+l*o),r[l+1]=n.call(e,s+(l*o+4));else for(let l=0;l<i;++l)r[l]=n.call(e,s+l*o);return t===it.ASCII?new TextDecoder("utf-8").decode(r):r}class Hc{constructor(t,i,s){this.fileDirectory=t,this.geoKeyDirectory=i,this.nextIFDByteOffset=s}}class yi extends Error{constructor(t){super(`No image at index ${t}`),this.index=t}}class Wc{async readRasters(t={}){const{window:i,width:s,height:r}=t;let{resX:n,resY:o,bbox:l}=t;const a=await this.getImage();let c=a;const h=await this.getImageCount(),d=a.getBoundingBox();if(i&&l)throw new Error('Both "bbox" and "window" passed.');if(s||r){if(i){const[m,g]=a.getOrigin(),[A,p]=a.getResolution();l=[m+i[0]*A,g+i[1]*p,m+i[2]*A,g+i[3]*p]}const u=l||d;if(s){if(n)throw new Error("Both width and resX passed");n=(u[2]-u[0])/s}if(r){if(o)throw new Error("Both width and resY passed");o=(u[3]-u[1])/r}}if(n||o){const u=[];for(let m=0;m<h;++m){const g=await this.getImage(m),{SubfileType:A,NewSubfileType:p}=g.fileDirectory;(m===0||A===2||p&1)&&u.push(g)}u.sort((m,g)=>m.getWidth()-g.getWidth());for(let m=0;m<u.length;++m){const g=u[m],A=(d[2]-d[0])/g.getWidth(),p=(d[3]-d[1])/g.getHeight();if(c=g,n&&n>A||o&&o>p)break}}let f=i;if(l){const[u,m]=a.getOrigin(),[g,A]=c.getResolution(a);f=[Math.round((l[0]-u)/g),Math.round((l[1]-m)/A),Math.round((l[2]-u)/g),Math.round((l[3]-m)/A)],f=[Math.min(f[0],f[2]),Math.min(f[1],f[3]),Math.max(f[0],f[2]),Math.max(f[1],f[3])]}return c.readRasters({...t,window:f})}}class ws extends Wc{constructor(t,i,s,r,n={}){super(),this.source=t,this.littleEndian=i,this.bigTiff=s,this.firstIFDOffset=r,this.cache=n.cache||!1,this.ifdRequests=[],this.ghostValues=null}async getSlice(t,i){const s=this.bigTiff?4048:1024;return new Yc((await this.source.fetch([{offset:t,length:typeof i<"u"?i:s}]))[0],t,this.littleEndian,this.bigTiff)}async parseFileDirectoryAt(t){const i=this.bigTiff?20:12,s=this.bigTiff?8:2;let r=await this.getSlice(t);const n=this.bigTiff?r.readUint64(t):r.readUint16(t),o=n*i+(this.bigTiff?16:6);r.covers(t,o)||(r=await this.getSlice(t,o));const l={};let a=t+(this.bigTiff?8:2);for(let d=0;d<n;a+=i,++d){const f=r.readUint16(a),u=r.readUint16(a+2),m=this.bigTiff?r.readUint64(a+4):r.readUint32(a+4);let g,A;const p=ns(u),w=a+(this.bigTiff?12:8);if(p*m<=(this.bigTiff?8:4))g=Te(r,u,m,w);else{const y=r.readOffset(w),x=ns(u)*m;if(r.covers(y,x))g=Te(r,u,m,y);else{const b=await this.getSlice(y,x);g=Te(b,u,m,y)}}m===1&&gc.indexOf(f)===-1&&!(u===it.RATIONAL||u===it.SRATIONAL)?A=g[0]:A=g,l[Ze[f]]=A}const c=Qc(l),h=r.readOffset(t+s+i*n);return new Hc(l,c,h)}async requestIFD(t){if(this.ifdRequests[t])return this.ifdRequests[t];if(t===0)return this.ifdRequests[t]=this.parseFileDirectoryAt(this.firstIFDOffset),this.ifdRequests[t];if(!this.ifdRequests[t-1])try{this.ifdRequests[t-1]=this.requestIFD(t-1)}catch(i){throw i instanceof yi?new yi(t):i}return this.ifdRequests[t]=(async()=>{const i=await this.ifdRequests[t-1];if(i.nextIFDByteOffset===0)throw new yi(t);return this.parseFileDirectoryAt(i.nextIFDByteOffset)})(),this.ifdRequests[t]}async getImage(t=0){const i=await this.requestIFD(t);return new kc(i.fileDirectory,i.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){let t=0,i=!0;for(;i;)try{await this.requestIFD(t),++t}catch(s){if(s instanceof yi)i=!1;else throw s}return t}async getGhostValues(){const t=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const i="GDAL_STRUCTURAL_METADATA_SIZE=",s=i.length+100;let r=await this.getSlice(t,s);if(i===Te(r,it.ASCII,i.length,t)){const o=Te(r,it.ASCII,s,t).split(`
`)[0],l=Number(o.split("=")[1].split(" ")[0])+o.length;l>s&&(r=await this.getSlice(t,l));const a=Te(r,it.ASCII,l,t);this.ghostValues={},a.split(`
`).filter(c=>c.length>0).map(c=>c.split("=")).forEach(([c,h])=>{this.ghostValues[c]=h})}return this.ghostValues}static async fromSource(t,i,s){const r=(await t.fetch([{offset:0,length:1024}],s))[0],n=new Gc(r),o=n.getUint16(0,0);let l;if(o===18761)l=!0;else if(o===19789)l=!1;else throw new TypeError("Invalid byte order value.");const a=n.getUint16(2,l);let c;if(a===42)c=!1;else if(a===43){if(c=!0,n.getUint16(4,l)!==8)throw new Error("Unsupported offset byte-size.")}else throw new TypeError("Invalid magic number.");const h=c?n.getUint64(8,l):n.getUint32(4,l);return new ws(t,l,c,h,i)}close(){return typeof this.source.close=="function"?this.source.close():!1}}async function Xc(e,t){return ws.fromSource(qc(e),t)}var Fe={},ts={},hr;function jc(){return hr||(hr=1,ts.entityMap={lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",times:"",divide:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",fnof:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",bull:"",hellip:"",permil:"",prime:"",Prime:"",lsaquo:"",rsaquo:"",oline:"",euro:"",trade:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lceil:"",rceil:"",lfloor:"",rfloor:"",loz:"",spades:"",clubs:"",hearts:"",diams:""}),ts}var bi={},fr;function Zc(){if(fr)return bi;fr=1;var e=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,t=new RegExp("[\\-\\.0-9"+e.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),i=new RegExp("^"+e.source+t.source+"*(?::"+e.source+t.source+"*)?$"),s=0,r=1,n=2,o=3,l=4,a=5,c=6,h=7;function d(v,C){this.message=v,this.locator=C,Error.captureStackTrace&&Error.captureStackTrace(this,d)}d.prototype=new Error,d.prototype.name=d.name;function f(){}f.prototype={parse:function(v,C,I){var S=this.domBuilder;S.startDocument(),y(C,C={}),u(v,C,I,S,this.errorHandler),S.endDocument()}};function u(v,C,I,S,E){function V(wt){if(wt>65535){wt-=65536;var Vt=55296+(wt>>10),ii=56320+(wt&1023);return String.fromCharCode(Vt,ii)}else return String.fromCharCode(wt)}function T(wt){var Vt=wt.slice(1,-1);return Vt in I?I[Vt]:Vt.charAt(0)==="#"?V(parseInt(Vt.substr(1).replace("x","0x"))):(E.error("entity not found:"+wt),wt)}function R(wt){if(wt>tt){var Vt=v.substring(tt,wt).replace(/&#?\w+;/g,T);q&&N(tt),S.characters(Vt,0,wt-tt),tt=wt}}function N(wt,Vt){for(;wt>=G&&(Vt=z.exec(v));)O=Vt.index,G=O+Vt[0].length,q.lineNumber++;q.columnNumber=wt-O+1}for(var O=0,G=0,z=/.*(?:\r\n?|\n)|.*$/g,q=S.locator,J=[{currentNSMap:C}],_={},tt=0;;){try{var $=v.indexOf("<",tt);if($<0){if(!v.substr(tt).match(/^\s*$/)){var dt=S.doc,lt=dt.createTextNode(v.substr(tt));dt.appendChild(lt),S.currentElement=lt}return}switch($>tt&&R($),v.charAt($+1)){case"/":var Dt=v.indexOf(">",$+3),rt=v.substring($+2,Dt),ht=J.pop();Dt<0?(rt=v.substring($+2).replace(/[\s<].*/,""),E.error("end tag name: "+rt+" is not complete:"+ht.tagName),Dt=$+1+rt.length):rt.match(/\s</)&&(rt=rt.replace(/[\s<].*/,""),E.error("end tag name: "+rt+" maybe not complete"),Dt=$+1+rt.length);var Ct=ht.localNSMap,ct=ht.tagName==rt,ft=ct||ht.tagName&&ht.tagName.toLowerCase()==rt.toLowerCase();if(ft){if(S.endElement(ht.uri,ht.localName,rt),Ct)for(var ut in Ct)S.endPrefixMapping(ut);ct||E.fatalError("end tag name: "+rt+" is not match the current start tagName:"+ht.tagName)}else J.push(ht);Dt++;break;case"?":q&&N($),Dt=b(v,$,S);break;case"!":q&&N($),Dt=x(v,$,S,E);break;default:q&&N($);var At=new M,Kt=J[J.length-1].currentNSMap,Dt=g(v,$,At,Kt,T,E),de=At.length;if(!At.closed&&w(v,Dt,At.tagName,_)&&(At.closed=!0,I.nbsp||E.warning("unclosed xml attribute")),q&&de){for(var ye=m(q,{}),ue=0;ue<de;ue++){var jt=At[ue];N(jt.offset),jt.locator=m(q,{})}S.locator=ye,A(At,S,Kt)&&J.push(At),S.locator=q}else A(At,S,Kt)&&J.push(At);At.uri==="http://www.w3.org/1999/xhtml"&&!At.closed?Dt=p(v,Dt,At.tagName,T,S):Dt++}}catch(wt){if(wt instanceof d)throw wt;E.error("element parse error: "+wt),Dt=-1}Dt>tt?tt=Dt:R(Math.max($,tt)+1)}}function m(v,C){return C.lineNumber=v.lineNumber,C.columnNumber=v.columnNumber,C}function g(v,C,I,S,E,V){function T(q,J,_){q in I.attributeNames&&V.fatalError("Attribute "+q+" redefined"),I.addValue(q,J,_)}for(var R,N,O=++C,G=s;;){var z=v.charAt(O);switch(z){case"=":if(G===r)R=v.slice(C,O),G=o;else if(G===n)G=o;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(G===o||G===r)if(G===r&&(V.warning('attribute value must after "="'),R=v.slice(C,O)),C=O+1,O=v.indexOf(z,C),O>0)N=v.slice(C,O).replace(/&#?\w+;/g,E),T(R,N,C-1),G=a;else throw new Error("attribute value no end '"+z+"' match");else if(G==l)N=v.slice(C,O).replace(/&#?\w+;/g,E),T(R,N,C),V.warning('attribute "'+R+'" missed start quot('+z+")!!"),C=O+1,G=a;else throw new Error('attribute value must after "="');break;case"/":switch(G){case s:I.setTagName(v.slice(C,O));case a:case c:case h:G=h,I.closed=!0;case l:case r:case n:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return V.error("unexpected end of input"),G==s&&I.setTagName(v.slice(C,O)),O;case">":switch(G){case s:I.setTagName(v.slice(C,O));case a:case c:case h:break;case l:case r:N=v.slice(C,O),N.slice(-1)==="/"&&(I.closed=!0,N=N.slice(0,-1));case n:G===n&&(N=R),G==l?(V.warning('attribute "'+N+'" missed quot(")!'),T(R,N.replace(/&#?\w+;/g,E),C)):((S[""]!=="http://www.w3.org/1999/xhtml"||!N.match(/^(?:disabled|checked|selected)$/i))&&V.warning('attribute "'+N+'" missed value!! "'+N+'" instead!!'),T(N,N,C));break;case o:throw new Error("attribute value missed!!")}return O;case"":z=" ";default:if(z<=" ")switch(G){case s:I.setTagName(v.slice(C,O)),G=c;break;case r:R=v.slice(C,O),G=n;break;case l:var N=v.slice(C,O).replace(/&#?\w+;/g,E);V.warning('attribute "'+N+'" missed quot(")!!'),T(R,N,C);case a:G=c;break}else switch(G){case n:I.tagName,(S[""]!=="http://www.w3.org/1999/xhtml"||!R.match(/^(?:disabled|checked|selected)$/i))&&V.warning('attribute "'+R+'" missed value!! "'+R+'" instead2!!'),T(R,R,C),C=O,G=r;break;case a:V.warning('attribute space is required"'+R+'"!!');case c:G=r,C=O;break;case o:G=l,C=O;break;case h:throw new Error("elements closed character '/' and '>' must be connected to")}}O++}}function A(v,C,I){for(var S=v.tagName,E=null,z=v.length;z--;){var V=v[z],T=V.qName,R=V.value,q=T.indexOf(":");if(q>0)var N=V.prefix=T.slice(0,q),O=T.slice(q+1),G=N==="xmlns"&&O;else O=T,N=null,G=T==="xmlns"&&"";V.localName=O,G!==!1&&(E==null&&(E={},y(I,I={})),I[G]=E[G]=R,V.uri="http://www.w3.org/2000/xmlns/",C.startPrefixMapping(G,R))}for(var z=v.length;z--;){V=v[z];var N=V.prefix;N&&(N==="xml"&&(V.uri="http://www.w3.org/XML/1998/namespace"),N!=="xmlns"&&(V.uri=I[N||""]))}var q=S.indexOf(":");q>0?(N=v.prefix=S.slice(0,q),O=v.localName=S.slice(q+1)):(N=null,O=v.localName=S);var J=v.uri=I[N||""];if(C.startElement(J,O,S,v),v.closed){if(C.endElement(J,O,S),E)for(N in E)C.endPrefixMapping(N)}else return v.currentNSMap=I,v.localNSMap=E,!0}function p(v,C,I,S,E){if(/^(?:script|textarea)$/i.test(I)){var V=v.indexOf("</"+I+">",C),T=v.substring(C+1,V);if(/[&<]/.test(T))return/^script$/i.test(I)?(E.characters(T,0,T.length),V):(T=T.replace(/&#?\w+;/g,S),E.characters(T,0,T.length),V)}return C+1}function w(v,C,I,S){var E=S[I];return E==null&&(E=v.lastIndexOf("</"+I+">"),E<C&&(E=v.lastIndexOf("</"+I)),S[I]=E),E<C}function y(v,C){for(var I in v)C[I]=v[I]}function x(v,C,I,S){var E=v.charAt(C+2);switch(E){case"-":if(v.charAt(C+3)==="-"){var V=v.indexOf("-->",C+4);return V>C?(I.comment(v,C+4,V-C-4),V+3):(S.error("Unclosed comment"),-1)}else return-1;default:if(v.substr(C+3,6)=="CDATA["){var V=v.indexOf("]]>",C+9);return I.startCDATA(),I.characters(v,C+9,V-C-9),I.endCDATA(),V+3}var T=D(v,C),R=T.length;if(R>1&&/!doctype/i.test(T[0][0])){var N=T[1][0],O=!1,G=!1;R>3&&(/^public$/i.test(T[2][0])?(O=T[3][0],G=R>4&&T[4][0]):/^system$/i.test(T[2][0])&&(G=T[3][0]));var z=T[R-1];return I.startDTD(N,O,G),I.endDTD(),z.index+z[0].length}}return-1}function b(v,C,I){var S=v.indexOf("?>",C);if(S){var E=v.substring(C,S).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return E?(E[0].length,I.processingInstruction(E[1],E[2]),S+2):-1}return-1}function M(){this.attributeNames={}}M.prototype={setTagName:function(v){if(!i.test(v))throw new Error("invalid tagName:"+v);this.tagName=v},addValue:function(v,C,I){if(!i.test(v))throw new Error("invalid attribute:"+v);this.attributeNames[v]=this.length,this[this.length++]={qName:v,value:C,offset:I}},length:0,getLocalName:function(v){return this[v].localName},getLocator:function(v){return this[v].locator},getQName:function(v){return this[v].qName},getURI:function(v){return this[v].uri},getValue:function(v){return this[v].value}};function D(v,C){var I,S=[],E=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(E.lastIndex=C,E.exec(v);I=E.exec(v);)if(S.push(I),I[1])return S}return bi.XMLReader=f,bi.ParseError=d,bi}var Ve={},dr;function ur(){if(dr)return Ve;dr=1;function e(B,U){for(var L in B)U[L]=B[L]}function t(B,U){var L=B.prototype;if(!(L instanceof U)){let Y=function(){};Y.prototype=U.prototype,Y=new Y,e(L,Y),B.prototype=L=Y}L.constructor!=B&&(typeof B!="function"&&console.error("unknow Class:"+B),L.constructor=B)}var i="http://www.w3.org/1999/xhtml",s={},r=s.ELEMENT_NODE=1,n=s.ATTRIBUTE_NODE=2,o=s.TEXT_NODE=3,l=s.CDATA_SECTION_NODE=4,a=s.ENTITY_REFERENCE_NODE=5,c=s.ENTITY_NODE=6,h=s.PROCESSING_INSTRUCTION_NODE=7,d=s.COMMENT_NODE=8,f=s.DOCUMENT_NODE=9,u=s.DOCUMENT_TYPE_NODE=10,m=s.DOCUMENT_FRAGMENT_NODE=11,g=s.NOTATION_NODE=12,A={},p={};A.INDEX_SIZE_ERR=(p[1]="Index size error",1),A.DOMSTRING_SIZE_ERR=(p[2]="DOMString size error",2);var w=A.HIERARCHY_REQUEST_ERR=(p[3]="Hierarchy request error",3);A.WRONG_DOCUMENT_ERR=(p[4]="Wrong document",4),A.INVALID_CHARACTER_ERR=(p[5]="Invalid character",5),A.NO_DATA_ALLOWED_ERR=(p[6]="No data allowed",6),A.NO_MODIFICATION_ALLOWED_ERR=(p[7]="No modification allowed",7);var y=A.NOT_FOUND_ERR=(p[8]="Not found",8);A.NOT_SUPPORTED_ERR=(p[9]="Not supported",9);var x=A.INUSE_ATTRIBUTE_ERR=(p[10]="Attribute in use",10);A.INVALID_STATE_ERR=(p[11]="Invalid state",11),A.SYNTAX_ERR=(p[12]="Syntax error",12),A.INVALID_MODIFICATION_ERR=(p[13]="Invalid modification",13),A.NAMESPACE_ERR=(p[14]="Invalid namespace",14),A.INVALID_ACCESS_ERR=(p[15]="Invalid access",15);function b(B,U){if(U instanceof Error)var L=U;else L=this,Error.call(this,p[B]),this.message=p[B],Error.captureStackTrace&&Error.captureStackTrace(this,b);return L.code=B,U&&(this.message=this.message+": "+U),L}b.prototype=Error.prototype,e(A,b);function M(){}M.prototype={length:0,item:function(B){return this[B]||null},toString:function(B,U){for(var L=[],Y=0;Y<this.length;Y++)jt(this[Y],L,B,U);return L.join("")}};function D(B,U){this._node=B,this._refresh=U,v(this)}function v(B){var U=B._node._inc||B._node.ownerDocument._inc;if(B._inc!=U){var L=B._refresh(B._node);ii(B,"length",L.length),e(L,B),B._inc=U}}D.prototype.item=function(B){return v(this),this[B]},t(D,M);function C(){}function I(B,U){for(var L=B.length;L--;)if(B[L]===U)return L}function S(B,U,L,Y){if(Y?U[I(U,Y)]=L:U[U.length++]=L,B){L.ownerElement=B;var W=B.ownerDocument;W&&(Y&&z(W,B,Y),G(W,B,L))}}function E(B,U,L){var Y=I(U,L);if(Y>=0){for(var W=U.length-1;Y<W;)U[Y]=U[++Y];if(U.length=W,B){var gt=B.ownerDocument;gt&&(z(gt,B,L),L.ownerElement=null)}}else throw b(y,new Error(B.tagName+"@"+L))}C.prototype={length:0,item:M.prototype.item,getNamedItem:function(B){for(var U=this.length;U--;){var L=this[U];if(L.nodeName==B)return L}},setNamedItem:function(B){var U=B.ownerElement;if(U&&U!=this._ownerElement)throw new b(x);var L=this.getNamedItem(B.nodeName);return S(this._ownerElement,this,B,L),L},setNamedItemNS:function(B){var U=B.ownerElement,L;if(U&&U!=this._ownerElement)throw new b(x);return L=this.getNamedItemNS(B.namespaceURI,B.localName),S(this._ownerElement,this,B,L),L},removeNamedItem:function(B){var U=this.getNamedItem(B);return E(this._ownerElement,this,U),U},removeNamedItemNS:function(B,U){var L=this.getNamedItemNS(B,U);return E(this._ownerElement,this,L),L},getNamedItemNS:function(B,U){for(var L=this.length;L--;){var Y=this[L];if(Y.localName==U&&Y.namespaceURI==B)return Y}return null}};function V(B){if(this._features={},B)for(var U in B)this._features=B[U]}V.prototype={hasFeature:function(B,U){var L=this._features[B.toLowerCase()];return!!(L&&(!U||U in L))},createDocument:function(B,U,L){var Y=new O;if(Y.implementation=this,Y.childNodes=new M,Y.doctype=L,L&&Y.appendChild(L),U){var W=Y.createElementNS(B,U);Y.appendChild(W)}return Y},createDocumentType:function(B,U,L){var Y=new ct;return Y.name=B,Y.nodeName=B,Y.publicId=U,Y.systemId=L,Y}};function T(){}T.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(B,U){return _(this,B,U)},replaceChild:function(B,U){this.insertBefore(B,U),U&&this.removeChild(U)},removeChild:function(B){return J(this,B)},appendChild:function(B){return this.insertBefore(B,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(B){return Vt(this.ownerDocument||this,this,B)},normalize:function(){for(var B=this.firstChild;B;){var U=B.nextSibling;U&&U.nodeType==o&&B.nodeType==o?(this.removeChild(U),B.appendData(U.data)):(B.normalize(),B=U)}},isSupported:function(B,U){return this.ownerDocument.implementation.hasFeature(B,U)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(B){for(var U=this;U;){var L=U._nsMap;if(L){for(var Y in L)if(L[Y]==B)return Y}U=U.nodeType==n?U.ownerDocument:U.parentNode}return null},lookupNamespaceURI:function(B){for(var U=this;U;){var L=U._nsMap;if(L&&B in L)return L[B];U=U.nodeType==n?U.ownerDocument:U.parentNode}return null},isDefaultNamespace:function(B){var U=this.lookupPrefix(B);return U==null}};function R(B){return B=="<"&&"&lt;"||B==">"&&"&gt;"||B=="&"&&"&amp;"||B=='"'&&"&quot;"||"&#"+B.charCodeAt()+";"}e(s,T),e(s,T.prototype);function N(B,U){if(U(B))return!0;if(B=B.firstChild)do if(N(B,U))return!0;while(B=B.nextSibling)}function O(){}function G(B,U,L){B&&B._inc++;var Y=L.namespaceURI;Y=="http://www.w3.org/2000/xmlns/"&&(U._nsMap[L.prefix?L.localName:""]=L.value)}function z(B,U,L,Y){B&&B._inc++;var W=L.namespaceURI;W=="http://www.w3.org/2000/xmlns/"&&delete U._nsMap[L.prefix?L.localName:""]}function q(B,U,L){if(B&&B._inc){B._inc++;var Y=U.childNodes;if(L)Y[Y.length++]=L;else{for(var W=U.firstChild,gt=0;W;)Y[gt++]=W,W=W.nextSibling;Y.length=gt}}}function J(B,U){var L=U.previousSibling,Y=U.nextSibling;return L?L.nextSibling=Y:B.firstChild=Y,Y?Y.previousSibling=L:B.lastChild=L,q(B.ownerDocument,B),U}function _(B,U,L){var Y=U.parentNode;if(Y&&Y.removeChild(U),U.nodeType===m){var W=U.firstChild;if(W==null)return U;var gt=U.lastChild}else W=gt=U;var Ot=L?L.previousSibling:B.lastChild;W.previousSibling=Ot,gt.nextSibling=L,Ot?Ot.nextSibling=W:B.firstChild=W,L==null?B.lastChild=gt:L.previousSibling=gt;do W.parentNode=B;while(W!==gt&&(W=W.nextSibling));return q(B.ownerDocument||B,B),U.nodeType==m&&(U.firstChild=U.lastChild=null),U}function tt(B,U){var L=U.parentNode;if(L){var Y=B.lastChild;L.removeChild(U);var Y=B.lastChild}var Y=B.lastChild;return U.parentNode=B,U.previousSibling=Y,U.nextSibling=null,Y?Y.nextSibling=U:B.firstChild=U,B.lastChild=U,q(B.ownerDocument,B,U),U}O.prototype={nodeName:"#document",nodeType:f,doctype:null,documentElement:null,_inc:1,insertBefore:function(B,U){if(B.nodeType==m){for(var L=B.firstChild;L;){var Y=L.nextSibling;this.insertBefore(L,U),L=Y}return B}return this.documentElement==null&&B.nodeType==r&&(this.documentElement=B),_(this,B,U),B.ownerDocument=this,B},removeChild:function(B){return this.documentElement==B&&(this.documentElement=null),J(this,B)},importNode:function(B,U){return wt(this,B,U)},getElementById:function(B){var U=null;return N(this.documentElement,function(L){if(L.nodeType==r&&L.getAttribute("id")==B)return U=L,!0}),U},getElementsByClassName:function(B){var U=new RegExp("(^|\\s)"+B+"(\\s|$)");return new D(this,function(L){var Y=[];return N(L.documentElement,function(W){W!==L&&W.nodeType==r&&U.test(W.getAttribute("class"))&&Y.push(W)}),Y})},createElement:function(B){var U=new $;U.ownerDocument=this,U.nodeName=B,U.tagName=B,U.childNodes=new M;var L=U.attributes=new C;return L._ownerElement=U,U},createDocumentFragment:function(){var B=new Kt;return B.ownerDocument=this,B.childNodes=new M,B},createTextNode:function(B){var U=new rt;return U.ownerDocument=this,U.appendData(B),U},createComment:function(B){var U=new ht;return U.ownerDocument=this,U.appendData(B),U},createCDATASection:function(B){var U=new Ct;return U.ownerDocument=this,U.appendData(B),U},createProcessingInstruction:function(B,U){var L=new Dt;return L.ownerDocument=this,L.tagName=L.target=B,L.nodeValue=L.data=U,L},createAttribute:function(B){var U=new dt;return U.ownerDocument=this,U.name=B,U.nodeName=B,U.localName=B,U.specified=!0,U},createEntityReference:function(B){var U=new At;return U.ownerDocument=this,U.nodeName=B,U},createElementNS:function(B,U){var L=new $,Y=U.split(":"),W=L.attributes=new C;return L.childNodes=new M,L.ownerDocument=this,L.nodeName=U,L.tagName=U,L.namespaceURI=B,Y.length==2?(L.prefix=Y[0],L.localName=Y[1]):L.localName=U,W._ownerElement=L,L},createAttributeNS:function(B,U){var L=new dt,Y=U.split(":");return L.ownerDocument=this,L.nodeName=U,L.name=U,L.namespaceURI=B,L.specified=!0,Y.length==2?(L.prefix=Y[0],L.localName=Y[1]):L.localName=U,L}},t(O,T);function $(){this._nsMap={}}$.prototype={nodeType:r,hasAttribute:function(B){return this.getAttributeNode(B)!=null},getAttribute:function(B){var U=this.getAttributeNode(B);return U&&U.value||""},getAttributeNode:function(B){return this.attributes.getNamedItem(B)},setAttribute:function(B,U){var L=this.ownerDocument.createAttribute(B);L.value=L.nodeValue=""+U,this.setAttributeNode(L)},removeAttribute:function(B){var U=this.getAttributeNode(B);U&&this.removeAttributeNode(U)},appendChild:function(B){return B.nodeType===m?this.insertBefore(B,null):tt(this,B)},setAttributeNode:function(B){return this.attributes.setNamedItem(B)},setAttributeNodeNS:function(B){return this.attributes.setNamedItemNS(B)},removeAttributeNode:function(B){return this.attributes.removeNamedItem(B.nodeName)},removeAttributeNS:function(B,U){var L=this.getAttributeNodeNS(B,U);L&&this.removeAttributeNode(L)},hasAttributeNS:function(B,U){return this.getAttributeNodeNS(B,U)!=null},getAttributeNS:function(B,U){var L=this.getAttributeNodeNS(B,U);return L&&L.value||""},setAttributeNS:function(B,U,L){var Y=this.ownerDocument.createAttributeNS(B,U);Y.value=Y.nodeValue=""+L,this.setAttributeNode(Y)},getAttributeNodeNS:function(B,U){return this.attributes.getNamedItemNS(B,U)},getElementsByTagName:function(B){return new D(this,function(U){var L=[];return N(U,function(Y){Y!==U&&Y.nodeType==r&&(B==="*"||Y.tagName==B)&&L.push(Y)}),L})},getElementsByTagNameNS:function(B,U){return new D(this,function(L){var Y=[];return N(L,function(W){W!==L&&W.nodeType===r&&(B==="*"||W.namespaceURI===B)&&(U==="*"||W.localName==U)&&Y.push(W)}),Y})}},O.prototype.getElementsByTagName=$.prototype.getElementsByTagName,O.prototype.getElementsByTagNameNS=$.prototype.getElementsByTagNameNS,t($,T);function dt(){}dt.prototype.nodeType=n,t(dt,T);function lt(){}lt.prototype={data:"",substringData:function(B,U){return this.data.substring(B,B+U)},appendData:function(B){B=this.data+B,this.nodeValue=this.data=B,this.length=B.length},insertData:function(B,U){this.replaceData(B,0,U)},appendChild:function(B){throw new Error(p[w])},deleteData:function(B,U){this.replaceData(B,U,"")},replaceData:function(B,U,L){var Y=this.data.substring(0,B),W=this.data.substring(B+U);L=Y+L+W,this.nodeValue=this.data=L,this.length=L.length}},t(lt,T);function rt(){}rt.prototype={nodeName:"#text",nodeType:o,splitText:function(B){var U=this.data,L=U.substring(B);U=U.substring(0,B),this.data=this.nodeValue=U,this.length=U.length;var Y=this.ownerDocument.createTextNode(L);return this.parentNode&&this.parentNode.insertBefore(Y,this.nextSibling),Y}},t(rt,lt);function ht(){}ht.prototype={nodeName:"#comment",nodeType:d},t(ht,lt);function Ct(){}Ct.prototype={nodeName:"#cdata-section",nodeType:l},t(Ct,lt);function ct(){}ct.prototype.nodeType=u,t(ct,T);function ft(){}ft.prototype.nodeType=g,t(ft,T);function ut(){}ut.prototype.nodeType=c,t(ut,T);function At(){}At.prototype.nodeType=a,t(At,T);function Kt(){}Kt.prototype.nodeName="#document-fragment",Kt.prototype.nodeType=m,t(Kt,T);function Dt(){}Dt.prototype.nodeType=h,t(Dt,T);function de(){}de.prototype.serializeToString=function(B,U,L){return ye.call(B,U,L)},T.prototype.toString=ye;function ye(B,U){var L=[],Y=this.nodeType==9&&this.documentElement||this,W=Y.prefix,gt=Y.namespaceURI;if(gt&&W==null){var W=Y.lookupPrefix(gt);if(W==null)var Ot=[{namespace:gt,prefix:null}]}return jt(this,L,B,U,Ot),L.join("")}function ue(B,U,L){var Y=B.prefix||"",W=B.namespaceURI;if(!Y&&!W||Y==="xml"&&W==="http://www.w3.org/XML/1998/namespace"||W=="http://www.w3.org/2000/xmlns/")return!1;for(var gt=L.length;gt--;){var Ot=L[gt];if(Ot.prefix==Y)return Ot.namespace!=W}return!0}function jt(B,U,L,Y,W){if(Y)if(B=Y(B),B){if(typeof B=="string"){U.push(B);return}}else return;switch(B.nodeType){case r:W||(W=[]),W.length;var gt=B.attributes,Ot=gt.length,Bt=B.firstChild,be=B.tagName;L=i===B.namespaceURI||L,U.push("<",be);for(var se=0;se<Ot;se++){var kt=gt.item(se);kt.prefix=="xmlns"?W.push({prefix:kt.localName,namespace:kt.value}):kt.nodeName=="xmlns"&&W.push({prefix:"",namespace:kt.value})}for(var se=0;se<Ot;se++){var kt=gt.item(se);if(ue(kt,L,W)){var Wt=kt.prefix||"",Ce=kt.namespaceURI,Li=Wt?" xmlns:"+Wt:" xmlns";U.push(Li,'="',Ce,'"'),W.push({prefix:Wt,namespace:Ce})}jt(kt,U,L,Y,W)}if(ue(B,L,W)){var Wt=B.prefix||"",Ce=B.namespaceURI;if(Ce){var Li=Wt?" xmlns:"+Wt:" xmlns";U.push(Li,'="',Ce,'"'),W.push({prefix:Wt,namespace:Ce})}}if(Bt||L&&!/^(?:meta|link|img|br|hr|input)$/i.test(be)){if(U.push(">"),L&&/^script$/i.test(be))for(;Bt;)Bt.data?U.push(Bt.data):jt(Bt,U,L,Y,W),Bt=Bt.nextSibling;else for(;Bt;)jt(Bt,U,L,Y,W),Bt=Bt.nextSibling;U.push("</",be,">")}else U.push("/>");return;case f:case m:for(var Bt=B.firstChild;Bt;)jt(Bt,U,L,Y,W),Bt=Bt.nextSibling;return;case n:return U.push(" ",B.name,'="',B.value.replace(/[<&"]/g,R),'"');case o:return U.push(B.data.replace(/[<&]/g,R).replace(/]]>/g,"]]&gt;"));case l:return U.push("<![CDATA[",B.data,"]]>");case d:return U.push("<!--",B.data,"-->");case u:var ys=B.publicId,De=B.systemId;if(U.push("<!DOCTYPE ",B.name),ys)U.push(" PUBLIC ",ys),De&&De!="."&&U.push(" ",De),U.push(">");else if(De&&De!=".")U.push(" SYSTEM ",De,">");else{var bs=B.internalSubset;bs&&U.push(" [",bs,"]"),U.push(">")}return;case h:return U.push("<?",B.target," ",B.data,"?>");case a:return U.push("&",B.nodeName,";");default:U.push("??",B.nodeName)}}function wt(B,U,L){var Y;switch(U.nodeType){case r:Y=U.cloneNode(!1),Y.ownerDocument=B;case m:break;case n:L=!0;break}if(Y||(Y=U.cloneNode(!1)),Y.ownerDocument=B,Y.parentNode=null,L)for(var W=U.firstChild;W;)Y.appendChild(wt(B,W,L)),W=W.nextSibling;return Y}function Vt(B,U,L){var Y=new U.constructor;for(var W in U){var gt=U[W];typeof gt!="object"&&gt!=Y[W]&&(Y[W]=gt)}switch(U.childNodes&&(Y.childNodes=new M),Y.ownerDocument=B,Y.nodeType){case r:var Ot=U.attributes,be=Y.attributes=new C,se=Ot.length;be._ownerElement=Y;for(var kt=0;kt<se;kt++)Y.setAttributeNode(Vt(B,Ot.item(kt),!0));break;case n:L=!0}if(L)for(var Wt=U.firstChild;Wt;)Y.appendChild(Vt(B,Wt,L)),Wt=Wt.nextSibling;return Y}function ii(B,U,L){B[U]=L}try{if(Object.defineProperty){let B=function(U){switch(U.nodeType){case r:case m:var L=[];for(U=U.firstChild;U;)U.nodeType!==7&&U.nodeType!==8&&L.push(B(U)),U=U.nextSibling;return L.join("");default:return U.nodeValue}};Object.defineProperty(D.prototype,"length",{get:function(){return v(this),this.$$length}}),Object.defineProperty(T.prototype,"textContent",{get:function(){return B(this)},set:function(U){switch(this.nodeType){case r:case m:for(;this.firstChild;)this.removeChild(this.firstChild);(U||String(U))&&this.appendChild(this.ownerDocument.createTextNode(U));break;default:this.data=U,this.value=U,this.nodeValue=U}}}),ii=function(U,L,Y){U["$$"+L]=Y}}}catch{}return Ve.Node=T,Ve.DOMException=b,Ve.DOMImplementation=V,Ve.XMLSerializer=de,Ve}var mr;function Jc(){if(mr)return Fe;mr=1;function e(f){this.options=f||{locator:{}}}e.prototype.parseFromString=function(f,u){var m=this.options,g=new c,A=m.domBuilder||new i,p=m.errorHandler,w=m.locator,y=m.xmlns||{},x=/\/x?html?$/.test(u),b=x?l.entityMap:{lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return w&&A.setDocumentLocator(w),g.errorHandler=t(p,A,w),g.domBuilder=m.domBuilder||A,x&&(y[""]="http://www.w3.org/1999/xhtml"),y.xml=y.xml||"http://www.w3.org/XML/1998/namespace",f&&typeof f=="string"?g.parse(f,y,b):g.errorHandler.error("invalid doc source"),A.doc};function t(f,u,m){if(!f){if(u instanceof i)return u;f=u}var g={},A=f instanceof Function;m=m||{};function p(w){var y=f[w];!y&&A&&(y=f.length==2?function(x){f(w,x)}:f),g[w]=y&&function(x){y("[xmldom "+w+"]	"+x+r(m))}||function(){}}return p("warning"),p("error"),p("fatalError"),g}function i(){this.cdata=!1}function s(f,u){u.lineNumber=f.lineNumber,u.columnNumber=f.columnNumber}i.prototype={startDocument:function(){this.doc=new d().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(f,u,m,g){var A=this.doc,p=A.createElementNS(f,m||u),w=g.length;o(this,p),this.currentElement=p,this.locator&&s(this.locator,p);for(var y=0;y<w;y++){var f=g.getURI(y),x=g.getValue(y),m=g.getQName(y),b=A.createAttributeNS(f,m);this.locator&&s(g.getLocator(y),b),b.value=b.nodeValue=x,p.setAttributeNode(b)}},endElement:function(f,u,m){var g=this.currentElement;g.tagName,this.currentElement=g.parentNode},startPrefixMapping:function(f,u){},endPrefixMapping:function(f){},processingInstruction:function(f,u){var m=this.doc.createProcessingInstruction(f,u);this.locator&&s(this.locator,m),o(this,m)},ignorableWhitespace:function(f,u,m){},characters:function(f,u,m){if(f=n.apply(this,arguments),f){if(this.cdata)var g=this.doc.createCDATASection(f);else var g=this.doc.createTextNode(f);this.currentElement?this.currentElement.appendChild(g):/^\s*$/.test(f)&&this.doc.appendChild(g),this.locator&&s(this.locator,g)}},skippedEntity:function(f){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(f){(this.locator=f)&&(f.lineNumber=0)},comment:function(f,u,m){f=n.apply(this,arguments);var g=this.doc.createComment(f);this.locator&&s(this.locator,g),o(this,g)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(f,u,m){var g=this.doc.implementation;if(g&&g.createDocumentType){var A=g.createDocumentType(f,u,m);this.locator&&s(this.locator,A),o(this,A)}},warning:function(f){console.warn("[xmldom warning]	"+f,r(this.locator))},error:function(f){console.error("[xmldom error]	"+f,r(this.locator))},fatalError:function(f){throw new h(f,this.locator)}};function r(f){if(f)return`
@`+(f.systemId||"")+"#[line:"+f.lineNumber+",col:"+f.columnNumber+"]"}function n(f,u,m){return typeof f=="string"?f.substr(u,m):f.length>=u+m||u?new java.lang.String(f,u,m)+"":f}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(f){i.prototype[f]=function(){return null}});function o(f,u){f.currentElement?f.currentElement.appendChild(u):f.doc.appendChild(u)}var l=jc(),a=Zc(),c=a.XMLReader,h=a.ParseError,d=Fe.DOMImplementation=ur().DOMImplementation;return Fe.XMLSerializer=ur().XMLSerializer,Fe.DOMParser=e,Fe.__DOMHandler=i,Fe}var _c=Jc();function $c(e){const t=new DataView(e.buffer);let i=0;function s(){const o=t.getUint32(i,!0);return i+=4,o}function r(){const o=t.getUint16(i,!0);return i+=2,o}function n(){const o=t.getFloat64(i,!0);return i+=8,o}return{MagicNumber:s(),StructureSize:s(),DimensionX:s(),DimensionY:s(),DimensionZ:s(),DimensionChannels:s(),DimensionTime:s(),IntensityDataType:s(),ThumbnailX:s(),ThumbnailY:s(),VoxelSizeX:n(),VoxelSizeY:n(),VoxelSizeZ:n(),OriginX:n(),OriginY:n(),OriginZ:n(),ScanType:r(),SpectralScan:r(),DataType:s(),OffsetVectorOverlay:s(),OffsetInputLut:s(),OffsetOutputLut:s(),OffsetChannelColors:s(),TimeInterval:n(),OffsetChannelDataTypes:s(),OffsetScanInformation:s(),OffsetKsData:s(),OffsetTimeStamps:s(),OffsetEventList:s(),OffsetRoi:s(),OffsetBleachRoi:s(),OffsetNextRecording:s(),DisplayAspectX:n(),DisplayAspectY:n(),DisplayAspectZ:n(),DisplayAspectTime:n(),OffsetMeanOfRoisOverlay:s(),OffsetTopoIsolineOverlay:s(),OffsetTopoProfileOverlay:s(),OffsetLinescanOverlay:s(),ToolbarFlags:s(),OffsetChannelWavelength:s(),OffsetChannelFactors:s(),ObjectiveSphereCorrection:n(),OffsetUnmixParameters:s()}}async function th(e,t=!1,i=0){try{let s=e;if(e instanceof Uint8Array&&(s=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)),!(s instanceof ArrayBuffer))throw new Error("Unsupported input type: Expected Buffer or ArrayBuffer");const r=await Xc(s);let n=await r.getImageCount();const o=[],l=new Array(n).fill(0),a=[];for(let T=0;T<n;T++){const R=await r.getImage(T);o.push(R);const N=R.getWidth(),O=R.getHeight(),G=R.getSamplesPerPixel(),z=R.getBytesPerPixel()*8,q=`${N}x${O}c${G}b${z}`;let J=a.indexOf(q);J===-1&&(a.push(q),J=a.length-1),l[T]=J}const c=o[0].getFileDirectory();if(a.length>1){(i>=a.length||i<0)&&(i=0);const T=i,R=[];for(let N=0;N<n;N++)l[N]===T&&R.push(o[N]);o.length=0,o.push(...R),n=o.length,t&&console.log(`${o.length} of ${a.length} possible slices match dimensions of stackGroup ${i}`)}const h=o[0].getWidth(),d=o[0].getHeight();let f=o[0].getSamplesPerPixel();const u=o[0].getBytesPerPixel()*8,m=new et;m.littleEndian=!0,m.vox_offset=352,m.scl_inter=0,m.scl_slope=1,m.magic="n+1",m.pixDims=[1,1,1,1,1,0,0,0];let g=1,A=1,p=1,w=!1;if((c==null?void 0:c.undefined)instanceof Uint8Array&&c.undefined.length>=224&&c.undefined[0]===76&&c.undefined[1]===73&&c.undefined[2]===0&&c.undefined[3]===4){const T=$c(c.undefined),R=T.DimensionX/h;m.pixDims[1]=R*T.VoxelSizeX*1e6;const N=T.DimensionY/d;m.pixDims[2]=N*T.VoxelSizeY*1e6,m.pixDims[3]=T.VoxelSizeZ*1e6,m.pixDims[4]=T.TimeInterval,m.xyzt_units=11,g=T.DimensionZ,A=T.DimensionTime,p=T.DimensionChannels,w=!0,n!==g*A*p&&(n===g*A?p=1:(console.warn(`Inconsistent LSM TIFF ${g}${A}${p} != ${n} (perhaps multi-dimensional)`),console.warn(`${h}${d}c${f}bpp${u}`)))}const y=c==null?void 0:c.ImageDescription,x=new Array(n).fill(0).map((T,R)=>R);if(y!=null&&y.includes("ImageJ=")){const T=y.match(/slices=(\d+)/),R=y.match(/frames=(\d+)/),N=y.match(/channels=(\d+)/),O=y.match(/spacing=([\d.]+)/),G=y.match(/unit=([\S]+)/);g=T?parseInt(T[1],10):1,A=R?parseInt(R[1],10):1,p=N?parseInt(N[1],10):1;const z=O?parseFloat(O[1]):1;let q=(c==null?void 0:c.ResolutionUnit)===2?2.54:1;const J=c!=null&&c.XResolution?c.XResolution[0]/c.XResolution[1]:1;m.pixDims[1]=q/J;const _=c!=null&&c.YResolution?c.YResolution[0]/c.YResolution[1]:1;m.pixDims[2]=q/_,m.pixDims[3]=z;const tt=G?G[1]:"";if(["m","m","m"].includes(tt)&&(m.xyzt_units=3),n>1&&g*A*p===n){const dt=y.indexOf("slices="),lt=y.indexOf("frames="),rt=y.indexOf("channels=");let ht=1;dt>lt&&(ht*=A),dt>rt&&(ht*=p);let Ct=1;lt>dt&&(Ct*=g),lt>rt&&(Ct*=p);let ct=1;rt>dt&&(ct*=g),rt>lt&&(ct*=A);for(let ft=0;ft<n;ft++){const ut=Math.floor(ft/ht)%g,At=Math.floor(ft/Ct)%A,Kt=Math.floor(ft/ct)%p,Dt=ut+At*g+Kt*g*A;x[ft]=Dt}}}if(y!=null&&y.includes("<OME xml")){const R=new _c.DOMParser().parseFromString(y,"text/xml"),N=R.getElementsByTagName("Pixels")[0];g=parseInt((N==null?void 0:N.getAttribute("SizeZ"))||"1",10),A=parseInt((N==null?void 0:N.getAttribute("SizeT"))||"1",10),p=parseInt((N==null?void 0:N.getAttribute("SizeC"))||"1",10),m.pixDims[1]=parseFloat((N==null?void 0:N.getAttribute("PhysicalSizeX"))||"1"),m.pixDims[2]=parseFloat((N==null?void 0:N.getAttribute("PhysicalSizeY"))||"1"),m.pixDims[3]=parseFloat((N==null?void 0:N.getAttribute("PhysicalSizeZ"))||"1");const O=(N==null?void 0:N.getAttribute("PhysicalSizeXUnit"))||"";O==="m"&&(m.xyzt_units=3),O==="mm"&&(m.xyzt_units=2);const G=R.getElementsByTagName("Plane");if(G.length>0){const z=new Array(n).fill(0),q=new Array(n).fill(0),J=new Array(n).fill(0);for(let _=0;_<Math.min(G.length,n);_++){const tt=G[_];z[_]=parseInt(tt.getAttribute("TheZ")||"0",10),q[_]=parseInt(tt.getAttribute("TheT")||"0",10),J[_]=parseInt(tt.getAttribute("TheC")||"0",10)}for(let _=0;_<n;_++){const tt=z[_]+q[_]*g+J[_]*g*A;x[_]=tt}t&&console.log(`OME SizeZ: ${g}, SizeT: ${A}, SizeC: ${p}`)}}m.dims=[3,h,d,n,0,0,0,0],g*A*p===n&&A*p>1&&n>1&&(m.dims[0]=4,m.dims[3]=g,m.dims[4]=A,p>1&&(m.dims[0]=5,m.dims[5]=p));let b=!1;const M=c!=null&&c.SampleFormat?c.SampleFormat[0]:void 0;if(u===16&&f===1)m.numBitsPerVoxel=16,M===2?m.datatypeCode=4:m.datatypeCode=512;else if(u===8&&f===1)m.numBitsPerVoxel=8,m.datatypeCode=2;else if(u===16&&f===2)b=!0,f=3,m.numBitsPerVoxel=24,m.datatypeCode=128;else if(u===24&&f===3)m.numBitsPerVoxel=24,m.datatypeCode=128;else if(u===32&&f===1)m.numBitsPerVoxel=32,M===2?m.datatypeCode=8:M===3?m.datatypeCode=16:m.datatypeCode=768;else if(u===32&&f===4)m.numBitsPerVoxel=32,m.datatypeCode=2304;else throw new Error(`Unsupported TIFF bit depth: ${u}, channels: ${f}`);t&&console.log(`NIfTI dimensions: ${m.dims.slice(1).join("")}, bit-depth: ${u}, channels: ${f}, pixDims: ${m.pixDims.slice(1,4).join("")} unit: ${m.xyzt_units}`);const D=h*d*n;let v;switch(m.datatypeCode){case 4:v=new Int16Array(D);break;case 8:v=new Int32Array(D);break;case 16:v=new Float32Array(D);break;case 512:v=new Uint16Array(D);break;case 768:v=new Uint32Array(D);break;default:v=new Uint8Array(D*f);break}for(let T=0;T<n;T++){const R=x[T];if(R<0||R>=n)throw new Error("Fatal slice-order error");let G=await o[T].readRasters({interleave:!0});if(b){const q=new Uint8Array(G),J=h*d,_=new Uint8Array(J*3);let tt=0;for(let $=0;$<q.length;$+=2)_[tt++]=q[$],_[tt++]=q[$+1],_[tt++]=0;G=_}const z=R*h*d*f;G instanceof Uint8Array&&v instanceof Uint8Array,v.set(G,z)}const C=new Uint8Array(v.buffer),I=[m.pixDims[1],m.pixDims[2],m.pixDims[3]],S=[m.dims[1],m.dims[2],m.dims[3]];m.affine=[[I[0],0,0,-(I[0]*S[0]/2)],[0,I[1],0,-(I[1]*S[1]/2)],[0,0,I[2],-(I[2]*S[2]/2)],[0,0,0,1]];const E=m.toArrayBuffer(),V=new Uint8Array(E.byteLength+C.byteLength);return V.set(new Uint8Array(E),0),V.set(C,E.byteLength),{niftiImage:V,stackConfigs:a}}catch(s){throw s}}async function Qe(e,t=!1){const i=await th(e,t,0);if(!i)throw new Error("No valid NIfTI image data");return i.niftiImage}async function eh(e){const t=document.getElementById("dragSelect");t.onchange=function(){const a=t.options[t.selectedIndex].text;a==="None"?s.opts.dragMode=s.dragModes.none:a==="Contrast"?s.opts.dragMode=s.dragModes.contrast:a==="Measurement"?s.opts.dragMode=s.dragModes.measurement:a==="Pan"&&(s.opts.dragMode=s.dragModes.pan)};const i=a=>{const c=document.getElementById("statusText");c.innerHTML="&nbsp;&nbsp;"+a.string+` slice: ${a.vox[2]+1}/${s.back.dims[3]}`},s=new Pl;s.onLocationChange=i,window.addEventListener("DOMContentLoaded",async()=>{const c=new URLSearchParams(window.location.search).get("image");let h="/mni.tiff";c&&(console.log("Image URL detected:",c),h=c);var d=[{url:h,limitFrames4D:5}];await s.loadVolumes(d)}),s.useLoader(Qe,"tif","nii"),s.useLoader(Qe,"tiff","nii"),s.useLoader(Qe,"lsm","nii"),s.useLoader(Qe,"tf8","nii"),s.useLoader(Qe,"btf","nii"),await s.attachToCanvas(e),s.onImageLoaded=a=>{s.setVolumeRenderIllumination(0),s.volumes[0].hdr.dims[3]>1?(n.style.display="inline-block",o.style.display="inline-block"):(n.style.display="none",o.style.display="none",s.setSliceType(s.sliceTypeAxial))};const r=document.getElementById("smoothCheck");r.onchange=function(){s.setInterpolation(r.checked)};const n=document.getElementById("prevBtn");n.onclick=async function(){s.moveCrosshairInVox(0,0,-1)};const o=document.getElementById("nextBtn");o.onclick=async function(){s.moveCrosshairInVox(0,0,1)};const l=document.getElementById("aboutBtn");l.onclick=async function(){alert("NiiVue visualization")},s.setSliceType(s.sliceTypeMultiplanar),s.graph.autoSizeMultiplanar=!0,s.graph.normalizeValues=!1,s.graph.opacity=1,s.opts.multiplanarShowRender=kr.ALWAYS}async function ih(){await eh(document.querySelector("#nvCanvas"))}ih();export{nh as L,oh as a,ls as g};
